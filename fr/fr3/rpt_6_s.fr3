<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="3.22" DotMatrixReport="False" EngineOptions.ConvertNulls="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" ReportOptions.CreateDate="38287.7802357292" ReportOptions.Description.Text="" ReportOptions.Name="Отчёт движения товаров на СВХ (Форма №2)" ReportOptions.LastChange="39031.7175011111" ScriptLanguage="PascalScript" ScriptText.Text="Var&#13;&#10;  CustomDocsOnly, AistCompatible, StoreDocsBlock: Integer;&#13;&#10;  NoArchive: Integer;&#13;&#10;  vPlaceID, vID, vG32: Integer;&#13;&#10;  dtPeriodEnd, dtPeriodStart, OutRelPeriodStart: TDateTime;&#13;&#10;  vRelDocNos, vRelDates, vRelG311, vRelG35: String;&#13;&#10;  vG312 : String;&#13;&#10;  strPeriod: String;&#13;&#10;&#13;&#10;  vOutDate: String;&#13;&#10;  vBDDate : TDateTime;&#13;&#10;&#13;&#10;  rsG311, rsG35, rsG42: Double;&#13;&#10;  riG311, riG35, riG42: Double;&#13;&#10;  roG311, roG35, roG42: Double;&#13;&#10;  rfG311, rfG35, rfG42: Double;&#13;&#10;&#13;&#10;  tsG311, tsG35, tsG42: Double;&#13;&#10;  tiG311, tiG35, tiG42: Double;&#13;&#10;  toG311, toG35, toG42: Double;&#13;&#10;  tfG311, tfG35, tfG42: Double;&#13;&#10;&#13;&#10;  vLastReleaseDate: TDateTime;&#13;&#10;  vFilterCrit, vSQL: String;&#13;&#10;  vLine: Integer; vLinePrint: String;&#13;&#10;  vStoreDate, vDONum, vOwner: String;&#13;&#10;  vUseStoreDocs, vCanPrint: Boolean;&#13;&#10;&#13;&#10;  sDataSetName: String;&#13;&#10;&#13;&#10;procedure SetLine(ID: Integer);&#13;&#10;var&#13;&#10;  vCurID: Integer;&#13;&#10;begin&#13;&#10;  vLinePrint := '';&#13;&#10;  vStoreDate := '';&#13;&#10;  vDONum := '';&#13;&#10;  vOwner := '';&#13;&#10;  vG312 := '';&#13;&#10;  vLine := vLine + 1;&#13;&#10;  vLinePrint := IntToStr(vLine);&#13;&#10;  //Номер ДО1(мв)&#13;&#10;  vDONum := COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;NBD&#34;)');&#13;&#10;  // описание товара&#13;&#10;  vG312 := &#60;KRD_COMM_2.&#34;G312&#34;&#62;;&#13;&#10;  // подсчет сумм&#13;&#10;  tsG311 := tsG311 + rsG311;&#13;&#10;  tsG35 :=  tsG35  + rsG35;&#13;&#10;  tsG42 :=  tsG42  + rsG42;&#13;&#10;&#13;&#10;  tiG311 := tiG311 + riG311;&#13;&#10;  tiG35 :=  tiG35  + riG35;&#13;&#10;  tiG42 :=  tiG42  + riG42;&#13;&#10;&#13;&#10;  toG311 := toG311 + roG311;&#13;&#10;  toG35 :=  toG35  + roG35;&#13;&#10;  toG42 :=  toG42  + roG42;&#13;&#10;&#13;&#10;  tfG311 := tfG311 + rfG311;&#13;&#10;  tfG35 :=  tfG35  + rfG35;&#13;&#10;  tfG42 :=  tfG42  + rfG42;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure btnCallRefOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with btnCallRef, Engine do&#13;&#10;  begin&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreNumLic&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreNum&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreName&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strLicExt&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;sPlaceId&#34;,Integer)');&#13;&#10;    COMPUTE('OPENQUERY (&#34;Stors&#34;, &#34;STS_DB&#34;, &#34;Select * from STORES&#34;)');&#13;&#10;    COMPUTE('SelectValues(&#34;Список складов&#34;, &#34;Stors&#34;,[[&#34;LICENCENO&#34;,   &#34;Номер лицензии&#34;, 15],[&#34;LICENCENO_EXT&#34;,   &#34; &#34;, 1],[&#34;STORE_NO&#34;,   &#34;Номер склада&#34;, 15],[&#34;NAME&#34;,   &#34;Название склада&#34;, 30],[&#34;PlaceId&#34;,   &#34;&#34;, 10]],[[&#34;LICENCENO&#34;, &#34;strStoreNumLic&#34;],[&#34;STORE_NO&#34;, &#34;strStoreNum&#34;],[&#34;NAME&#34;, &#34;strStoreName&#34;],[&#34;LICENCENO_EXT&#34;, &#34;strLicExt&#34;],[&#34;PlaceId&#34;, &#34;sPlaceId&#34;],],&#34;&#34;, &#34;STS_DB&#34;)');&#13;&#10;&#13;&#10;&#13;&#10;    fldStoreLicNum.Text := COMPUTE('Value(&#34;strStoreNumLic&#34;)') ;      //   номер лицензии&#13;&#10;    fldStoreNum.Text := '№ склада: ' + COMPUTE('value(&#34;strStoreNum&#34;)') ; //   номер склада&#13;&#10;    lblStoreName.Caption := COMPUTE('Value(&#34;strStoreName&#34;)') ;     //   название склада&#13;&#10;    fldLicExt.Text := COMPUTE('Value(&#34;strLIcExt&#34;)');     //   Признак перерегистрации&#13;&#10;    vPlaceId := StrToInt(COMPUTE('Value(&#34;sPlaceId&#34;)'));&#13;&#10;    if Length(COMPUTE('Value(&#34;strStoreNumLic&#34;)')) &#62; 0 then&#13;&#10;      cbtnOk.Enabled := True&#13;&#10;    else cbtnOk.Enabled := False;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure cbtnOkOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with cbtnOk, Engine do begin&#13;&#10;&#13;&#10;      dtPeriodStart := STRTODATE('27.02.1976') + STRTOTIME('00:00:01');&#13;&#10;      dtPeriodEnd := Trunc(dtTo.Date) + STRTOTIME('23:59:59');&#13;&#10;      //Начало периода для подсчета кол-ва на начало периода&#13;&#10;      OutRelPeriodStart := Trunc(dtFrom.Date);&#13;&#10;      strPeriod := 'с ' + FORMATDATETIME(&#34;DD MMMM YYYY&#34;, OutRelPeriodStart) + ' по ' + FORMATDATETIME(&#34;DD MMMM YYYY&#34;, dtPeriodend);&#13;&#10;&#13;&#10;      vSQL := 'SELECT * FROM KRD_MAIN WHERE PLACEID = ' + IntToStr(vPlaceId) +&#13;&#10;              ' AND BD_DATE &#60;= ' + CHR(39) + VarToStr(dtPeriodEnd) + CHR(39) +&#13;&#10;              ' ORDER BY BD_DATE, NBD';&#13;&#10;      COMPUTE('OPENQUERY(&#34;QRYKRDMAIN2&#34;, &#34;STS_DB&#34;, &#34;' + vSQL + '&#34;)');&#13;&#10;      sDataSetName := 'QRYKRDMAIN2';&#13;&#10;      Band1.RowCount := StrToInt(COMPUTE('RECORDCOUNT(&#34;QRYKRDMAIN2&#34;)'));&#13;&#10;&#13;&#10;    //Чтобы взять информацию о складе&#13;&#10;    COMPUTE('FINDKEY(&#34;STORES_2&#34;, [&#34;' + IntToStr(vPlaceId) + '&#34;])');&#13;&#10;&#13;&#10;    //сохраняем настройки&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;'+DATETOSTR(dtFrom.Date)+'&#34;)');&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;'+DateToStr(dtTo.Date)+'&#34;)');&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;'+IntToStr(vPlaceId)+'&#34;)');&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band3OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');&#13;&#10;  COMPUTE('CLOSEDATASET(&#34;QRYKRDMAIN2&#34;)');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  fldLicExt.Text := '';&#13;&#10;  fldStoreLicNum.Text := '';&#13;&#10;  fldStoreNum.Text := '';&#13;&#10;&#13;&#10;  vPlaceId:=StrToInt(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;0&#34;)'));&#13;&#10;  If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;])') then begin&#13;&#10;     fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;     fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;     lblStoreName.Caption := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;     fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;     vCanPrint := True;&#13;&#10;     cbtnOk.Enabled := True;&#13;&#10;  end&#13;&#10;  else begin&#13;&#10;    vPlaceId:=StrToInt(COMPUTE('INIFILE(&#34;WorkPlace&#34;,&#34;PlaceNum&#34;,&#34;0&#34;)'));&#13;&#10;    If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;])') then begin&#13;&#10;      fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;      fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;      lblStoreName.Caption := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;      fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;      vCanPrint := True;&#13;&#10;      cbtnOk.Enabled := True;&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      fldStoreLicNum.Text := '';&#13;&#10;      fldStoreNum.Text := '№ склада: ';&#13;&#10;      lblStoreName.Caption := '';&#13;&#10;      fldLicExt.Text := '';&#13;&#10;      vCanPrint := False;&#13;&#10;      cbtnOk.Enabled := False;&#13;&#10;    end&#13;&#10;  end;&#13;&#10;&#13;&#10;  dtFrom.Date := STRTODATEDEF(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;&#34;)'), DATE);&#13;&#10;  dtTo.Date := STRTODATEDEF(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;&#34;)'), DATE);&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DetailData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  vPlaceID := StrToInt(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;PLACEID&#34;)'));&#13;&#10;  //Запомним ID для установки номера текущей строки&#13;&#10;  vID := StrToInt(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;ID&#34;)'));&#13;&#10;  vG32 := STRtoInt(&#60;KRD_COMM_2.&#34;G32&#34;&#62;);&#13;&#10;&#13;&#10;  vBDDate := StrToDateDef(LeftCopy(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;BD_DATE&#34;)'), 10), Date);&#13;&#10;&#13;&#10;  if Not vUseStoreDocs then&#13;&#10;    begin&#13;&#10;      riG311 := iif(&#60;KRD_COMM_2.&#34;FACT_G311&#34;&#62; &#60;&#62; Null, &#60;KRD_COMM_2.&#34;FACT_G311&#34;&#62;, 0);&#13;&#10;      riG35 := iif(&#60;KRD_COMM_2.&#34;FACT_G35&#34;&#62; &#60;&#62; Null, &#60;KRD_COMM_2.&#34;FACT_G35&#34;&#62;, 0);&#13;&#10;      riG42 := iif(&#60;KRD_COMM_2.&#34;FACT_G42&#34;&#62; &#60;&#62; Null, &#60;KRD_COMM_2.&#34;FACT_G42&#34;&#62;, 0);&#13;&#10;    end&#13;&#10;  else&#13;&#10;    if COMPUTE('FINDKEY(&#34;IN_COMM_2&#34;, [&#34;' + IntToStr(vPlaceId) + '&#34;, &#34;' + IntToStr(vID) + '&#34;, &#34;' + IntToStr(vG32) +'&#34;])') &#60;&#62; '0' then&#13;&#10;      begin&#13;&#10;        riG311 := iif(&#60;IN_COMM_2.&#34;G311&#34;&#62; &#60;&#62; Null, &#60;IN_COMM_2.&#34;G311&#34;&#62;, 0);&#13;&#10;        riG35 := iif(&#60;IN_COMM_2.&#34;G35&#34;&#62; &#60;&#62; Null, &#60;IN_COMM_2.&#34;G35&#34;&#62;, 0);&#13;&#10;        riG42 := iif(&#60;IN_COMM_2.&#34;G42&#34;&#62; &#60;&#62; Null, &#60;IN_COMM_2.&#34;G42&#34;&#62;, 0);&#13;&#10;      end&#13;&#10;    else&#13;&#10;      begin&#13;&#10;        riG311 := iif(&#60;KRD_COMM_2.&#34;G311&#34;&#62; &#60;&#62; Null, &#60;KRD_COMM_2.&#34;G311&#34;&#62;, 0);&#13;&#10;        riG35 := iif(&#60;KRD_COMM_2.&#34;G35&#34;&#62; &#60;&#62; Null, &#60;KRD_COMM_2.&#34;G35&#34;&#62;, 0);&#13;&#10;        riG42 := iif(&#60;KRD_COMM_2.&#34;G42&#34;&#62; &#60;&#62; Null, &#60;KRD_COMM_2.&#34;G42&#34;&#62;, 0);&#13;&#10;      end;&#13;&#10;  // подсчет остатоков на начало периода и что прибыло в период&#13;&#10;//  ShowMessage(vBDDate);&#13;&#10;//  ShowMessage(OutRelPeriodStart);&#13;&#10;  if vBDDate &#60; OutRelPeriodStart then&#13;&#10;    begin&#13;&#10;      if  not vUseStoreDocs then  begin&#13;&#10;        ReleaseAtPeriod(vPLaceId, vID, vG32,&#13;&#10;                  EncodeDate(1976, 2, 27),&#13;&#10;                  OutRelPeriodStart-1,&#13;&#10;                  rsG311, rsG35, rsG42, vLastReleaseDate);&#13;&#10;      end&#13;&#10;      else begin&#13;&#10;        OutAtPeriod(vPLaceId, vID, vG32,&#13;&#10;                  EncodeDate(1976, 2, 27),&#13;&#10;                  OutRelPeriodStart-1,&#13;&#10;                  rsG311, rsG35, rsG42, vLastReleaseDate);&#13;&#10;      end;&#13;&#10;      rsG311 := riG311 - rsG311;&#13;&#10;      rsG35 := riG35  - rsG35;&#13;&#10;      rsG42 := riG42  - rsG42;&#13;&#10;      riG311 := 0;&#13;&#10;      riG35 := 0;&#13;&#10;      riG42 := 0;&#13;&#10;    end&#13;&#10;  else&#13;&#10;    begin&#13;&#10;      rsG311 := 0;&#13;&#10;      rsG35 := 0;&#13;&#10;      rsG42 := 0;&#13;&#10;    end;&#13;&#10;  // подсчет остатоков на конец периода и что убыло за период&#13;&#10;  if  not vUseStoreDocs  then&#13;&#10;    ReleaseAtPeriod(vPLaceId, vID, vG32,&#13;&#10;              OutRelPeriodStart,&#13;&#10;              dtPeriodEnd,&#13;&#10;              roG311, roG35, roG42, vLastReleaseDate)&#13;&#10;  else&#13;&#10;    OutAtPeriod(vPLaceId, vID, vG32,&#13;&#10;              OutRelPeriodStart,&#13;&#10;              dtPeriodEnd,&#13;&#10;              roG311, roG35, roG42, vLastReleaseDate);&#13;&#10;  rfG311 := rsG311 + riG311 - roG311;&#13;&#10;  rfG35 :=  rsG35  + riG35  - roG35;&#13;&#10;  rfG42 :=  rsG42  + riG42  - roG42;&#13;&#10;&#13;&#10;  // если товар не нулевой - печатаем&#13;&#10;  if ((rfG311 &#60;&#62; 0) or (rsG311 &#60;&#62; 0) or (riG311 &#60;&#62; 0) or (roG311 &#60;&#62; 0) or (rfG35 &#60;&#62; 0) or (rsG35 &#60;&#62; 0) or (riG35 &#60;&#62; 0) or (roG35 &#60;&#62; 0)) then&#13;&#10;    begin&#13;&#10;      DetailData1.Visible := True;&#13;&#10;      SetLine(vId);&#13;&#10;    end&#13;&#10;  else DetailData1.Visible := False;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; COMPUTE('FIRST(&#34;' + sDataSetName + '&#34;)');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');&#13;&#10;  COMPUTE('SETRANGE(&#34;KRD_COMM_2&#34;, [&#34;' + VarToStr(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;PLACEID&#34;)')) + '&#34;, &#34;' +&#13;&#10;                                        VarToStr(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;ID&#34;)')) + '&#34;])');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Footer1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('NEXT(&#34;QRYKRDMAIN2&#34;)')&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;begin&#13;&#10;  //Взяли из ini-шника &#34;Только таможенные документы учета&#34;&#13;&#10;  CustomDocsOnly := StrToInt(COMPUTE('INIFILE(&#34;RegBook&#34;, &#34;CustomsDocsOnly&#34;, 0)'));&#13;&#10;  //Включена ли настройка &#34;Совместимость с АИСТом&#34;, 1-да, 0-нет&#13;&#10;  AistCompatible := StrToInt(COMPUTE('INIFILE(&#34;Docs&#34;, &#34;AistCompatible&#34;, &#34;0&#34;)'));&#13;&#10;  //Отключен ли блок складских документов&#13;&#10;  StoreDocsBlock := StrToInt(COMPUTE('INIFILE(&#34;Database&#34;, &#34;StoreDocsBlock&#34;, &#34;0&#34;)'));&#13;&#10;  if (StoreDocsBlock = 1) and ((AistCompatible = 1) or ((AistCompatible = 0) and (CustomDocsOnly = 0))) then&#13;&#10;    vUseStoreDocs := True&#13;&#10;  else vUseStoreDocs := False;&#13;&#10;  rsG311 := 0; rsG35 := 0; rsG42 := 0;&#13;&#10;  riG311 := 0; riG35 := 0; riG42 := 0;&#13;&#10;  roG311 := 0; roG35 := 0; roG42 := 0;&#13;&#10;  rfG311 := 0; rfG35 := 0; rfG42 := 0;&#13;&#10;&#13;&#10;  tsG311 := 0; tsG35 := 0; tsG42 := 0;&#13;&#10;  tiG311 := 0; tiG35 := 0; tiG42 := 0;&#13;&#10;  toG311 := 0; toG35 := 0; toG42 := 0;&#13;&#10;  tfG311 := 0; tfG35 := 0; tfG42 := 0;&#13;&#10;&#13;&#10;end." OnStartReport="OnStartReport" PropData="08446174617365747301010C2F00000020446174615365743D2264735F494E5F434F4D4D5F322220446174615365744E616D653D22494E5F434F4D4D5F322200010C2F00000020446174615365743D2264735F494E5F4D41494E5F322220446174615365744E616D653D22494E5F4D41494E5F322200010C3100000020446174615365743D2264735F4B52445F434F4D4D5F322220446174615365744E616D653D224B52445F434F4D4D5F322200010C2D00000020446174615365743D2264735F4B52445F4D41494E2220446174615365744E616D653D224B52445F4D41494E2200010C3100000020446174615365743D2264735F4B52445F4D41494E5F322220446174615365744E616D653D224B52445F4D41494E5F322200010C3100000020446174615365743D2264735F4F55545F434F4D4D5F322220446174615365744E616D653D224F55545F434F4D4D5F322200010C3100000020446174615365743D2264735F4F55545F4D41494E5F322220446174615365744E616D653D224F55545F4D41494E5F322200010C3100000020446174615365743D2264735F52454C5F434F4D4D5F322220446174615365744E616D653D2252454C5F434F4D4D5F322200010C3100000020446174615365743D2264735F52454C5F4D41494E5F322220446174615365744E616D653D2252454C5F4D41494E5F322200010C2D00000020446174615365743D2264735F53544F5245535F322220446174615365744E616D653D2253544F5245535F32220000095661726961626C65730100055374796C650100">
  <TfrxDialogPage Name="Page1" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Отчет движения товаров на СВХ" Height="223" Left="341" Top="153" Width="310" OnActivate="Page1OnActivate">
    <TfrxColorFrameControl Name="frameMain" Left="3" Top="4" Width="296" Height="144" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201"/>
    <TfrxColorFrameControl Name="cfrmPeriod" Left="16" Top="84" Width="268" Height="40" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201"/>
    <TfrxEditControl Name="fldStoreLicNum" Left="99" Top="16" Width="106" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="039/000049"/>
    <TfrxLabelControl Name="lblNumLicence" Left="14" Top="20" Width="65" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" AutoSize="False" Caption="№ лицензии:" Color="-16777201"/>
    <TfrxButtonControl Name="btnCallRef" Left="179" Top="18" Width="24" Height="18" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" OnClick="btnCallRefOnBeforePrint"/>
    <TfrxEditControl Name="fldStoreNum" Left="208" Top="16" Width="81" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Color="-16777212" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="№ склада: 8"/>
    <TfrxRadioButtonControl Name="rbtnPeriod" Left="16" Top="64" Width="113" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Caption="За период" Checked="True" Color="-16777201" OnClick="rbtnPeriodOnBeforePrint"/>
    <TfrxLabelControl Name="lblFrom" Left="24" Top="95" Width="11" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" AutoSize="False" Caption="С" Color="-16777201"/>
    <TfrxLabelControl Name="lblTo" Left="151" Top="96" Width="12" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" AutoSize="False" Caption="по" Color="-16777201"/>
    <TfrxDateEditControl Name="dtFrom" Left="36" Top="92" Width="109" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Color="-16777211" Date="38287" Time="38287"/>
    <TfrxDateEditControl Name="dtTo" Left="168" Top="92" Width="105" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Color="-16777211" Date="38287" Time="38287"/>
    <TfrxColorButtonControl Name="cbtnOk" Left="140" Top="160" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" Caption="Просмотр" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="1" OnClick="cbtnOkOnBeforePrint"/>
    <TfrxEditControl Name="fldLicExt" Left="84" Top="16" Width="15" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="А"/>
    <TfrxColorButtonControl Name="cBtnCancel" Left="220" Top="160" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Caption="Отмена" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="2"/>
    <TfrxLabelControl Name="lblStoreName" Left="8" Top="44" Width="281" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" Alignment="taCenter" AutoSize="False" Caption="ЗАО &#34;КОМИНА&#34;" Color="-16777201"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page2" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="8" RightMargin="8" TopMargin="6" BottomMargin="6" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VirtualPage="False" VGuides.Text="" OnBeforePrint="Page2OnBeforePrint">
    <TfrxMasterData Name="Band1" Height="15" Left="0" Top="241.88992" Visible="False" Width="1062.04793" OnBeforePrint="Band1OnBeforePrint" AllowSplit="True" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="ds_KRD_MAIN_2" DataSetName="KRD_MAIN_2" FooterAfterEach="True" PrintChildIfInvisible="True" PrintIfDetailEmpty="True" RowCount="0" Stretched="True"/>
    <TfrxReportTitle Name="Band2" Height="92.22047" Left="0" Top="18.89765" Width="1062.04793">
      <TfrxMemoView Name="Memo58" Left="44.3624" Top="2.32282" Width="973.32313" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћС‚С‡РµС‚ Рѕ С‚РѕРІР°СЂР°С… Рё С‚СЂР°РЅСЃРїРѕСЂС‚РЅС‹С… СЃСЂРµРґСЃС‚РІР°С… РЅР° [IIF(Length(&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;)=0,'РЎР’РҐ',&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;)] [IIF((Length(&#60;STORES_2.&#34;PZTK_CODE&#34;&#62;)&#62;0) and (&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;='РџР—РўРљ'), '(' + &#60;STORES_2.&#34;PZTK_CODE&#34;&#62; + ')', '')]"/>
      <TfrxMemoView Name="Memo1" Left="133.17316" Top="33.10235" Width="336" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="[STORES_2.&#34;NAME&#34;]"/>
      <TfrxMemoView Name="Memo2" Left="17.17316" Top="33.10235" Width="116" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="РќР°Р·РІР°РЅРёРµ СЃРєР»Р°РґР°:"/>
      <TfrxLineView Name="Line1" Left="5" Top="53.10235" Width="1050" Height="0" Frame.Typ="4" Frame.Width="2"/>
      <TfrxMemoView Name="Memo4" Left="403.56679" Top="33.10235" Width="188.25201" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="[IIF((&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;='РЎР’РҐ'), 'в„– Р»РёС†РµРЅР·РёРё:','')] [IIF((Length(&#60;STORES_2.&#34;PZTK_CODE&#34;&#62;)&#62;0) and (&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;='РџР—РўРљ'), 'РџСЂРёРєР°Р· (СЂР°СЃРїРѕСЂСЏР¶РµРЅРёРµ) С‚Р°РјРѕР¶РЅРё:', '')]"/>
      <TfrxMemoView Name="Memo3" Left="591.8188" Top="33.10235" Width="318.45671" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="[IIF((&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;)='РЎР’РҐ',&#60;STORES_2.&#34;LICENCENO&#34;&#62;,'')] [IIF((&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;='РџР—РўРљ'), &#60;STORES_2.&#34;PZTK_CODE&#34;&#62;, '')]"/>
      <TfrxMemoView Name="Memo16" Left="337.02018547" Top="64.66141" Width="388" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="[strPeriod]"/>
      <TfrxMemoView Name="Memo44" Left="910.86673" Top="33.25201" Width="135.33859" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haRight" ParentFont="False" Text="в„– СЃРєР»Р°РґР°: [STORES_2.&#34;STORE_NO&#34;]"/>
    </TfrxReportTitle>
    <TfrxReportSummary Name="Band3" Height="35.76376" Left="0" Top="389.29159" Width="1062.04793" OnAfterPrint="Band3OnAfterPrint">
      <TfrxMemoView Name="Memo56" Left="15.11812" Top="11.33859" Width="105.57483" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="РћС‚С‡РµС‚ СЃРґР°Р»:"/>
      <TfrxMemoView Name="Memo57" Left="419.52783" Top="11.33859" Width="105.57483" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="РћС‚С‡РµС‚ РїСЂРёРЅСЏР»:"/>
    </TfrxReportSummary>
    <TfrxPageHeader Name="PageHeader1" Height="50.07096378" Left="0" Top="132.28355" Width="1062.04793">
      <TfrxMemoView Name="Memo10" Left="292.15714102" Top="0" Width="189.73234937" Height="24.94488189" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћСЃС‚Р°С‚РѕРє РЅР° РЅР°С‡Р°Р»Рѕ РїРµСЂРёРѕРґР°"/>
      <TfrxMemoView Name="Memo13" Left="57.92122567" Top="0" Width="94.23624" Height="49.88976378" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– С„РѕСЂРјС‹ Р”Рћ1 (РјРІ) / Р”РЈ Р—РўРљ"/>
      <TfrxMemoView Name="Memo23" Left="151.93703228" Top="0" Width="140.22050906" Height="49.88976378" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќР°РёРјРµРЅРѕРІР°РЅРёРµ С‚РѕРІР°СЂР°"/>
      <TfrxMemoView Name="Memo19" Left="292.15714102" Top="24.94488189" Width="80.1259842519685" Height="24.94488189" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»-РІРѕ РјРµСЃС‚"/>
      <TfrxMemoView Name="Memo6" Left="481.88979307" Top="0" Width="189.73228346" Height="24.94488189" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџСЂРёС…РѕРґ"/>
      <TfrxMemoView Name="Memo11" Left="671.62207654" Top="0" Width="189.73234937" Height="24.94488189" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р Р°СЃС…РѕРґ"/>
      <TfrxMemoView Name="Memo12" Left="861.35434291" Top="0" Width="190.11023622" Height="24.94488189" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћСЃС‚Р°С‚РѕРє РЅР° РєРѕРЅРµС† РїРµСЂРёРѕРґР°"/>
      <TfrxMemoView Name="Memo14" Left="372.28345236" Top="24.94488189" Width="109.60632362" Height="24.94488189" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎС‚РѕРёРјРѕСЃС‚СЊ"/>
      <TfrxMemoView Name="Memo15" Left="481.88979307" Top="24.94488189" Width="80.1259842519685" Height="24.94488189" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»-РІРѕ РјРµСЃС‚"/>
      <TfrxMemoView Name="Memo21" Left="562.015748031496" Top="24.94488189" Width="109.606299212598" Height="24.94488189" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎС‚РѕРёРјРѕСЃС‚СЊ"/>
      <TfrxMemoView Name="Memo24" Left="671.62207654" Top="24.94488189" Width="80.12598425" Height="24.94488189" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»-РІРѕ РјРµСЃС‚"/>
      <TfrxMemoView Name="Memo28" Left="751.748031496063" Top="24.94488189" Width="109.60632362" Height="24.94488189" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎС‚РѕРёРјРѕСЃС‚СЊ"/>
      <TfrxMemoView Name="Memo31" Left="861.35434291" Top="24.94488189" Width="80.12598425" Height="24.94488189" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»-РІРѕ РјРµСЃС‚"/>
      <TfrxMemoView Name="Memo54" Left="941.48031496" Top="24.94488189" Width="109.984251968504" Height="24.94488189" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎС‚РѕРёРјРѕСЃС‚СЊ"/>
      <TfrxMemoView Name="Memo35" Left="15.11812" Top="0" Width="42.70866142" Height="49.88976378" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– Рї/Рї"/>
    </TfrxPageHeader>
    <TfrxDetailData Name="DetailData1" Height="27.28355" Left="0" Top="302.3624" Width="1062.04793" OnBeforePrint="DetailData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="ds_KRD_COMM_2" DataSetName="KRD_COMM_2" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo25" Left="57.92122567" Top="0" Width="94.23624" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vDONum]"/>
      <TfrxMemoView Name="Memo46" Left="151.93703228" Top="0" Width="140.22050906" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[vG312]"/>
      <TfrxMemoView Name="Memo22" Left="292.15714102" Top="0" Width="80.1259842519685" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[IIF(rsG311 &#60;&#62; 0 , rsG311, '')]"/>
      <TfrxMemoView Name="Memo30" Left="372.28345236" Top="0" Width="109.60632362" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[IIF(rsG42 &#60;&#62; 0 , rsG42, '')]"/>
      <TfrxMemoView Name="Memo40" Left="481.88979307" Top="0" Width="80.12598425" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[IIF(riG311 &#60;&#62; 0 , riG311, '')]"/>
      <TfrxMemoView Name="Memo42" Left="562.015748031496" Top="0" Width="109.60629921" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[IIF(riG42 &#60;&#62; 0 , riG42, '')]"/>
      <TfrxMemoView Name="Memo27" Left="671.62207654" Top="0" Width="80.12598425" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[IIF(roG311 &#60;&#62; 0 , roG311, '')]"/>
      <TfrxMemoView Name="Memo37" Left="751.748031496063" Top="0" Width="109.60632362" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[IIF(roG42 &#60;&#62; 0 , roG42, '')]"/>
      <TfrxMemoView Name="Memo39" Left="861.35434291" Top="0" Width="80.12598425" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[rfG311]"/>
      <TfrxMemoView Name="Memo47" Left="941.48031496" Top="0" Width="109.984251968504" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[rfG42]"/>
      <TfrxMemoView Name="Memo59" Left="15.11812" Top="0" Width="42.70866142" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vLinePrint]"/>
    </TfrxDetailData>
    <TfrxPageFooter Name="PageFooter1" Height="30" Left="0" Top="449.76407" Width="1062.04793">
      <TfrxMemoView Name="Memo9" Left="852" Top="8" Width="196" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haRight" ParentFont="False" Text="РЎС‚СЂР°РЅРёС†Р° [PAGE#]"/>
      <TfrxMemoView Name="Memo7" Left="191.02018547" Top="8" Width="660" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р’Р­Р”-РЎРєР»Р°Рґ   Copyright (C) РћРћРћ &#34;РЎРўРњ&#34;,1999-[FORMATDATETIME(&#34;YYYY&#34;, DATE)].            Internet: www.ctm.ru"/>
      <TfrxLineView Name="Line2" Left="5" Top="4" Width="1050" Height="0" Frame.Typ="4" Frame.Width="2"/>
      <TfrxMemoView Name="Memo8" Left="12" Top="8" Width="176" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="[Date] [Time]"/>
    </TfrxPageFooter>
    <TfrxFooter Name="Footer1" Height="0" Left="0" Top="279.68522" Width="1062.04793" OnBeforePrint="Footer1OnBeforePrint"/>
  </TfrxReportPage>
</TfrxReport>
