<?xml version="1.0" encoding="windows-1251"?>
<TfrxReport Name="" DotMatrixReport="False" EngineOptions.ConvertNulls="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" ReportOptions.CreateDate="38287.7802357292" ReportOptions.Description.Text="" ReportOptions.Name="rpt_tech.fr3" ReportOptions.LastChange="38342.618315081" ScriptLanguage="PascalScript" ScriptText.Text="Var&#13;&#10;  CustomDocsOnly, AistCompatible, StoreDocsBlock: Integer;&#13;&#10;  NoArchive: Integer;&#13;&#10;  vPlaceID, vID, vG32: Integer;&#13;&#10;  vRepDate, vChRepDate: TDateTime;&#13;&#10;  vRelDocNos, vRelDates, vRelG311, vRelG35: String;&#13;&#10;  vPeriod: Integer;&#13;&#10;&#13;&#10;  dQtyAtStoreG311, dQtyAtStoreG35, dQtyAtStoreG42: Double;&#13;&#10;  dRelG311, dRelG35, dRelG42: Double;&#13;&#10;  vLastReleaseDate: TDateTime;&#13;&#10;&#13;&#10;  vFilterCrit, vSQL: String;&#13;&#10;  vLine: Integer; vLinePrint: String;&#13;&#10;  vStoreDate: String;&#13;&#10;  vDONum, vReceiver, vReceiverAddr: String;&#13;&#10;  vCustomName, vLicenceNo, vLicenceDate: String;&#13;&#10;  vUseStoreDocs: Boolean;&#13;&#10;&#13;&#10;  vCostSum, vPaymentSum, vFineSum: Double;&#13;&#10;  vTotalCostSum, vTotalPaymentSum, vTotalFineSum: Double;&#13;&#10;  vFineDaysCount: Integer;&#13;&#10;&#13;&#10;  vOnCurrentBook: Boolean;&#13;&#10;  vCanPrint: Boolean;&#13;&#10;&#13;&#10;  sDataSetName: String;&#13;&#10;&#13;&#10;procedure SetLine(ID: Integer);&#13;&#10;var&#13;&#10;  vCurID: Integer;&#13;&#10;begin&#13;&#10;  vLinePrint := '';&#13;&#10;  vCustomName := '';&#13;&#10;  vLicenceNo := '';&#13;&#10;  vDONum := '';&#13;&#10;  vReceiver := '';&#13;&#10;  //Номер по порядку&#13;&#10;  vLine := vLine + 1;&#13;&#10;  vLinePrint := IntToStr(vLine);&#13;&#10;  if vCurID &#60;&#62; ID then begin&#13;&#10;    //Номер ДО1(мв)&#13;&#10;    vDONum := COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;NBD&#34;)');&#13;&#10;    //Владелец товара&#13;&#10;    if Copy(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;G011&#34;)'), 1, 1) = 'Э' then begin&#13;&#10;      vReceiver := COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;G022&#34;)');&#13;&#10;      vReceiverAddr := COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;G023&#34;)');&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      vReceiver := COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;G082&#34;)');&#13;&#10;      vReceiverAddr := COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;G083&#34;)');&#13;&#10;    end;&#13;&#10;&#13;&#10;    COMPUTE('FINDKEY(&#34;STORES_2&#34;, [&#34;' + VarToStr(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;PLACEID&#34;)')) + '&#34;])');&#13;&#10;    //№ лицензии СВХ&#13;&#10;    if Length(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;G144&#34;)')) &#62; 0 then&#13;&#10;      vLicenceNo := COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;G144&#34;)')&#13;&#10;    else vLicenceNo := &#60;STORES_2.&#34;LICENCENO&#34;&#62;;&#13;&#10;    //Дата лицензии СВХ&#13;&#10;    if Length(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;G145&#34;)')) &#62; 0 then&#13;&#10;      vLicenceDate := LeftCopy(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;G145&#34;)'), 10)&#13;&#10;    else vLicenceDate := FormatDateTime('DD.MM.YYYY', &#60;STORES_2.&#34;LICENCEDATE&#34;&#62;);&#13;&#10;    //Название таможенного поста&#13;&#10;    vCustomName := &#60;STORES_2.&#34;CUSTOMS_NAME&#34;&#62;;&#13;&#10;  end;&#13;&#10;  vCurID := ID;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure btnCallRefOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with btnCallRef, Engine do&#13;&#10;  begin&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreNumLic&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreNum&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreName&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strLicExt&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;sPlaceId&#34;,Integer)');&#13;&#10;    COMPUTE('OPENQUERY(&#34;Stors&#34;, &#34;STS_DB&#34;, &#34;Select * from STORES&#34;)');&#13;&#10;    COMPUTE('SELECTVALUES(&#34;Список складов&#34;, &#34;Stors&#34;, ' +&#13;&#10;                                                    '[[&#34;LICENCENO&#34;,   &#34;Номер лицензии&#34;, 15], ' +&#13;&#10;                                                    ' [&#34;LICENCENO_EXT&#34;,   &#34; &#34;, 1], ' +&#13;&#10;                                                    ' [&#34;STORE_NO&#34;,   &#34;Номер склада&#34;, 15], ' +&#13;&#10;                                                    ' [&#34;NAME&#34;,   &#34;Название склада&#34;, 30], ' +&#13;&#10;                                                    ' [&#34;PlaceId&#34;,   &#34;&#34;, 10]], ' +&#13;&#10;                                                    '[[&#34;LICENCENO&#34;, &#34;strStoreNumLic&#34;], ' +&#13;&#10;                                                    ' [&#34;STORE_NO&#34;, &#34;strStoreNum&#34;], ' +&#13;&#10;                                                    ' [&#34;NAME&#34;, &#34;strStoreName&#34;], ' +&#13;&#10;                                                    ' [&#34;LICENCENO_EXT&#34;, &#34;strLicExt&#34;], ' +&#13;&#10;                                                    ' [&#34;PlaceId&#34;, &#34;sPlaceId&#34;]], ' +&#13;&#10;    '&#34;&#34;, &#34;STORES&#34;)');&#13;&#10;&#13;&#10;    fldStoreLicNum.Text := COMPUTE('Value(&#34;strStoreNumLic&#34;)') ;      //   номер лицензии&#13;&#10;    fldStoreNum.Text := '№ склада: ' + COMPUTE('value(&#34;strStoreNum&#34;)') ; //   номер склада&#13;&#10;    lblStoreName.Caption := COMPUTE('Value(&#34;strStoreName&#34;)') ;     //   название склада&#13;&#10;    fldLicExt.Text := COMPUTE('Value(&#34;strLIcExt&#34;)');     //   Признак перерегистрации&#13;&#10;    vPlaceId := StrToInt(COMPUTE('Value(&#34;sPlaceId&#34;)'));&#13;&#10;    if Length(COMPUTE('Value(&#34;strStoreNumLic&#34;)')) &#62; 0 then&#13;&#10;      cbtnOk.Enabled := True&#13;&#10;    else cbtnOk.Enabled := False;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbtnOkOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with cbtnOk, Engine do begin&#13;&#10;&#13;&#10;    //Если надо, включим архивы&#13;&#10;    if not cbxArchive.Checked then&#13;&#10;      NoArchive := 1&#13;&#10;    else NoArchive := 3;&#13;&#10;&#13;&#10;    vSQL := 'SELECT S.CUSTOMS_CODE, KC.*, KM.* FROM STORES S, KRD_MAIN KM, KRD_COMM KC WHERE';&#13;&#10;    if not cbxAllStores.Checked then&#13;&#10;      vSQL := vSQL + ' S.PLACEID = ' + IntToStr(vPlaceId) + ' AND';&#13;&#10;    vSQL := vSQL + ' S.PLACEID = KM.PLACEID ' +&#13;&#10;                   ' AND S.PLACEID = KC.PLACEID ' +&#13;&#10;                   ' AND KM.ID = KC.ID ' +&#13;&#10;                   ' AND KC.G331 = ' + CHR(39) + '1' + CHR(39) +&#13;&#10;                   ' AND (KM.IN_ARCHIVE &#60;&#62; ' + IntToStr(NoArchive) +&#13;&#10;                   ' OR KM.IN_ARCHIVE IS NULL)' +&#13;&#10;                   ' ORDER BY S.CUSTOMS_CODE';&#13;&#10;    COMPUTE('OPENQUERY(&#34;TECH_COMM&#34;, &#34;STS_DB&#34;, &#34;' + vSQL + '&#34;)');&#13;&#10;    sDataSetName := 'TECH_COMM';&#13;&#10;    Band1.RowCount := StrToInt(COMPUTE('RECORDCOUNT(&#34;TECH_COMM&#34;)'));&#13;&#10;    COMPUTE('FIRST(&#34;TECH_COMM&#34;)');&#13;&#10;&#13;&#10;    if cbxUseStoreDocs.Checked then&#13;&#10;      vUseStoreDocs := True&#13;&#10;    else vUseStoreDocs := False;&#13;&#10;&#13;&#10;    if cbxAllStores.Checked then Memo58.Visible := False;&#13;&#10;&#13;&#10;    //Чтобы взять информацию о складе&#13;&#10;    if vPlaceId &#60;&#62; Null then&#13;&#10;      COMPUTE('FINDKEY(&#34;STORES_2&#34;, [&#34;' + IntToStr(vPlaceId) + '&#34;])');&#13;&#10;&#13;&#10;    //сохраняем настройки&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;Archive&#34;,&#34;'+VarToStr(cbxArchive.Checked)+'&#34;)');&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;'+IntToStr(vPlaceId)+'&#34;)');&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;AllStores&#34;,&#34;'+VarToStr(cbxAllStores.Checked)+'&#34;)');&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band3OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('FINDKEY(&#34;STORES_2&#34;, [&#34;' + VarToStr(vPlaceId) + '&#34;])');&#13;&#10;  COMPUTE('SETFILTER(&#34;IN_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('SETFILTER(&#34;IN_COMM_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('SETFILTER(&#34;OUT_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;  COMPUTE('CLOSEDATASET(&#34;TECH_COMM&#34;)');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  fldLicExt.Text := '';&#13;&#10;  fldStoreLicNum.Text := '';&#13;&#10;  fldStoreNum.Text := '';&#13;&#10;&#13;&#10;  vPlaceId:=StrToInt(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;0&#34;)'));&#13;&#10;  If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;])') then begin&#13;&#10;     fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;     fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;     lblStoreName.Caption := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;     fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;     vCanPrint := True;&#13;&#10;     cbtnOk.Enabled := True;&#13;&#10;  end&#13;&#10;  else begin&#13;&#10;    vPlaceId:=StrToInt(COMPUTE('INIFILE(&#34;WorkPlace&#34;,&#34;PlaceNum&#34;,&#34;0&#34;)'));&#13;&#10;    If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;])') then begin&#13;&#10;      fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;      fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;      lblStoreName.Caption := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;      fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;      vCanPrint := True;&#13;&#10;      cbtnOk.Enabled := True;&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      fldStoreLicNum.Text := '';&#13;&#10;      fldStoreNum.Text := '№ склада: ';&#13;&#10;      lblStoreName.Caption := '';&#13;&#10;      fldLicExt.Text := '';&#13;&#10;      vCanPrint := False;&#13;&#10;      cbtnOk.Enabled := False;&#13;&#10;    end&#13;&#10;  end;&#13;&#10;&#13;&#10;  if not vUseStoreDocs then begin&#13;&#10;    cbxUseStoreDocs.Enabled := False;&#13;&#10;    cbxUseCustDocs.Checked := True;&#13;&#10;  end&#13;&#10;  else cbxUseStoreDocs.Checked := True;&#13;&#10;&#13;&#10;  if COMPUTE('INIFILE(&#34;Print&#34;,&#34;AllStores&#34;,&#34;False&#34;)') = 'True' then&#13;&#10;     cbxAllStores.Checked := True;&#13;&#10;  if COMPUTE('INIFILE(&#34;Print&#34;,&#34;Archive&#34;,&#34;False&#34;)') = 'True' then&#13;&#10;    cbxArchive.Checked := True&#13;&#10;  else cbxArchive.Checked := False;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DetailData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('NEXT(&#34;TECH_COMM&#34;)');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbxUseStoreDocsOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if cbxUseStoreDocs.Checked then begin&#13;&#10;    cbxUseCustDocs.Checked := False;&#13;&#10;    cbxUseFactInfo.Enabled := False;&#13;&#10;    cbxUseDuInfo.Enabled := True;&#13;&#10;  end&#13;&#10;  else if not cbxUseCustDocs.Checked then&#13;&#10;         cbxUseStoreDocs.Checked := True;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbxUseCustDocsOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if cbxUseCustDocs.Checked then begin&#13;&#10;    cbxUseStoreDocs.Checked := False;&#13;&#10;    cbxUseDuInfo.Enabled := False;&#13;&#10;    cbxUseFactInfo.Enabled := True;&#13;&#10;  end&#13;&#10;  else if not cbxUseStoreDocs.Checked then&#13;&#10;         cbxUseCustDocs.Checked := True;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; COMPUTE('FIRST(&#34;' + sDataSetName + '&#34;)');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  //Запомним ID для установки номера текущей строки&#13;&#10;  vID := StrToInt(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;ID&#34;)'));&#13;&#10;&#13;&#10;  //Подсчет остатков; информация по документам выпуска&#13;&#10;  dQtyAtStoreG311:= 0; dQtyAtStoreG35 := 0; dQtyAtStoreG42 := 0;&#13;&#10;  dRelG35 := 0; dRelG42 := 0; dRelG311 := 0;&#13;&#10;&#13;&#10;  if vUseStoreDocs then begin&#13;&#10;    //Дата поставки&#13;&#10;    if StrToInt(COMPUTE('FINDKEY(&#34;IN_MAIN_2&#34;, [&#34;' + VarToStr(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;PLACEID&#34;)')) + '&#34;, &#34;' + VarToStr(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;ID&#34;)')) + '&#34;])')) &#60;&#62; 0 then&#13;&#10;      vStoreDate := FormatDateTime('DD.MM.YYYY', &#60;IN_MAIN_2.&#34;G542&#34;&#62;)&#13;&#10;    else begin&#13;&#10;      if ValidDate(LeftCopy(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;ACCEPTDATE&#34;)'), 10)) then&#13;&#10;        vStoreDate := FormatDateTime('DD.MM.YYYY', StrToDateTime(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;ACCEPTDATE&#34;)')))&#13;&#10;      else if ValidDate(LeftCopy(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;BEG_KEEP&#34;)'), 10)) then&#13;&#10;        vStoreDate := FormatDateTime('DD.MM.YYYY', StrToDate(LeftCopy(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;BEG_KEEP&#34;)'), 10)))&#13;&#10;      else vStoreDate := '';&#13;&#10;    end;&#13;&#10;    //Кол-во при помещении&#13;&#10;    if (not cbxUseDuInfo.Checked) and (StrToInt(COMPUTE('FINDKEY(&#34;IN_COMM_2&#34;, [&#34;' + VarToStr(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;PLACEID&#34;)')) + '&#34;, &#34;' + VarToStr(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;ID&#34;)')) + '&#34;, &#34;' + VarToStr(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G32&#34;)')) +'&#34;])')) &#60;&#62; 0) then begin&#13;&#10;      dQtyAtStoreG35 := IIF(&#60;IN_COMM_2.&#34;G35&#34;&#62;&#60;&#62;NULL,&#60;IN_COMM_2.&#34;G35&#34;&#62;,IIF(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G35&#34;)')&#60;&#62;Null,COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G35&#34;)'),0));&#13;&#10;      dQtyAtStoreG311 := IIF(&#60;IN_COMM_2.&#34;G311&#34;&#62;&#60;&#62;NULL,&#60;IN_COMM_2.&#34;G311&#34;&#62;,IIF(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G311&#34;)')&#60;&#62;Null,COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G311&#34;)'),0));&#13;&#10;      dQtyAtStoreG42 := IIF(&#60;IN_COMM_2.&#34;G42&#34;&#62;&#60;&#62;NULL,&#60;IN_COMM_2.&#34;G42&#34;&#62;,IIF(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G42&#34;)')&#60;&#62;Null,COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G42&#34;)'),0));&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      dQtyAtStoreG35 := IIF(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G35&#34;)')&#60;&#62;Null,COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G35&#34;)'),0);&#13;&#10;      dQtyAtStoreG311 := IIF(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G311&#34;)')&#60;&#62;Null,COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G311&#34;)'),0);&#13;&#10;      dQtyAtStoreG42 := IIF(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G42&#34;)')&#60;&#62;Null,COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G42&#34;)'),0);&#13;&#10;    end;&#13;&#10;    //То, что выпущено&#13;&#10;    OutAtPeriod(StrToInt(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;PLACEID&#34;)')), StrToInt(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;ID&#34;)')), StrToInt(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G32&#34;)')),&#13;&#10;                  EncodeDate(1981, 8, 30),&#13;&#10;                  Date-1,&#13;&#10;                  dRelG311, dRelG35, dRelG42, vLastReleaseDate);&#13;&#10;    //Если что-то выпускалось - не печатаем&#13;&#10;    Band1.Visible := False;&#13;&#10;    if (dRelG35 = 0) and (dRelG42 = 0) and (dRelG311 = 0) then begin&#13;&#10;      Band1.Visible := True;&#13;&#10;      Band3.Visible := True;&#13;&#10;      SetLine(vId);&#13;&#10;    end;&#13;&#10;  end&#13;&#10;  else begin&#13;&#10;    //Дата помещения&#13;&#10;    if ValidDate(LeftCopy(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;ACCEPTDATE&#34;)'), 10)) then&#13;&#10;      vStoreDate := FormatDateTime('DD.MM.YYYY', StrToDateTime(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;ACCEPTDATE&#34;)')))&#13;&#10;    else if ValidDate(LeftCopy(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;BEG_KEEP&#34;)'), 10)) then&#13;&#10;      vStoreDate := FormatDateTime('DD.MM.YYYY', StrToDate(LeftCopy(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;BEG_KEEP&#34;)'), 10)))&#13;&#10;    else vStoreDate := '';&#13;&#10;    //Кол-во при помещении&#13;&#10;    if cbxUseFactInfo.Checked then begin&#13;&#10;      dQtyAtStoreG35 := IIF(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;FACT_G35&#34;)')&#60;&#62;Null,COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;FACT_G35&#34;)'),0);&#13;&#10;      dQtyAtStoreG311 := IIF(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;FACT_G311&#34;)')&#60;&#62;Null,COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;FACT_G311&#34;)'),0);&#13;&#10;      dQtyAtStoreG42 := IIF(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;FACT_G42&#34;)')&#60;&#62;Null,COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;FACT_G42&#34;)'),0);&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      dQtyAtStoreG35 := IIF(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G35&#34;)')&#60;&#62;Null,COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G35&#34;)'),0);&#13;&#10;      dQtyAtStoreG311 := IIF(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G311&#34;)')&#60;&#62;Null,COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G311&#34;)'),0);&#13;&#10;      dQtyAtStoreG42 := IIF(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G42&#34;)')&#60;&#62;Null,COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G42&#34;)'),0);&#13;&#10;    end;&#13;&#10;    //То, что выпущено на дату превышения срока хранения&#13;&#10;    ReleaseAtPeriod(StrToInt(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;PLACEID&#34;)')), StrToInt(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;ID&#34;)')), StrToInt(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G32&#34;)')),&#13;&#10;                  EncodeDate(1981, 8, 30),&#13;&#10;                  Date-1,&#13;&#10;                  dRelG311, dRelG35, dRelG42, vLastReleaseDate);&#13;&#10;    //То, что выпущено&#13;&#10;    Band1.Visible := False;&#13;&#10;    if (dRelG35 = 0) and (dRelG42 = 0) and (dRelG311 = 0) then begin&#13;&#10;      Band1.Visible := True;&#13;&#10;      Band3.Visible := True;&#13;&#10;      SetLine(vId);&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;  vCostSum := StrToFloatDef(COMPUTE('FLOATROUND(TRANSCURRENCY(&#34;' + VarToStr(Date) + '&#34;,IF(FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G42_CURRENCY&#34;)&#60;&#62;&#34;&#34;, FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G42_CURRENCY&#34;), FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G221&#34;)), &#34;643&#34;, &#34;' + VarToStr(dQtyAtStoreG42) + '&#34;)/1000, 3)'), 0);&#13;&#10;  vPaymentSum :=  StrToFloatDef(COMPUTE('FLOATROUND(PAYMENTS(FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G011&#34;), FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G33&#34;), ' + FloatToStr(Date) + ', ' +&#13;&#10;             ' IF(COPY(FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G011&#34;), 1, 1)=&#34;?&#34;, FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G15A&#34;), FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G17A&#34;)), ' +&#13;&#10;             ' IF(FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G42_CURRENCY&#34;)&#60;&#62;&#34;&#34;, FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G42_CURRENCY&#34;), FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G221&#34;)), ' +&#13;&#10;             ' &#34;643&#34;, &#34;' + VarToStr(dQtyAtStoreG42) + '&#34;, &#34;' + VarToStr(dQtyAtStoreG35) + '&#34;, FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G315A&#34;), FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G315C&#34;))/1000, 3)'), 0);&#13;&#10;&#13;&#10;  vFineDaysCount := Trunc(Date) - Trunc(StrToDateDef(vStoreDate, Date)) - IIF(COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;LEG_PERIOD&#34;)')&#60;&#62;NULL, COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;LEG_PERIOD&#34;)'), 15);&#13;&#10;  if vFineDaysCount &#62; 0 then&#13;&#10;    vFineSum := vPaymentSum * (0.25 / 300) * vFineDaysCount&#13;&#10;  else vFineSum := 0;&#13;&#10;&#13;&#10;  vTotalCostSum := vTotalCostSum + vCostSum;&#13;&#10;  vTotalPaymentSum := vTotalPaymentSum + vPaymentSum;&#13;&#10;  vTotalFineSum := vTotalFineSum + vFineSum;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure CheckBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if cbxAllStores.Checked then begin&#13;&#10;    fldStoreLicNum.Enabled := False;&#13;&#10;    fldStoreNum.Enabled := False;&#13;&#10;    lblStoreName.Enabled := False;&#13;&#10;    fldLicExt.Enabled := False;&#13;&#10;    btnCallRef.Enabled := False;&#13;&#10;    lblNumLicence.Enabled := False;&#13;&#10;    vCanPrint := cbtnOK.Enabled;&#13;&#10;    cbtnOK.Enabled := True;&#13;&#10;  end&#13;&#10;  else begin&#13;&#10;    fldStoreLicNum.Enabled := True;&#13;&#10;    fldStoreNum.Enabled := True;&#13;&#10;    lblStoreName.Enabled := True;&#13;&#10;    fldLicExt.Enabled := True;&#13;&#10;    btnCallRef.Enabled := True;&#13;&#10;    lblNumLicence.Enabled := True;&#13;&#10;    cbtnOk.Enabled := vCanPrint;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  //Взяли из ini-шника &#34;Только таможенные документы учета&#34;&#13;&#10;  CustomDocsOnly := StrToInt(COMPUTE('INIFILE(&#34;RegBook&#34;, &#34;CustomsDocsOnly&#34;, 0)'));&#13;&#10;  //Включена ли настройка &#34;Совместимость с АИСТом&#34;, 1-да, 0-нет&#13;&#10;  AistCompatible := StrToInt(COMPUTE('INIFILE(&#34;Docs&#34;, &#34;AistCompatible&#34;, &#34;0&#34;)'));&#13;&#10;  //Отключен ли блок складских документов&#13;&#10;  StoreDocsBlock := StrToInt(COMPUTE('INIFILE(&#34;Database&#34;, &#34;StoreDocsBlock&#34;, &#34;0&#34;)'));&#13;&#10;  if (StoreDocsBlock = 1) and ((AistCompatible = 1) or ((AistCompatible = 0) and (CustomDocsOnly = 0))) then&#13;&#10;    vUseStoreDocs := True&#13;&#10;  else vUseStoreDocs := False;&#13;&#10;end." PropData="08446174617365747301010C2F00000020446174615365743D2264735F494E5F434F4D4D5F322220446174615365744E616D653D22494E5F434F4D4D5F322200010C2F00000020446174615365743D2264735F494E5F4D41494E5F322220446174615365744E616D653D22494E5F4D41494E5F322200010C3100000020446174615365743D2264735F4B52445F434F4D4D5F322220446174615365744E616D653D224B52445F434F4D4D5F322200010C3F00000020446174615365743D2264735F4B52445F434F4D4D5F5041504552535F322220446174615365744E616D653D224B52445F434F4D4D5F5041504552535F322200010C2D00000020446174615365743D2264735F4B52445F4D41494E2220446174615365744E616D653D224B52445F4D41494E2200010C3100000020446174615365743D2264735F4B52445F4D41494E5F322220446174615365744E616D653D224B52445F4D41494E5F322200010C3500000020446174615365743D2264735F4B52445F5041504552535F322220446174615365744E616D653D224B52445F5041504552535F322200010C3100000020446174615365743D2264735F4F55545F434F4D4D5F322220446174615365744E616D653D224F55545F434F4D4D5F322200010C3100000020446174615365743D2264735F4F55545F4D41494E5F322220446174615365744E616D653D224F55545F4D41494E5F322200010C3100000020446174615365743D2264735F52454C5F434F4D4D5F322220446174615365744E616D653D2252454C5F434F4D4D5F322200010C3100000020446174615365743D2264735F52454C5F4D41494E5F322220446174615365744E616D653D2252454C5F4D41494E5F322200010C2D00000020446174615365743D2264735F53544F5245535F322220446174615365744E616D653D2253544F5245535F32220000095661726961626C65730100055374796C650100">
  <TfrxDialogPage Name="Page1" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Товары, хранящиеся свыше срока" Height="254" Left="481" Top="340" Width="310" OnActivate="Page1OnActivate">
    <TfrxColorFrameControl Name="frameMain" Left="3" Top="4" Width="296" Height="90" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" BorderWidth="0" Color="-16777201"/>
    <TfrxEditControl Name="fldStoreLicNum" Left="99" Top="16" Width="106" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="039/000049"/>
    <TfrxLabelControl Name="lblNumLicence" Left="14" Top="20" Width="65" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" AutoSize="False" Caption="№ лицензии:" Color="-16777201"/>
    <TfrxButtonControl Name="btnCallRef" Left="179" Top="18" Width="24" Height="18" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" OnClick="btnCallRefOnBeforePrint"/>
    <TfrxEditControl Name="fldStoreNum" Left="208" Top="16" Width="81" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Color="-16777212" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="№ склада: 8"/>
    <TfrxColorButtonControl Name="cbtnOk" Left="144" Top="198" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" Caption="Просмотр" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="1" OnClick="cbtnOkOnBeforePrint"/>
    <TfrxEditControl Name="fldLicExt" Left="84" Top="16" Width="15" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="А"/>
    <TfrxColorButtonControl Name="cBtnCancel" Left="224" Top="198" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Caption="Отмена" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="2"/>
    <TfrxCheckBoxControl Name="cbxArchive" Left="148" Top="64" Width="101" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Caption="Включать Архив" Color="-16777201"/>
    <TfrxLabelControl Name="lblStoreName" Left="8" Top="44" Width="281" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" Alignment="taCenter" AutoSize="False" Caption="ЗАО &#34;КОМИНА&#34;" Color="-16777201"/>
    <TfrxColorFrameControl Name="ColorFrame2" Left="4" Top="98" Width="296" Height="96" BorderWidth="0" Caption="Информация о выпусках/выдачах из" Color="-16777201"/>
    <TfrxCheckBoxControl Name="cbxUseStoreDocs" Left="12" Top="122" Width="273" Height="17" Caption="Складских документов учета" Color="-16777201" OnClick="cbxUseStoreDocsOnClick"/>
    <TfrxCheckBoxControl Name="cbxUseCustDocs" Left="12" Top="154" Width="273" Height="17" Caption="Таможенных документов учета" Color="-16777201" OnClick="cbxUseCustDocsOnClick"/>
    <TfrxCheckBoxControl Name="cbxUseDuInfo" Left="32" Top="138" Width="257" Height="17" Caption="Информация о товарах из документа учета" Checked="True" State="cbChecked" Color="-16777201"/>
    <TfrxCheckBoxControl Name="cbxUseFactInfo" Left="32" Top="172" Width="257" Height="17" Caption="Фактические сведения о товарах" Checked="True" State="cbChecked" Color="-16777201"/>
    <TfrxCheckBoxControl Name="cbxAllStores" Left="36" Top="64" Width="109" Height="17" Caption="По всем складам" Color="-16777201" OnClick="CheckBox1OnClick"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page2" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="8" RightMargin="8" TopMargin="6" BottomMargin="6" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VirtualPage="False" VGuides.Text="" OnBeforePrint="Page2OnBeforePrint">
    <TfrxMasterData Name="Band1" Height="27.28" Left="0" Top="236.11039" Width="1062.04793" OnBeforePrint="Band1OnBeforePrint" AllowSplit="True" Columns="1" ColumnWidth="200" ColumnGap="20" FooterAfterEach="True" PrintChildIfInvisible="True" PrintIfDetailEmpty="True" RowCount="1" Stretched="True">
      <TfrxMemoView Name="Memo37" Left="12" Top="0" Width="28" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[vLinePrint]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo38" Left="443.98425197" Top="0" Width="68" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[vStoreDate]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo25" Left="39.81851929" Top="0" Width="117.76376" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[vCustomName]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo39" Left="157.93700299" Top="0" Width="149.29133858" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Memo.Text="[COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;G312&#34;)')]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo2" Left="307.2" Top="0" Width="136.44094488" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" Memo.Text="[vReceiver]&#13;&#10;[vReceiverAddr]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo24" Left="621.5" Top="0" Width="92.33070866" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[FormatFloat(',0.000', vCostSum)]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo14" Left="956.98" Top="0" Width="88" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[COMPUTE('FIELDVALUE(&#34;TECH_COMM&#34;, &#34;REASONS&#34;)')]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo15" Left="512.00017087" Top="0" Width="109.75" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[vLicenceNo] ОТ [vLicenceDate]&#13;&#10;[vDONum]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo4" Left="879" Top="0" Width="78" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo10" Left="714" Top="0" Width="82" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[FormatFloat(',0.000', vPaymentSum)]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo12" Left="796" Top="0" Width="83" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[FormatFloat(',0.000', vFineSum)]" ParentFont="False" VAlign="vaCenter"/>
    </TfrxMasterData>
    <TfrxReportTitle Name="Band2" Height="57.10235" Left="0" Top="18.89765" Width="1062.04793">
      <TfrxMemoView Name="Memo58" Left="74.59864" Top="25" Width="912.85065" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="3" HAlign="haCenter" Memo.Text="хранящемся на [IIF(Length(&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;)=0,'СВХ',&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;)] [IIF((Length(&#60;STORES_2.&#34;PZTK_CODE&#34;&#62;)&#62;0) and (&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;='ПЗТК'), '(' + &#60;STORES_2.&#34;PZTK_CODE&#34;&#62; + ')', '')] [STORES_2.&#34;NAME&#34;]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxLineView Name="Line1" Left="5" Top="52" Width="1050" Height="0" Frame.Typ="4" Frame.Width="2"/>
      <TfrxMemoView Name="Memo20" Left="297.02018547" Top="4" Width="468" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="3" HAlign="haCenter" Memo.Text="Отчет о технологическом оборудовании," ParentFont="False" VAlign="vaCenter"/>
    </TfrxReportTitle>
    <TfrxReportSummary Name="Band3" Height="100.25201" Left="0" Top="354.17347" Visible="False" Width="1062.04793" OnAfterPrint="Band3OnAfterPrint">
      <TfrxMemoView Name="Memo35" Left="30.23624" Top="51.85869" Width="81.98423" Height="19.10235" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Memo.Text="Отчет сдал:" ParentFont="False"/>
      <TfrxMemoView Name="Memo36" Left="112.3859" Top="51.85869" Width="152.47248" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Memo.Text="" ParentFont="False" Underlines="True"/>
      <TfrxMemoView Name="Memo40" Left="267.34663" Top="51.85869" Width="97.10235" Height="19.10235" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Memo.Text="Отчет принял:" ParentFont="False"/>
      <TfrxMemoView Name="Memo41" Left="410.96877" Top="74.53587" Width="36.62987" Height="19.10235" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Memo.Text="М.П." ParentFont="False"/>
      <TfrxMemoView Name="Memo42" Left="365.61441" Top="51.85869" Width="152.47248" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Memo.Text="" ParentFont="False" Underlines="True"/>
      <TfrxMemoView Name="Memo13" Left="12" Top="8.88178419700125E-15" Width="610" Height="27.21259843" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" Memo.Text="Итого:" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo16" Left="621.5" Top="8.88178419700125E-15" Width="92.33" Height="27.21259843" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[FormatFloat(',0.000', vTotalCostSum)]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo17" Left="714" Top="8.88178419700125E-15" Width="82" Height="27.21259843" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[FormatFloat(',0.000', vTotalPaymentSum)]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo18" Left="796" Top="8.88178419700125E-15" Width="83" Height="27.21259843" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[FormatFloat(',0.000', vTotalFineSum)]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo21" Left="879" Top="8.88178419700125E-15" Width="166" Height="27.21259843" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haRight" Memo.Text="" ParentFont="False" VAlign="vaCenter"/>
    </TfrxReportSummary>
    <TfrxPageHeader Name="PageHeader1" Height="50.07096378" Left="0" Top="154.72449" Width="1062.04793">
      <TfrxMemoView Name="Memo63" Left="12" Top="2.96984659087229E-15" Width="28" Height="49.88976378" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="№ п/п" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo23" Left="39.81851929" Top="2.96984659087229E-15" Width="117.76376" Height="49.88976378" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Наименование таможни" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo26" Left="444.16543" Top="2.96984659087229E-15" Width="67.77953" Height="49.88976378" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Дата поставки" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo11" Left="157.93700299" Top="2.96984659087229E-15" Width="149.29133858" Height="49.88976378" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Наименование оборудования" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo6" Left="956.9765" Top="2.96984659087229E-15" Width="88" Height="49.88976378" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Причины неоформления" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo28" Left="512" Top="2.96984659087229E-15" Width="109.7480315" Height="49.88976378" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Место хранения (№ и дата лицензии [IIF(Length(&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;)=0,'СВХ',&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;)] [IIF((Length(&#60;STORES_2.&#34;PZTK_CODE&#34;&#62;)&#62;0) and (&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;='ПЗТК'), '(' + &#60;STORES_2.&#34;PZTK_CODE&#34;&#62; + ')', '')], номер [IIF((&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;='ПЗТК') OR (&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;='ЗТК'), '№ ДУ ЗТК', '№ ДО1(мв)')])" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo1" Left="307.2" Top="2.96984659087229E-15" Width="136.44094488" Height="49.88976378" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Наименование получателя и адрес" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo19" Left="621.5" Top="0.27551" Width="92.33070866" Height="49.88976378" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Фактурная стоимость оборудования (тыс. руб.)" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo3" Left="879" Top="2.96984659087229E-15" Width="78" Height="49.88976378" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Примечание" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo5" Left="714" Top="2.96984659087229E-15" Width="165" Height="49.88976378" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" Memo.Text="Предполгаемые таможенные платежи.&#13;&#10;Сумма подлежащих уплате пеней (тыс. руб.)" ParentFont="False" VAlign="vaCenter"/>
    </TfrxPageHeader>
    <TfrxDetailData Name="DetailData1" Height="0" Left="0" Top="298.58287" Width="1062.04793" OnBeforePrint="DetailData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" RowCount="1" Stretched="True"/>
    <TfrxPageFooter Name="PageFooter1" Height="30" Left="0" Top="540.47279" Width="1062.04793">
      <TfrxMemoView Name="Memo9" Left="852" Top="8.00000000000003" Width="196" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haRight" Memo.Text="Страница [PAGE#]" ParentFont="False"/>
      <TfrxMemoView Name="Memo7" Left="191.02018547" Top="8.00000000000003" Width="660" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haCenter" Memo.Text="ВЭД-Склад   Copyright (C) ООО &#34;СТМ&#34;,1999-[FORMATDATETIME(&#34;YYYY&#34;, DATE)].            Internet: www.ctm.ru" ParentFont="False" VAlign="vaCenter"/>
      <TfrxLineView Name="Line2" Left="5" Top="4.00000000000003" Width="1050" Height="0" Frame.Typ="4" Frame.Width="2"/>
      <TfrxMemoView Name="Memo8" Left="12" Top="8.00000000000003" Width="176" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" Memo.Text="[Date] [Time]" ParentFont="False"/>
    </TfrxPageFooter>
  </TfrxReportPage>
</TfrxReport>
