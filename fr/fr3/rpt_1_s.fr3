<?xml version="1.0" encoding="utf-8" standalone="no"?><TfrxReport Version="4.6.78" DotMatrixReport="False" EngineOptions.ConvertNulls="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38287.7802357292" ReportOptions.Description.Text="" ReportOptions.Name="Товары на складе (Форма №2)" ReportOptions.LastChange="42520.6849096065" ScriptLanguage="PascalScript" ScriptText.Text="Var&#13;&#10;  CustomDocsOnly, AistCompatible, StoreDocsBlock: Integer;&#13;&#10;  NoArchive: Integer;&#13;&#10;  vPlaceID, vID: Integer;&#13;&#10;  dtPeriodEnd, dtPeriodStart, OutRelPeriodStart: TDateTime;&#13;&#10;  vRelDocNos, vRelDates, vRelG311, vRelG35: String;&#13;&#10;  strPeriod,sTypeDoc: String;&#13;&#10;&#13;&#10;  vOutDate: String;&#13;&#10;&#13;&#10;  dRelAtRepDateG311, dRelAtRepDateG35, dRelAtRepDateG42: Double;&#13;&#10;  dRelG311, dRelG35, dRelG42: Double;&#13;&#10;  dRelAtPeriodG311, dRelAtPeriodG35, dRelAtPeriodG42: Double;&#13;&#10;  dRestAtRepDateG311, dRestAtRepDateG35, dRestAtRepDateG42: Double;&#13;&#10;  dRestG311, dRestG35, dRestG42: Double;&#13;&#10;  dQtyAtStoreG311, dQtyAtStoreG35, dQtyAtStoreG42: Double;&#13;&#10;&#13;&#10;  sRelAtPeriod: String;&#13;&#10;&#13;&#10;  i, k, l: Integer;&#13;&#10;  vText: String;&#13;&#10;&#13;&#10;  vLastReleaseDate: TDateTime;&#13;&#10;  vFilterCrit, vSQL: String;&#13;&#10;  vLine: Integer; vLinePrint: String;&#13;&#10;  vStoreDate: String;&#13;&#10;  vDONum: String;&#13;&#10;  vTranspDocs: String;&#13;&#10;  vOutDocDates, vOutDocNos: String;&#13;&#10;&#13;&#10;  vUseStoreDocs: Boolean;&#13;&#10;  vUseDuInfo, vUseFactInfo: Boolean;&#13;&#10;  vTDByComms: Boolean;&#13;&#10;&#13;&#10;  vOnCurrentBook: Boolean;&#13;&#10;  vCanPrint: Boolean;&#13;&#10;&#13;&#10;  sDataSetName: String;&#13;&#10;&#13;&#10;procedure SetLine(ID: Integer);&#13;&#10;var&#13;&#10;  vCurID: Integer;&#13;&#10;begin&#13;&#10;  vLinePrint := '';&#13;&#10;  vStoreDate := '';&#13;&#10;  vDONum := '';&#13;&#10;  //Номер по порядку и Дата помещения&#13;&#10;  if vCurID &#60;&#62; ID then begin&#13;&#10;    vLine := vLine + 1;&#13;&#10;    vLinePrint := IntToStr(vLine);&#13;&#10;    //Номер ДО1(мв)&#13;&#10;    if (&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;='ПЗТК') or (&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;='ЗТК') then&#13;&#10;      vDONum := 'ДУ ЗТК: '&#13;&#10;    else vDONum := 'ДО1(мв): ';&#13;&#10;    vDONum := vDONum + COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;NBD&#34;)');&#13;&#10;    if vUseStoreDocs then begin&#13;&#10;      //Дата помещения на склад&#13;&#10;      if StrToInt(COMPUTE('FINDKEY(&#34;IN_MAIN_2&#34;, [&#34;' + IntToStr(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + '&#34;])')) &#60;&#62; 0 then&#13;&#10;        vStoreDate := FormatDateTime('DD.MM.YYYY', &#60;IN_MAIN_2.&#34;G542&#34;&#62;)&#13;&#10;      else begin&#13;&#10;        if ValidDate(LeftCopy(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;BEG_KEEP&#34;)'), 10))  then&#13;&#10;          vStoreDate := FormatDateTime('DD.MM.YYYY', StrToDate(LeftCopy(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;BEG_KEEP&#34;)'), 10)))&#13;&#10;        else vStoreDate := '';&#13;&#10;      end;&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      if ValidDate(LeftCopy(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;BEG_KEEP&#34;)'), 10))  then&#13;&#10;        vStoreDate := FormatDateTime('DD.MM.YYYY', StrToDate(LeftCopy(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;BEG_KEEP&#34;)'), 10)))&#13;&#10;      else vStoreDate := '';&#13;&#10;    end;&#13;&#10;  end&#13;&#10;  else if not vTDByComms then vTranspDocs := '';&#13;&#10;  vCurID := ID;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure btnCallRefOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with btnCallRef, Engine do&#13;&#10;  begin&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreNumLic&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreNum&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreName&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strLicExt&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;sPlaceId&#34;,Integer)');&#13;&#10;    COMPUTE('OPENQUERY (&#34;Stors&#34;, &#34;STS_DB&#34;, &#34;Select * from STORES&#34;)');&#13;&#10;    COMPUTE('SELECTVALUES(&#34;Список складов&#34;, &#34;Stors&#34;, ' +&#13;&#10;                                                    '[[&#34;LICENCENO&#34;,   &#34;Номер лицензии&#34;, 15], ' +&#13;&#10;                                                    ' [&#34;LICENCENO_EXT&#34;,   &#34; &#34;, 1], ' +&#13;&#10;                                                    ' [&#34;STORE_NO&#34;,   &#34;Номер склада&#34;, 15], ' +&#13;&#10;                                                    ' [&#34;NAME&#34;,   &#34;Название склада&#34;, 30], ' +&#13;&#10;                                                    ' [&#34;PlaceId&#34;,   &#34;&#34;, 10]], ' +&#13;&#10;                                                    '[[&#34;LICENCENO&#34;, &#34;strStoreNumLic&#34;], ' +&#13;&#10;                                                    ' [&#34;STORE_NO&#34;, &#34;strStoreNum&#34;], ' +&#13;&#10;                                                    ' [&#34;NAME&#34;, &#34;strStoreName&#34;], ' +&#13;&#10;                                                    ' [&#34;LICENCENO_EXT&#34;, &#34;strLicExt&#34;], ' +&#13;&#10;                                                    ' [&#34;PlaceId&#34;, &#34;sPlaceId&#34;]], ' +&#13;&#10;    '&#34;&#34;, &#34;STORES&#34;)');&#13;&#10;&#13;&#10;    fldStoreLicNum.Text := COMPUTE('Value(&#34;strStoreNumLic&#34;)') ;      //   номер лицензии&#13;&#10;    fldStoreNum.Text := '№ склада: ' + COMPUTE('value(&#34;strStoreNum&#34;)') ; //   номер склада&#13;&#10;    lblStoreName.Caption := COMPUTE('Value(&#34;strStoreName&#34;)') ;     //   название склада&#13;&#10;    fldLicExt.Text := COMPUTE('Value(&#34;strLIcExt&#34;)');     //   Признак перерегистрации&#13;&#10;    vPlaceId := StrToInt(COMPUTE('Value(&#34;sPlaceId&#34;)'));&#13;&#10;    if Length(COMPUTE('Value(&#34;strStoreNumLic&#34;)')) &#62; 0 then&#13;&#10;      cbtnOk.Enabled := True&#13;&#10;    else cbtnOk.Enabled := False;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure rbtnDateOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with rbtnDate, Engine do&#13;&#10;  begin&#13;&#10;    dtOnDate.Enabled := True;&#13;&#10;    dtFrom.Enabled := False;&#13;&#10;    dtTo.Enabled := False;&#13;&#10;    cbxNotInclude.Enabled := False;&#13;&#10;    lblPer.Enabled := False;&#13;&#10;    fldStoreLicNum.Enabled := True;&#13;&#10;    fldStoreNum.Enabled := True;&#13;&#10;    lblStoreName.Enabled := True;&#13;&#10;    fldLicExt.Enabled := True;&#13;&#10;    btnCallRef.Enabled := True;&#13;&#10;    lblNumLicence.Enabled := True;&#13;&#10;    cbxArchive.Enabled := True;&#13;&#10;    cbtnOk.Enabled := vCanPrint;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure rbtnPeriodOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with rbtnPeriod, Engine do&#13;&#10;  begin&#13;&#10;    dtOnDate.Enabled := False;&#13;&#10;    dtFrom.Enabled := True;&#13;&#10;    dtTo.Enabled := True;&#13;&#10;    cbxNotInclude.Enabled := True;&#13;&#10;    lblPer.Enabled := True;&#13;&#10;    fldStoreLicNum.Enabled := True;&#13;&#10;    fldStoreNum.Enabled := True;&#13;&#10;    lblStoreName.Enabled := True;&#13;&#10;    fldLicExt.Enabled := True;&#13;&#10;    btnCallRef.Enabled := True;&#13;&#10;    lblNumLicence.Enabled := True;&#13;&#10;    cbxArchive.Enabled := True;&#13;&#10;    cbtnOk.Enabled := vCanPrint;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure rbtnCurBookOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with rbtnCurBook, Engine do&#13;&#10;  begin&#13;&#10;    dtOnDate.Enabled := False;&#13;&#10;    dtFrom.Enabled := False;&#13;&#10;    dtTo.Enabled := False;&#13;&#10;    cbxNotInclude.Enabled := False;&#13;&#10;    lblPer.Enabled := False;&#13;&#10;    fldStoreLicNum.Enabled := False;&#13;&#10;    fldStoreNum.Enabled := False;&#13;&#10;    lblStoreName.Enabled := False;&#13;&#10;    fldLicExt.Enabled := False;&#13;&#10;    btnCallRef.Enabled := False;&#13;&#10;    lblNumLicence.Enabled := False;&#13;&#10;    cbxArchive.Enabled := False;&#13;&#10;    vCanPrint := cbtnOk.Enabled;&#13;&#10;    cbtnOk.Enabled := True;&#13;&#10;    cbxArchive.Enabled := False;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbtnOkOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with cbtnOk, Engine do begin&#13;&#10;&#13;&#10;    vOnCurrentBook := rbtnCurBook.Checked;&#13;&#10;&#13;&#10;    if not vOnCurrentBook then begin&#13;&#10;      //На дату или за период?&#13;&#10;      if rbtnDate.Checked = True then begin&#13;&#10;        dtPeriodStart := STRTODATE('30.08.1981') + STRTOTIME('00:00:01');&#13;&#10;        dtPeriodEnd := Trunc(dtOnDate.Date) + STRTOTIME('23:59:59');&#13;&#10;        //Начало периода для подсчета кол-ва на начало периода&#13;&#10;        OutRelPeriodStart := Trunc(dtOnDate.Date) + STRTOTIME('23:59:59');&#13;&#10;        //Для печати периода отчета (название месяца)&#13;&#10;        strPeriod := 'на ' + FORMATDATETIME(&#34;DD MMMM YYYY&#34;, dtPeriodEnd)&#13;&#10;      end&#13;&#10;      else begin&#13;&#10;        //Проверим галку &#34;Не включать ранее периода&#34;&#13;&#10;        if cbxNotInclude.Checked then&#13;&#10;           dtPeriodStart := Trunc(dtFrom.Date) + STRTOTIME('00:00:00')&#13;&#10;        else dtPeriodStart := STRTODATE('30.08.1981') + STRTOTIME('00:00:00');&#13;&#10;        dtPeriodEnd := Trunc(dtTo.Date) + STRTOTIME('23:59:59');&#13;&#10;        //Начало периода для подсчета кол-ва на начало периода&#13;&#10;        OutRelPeriodStart := Trunc(dtFrom.Date) + STRTOTIME('23:59:59');&#13;&#10;        strPeriod := 'с ' + FORMATDATETIME(&#34;DD MMMM YYYY&#34;, OutRelPeriodStart) + ' по ' + FORMATDATETIME(&#34;DD MMMM YYYY&#34;, dtPeriodend)&#13;&#10;      end;&#13;&#10;&#13;&#10;      //Если надо, включим архивы&#13;&#10;      if not cbxArchive.Checked then&#13;&#10;        NoArchive := 1&#13;&#10;      else NoArchive := 3;&#13;&#10;&#13;&#10;      vSQL := 'SELECT * FROM KRD_MAIN WHERE PLACEID = ' + IntToStr(vPlaceId) +&#13;&#10;              ' AND BEG_KEEP &#60;= ' + CHR(39) + VarToStr(dtPeriodEnd) + CHR(39) +&#13;&#10;              ' AND BEG_KEEP &#62;= ' + CHR(39) + VarToStr(dtPeriodStart) + CHR(39) +&#13;&#10;              ' AND (IN_ARCHIVE &#60;&#62; ' + IntToStr(NoArchive) +&#13;&#10;              ' OR IN_ARCHIVE IS NULL)' +&#13;&#10;              ' ORDER BY BEG_KEEP';&#13;&#10;      COMPUTE('OPENQUERY(&#34;QRYKRDMAIN2&#34;, &#34;STS_DB&#34;, &#34;' + vSQL + '&#34;)');&#13;&#10;      sDataSetName := 'QRYKRDMAIN2';&#13;&#10;      Band1.RowCount := StrToInt(COMPUTE('RECORDCOUNT(&#34;QRYKRDMAIN2&#34;)'));&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      dtPeriodStart := STRTODATE('30.08.1981') + STRTOTIME('00:00:01');&#13;&#10;      OutRelPeriodStart := STRTODATE('30.08.1981') + STRTOTIME('00:00:01');&#13;&#10;      dtPeriodEnd := Date + STRTOTIME('23:59:59');&#13;&#10;      vPlaceId := &#60;KRD_MAIN.&#34;PLACEID&#34;&#62;;&#13;&#10;      sDataSetName := 'KRD_MAIN';&#13;&#10;      Band1.DataSetName := 'KRD_MAIN';&#13;&#10;    end;&#13;&#10;&#13;&#10;    if not cbxAddParams.Checked then dPage3.Visible := False;&#13;&#10;&#13;&#10;    //Чтобы взять информацию о складе&#13;&#10;    COMPUTE('FINDKEY(&#34;STORES_2&#34;, [&#34;' + IntToStr(vPlaceId) + '&#34;])');&#13;&#10;&#13;&#10;    //сохраняем настройки&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;Date&#34;,&#34;'+DATETOSTR(dtOnDate.Date)+'&#34;)');&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;OnDate&#34;,&#34;'+VarToStr(rbtnDate.Checked)+'&#34;)');&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;OnCurrentBook&#34;,&#34;'+VarToStr(rbtnCurBook.Checked)+'&#34;)');&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;Archive&#34;,&#34;'+VarToStr(cbxArchive.Checked)+'&#34;)');&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;NotIncludeBefore&#34;,&#34;'+VarToStr(cbxNotInclude.Checked)+'&#34;)');&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;'+DATETOSTR(dtFrom.Date)+'&#34;)');&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;'+DateToStr(dtTo.Date)+'&#34;)');&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;'+IntToStr(vPlaceId)+'&#34;)');&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band3OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('SETFILTER(&#34;IN_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('SETFILTER(&#34;IN_COMM_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('SETFILTER(&#34;OUT_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;  if not vOnCurrentBook then COMPUTE('CLOSEDATASET(&#34;QRYKRDMAIN2&#34;)');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  fldLicExt.Text := '';&#13;&#10;  fldStoreLicNum.Text := '';&#13;&#10;  fldStoreNum.Text := '';&#13;&#10;&#13;&#10;  vPlaceId:=StrToInt(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;0&#34;)'));&#13;&#10;  If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;])') then begin&#13;&#10;     fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;     fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;     lblStoreName.Caption := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;     fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;     vCanPrint := True;&#13;&#10;     cbtnOk.Enabled := True;&#13;&#10;  end&#13;&#10;  else begin&#13;&#10;    vPlaceId:=StrToInt(COMPUTE('INIFILE(&#34;WorkPlace&#34;,&#34;PlaceNum&#34;,&#34;0&#34;)'));&#13;&#10;    If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;])') then begin&#13;&#10;      fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;      fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;      lblStoreName.Caption := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;      fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;      vCanPrint := True;&#13;&#10;      cbtnOk.Enabled := True;&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      fldStoreLicNum.Text := '';&#13;&#10;      fldStoreNum.Text := '№ склада: ';&#13;&#10;      lblStoreName.Caption := '';&#13;&#10;      fldLicExt.Text := '';&#13;&#10;      vCanPrint := False;&#13;&#10;      cbtnOk.Enabled := False;&#13;&#10;    end&#13;&#10;  end;&#13;&#10;  dtOnDate.Date:= StrToDateDef(COMPUTE('INIFILE(&#34;Print&#34;,&#34;Date&#34;,&#34;&#34;)'), Date);&#13;&#10;  dtFrom.Date := STRTODATEDEF(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;&#34;)'), DATE);&#13;&#10;  dtTo.Date := STRTODATEDEF(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;&#34;)'), DATE);&#13;&#10;&#13;&#10;  IF COMPUTE('INIFILE(&#34;Print&#34;,&#34;OnDate&#34;,&#34;True&#34;)') = 'True' then&#13;&#10;     rbtnDate.Checked := True&#13;&#10;  else rbtnPeriod.Checked := True;&#13;&#10;  if COMPUTE('INIFILE(&#34;Print&#34;,&#34;OnCurrentBook&#34;,&#34;True&#34;)') = 'True' then&#13;&#10;     rbtnCurBook.Checked := True;&#13;&#10;  if COMPUTE('INIFILE(&#34;Print&#34;,&#34;Archive&#34;,&#34;False&#34;)') = 'True' then&#13;&#10;    cbxArchive.Checked := True&#13;&#10;  else cbxArchive.Checked := False;&#13;&#10;  if COMPUTE('INIFILE(&#34;Print&#34;,&#34;NotIncludeBefore&#34;,&#34;False&#34;)') = 'True' then&#13;&#10;    cbxNotInclude.Checked := True&#13;&#10;  else cbxNotInclude.Checked := False;&#13;&#10;&#13;&#10;  if COMPUTE('INIFILE(&#34;Print&#34;,&#34;UseDuInfo&#34;,&#34;False&#34;)') = 'True' then&#13;&#10;    vUseDuInfo := True&#13;&#10;  else vUseDuInfo := False;&#13;&#10;  if COMPUTE('INIFILE(&#34;Print&#34;,&#34;UseFactInfo&#34;,&#34;True&#34;)') = 'True' then&#13;&#10;    vUseFactInfo := True&#13;&#10;  else vUseFactInfo := False;&#13;&#10;  if COMPUTE('INIFILE(&#34;Print&#34;,&#34;TDByComms&#34;,&#34;False&#34;)') = 'True' then&#13;&#10;    vTDByComms := True&#13;&#10;  else vTDByComms := False;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DetailData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  //Товаросопроводительные документы&#13;&#10;  if vTDByComms then begin&#13;&#10;    //ТД&#13;&#10;    vTranspDocs := '';&#13;&#10;    COMPUTE('SETFILTER(&#34;KRD_COMM_PAPERS_2&#34;, &#34;&#34;)');&#13;&#10;    vFilterCrit := 'PLACEID = ' + IntToStr(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) +&#13;&#10;                   ' AND ID = ' + IntToStr(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) +&#13;&#10;                  ' AND G32 = ' + IntToStr(&#60;KRD_COMM_2.&#34;G32&#34;&#62;) +&#13;&#10;             ' AND DOC_TYPE = 13';&#13;&#10;    COMPUTE('SETFILTER(&#34;KRD_COMM_PAPERS_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;    COMPUTE('FIRST(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;    while StrToInt(COMPUTE('EOF(&#34;KRD_COMM_PAPERS_2&#34;)')) = 0 do begin&#13;&#10;      COMPUTE('SETRANGE(&#34;KRD_PAPERS_2&#34;, [&#34;' + IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;DOC_COUNTER&#34;&#62;) + '&#34;])');&#13;&#10;      if vTranspDocs &#60;&#62; '' then vTranspDocs := vTranspDocs + ', ';&#13;&#10;      vTranspDocs := vTranspDocs + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + ' ' + &#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;;&#13;&#10;      COMPUTE('NEXT(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;  COMPUTE('SETFILTER(&#34;KRD_COMM_PAPERS_2&#34;, &#34;&#34;)');&#13;&#10;&#13;&#10;  //Запомним ID для установки номера текущей строки&#13;&#10;  if COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;A_MODE&#34;)') = '7' then&#13;&#10;    vID := StrToInt(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;MAIN_ID&#34;)'))&#13;&#10;  else vID := StrToInt(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;ID&#34;)'));&#13;&#10;&#13;&#10;  //Подсчет остатков; информация по документам выпуска&#13;&#10;  vOutDocDates := '';&#13;&#10;  vOutDocNos := '';&#13;&#10;  dRestAtRepDateG35 := 0;&#13;&#10;  dRestAtRepDateG311 := 0;&#13;&#10;  dRestAtRepDateG42 := 0;&#13;&#10;  dRestG35 := 0;&#13;&#10;  dRestG311 := 0;&#13;&#10;  dRestG42 := 0;&#13;&#10;  dQtyAtStoreG311:= 0;&#13;&#10;  dQtyAtStoreG35 := 0;&#13;&#10;  dQtyAtStoreG42 := 0;&#13;&#10;  sRelAtPeriod := '';&#13;&#10;  vOutDate := '';&#13;&#10;  i := 0; k := 0; l := 0;&#13;&#10;  vText := 'Мест:' + CHR(13) + 'Вес:' + CHR(13) +'Ст-ть';&#13;&#10;  if vUseStoreDocs then begin&#13;&#10;    //Кол-во при помещении&#13;&#10;    if (not vUseDuInfo) and (StrToInt(COMPUTE('FINDKEY(&#34;IN_COMM_2&#34;, [&#34;' + IntToStr(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;KRD_COMM_2.&#34;G32&#34;&#62;) +'&#34;])')) &#60;&#62; 0) then begin&#13;&#10;      dQtyAtStoreG35 := IIF(&#60;IN_COMM_2.&#34;G35&#34;&#62;&#60;&#62;NULL,&#60;IN_COMM_2.&#34;G35&#34;&#62;,IIF(&#60;KRD_COMM_2.&#34;G35&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;G35&#34;&#62;,0));&#13;&#10;      dQtyAtStoreG311 := IIF(&#60;IN_COMM_2.&#34;G311&#34;&#62;&#60;&#62;NULL,&#60;IN_COMM_2.&#34;G311&#34;&#62;,IIF(&#60;KRD_COMM_2.&#34;G311&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;G311&#34;&#62;,0));&#13;&#10;      dQtyAtStoreG42 := IIF(&#60;IN_COMM_2.&#34;G42&#34;&#62;&#60;&#62;NULL,&#60;IN_COMM_2.&#34;G42&#34;&#62;,IIF(&#60;KRD_COMM_2.&#34;G42&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;G42&#34;&#62;,0));&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      dQtyAtStoreG35 := IIF(&#60;KRD_COMM_2.&#34;G35&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;G35&#34;&#62;,0);&#13;&#10;      dQtyAtStoreG311 := IIF(&#60;KRD_COMM_2.&#34;G311&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;G311&#34;&#62;,0);&#13;&#10;      dQtyAtStoreG42 := IIF(&#60;KRD_COMM_2.&#34;G42&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;G42&#34;&#62;,0);&#13;&#10;    end;&#13;&#10;    //То, что выпущено до конца периода&#13;&#10;    OutAtPeriod(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;, &#60;KRD_COMM_2.&#34;ID&#34;&#62;, &#60;KRD_COMM_2.&#34;G32&#34;&#62;,&#13;&#10;                  EncodeDate(1981, 8, 30),&#13;&#10;                  dtPeriodEnd,&#13;&#10;                  dRelAtRepDateG311, dRelAtRepDateG35, dRelAtRepDateG42, vLastReleaseDate);&#13;&#10;    //Остатки на конец периода  - дату отчета&#13;&#10;    dRestAtRepDateG35 := dQtyAtStoreG35 - dRelAtRepDateG35;&#13;&#10;    dRestAtRepDateG311 := dQtyAtStoreG311 - dRelAtRepDateG311;&#13;&#10;    dRestAtRepDateG42 := dQtyAtStoreG42 - dRelAtRepDateG42;&#13;&#10;    //То, что выпущено  до начала периода (без первого дня периода - чтобы видеть товары, выпущенные в первый день периода)&#13;&#10;    OutAtPeriod(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;, &#60;KRD_COMM_2.&#34;ID&#34;&#62;, &#60;KRD_COMM_2.&#34;G32&#34;&#62;,&#13;&#10;                  EncodeDate(1981, 8, 30),&#13;&#10;                  OutRelPeriodStart-1,&#13;&#10;                  dRelAtRepDateG311, dRelAtRepDateG35, dRelAtRepDateG42, vLastReleaseDate);&#13;&#10;    //Остатки на начало периода&#13;&#10;    dRestG311 := dQtyAtStoreG35 - dRelAtRepDateG35;&#13;&#10;    dRestG35 := dQtyAtStoreG311 - dRelAtRepDateG311;&#13;&#10;    dRestG42 := dQtyAtStoreG42 - dRelAtRepDateG42;&#13;&#10;    //Если в начале периода есть что-то на складе - печатаем строку&#13;&#10;    if (dRestG35 &#62; 0) or (dRestG311 &#62; 0) or (dRestG42 &#62; 0) then begin&#13;&#10;      DetailData1.Visible := True;&#13;&#10;      SetLine(vId);&#13;&#10;      //Смотрим выпуски - получаем дату и номер выпускающего документа&#13;&#10;      COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;&#34;)');&#13;&#10;      vFilterCrit := 'PLACEID=' + IntToStr(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + ' AND ID=' + IntToStr(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + ' AND G32=' + IntToStr(&#60;KRD_COMM_2.&#34;G32&#34;&#62;);&#13;&#10;      COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;      COMPUTE('FIRST(&#34;OUT_COMM_2&#34;)');&#13;&#10;      while StrToInt(COMPUTE('EOF(&#34;OUT_COMM_2&#34;)')) = 0 do begin&#13;&#10;        if StrToInt(COMPUTE('FINDKEY(&#34;OUT_MAIN_2&#34;, [&#34;' + IntToStr(&#60;OUT_COMM_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;OUT_COMM_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;OUT_COMM_2.&#34;ACTOUTID&#34;&#62;) + '&#34;])')) &#60;&#62; 0 then begin&#13;&#10;          if (&#60;OUT_MAIN_2.&#34;G542&#34;&#62; &#60;&#62; NULL) and (&#60;OUT_MAIN_2.&#34;G542&#34;&#62; &#60;= dtPeriodEnd) then begin&#13;&#10;            if vOutDate &#60;&#62; '' then vOutDate := vOutDate + CHR(13) + CHR(13)+ CHR(13);&#13;&#10;            vOutDate := vOutDate + FormatDateTime('DD.MM.YYYY', &#60;OUT_MAIN_2.&#34;G542&#34;&#62;);&#13;&#10;            if vOutDocNos &#60;&#62; '' then vOutDocNos := vOutDocNos + CHR(13) + CHR(13)+ CHR(13);&#13;&#10;            vOutDocNos := vOutDocNos + &#60;OUT_COMM_2.&#34;ND_GTD&#34;&#62;;&#13;&#10;            dRelAtPeriodG311 := &#60;OUT_COMM_2.&#34;OUT_G311&#34;&#62;;&#13;&#10;            dRelAtPeriodG35 := &#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;;&#13;&#10;            dRelAtPeriodG42 := &#60;OUT_COMM_2.&#34;OUT_G42&#34;&#62;;&#13;&#10;            if Length(sRelAtPeriod) &#62; 0 then sRelAtPeriod := sRelAtPeriod + CHR(13);&#13;&#10;            sRelAtPeriod := sRelAtPeriod + VarToStr(dRelAtPeriodG311) + CHR(13) + VarToStr(dRelAtPeriodG35)+ CHR(13) +VarToStr(dRelAtPeriodG42);&#13;&#10;            l := l + 1;&#13;&#10;              &#13;&#10;          end;&#13;&#10;        end;&#13;&#10;        //Придется поставить вручную текущую запись, т.к. ReleaseAtPeriod переводит на послднюю в OUT_COMM_2 :(&#13;&#10;        i := i + 1;&#13;&#10;        COMPUTE('FIRST(&#34;OUT_COMM_2&#34;)');&#13;&#10;        for k := 1 to i do COMPUTE('NEXT(&#34;OUT_COMM_2&#34;)');&#13;&#10;      end;&#13;&#10;      for k := 1 to l do begin&#13;&#10;        if k &#62; 1 then&#13;&#10;          vText := vText + CHR(13) + 'Мест:' + CHR(13) + 'Вес:' + CHR(13) + 'Ст-ть:';&#13;&#10;      end;&#13;&#10;      if COMPUTE('RECORDCOUNT(&#34;OUT_COMM_2&#34;)') = '0' then sRelAtPeriod := '0' + CHR(13) + '0';&#13;&#10;      COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;&#34;)');&#13;&#10;      COMPUTE('SETFILTER(&#34;OUT_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;    end&#13;&#10;    else DetailData1.Visible := False;&#13;&#10;  end&#13;&#10;  else begin&#13;&#10;    //Кол-во при помещении&#13;&#10;    if vUseFactInfo then begin&#13;&#10;      dQtyAtStoreG35 := IIF(&#60;KRD_COMM_2.&#34;FACT_G35&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;FACT_G35&#34;&#62;,0);&#13;&#10;      dQtyAtStoreG311 := IIF(&#60;KRD_COMM_2.&#34;FACT_G311&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;FACT_G311&#34;&#62;,0);&#13;&#10;      dQtyAtStoreG42 := IIF(&#60;KRD_COMM_2.&#34;FACT_G42&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;FACT_G42&#34;&#62;,0);&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      dQtyAtStoreG35 := IIF(&#60;KRD_COMM_2.&#34;G35&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;G35&#34;&#62;,0);&#13;&#10;      dQtyAtStoreG311 := IIF(&#60;KRD_COMM_2.&#34;G311&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;G311&#34;&#62;,0);&#13;&#10;      dQtyAtStoreG42 := IIF(&#60;KRD_COMM_2.&#34;G42&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;G42&#34;&#62;,0);&#13;&#10;    end;&#13;&#10;    //То, что выпущено до конца периода&#13;&#10;    ReleaseAtPeriod(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;, &#60;KRD_COMM_2.&#34;ID&#34;&#62;, &#60;KRD_COMM_2.&#34;G32&#34;&#62;,&#13;&#10;                  EncodeDate(1981, 8, 30),&#13;&#10;                  dtPeriodEnd,&#13;&#10;                  dRelAtRepDateG311, dRelAtRepDateG35, dRelAtRepDateG42, vLastReleaseDate);&#13;&#10;    //Остатки на конец периода - дату отчета&#13;&#10;    dRestAtRepDateG311 := dQtyAtStoreG311 - dRelAtRepDateG311;&#13;&#10;    dRestAtRepDateG35 := dQtyAtStoreG35 - dRelAtRepDateG35;&#13;&#10;    dRestAtRepDateG42 := dQtyAtStoreG42 - dRelAtRepDateG42;&#13;&#10;    //То, что выпущено  до начала периода (без первого дня периода - чтобы видеть товары, выпущенные в первый день периода)&#13;&#10;    ReleaseAtPeriod(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;, &#60;KRD_COMM_2.&#34;ID&#34;&#62;, &#60;KRD_COMM_2.&#34;G32&#34;&#62;,&#13;&#10;                  EncodeDate(1981, 8, 30),&#13;&#10;                  OutRelPeriodStart-1,&#13;&#10;                  dRelAtRepDateG311, dRelAtRepDateG35, dRelAtRepDateG42, vLastReleaseDate);&#13;&#10;    //Остатки на начало периода&#13;&#10;    dRestG311 := dQtyAtStoreG311 - dRelAtRepDateG311;&#13;&#10;    dRestG35 := dQtyAtStoreG35 - dRelAtRepDateG35;&#13;&#10;    dRestG42 := dQtyAtStoreG42 - dRelAtRepDateG42;&#13;&#10;    //Если в начале периода есть что-то на складе - печатаем строку&#13;&#10;    if (dRestG35 &#62; 0) or (dRestG311 &#62; 0) or (dRestG42 &#62; 0) then begin&#13;&#10;      DetailData1.Visible := True;&#13;&#10;      SetLine(vID);&#13;&#10;      COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;&#34;)');&#13;&#10;      vFilterCrit := 'PLACEID=' + IntToStr(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + ' AND ID=' + IntToStr(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + ' AND G32=' + IntToStr(&#60;KRD_COMM_2.&#34;G32&#34;&#62;);&#13;&#10;      COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;      COMPUTE('FIRST(&#34;REL_COMM_2&#34;)');&#13;&#10;      while StrToInt(COMPUTE('EOF(&#34;REL_COMM_2&#34;)')) = 0 do begin&#13;&#10;        if StrToInt(COMPUTE('FINDKEY(&#34;REL_MAIN_2&#34;, [&#34;' + IntToStr(&#60;REL_COMM_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;REL_COMM_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;REL_COMM_2.&#34;COUNTER&#34;&#62;) + '&#34;])')) &#60;&#62; 0 then begin&#13;&#10;          if (&#60;REL_MAIN_2.&#34;OUT_DATE&#34;&#62;&#60;&#62;NULL) and (&#60;REL_MAIN_2.&#34;OUT_DATE&#34;&#62; &#60;= dtPeriodEnd) then begin&#13;&#10;            if vOutDate &#60;&#62; '' then vOutDate := vOutDate + CHR(13) + CHR(13)+ CHR(13);&#13;&#10;            vOutDate := vOutDate + FormatDateTime('DD.MM.YYYY', &#60;REL_MAIN_2.&#34;OUT_DATE&#34;&#62;);&#13;&#10;            if vOutDocNos &#60;&#62; '' then vOutDocNos := vOutDocNos + CHR(13) + CHR(13)+ CHR(13);&#13;&#10;            vOutDocNos := vOutDocNos + &#60;REL_MAIN_2.&#34;DOC_NO&#34;&#62;;&#13;&#10;            dRelAtPeriodG311 := &#60;REL_COMM_2.&#34;RELEASE_G311&#34;&#62;;&#13;&#10;            dRelAtPeriodG35 := &#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;;&#13;&#10;            dRelAtPeriodG42 := &#60;REL_COMM_2.&#34;RELEASE_G42&#34;&#62;;&#13;&#10;          &#13;&#10;                                                                &#13;&#10;          &#13;&#10;            if Length(sRelAtPeriod) &#62; 0 then sRelAtPeriod := sRelAtPeriod + CHR(13);&#13;&#10;            sRelAtPeriod := sRelAtPeriod + VarToStr(dRelAtPeriodG311) + CHR(13) + VarToStr(dRelAtPeriodG35) + CHR(13) +VarToStr(dRelAtPeriodG42);&#13;&#10;            l := l + 1;&#13;&#10;          end;&#13;&#10;        end;&#13;&#10;        //Придется поставить вручную текущую запись, т.к. ReleaseAtPeriod переводит на послeднюю в REL_COMM_2 :(&#13;&#10;        i := i + 1;&#13;&#10;        COMPUTE('FIRST(&#34;REL_COMM_2&#34;)');&#13;&#10;        for k := 1 to i do COMPUTE('NEXT(&#34;REL_COMM_2&#34;)');&#13;&#10;      end;&#13;&#10;      for k := 1 to l do begin&#13;&#10;        if k &#62; 1 then&#13;&#10;          vText := vText + CHR(13) + 'Мест:' + CHR(13) + 'Вес:'+CHR(13)+'Ст-ть:';&#13;&#10;      end;&#13;&#10;      if COMPUTE('RECORDCOUNT(&#34;REL_COMM_2&#34;)') = '0' then sRelAtPeriod := '0'+ CHR(13) +'0'+ CHR(13) +'0';&#13;&#10;      COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;&#34;)');&#13;&#10;      COMPUTE('SETFILTER(&#34;REL_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;          &#13;&#10;    end&#13;&#10;    else DetailData1.Visible := False;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbxUseStoreDocsOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if cbxUseStoreDocs.Checked then begin&#13;&#10;    cbxUseCustDocs.Checked := False;&#13;&#10;    cbxUseFactInfo.Enabled := False;&#13;&#10;    cbxUseDuInfo.Enabled := True;&#13;&#10;  end&#13;&#10;  else if not cbxUseCustDocs.Checked then&#13;&#10;         cbxUseStoreDocs.Checked := True;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbxUseCustDocsOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if cbxUseCustDocs.Checked then begin&#13;&#10;    cbxUseStoreDocs.Checked := False;&#13;&#10;    cbxUseDuInfo.Enabled := False;&#13;&#10;    cbxUseFactInfo.Enabled := True;&#13;&#10;  end&#13;&#10;  else if not cbxUseStoreDocs.Checked then&#13;&#10;         cbxUseCustDocs.Checked := True;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; COMPUTE('FIRST(&#34;' + sDataSetName + '&#34;)');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');&#13;&#10;  COMPUTE('SETRANGE(&#34;KRD_COMM_2&#34;, [&#34;' + VarToStr(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;PLACEID&#34;)')) + '&#34;, &#34;' +&#13;&#10;                                        VarToStr(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;ID&#34;)')) + '&#34;])');&#13;&#10;  //Товаросопроводительные документы&#13;&#10;  if not vTDByComms then begin&#13;&#10;    //ТСД&#13;&#10;    vTranspDocs := '';&#13;&#10;    COMPUTE('SETRANGE(&#34;KRD_PAPERS_2&#34;, [&#34;' +&#13;&#10;      VarToStr(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;PLACEID&#34;)')) + '&#34;, &#34;' +&#13;&#10;      VarToStr(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;ID&#34;)')) + '&#34;])');&#13;&#10;    vTranspDocs := COMPUTE('UNIONVALUES(&#34;KRD_PAPERS_2&#34;, [&#34;PAPERNAME&#34;, &#34;PAPERNO&#34;], &#34;, &#34;, &#34; &#34;)');&#13;&#10;    COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Footer1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; if not vOnCurrentBook then COMPUTE('NEXT(&#34;QRYKRDMAIN2&#34;)')&#13;&#10;end;&#13;&#10;&#13;&#10;procedure btnOkOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  vUseStoreDocs := cbxUseStoreDocs.Checked;&#13;&#10;&#13;&#10;  vUseDuInfo := cbxUseDuInfo.Checked;&#13;&#10;  vUseFactInfo := cbxUseFactInfo.Checked;&#13;&#10;&#13;&#10;  vTDByComms := cbxTDByComms.Checked;&#13;&#10;&#13;&#10;  COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;TDByComms&#34;,&#34;'+VarToStr(cbxTDByComms.Checked)+'&#34;)');&#13;&#10;  COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;UseDuInfo&#34;,&#34;'+VarToStr(cbxUseDuInfo.Checked)+'&#34;)');&#13;&#10;  COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;UseFactInfo&#34;,&#34;'+VarToStr(cbxUseFactInfo.Checked)+'&#34;)');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbxTDByDocsOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if cbxTDByDocs.Checked then&#13;&#10;    cbxTDByComms.Checked := False&#13;&#10;  else if not cbxTDByComms.Checked then&#13;&#10;         cbxTDByDocs.Checked := True;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbxTDByCommsOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if cbxTDByComms.Checked then&#13;&#10;    cbxTDByDocs.Checked := False&#13;&#10;  else if not cbxTDByDocs.Checked then&#13;&#10;         cbxTDByComms.Checked := True;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure dPage3OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if not vUseStoreDocs then begin&#13;&#10;    cbxUseStoreDocs.Enabled := False;&#13;&#10;    cbxUseCustDocs.Checked := True;&#13;&#10;  end&#13;&#10;  else cbxUseStoreDocs.Checked := True;&#13;&#10;&#13;&#10;  cbxUseDuInfo.Checked := vUseDuInfo;&#13;&#10;  cbxUseFactinfo.Checked := vUseFactInfo;&#13;&#10;&#13;&#10;  cbxTDByComms.Checked := vTDByComms;&#13;&#10;  cbxTDByDocs.Checked := not vTDByComms;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  //Взяли из ini-шника &#34;Только таможенные документы учета&#34;&#13;&#10;  CustomDocsOnly := StrToInt(COMPUTE('INIFILE(&#34;RegBook&#34;, &#34;CustomsDocsOnly&#34;, 0)'));&#13;&#10;  //Включена ли настройка &#34;Совместимость с АИСТом&#34;, 1-да, 0-нет&#13;&#10;  AistCompatible := StrToInt(COMPUTE('INIFILE(&#34;Docs&#34;, &#34;AistCompatible&#34;, &#34;0&#34;)'));&#13;&#10;  //Отключен ли блок складских документов&#13;&#10;  StoreDocsBlock := StrToInt(COMPUTE('INIFILE(&#34;Database&#34;, &#34;StoreDocsBlock&#34;, &#34;0&#34;)'));&#13;&#10;  if (StoreDocsBlock = 1) and ((AistCompatible = 1) or ((AistCompatible = 0) and (CustomDocsOnly = 0))) then&#13;&#10;    vUseStoreDocs := True&#13;&#10;  else vUseStoreDocs := False;&#13;&#10;&#13;&#10;            &#13;&#10;end." OnStartReport="OnStartReport" PropData="08446174617365747301010C2F00000020446174615365743D2264735F494E5F434F4D4D5F322220446174615365744E616D653D22494E5F434F4D4D5F322200010C2F00000020446174615365743D2264735F494E5F4D41494E5F322220446174615365744E616D653D22494E5F4D41494E5F322200010C3100000020446174615365743D2264735F4B52445F434F4D4D5F322220446174615365744E616D653D224B52445F434F4D4D5F322200010C3F00000020446174615365743D2264735F4B52445F434F4D4D5F5041504552535F322220446174615365744E616D653D224B52445F434F4D4D5F5041504552535F322200010C2D00000020446174615365743D2264735F4B52445F4D41494E2220446174615365744E616D653D224B52445F4D41494E2200010C3100000020446174615365743D2264735F4B52445F4D41494E5F322220446174615365744E616D653D224B52445F4D41494E5F322200010C3500000020446174615365743D2264735F4B52445F5041504552535F322220446174615365744E616D653D224B52445F5041504552535F322200010C3100000020446174615365743D2264735F4F55545F434F4D4D5F322220446174615365744E616D653D224F55545F434F4D4D5F322200010C3100000020446174615365743D2264735F4F55545F4D41494E5F322220446174615365744E616D653D224F55545F4D41494E5F322200010C3100000020446174615365743D2264735F52454C5F434F4D4D5F322220446174615365744E616D653D2252454C5F434F4D4D5F322200010C3100000020446174615365743D2264735F52454C5F4D41494E5F322220446174615365744E616D653D2252454C5F4D41494E5F322200010C2D00000020446174615365743D2264735F53544F5245535F322220446174615365744E616D653D2253544F5245535F32220000095661726961626C65730100055374796C650100"><TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/><TfrxDialogPage Name="Page1" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Товары на складе" Height="391" Left="402" Top="259" Width="310" OnActivate="Page1OnActivate"><TfrxColorFrameControl Name="frameMain" Left="3" Top="4" Width="296" Height="284" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201"/><TfrxColorFrameControl Name="ColorFrame1" Left="5" Top="6" Width="292" Height="256" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" BorderWidth="2" FormCaption="False" RectCaption="False" Color="-16777201"/><TfrxColorFrameControl Name="cfrmPeriod" Left="16" Top="160" Width="268" Height="72" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201"/><TfrxCheckBoxControl Name="cbxNotInclude" Left="24" Top="196" Width="229" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Не включать оформленные ранее начала периода" Color="-16777205"/><TfrxEditControl Name="fldStoreLicNum" Left="99" Top="16" Width="106" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="039/000049"/><TfrxLabelControl Name="lblNumLicence" Left="14" Top="20" Width="65" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="№ лицензии:" Color="-16777201"/><TfrxButtonControl Name="btnCallRef" Left="179" Top="18" Width="24" Height="18" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" OnClick="btnCallRefOnBeforePrint"/><TfrxEditControl Name="fldStoreNum" Left="208" Top="16" Width="81" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777212" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="№ склада: 8"/><TfrxRadioButtonControl Name="rbtnDate" Left="16" Top="68" Width="93" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Дата" TabStop="False" Color="-16777201" OnClick="rbtnDateOnBeforePrint"/><TfrxRadioButtonControl Name="rbtnPeriod" Left="16" Top="140" Width="113" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="За период" Checked="True" Color="-16777201" OnClick="rbtnPeriodOnBeforePrint"/><TfrxColorFrameControl Name="cfrmDate" Left="16" Top="88" Width="172" Height="44" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201"/><TfrxLabelControl Name="lblFrom" Left="24" Top="171" Width="11" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="С" Color="-16777201"/><TfrxLabelControl Name="lblTo" Left="151" Top="172" Width="12" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="по" Color="-16777201"/><TfrxLabelControl Name="lblOn" Left="24" Top="102" Width="18" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Alignment="taRightJustify" AutoSize="False" Caption="На:" Color="-16777201"/><TfrxDateEditControl Name="dtOnDate" Left="48" Top="99" Width="133" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" Color="-16777211" Date="38287" DateFormat="dfLong" Time="38287"/><TfrxDateEditControl Name="dtFrom" Left="36" Top="168" Width="109" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38287" Time="38287"/><TfrxDateEditControl Name="dtTo" Left="168" Top="168" Width="105" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38287" Time="38287"/><TfrxColorButtonControl Name="cbtnOk" Left="140" Top="332" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" Caption="Просмотр" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="1" OnClick="cbtnOkOnBeforePrint"/><TfrxLabelControl Name="lblPer" Left="43" Top="211" Width="58" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="периода" Color="-16777201"/><TfrxEditControl Name="fldLicExt" Left="84" Top="16" Width="15" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="А"/><TfrxColorButtonControl Name="cBtnCancel" Left="220" Top="332" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Отмена" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="2"/><TfrxCheckBoxControl Name="cbxArchive" Left="96" Top="236" Width="121" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Включать Архив" Color="-16777201"/><TfrxLabelControl Name="lblStoreName" Left="8" Top="44" Width="281" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" Alignment="taCenter" AutoSize="False" Caption="ЗАО &#34;КОМИНА&#34;" Color="-16777201"/><TfrxRadioButtonControl Name="rbtnCurBook" Left="16" Top="264" Width="261" Height="17" ShowHint="True" Caption="По текущей книге учета" TabStop="False" Color="-16777201" OnClick="rbtnCurBookOnClick"/><TfrxColorFrameControl Name="ColorFrame2" Left="4" Top="292" Width="296" Height="34" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201"/><TfrxCheckBoxControl Name="cbxAddParams" Left="12" Top="300" Width="265" Height="17" ShowHint="True" Caption="Дополнительные параметры отчета" Color="-16777201"/></TfrxDialogPage><TfrxDialogPage Name="dPage3" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Caption="Дополнительные параметры отчета" Height="246" Left="265" Top="150" Width="359" OnActivate="dPage3OnActivate"><TfrxColorButtonControl Name="btnOk" Left="188" Top="188" Width="75" Height="25" ShowHint="True" Caption="Ok" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="1" OnClick="btnOkOnClick"/><TfrxColorButtonControl Name="btnCancel" Left="268" Top="188" Width="75" Height="25" ShowHint="True" Caption="Отмена" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="2"/><TfrxColorFrameControl Name="ColorFrame3" Left="4" Top="4" Width="344" Height="100" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Информация о выпусках/выдачах из" Color="-16777201"/><TfrxCheckBoxControl Name="cbxUseStoreDocs" Left="12" Top="28" Width="273" Height="17" ShowHint="True" Caption="Складских документов учета" Color="-16777201" OnClick="cbxUseStoreDocsOnClick"/><TfrxCheckBoxControl Name="cbxUseCustDocs" Left="12" Top="64" Width="273" Height="17" ShowHint="True" Caption="Таможенных документов учета" Color="-16777201" OnClick="cbxUseCustDocsOnClick"/><TfrxCheckBoxControl Name="cbxUseDuInfo" Left="32" Top="46" Width="257" Height="17" ShowHint="True" Caption="Информация о товарах из документа учета" Color="-16777201"/><TfrxCheckBoxControl Name="cbxUseFactInfo" Left="32" Top="83" Width="257" Height="17" ShowHint="True" Caption="Фактические сведения о товарах" Checked="True" State="cbChecked" Color="-16777201"/><TfrxColorFrameControl Name="ColorFrame4" Left="4" Top="108" Width="344" Height="72" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Распределять товаросопроводительные документы" Color="-16777201"/><TfrxCheckBoxControl Name="cbxTDByComms" Left="16" Top="154" Width="241" Height="17" ShowHint="True" Caption="По товарам" Color="-16777201" OnClick="cbxTDByCommsOnClick"/><TfrxCheckBoxControl Name="cbxTDByDocs" Left="16" Top="132" Width="245" Height="17" ShowHint="True" Caption="По документам учета" Color="-16777201" OnClick="cbxTDByDocsOnClick"/></TfrxDialogPage><TfrxReportPage Name="Page2" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="8" RightMargin="8" TopMargin="6" BottomMargin="6" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False" OnBeforePrint="Page2OnBeforePrint"><TfrxMasterData Name="Band1" Height="15" Left="0" Top="245.66945" Visible="False" Width="1062.04793" OnBeforePrint="Band1OnBeforePrint" AllowSplit="True" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="ds_KRD_MAIN_2" DataSetName="KRD_MAIN_2" FooterAfterEach="True" PrintChildIfInvisible="True" PrintIfDetailEmpty="True" RowCount="0" Stretched="True"/><TfrxReportTitle Name="Band2" Height="96" Left="0" Top="18.89765" Width="1062.04793"><TfrxMemoView Name="Memo58" Left="74.59864" Top="25" Width="912.85065" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Рѕ С‚РѕРІР°СЂР°С… С…СЂР°РЅСЏС‰РёС…СЃСЏ (С…СЂР°РЅРёРІС€РёС…СЃСЏ) РЅР° [IIF(Length(&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;)=0,'РЎР’РҐ',&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;)] [IIF((Length(&#60;STORES_2.&#34;PZTK_CODE&#34;&#62;)&#62;0) and (&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;='РџР—РўРљ'), '(' + &#60;STORES_2.&#34;PZTK_CODE&#34;&#62; + ')', '')]"/><TfrxMemoView Name="Memo1" Left="133.17316" Top="52" Width="336" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="[STORES_2.&#34;NAME&#34;]"/><TfrxMemoView Name="Memo2" Left="17.17316" Top="52" Width="116" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="РќР°Р·РІР°РЅРёРµ СЃРєР»Р°РґР°:"/><TfrxLineView Name="Line1" Left="5" Top="72" Width="1050" Height="0" ShowHint="False" Frame.Typ="4" Frame.Width="2"/><TfrxMemoView Name="Memo4" Left="346.87384" Top="52" Width="301.63791" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="[IIF((&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;='РЎР’РҐ'), 'в„–  Р»РёС†РµРЅР·РёРё:','')] [IIF((Length(&#60;STORES_2.&#34;PZTK_CODE&#34;&#62;)&#62;0) and (&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;='РџР—РўРљ'), 'РџСЂРёРєР°Р· (СЂР°СЃРїРѕСЂСЏР¶РµРЅРёРµ) С‚Р°РјРѕР¶РЅРё:', '')]"/><TfrxMemoView Name="Memo3" Left="648.51175" Top="52" Width="318.45671" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="[IIF((&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;)='РЎР’РҐ',&#60;STORES_2.&#34;LICENCENO&#34;&#62;,'')] [IIF((&#60;STORES_2.&#34;STORE_TYPE&#34;&#62;='РџР—РўРљ'), &#60;STORES_2.&#34;PZTK_CODE&#34;&#62;, '')]"/><TfrxMemoView Name="Memo16" Left="337.02018547" Top="76" Width="388" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="[strPeriod]"/><TfrxMemoView Name="Memo20" Left="297.02018547" Top="4" Width="468" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћРўР§Р•Рў"/><TfrxMemoView Name="Memo44" Left="910.86673" Top="52.14966" Width="135.33859" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haRight" ParentFont="False" Text="в„– СЃРєР»Р°РґР°: [STORES_2.&#34;STORE_NO&#34;]"/></TfrxReportTitle><TfrxReportSummary Name="Band3" Height="130.25201" Left="0" Top="404.40971" Width="1062.04793" OnAfterPrint="Band3OnAfterPrint"><TfrxMemoView Name="Memo5" Left="30.33859" Top="14.26809" Width="202.92919" Height="19.10235" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="РќР°РёРјРµРЅРѕРІР°РЅРёРµ РІР»Р°РґРµР»СЊС†Р° СЃРєР»Р°РґР°:"/><TfrxMemoView Name="Memo17" Left="158.65337" Top="37.60668" Width="359.74026" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Underlines="True" Text="[STORES_2.&#34;CHIEF&#34;]"/><TfrxMemoView Name="Memo18" Left="233.48825" Top="14.9295" Width="285" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Underlines="True" Text="[STORES_2.&#34;G142&#34;]"/><TfrxMemoView Name="Memo32" Left="90.52721" Top="60.2838600000001" Width="175.14966" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" ParentFont="False" Underlines="True" Text=""/><TfrxMemoView Name="Memo33" Left="30.23624" Top="36.5043300000001" Width="127.33859" Height="19.10235" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="Р¤РРћ СЂСѓРєРѕРІРѕРґРёС‚РµР»СЏ:"/><TfrxMemoView Name="Memo34" Left="30.23624" Top="59.1815100000001" Width="59.30705" Height="19.10235" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="РџРѕРґРїРёСЃСЊ:"/><TfrxMemoView Name="Memo35" Left="30.23624" Top="81.8586900000001" Width="81.98423" Height="19.10235" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="РћС‚С‡РµС‚ СЃРґР°Р»:"/><TfrxMemoView Name="Memo36" Left="112.3859" Top="81.8586900000001" Width="152.47248" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" ParentFont="False" Underlines="True" Text=""/><TfrxMemoView Name="Memo40" Left="267.34663" Top="81.8586900000001" Width="97.10235" Height="19.10235" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="РћС‚С‡РµС‚ РїСЂРёРЅСЏР»:"/><TfrxMemoView Name="Memo41" Left="410.96877" Top="104.53587" Width="36.62987" Height="19.10235" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" ParentFont="False" Text="Рњ.Рџ."/><TfrxMemoView Name="Memo42" Left="365.61441" Top="81.8586900000001" Width="152.47248" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" ParentFont="False" Underlines="True" Text=""/></TfrxReportSummary><TfrxPageHeader Name="PageHeader1" Height="49.88976378" Left="0" Top="136.06308" Width="1062.04793"><TfrxMemoView Name="Memo63" Left="12" Top="0" Width="28" Height="49.8897637795276" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– Рї/Рї"/><TfrxMemoView Name="Memo13" Left="853.7718" Top="0" Width="80" Height="49.88976378" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ РЅР° РґР°С‚Сѓ РѕС‚С‡РµС‚Р° (РјРµСЃС‚ Рё РІРµСЃ)"/><TfrxMemoView Name="Memo23" Left="626.645669291339" Top="0" Width="148" Height="49.88976378" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ РґРѕРєСѓРјРµРЅС‚Р° РїСЂРё РІС‹РґР°С‡Рµ"/><TfrxMemoView Name="Memo24" Left="934" Top="0" Width="116" Height="49.8897637795276" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџСЂРёРјРµС‡Р°РЅРёСЏ"/><TfrxMemoView Name="Memo26" Left="40" Top="0" Width="67.77953" Height="49.88976378" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р° РїРѕРјРµС‰РµРЅРёСЏ РЅР° СЃРєР»Р°Рґ"/><TfrxMemoView Name="Memo11" Left="249.74799" Top="0" Width="213.66141" Height="49.88976378" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљСЂР°С‚РєРѕРµ РЅР°РёРјРµРЅРѕРІР°РЅРёРµ С‚РѕРІР°СЂР°"/><TfrxMemoView Name="Memo6" Left="463.4094" Top="0" Width="88" Height="49.88976378" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ РїСЂРё РїРѕРјРµС‰РµРЅРёРё (РјРµСЃС‚ Рё РІРµСЃ)"/><TfrxMemoView Name="Memo28" Left="774.425196850394" Top="0" Width="79.748031496063" Height="49.88976378" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ РїСЂРё РІС‹РґР°С‡Рµ (РјРµСЃС‚ Рё РІРµСЃ)"/><TfrxMemoView Name="Memo10" Left="551.433070866142" Top="0.18119999999999" Width="74.8346456692914" Height="49.88976378" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р° С„Р°РєС‚. РІС‹РґР°С‡Рё СЃРѕ СЃРєР»Р°РґР°"/><TfrxMemoView Name="Memo21" Left="108.09448819" Top="0.18119999999999" Width="141.35433071" Height="49.77953" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РўРѕРІР°СЂРѕ-&#13;&#10;СЃРѕРїСЂРѕРІРѕРґРёС‚РµР»СЊРЅС‹Рµ &#13;&#10;РґРѕРєСѓРјРµРЅС‚С‹"/></TfrxPageHeader><TfrxDetailData Name="DetailData1" Height="38.62214" Left="0" Top="306.14193" Width="1062.04793" OnBeforePrint="DetailData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="ds_KRD_COMM_2" DataSetName="KRD_COMM_2" RowCount="0" Stretched="True"><TfrxMemoView Name="Memo37" Left="12" Top="0" Width="28" Height="38.55118843" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vLinePrint]"/><TfrxMemoView Name="Memo38" Left="40.12585" Top="0" Width="68" Height="38.55118843" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vStoreDate]"/><TfrxMemoView Name="Memo12" Left="853.7718" Top="0" Width="32" Height="38.55118843" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="13" HAlign="haRight" ParentFont="False" Text="РњРµСЃС‚:&#13;&#10;Р’РµСЃ:&#13;&#10;РЎС‚-С‚СЊ:"/><TfrxMemoView Name="Memo19" Left="934" Top="0" Width="116" Height="38.55118843" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vDONum]"/><TfrxMemoView Name="Memo25" Left="626.64566929" Top="0" Width="148" Height="38.55118843" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vOutDocNos]"/><TfrxMemoView Name="Memo29" Left="885.7718" Top="0" Width="48" Height="38.55118843" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="14" ParentFont="False" Text="[dRestAtRepDateG311]&#13;&#10;[dRestAtRepDateG35]&#13;&#10;[dRestAtRepDateG42]"/><TfrxMemoView Name="Memo39" Left="249.74799" Top="0" Width="214" Height="38.55118843" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[KRD_COMM_2.&#34;G312&#34;]"/><TfrxMemoView Name="Memo14" Left="463.4094" Top="0" Width="32" Height="38.55118843" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="13" HAlign="haRight" ParentFont="False" Text="РњРµСЃС‚:&#13;&#10;Р’РµСЃ:&#13;&#10;РЎС‚-С‚СЊ:"/><TfrxMemoView Name="Memo22" Left="495.4094" Top="0" Width="56" Height="38.55118843" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="14" ParentFont="False" Text="[dQtyAtStoreG311]&#13;&#10;[dQtyAtStoreG35]&#13;&#10;[dQtyAtStoreG42]"/><TfrxMemoView Name="Memo30" Left="774.42519685" Top="0" Width="43.33859" Height="38.55118843" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="13" HAlign="haRight" ParentFont="False" Text="[vText]"/><TfrxMemoView Name="Memo31" Left="817.37013" Top="0" Width="36.66141" Height="38.55118843" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="14" ParentFont="False" Text="[sRelAtPeriod]"/><TfrxMemoView Name="Memo15" Left="551.43307087" Top="0" Width="74.83464567" Height="38.55118843" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vOutDate]"/><TfrxMemoView Name="Memo27" Left="108.09448819" Top="0" Width="141.35433071" Height="38.55118843" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vTranspDocs]"/></TfrxDetailData><TfrxPageFooter Name="PageFooter1" Height="30" Left="0" Top="559.37044" Width="1062.04793"><TfrxMemoView Name="Memo9" Left="852" Top="8" Width="196" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haRight" ParentFont="False" Text="РЎС‚СЂР°РЅРёС†Р° [PAGE#]"/><TfrxMemoView Name="Memo7" Left="191.02018547" Top="8" Width="660" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р’Р­Р”-РЎРєР»Р°Рґ   Copyright (C) РћРћРћ &#34;РЎРўРњ&#34;,1999-[FORMATDATETIME(&#34;YYYY&#34;, DATE)].            Internet: www.ctm.ru"/><TfrxLineView Name="Line2" Left="5" Top="4" Width="1050" Height="0" ShowHint="False" Frame.Typ="4" Frame.Width="2"/><TfrxMemoView Name="Memo8" Left="12" Top="8" Width="176" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="[Date] [Time]"/></TfrxPageFooter><TfrxFooter Name="Footer1" Height="0" Left="0" Top="283.46475" Width="1062.04793" OnBeforePrint="Footer1OnBeforePrint"/></TfrxReportPage></TfrxReport>