<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="5.3.1" DotMatrixReport="False" EngineOptions.ConvertNulls="False" EngineOptions.DoublePass="True" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38247.6593091667" ReportOptions.Description.Text="" ReportOptions.Name="Форма ДО3 (Пр.№ 2688 от 29.12.2012)" ReportOptions.LastChange="43564.7458685301" ReportOptions.VersionMajor="3" ReportOptions.VersionMinor="0" ReportOptions.VersionRelease="0" ScriptLanguage="PascalScript" ScriptText.Text="Var&#13;&#10;  bSTORexists, vExport, vprintItog, vprintG35, vprintG42, vprintUSDG42,&#13;&#10;  vprintEURG42,vprintRubG42, vprintClearG42: Boolean;&#13;&#10;  vTDByComms, PrintFirstAll: Boolean;&#13;&#10;  sInG311, sOutG311, sInG35_v, sOutG35_v, sInG35_b, sOutG35_b, sInG35_u, sOutG35_u, sInG42, sOutG42 : Double;&#13;&#10;  sInG35, sOutG35 : String;&#13;&#10;  vType, StoreDocsBlock, AistCompatible, CustomDocsOnly,&#13;&#10;  NumLines, MAINID, MainG32, CountPapers: Integer;&#13;&#10;  datestart, dateend, IncludeDo1, IncludeAllDO2, NotInclude, inStore, PrintFactIn,&#13;&#10;  onCurrBook, vPlaceId, vChief, sStoreKeeper,&#13;&#10;  sTempDo2Comm, sqlText,LicNum, StorName, StoreNo, ReportPeriod,&#13;&#10;  ss, sss, Text1, Tex_t, vBegKeep, vNumLine, nuv,&#13;&#10;  nG32, nG312, nG33, nG42, nG42_2, vG311, vrG311, vrG42, vOutDate,&#13;&#10;  vrG35, vG35, sValBukCode, vReleaseDoc, TransDocNames, sStoreNum,&#13;&#10;  vG082, vBegKeep1, vBegKeep2, vFilterCrit, NttN, NumCustQuery: String;&#13;&#10;  dtPeriodStart, dtPeriodEnd, PeriodStart, dtNumCustQuery: TDateTime;&#13;&#10;  vLicenceDate: Variant;&#13;&#10;  sTypeSVH, sNameSVH, sTypeDoc, sDateDoc, sNumDoc, sConts, sConstStore: string;                                    &#13;&#10;  sDirDO3DB, sIniFile : String;&#13;&#10;  bBrutto, bUnits, bVolume, bStorageDateNoPrint: Boolean;&#13;&#10;  sTemp : String;&#13;&#10;&#13;&#10;  bAllowSplit: Boolean;&#13;&#10;  vUseStoreDocs: Boolean;&#13;&#10;&#13;&#10;  bSortByNBD, bSortByBdDate, bSortByBegKeep: Boolean;&#13;&#10;&#13;&#10;  bPartInPlace, bPartOutPlace                                  : Boolean;&#13;&#10;&#13;&#10;  sPartInPlaceText,sPartOutPlaceText                           : String;&#13;&#10;&#13;&#10;  bGoodStoreNumKPS, bPrintContType, bUseConts, bPrintPlomb: Boolean;                           &#13;&#10;    &#13;&#10;  sPaperNames, sPaperCodes: String;&#13;&#10;  DO3Date :String;      &#13;&#10;                                      &#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin                                                                                                    &#13;&#10;  COMPUTE(' globalvar (&#34;strStoreNumLic&#34;,String)');&#13;&#10;  COMPUTE(' globalvar (&#34;strStoreNum&#34;,String)');&#13;&#10;  COMPUTE(' globalvar (&#34;strStoreName&#34;,String)');&#13;&#10;  COMPUTE(' globalvar (&#34;strLicExt&#34;,String)');&#13;&#10;  COMPUTE(' globalvar (&#34;sPlaceId&#34;,Integer)');&#13;&#10;  COMPUTE(' globalvar (&#34;sChief&#34;,string)');&#13;&#10;  COMPUTE(' globalvar (&#34;sLicenceDate&#34;,DateTime)');&#13;&#10;&#13;&#10;  vtype:=0;       {переменная для определения какой тип мера определения товара&#13;&#10;                 1 - объем&#13;&#10;                 2 - доп. един.&#13;&#10;                 3 - брутто}&#13;&#10;&#13;&#10;  if COMPUTE('INIFILE(&#34;Print&#34;,&#34;TDByComms&#34;,&#34;False&#34;)') = 'True' then&#13;&#10;    cbTDByComms.Checked := True&#13;&#10;  else&#13;&#10;    cbTDByComms.Checked := False;&#13;&#10;&#13;&#10;   bSTORexists := False;&#13;&#10;&#13;&#10;   //установка  периода&#13;&#10;   dtOnDate.Enabled := False;&#13;&#10;   dtFrom.Enabled := True;&#13;&#10;   dtTo.Enabled := True;          &#13;&#10;&#13;&#10;   DateDO3.Date := Date;&#13;&#10;&#13;&#10;   dtNumCust.Date := STRTODATEDEF(COMPUTE('INIFILE(&#34;Print&#34;,&#34;dtNumCust&#34;,&#34;&#34;)'), DATE);       &#13;&#10;   edtNumCust.Text := COMPUTE('INIFILE(&#34;Print&#34;,&#34;NumCust&#34;,&#34;&#34;)');&#13;&#10;     &#13;&#10;   rbtnPeriod.Checked := True;&#13;&#10;&#13;&#10;   datestart :=  COMPUTE('INIFILE(&#34;Print&#34;,&#34;LicenceDate&#34;,&#34;&#34;)');&#13;&#10;   fldStoreLicDate.Date:= STRTODATEDEF(datestart, DATE);&#13;&#10;&#13;&#10;   datestart:=COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;&#34;)');&#13;&#10;   dateend := COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;&#34;)');&#13;&#10;   dtFrom.Date := STRTODATEDEF(datestart, DATE);&#13;&#10;   dtTo.Date := STRTODATEDEF(dateend, DATE);&#13;&#10;&#13;&#10;   IncludeAllDO2 := Compute('INIFILE(&#34;Print&#34;,&#34;IncludeAllDO2&#34;,&#34;1&#34;)');&#13;&#10;   if IncludeAllDO2 = '0' then&#13;&#10;     chkDO2.Checked := True&#13;&#10;   else&#13;&#10;     chkDO2.Checked := False;&#13;&#10;&#13;&#10;   cbxNotInclude.Enabled := True;       // не включать до1 оформленные ранее&#13;&#10;   NotInclude := COMPUTE('INIFILE(&#34;Print&#34;,&#34;NotInclude&#34;,&#34;1&#34;)');&#13;&#10;   If NotInclude = '0' then&#13;&#10;     cbxNotInclude.Checked := False&#13;&#10;   else&#13;&#10;     cbxNotInclude.Checked := True;&#13;&#10;&#13;&#10;   cbxStore.Enabled := True;       // включать до1 оформленные ранее  и не выпущенные&#13;&#10;   inStore := COMPUTE('INIFILE(&#34;Print&#34;,&#34;InStore&#34;,&#34;0&#34;)');&#13;&#10;   If inStore = '0' then&#13;&#10;     cbxStore.Checked := False&#13;&#10;   else&#13;&#10;     cbxStore.Checked := True;&#13;&#10;&#13;&#10;   chkBrutto.Checked := bBrutto;&#13;&#10;   chkUnits.Checked := bUnits;&#13;&#10;   chkVolume.Checked := bVolume;&#13;&#10;&#13;&#10;   // печать по текущей книге&#13;&#10;   onCurrBook:=  COMPUTE('INIFILE(&#34;Print&#34;,&#34;OnCurrentBook&#34;,&#34;0&#34;)');&#13;&#10;   if onCurrBook = '0' then&#13;&#10;     rbtnBook.Checked := False&#13;&#10;   else&#13;&#10;     rbtnBook.Checked := True;&#13;&#10;&#13;&#10;   // сортировка&#13;&#10;   bSortByBegKeep := IniFile('Print', 'SortBy', '1') = '1';&#13;&#10;   bSortByBdDate := IniFile('Print', 'SortBy', '1') = '2';&#13;&#10;   bSortByNBD := IniFile('Print', 'SortBy', '1') = '3';&#13;&#10;&#13;&#10;   rbtnSortByBegKeep.Checked := bSortByBegKeep;&#13;&#10;   rbtnSortByBdDate.Checked := bSortByBdDate;&#13;&#10;   rbtnSortByNBD.Checked := bSortByNBD;&#13;&#10;&#13;&#10;   chkPartInPlace.Checked := bPartInPlace;&#13;&#10;   edPartInPlaceText.Text := sPartInPlaceText;&#13;&#10;   chkPartOutPlace.Checked := bPartOutPlace;&#13;&#10;   edPartOutPlaceText.Text := sPartOutPlaceText;  &#13;&#10;&#13;&#10;   chkAllowSplit.Checked := bAllowSplit;&#13;&#10;    &#13;&#10;   chkStorageDateNoPrint.Checked := bStorageDateNoPrint;&#13;&#10;&#13;&#10;   chkGoodStoreNumKPS.Checked := bGoodStoreNumKPS;       &#13;&#10;   chkUseConts.Checked := bUseConts;&#13;&#10;        &#13;&#10;   chkPrintPlomb.Checked := bPrintPlomb;&#13;&#10;   chkPrintPlomb.Enabled := bUseConts;&#13;&#10;          &#13;&#10;   chkPrintContType.Checked := bPrintContType;&#13;&#10;   chkPrintContType.Enabled := bUseConts;    &#13;&#10;     &#13;&#10;   // проверка, открыта ли книга учета&#13;&#10;   If Not BookOpened then begin&#13;&#10;     rbtnPeriod.Checked := True;&#13;&#10;     rbtnBook.Enabled := False&#13;&#10;   end;&#13;&#10;&#13;&#10;   // уполномоченный работник склада&#13;&#10;   StoreKeep.Text  :=  COMPUTE('INIFILE(&#34;Print&#34;,&#34;StoreKeeper&#34;,&#34; &#34;)');&#13;&#10;&#13;&#10;   // каталог для сохранения&#13;&#10;   sDirDO3DB := COMPUTE('INIFILE(&#34;Print&#34;,&#34;DO3DBDir&#34;,&#34;&#34;)');&#13;&#10;   If COMPUTE('DirectoryExists(&#34;'+sDirDO3DB+'&#34;)') &#60;&#62; '0' then&#13;&#10;     edtDO3DB.Text := sDirDO3DB&#13;&#10;   else&#13;&#10;     edtDO3DB.Text := '';&#13;&#10;&#13;&#10;    //установка склада&#13;&#10;  fldStoreLicNum.Text := '';&#13;&#10;  //fldStoreNum.Text := '';&#13;&#10;  lblStoreName.Text := '';&#13;&#10;  fldLicExt.Text := '';&#13;&#10;&#13;&#10;  vPlaceId:= COMPUTE('INIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;0&#34;)');&#13;&#10;  If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + VARtoSTR(vPlaceId) + '&#34;])') then Begin&#13;&#10;    fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;    StoreNo := &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;    lblStoreName.Text := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;    fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;    vChief:= &#60;STORES_2.&#34;CHIEF&#34;&#62;;&#13;&#10;    vLicenceDate := &#60;STORES_2.&#34;LICENCEDATE&#34;&#62;;&#13;&#10;    cbtnOk.Enabled := True;&#13;&#10;  end&#13;&#10;  else Begin&#13;&#10;    vPlaceId:=COMPUTE('INIFILE(&#34;WorkPlace&#34;,&#34;PlaceNum&#34;,&#34;&#34;)');&#13;&#10;    If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + VARtoSTR(vPlaceId) + '&#34;])') then Begin&#13;&#10;      fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;      StoreNo := &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;      lblStoreName.Text := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;      fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;      vChief:=  &#60;STORES_2.&#34;CHIEF&#34;&#62;;&#13;&#10;      vLicenceDate := &#60;STORES_2.&#34;LICENCEDATE&#34;&#62;;&#13;&#10;      cbtnOk.Enabled := True;&#13;&#10;    end&#13;&#10;    else&#13;&#10;      cbtnOk.Enabled := False&#13;&#10;  end;&#13;&#10;&#13;&#10;  cbxG082.Checked := COMPUTE ('INIFILE (&#34;Print&#34;, &#34;bG082&#34;, &#34;False&#34;)');                                                                                      &#13;&#10;    &#13;&#10;  If Compute('INIFILE(&#34;Print&#34;,&#34;LicenceNum&#34;,&#34;&#34;)') &#60;&#62; '' then&#13;&#10;    fldStoreLicNum.Text := Compute('INIFILE(&#34;Print&#34;,&#34;LicenceNum&#34;,&#34;&#34;)');&#13;&#10;&#13;&#10;  If Compute('INIFILE(&#34;Print&#34;,&#34;StoreName&#34;,&#34;&#34;)') &#60;&#62; '' then&#13;&#10;    lblStoreName.Text := Compute('INIFILE(&#34;Print&#34;,&#34;StoreName&#34;,&#34;&#34;)');&#13;&#10;&#13;&#10;  If Compute('INIFILE(&#34;Print&#34;,&#34;StoreNo&#34;,&#34;&#34;)') &#60;&#62; '' then&#13;&#10;    StoreNo := Compute('INIFILE(&#34;Print&#34;,&#34;StoreNo&#34;,&#34;&#34;)');&#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbxNotIncludeOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;{  with cbxNotInclude, Engine do&#13;&#10;  begin&#13;&#10;If cbxNotInclude.Checked = True then&#13;&#10;   begin&#13;&#10;      cbxStore.Enabled:= False&#13;&#10;   end&#13;&#10;else&#13;&#10;   begin&#13;&#10;   cbxStore.Enabled:= True&#13;&#10;   end&#13;&#10;  end}&#13;&#10;end;&#13;&#10;&#13;&#10;procedure rbtnBookOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with rbtnBook, Engine do&#13;&#10;  begin&#13;&#10;   dtOnDate.Enabled := True;&#13;&#10;   dtFrom.Enabled := False;&#13;&#10;   dtTo.Enabled := False;&#13;&#10;   cbxNotInclude.Enabled := False;&#13;&#10;   cbxStore.Enabled := False;&#13;&#10;   chkDO2.Enabled    := False;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure rbtnPeriodOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with rbtnPeriod, Engine do&#13;&#10;  begin&#13;&#10;   dtOnDate.Enabled := False;&#13;&#10;   dtFrom.Enabled := True;&#13;&#10;   dtTo.Enabled := True;&#13;&#10;   cbxNotInclude.Enabled := True;&#13;&#10;   cbxStore.Enabled := True;&#13;&#10;   chkDo2.Enabled := True;&#13;&#10;   If cbxStore.Checked = True then  cbxNotInclude.Enabled:= False;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure saveSettings(sIniFile: String);&#13;&#10;begin&#13;&#10;  Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;'+DATETOSTR(dtFrom.Date)+'&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;  Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;'+DateToStr(dtTo.Date)+'&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;  Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;'+vPlaceId+'&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;&#13;&#10;  COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;TDByComms&#34;,&#34;'+VarToStr(cbTDByComms.Checked)+'&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;&#13;&#10;  LicNum := fldStoreLicNum.Text;&#13;&#10;  ss := '&#34;';&#13;&#10;  sss := Chr(39);&#13;&#10;  LicNum := REPLACESTR(LicNum, ss, ' ');&#13;&#10;  LicNum := REPLACESTR(LicNum, sss, ' ');&#13;&#10;  Compute('WRITEINIFILE(&#34;Print&#34;,&#34;LicenceNum&#34;,&#34;'+LicNum+'&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;&#13;&#10;  Compute('WRITEINIFILE(&#34;Print&#34;,&#34;StoreNo&#34;,&#34;'+StoreNo+'&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;&#13;&#10;  StorName := lblStoreName.Text;&#13;&#10;&#13;&#10;  Compute('WRITEINIFILE(&#34;Print&#34;,&#34;LicenceDate&#34;,&#34;'+DATETOSTR(fldStoreLicDate.Date)+'&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;  ss := '&#34;';&#13;&#10;  sss := Chr(39);&#13;&#10;  StorName := REPLACESTR(StorName, ss, ' ');&#13;&#10;  StorName := REPLACESTR(StorName, sss, ' ');&#13;&#10;  Compute('WRITEINIFILE(&#34;Print&#34;,&#34;StoreName&#34;,&#34;'+StorName+'&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;&#13;&#10;  if chkDO2.Checked = True then&#13;&#10;    begin&#13;&#10;      Compute('WRITEINIFILE(&#34;Print&#34;,&#34;IncludeAllDO2&#34;,&#34;0&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;      IncludeAllDO2 := '1'&#13;&#10;    end&#13;&#10;  else&#13;&#10;    begin&#13;&#10;      Compute('WRITEINIFILE(&#34;Print&#34;,&#34;IncludeAllDO2&#34;,&#34;1&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;      IncludeAllDO2 := '0'&#13;&#10;    end;&#13;&#10;&#13;&#10;&#13;&#10;  WriteIniFile(&#34;Print&#34;, 'PartInPlace', VarToStr(bPartInPlace), sIniFile);&#13;&#10;  WriteIniFile(&#34;Print&#34;, 'PartInPlaceText', sPartInPlaceText, sIniFile);&#13;&#10;  WriteIniFile(&#34;Print&#34;, 'PartOutPlace', VarToStr(bPartOutPlace), sIniFile);&#13;&#10;  WriteIniFile(&#34;Print&#34;, 'PartOutPlaceText', sPartOutPlaceText, sIniFile);&#13;&#10;    &#13;&#10;  WriteIniFile(&#34;Print&#34;, 'GoodStoreNumKPS', VarToStr(bGoodStoreNumKPS), sIniFile);  &#13;&#10;  WriteIniFile(&#34;Print&#34;, 'UseConts', VarToStr(bUseConts), sIniFile);&#13;&#10;&#13;&#10;  WriteIniFile(&#34;Print&#34;, 'AllowSplit', VarToStr(bAllowSplit), sIniFile);    &#13;&#10;  WriteIniFile(&#34;Print&#34;, 'PrintPlomb', VarToStr(bPrintPlomb), sIniFile);        &#13;&#10;  WriteIniFile(&#34;Print&#34;, 'PrintContType', VarToStr(bPrintContType), sIniFile);      &#13;&#10;  &#13;&#10;  if cbxNotInclude.Checked = True then&#13;&#10;    Compute('WRITEINIFILE(&#34;Print&#34;,&#34;NotInclude&#34;,&#34;1&#34;,&#34;'+sIniFile+'&#34;)')&#13;&#10;  else Compute('WRITEINIFILE(&#34;Print&#34;,&#34;NotInclude&#34;,&#34;0&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;&#13;&#10;  if cbxStore.Checked = True then&#13;&#10;    Compute('WRITEINIFILE(&#34;Print&#34;,&#34;InStore&#34;,&#34;1&#34;,&#34;'+sIniFile+'&#34;)')&#13;&#10;  else Compute('WRITEINIFILE(&#34;Print&#34;,&#34;InStore&#34;,&#34;0&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;  {if chkStorageDateNoPrint.Checked = True then&#13;&#10;    Compute('WRITEINIFILE(&#34;Print&#34;,&#34;StorageDateNoPrint&#34;,&#34;1&#34;,&#34;'+sIniFile+'&#34;)')&#13;&#10;  else Compute('WRITEINIFILE(&#34;Print&#34;,&#34;StorageDateNoPrint&#34;,&#34;0&#34;,&#34;'+sIniFile+'&#34;)');}      &#13;&#10;  &#13;&#10;  if rbtnBook.Checked = True then&#13;&#10;    begin&#13;&#10;      COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;OnCurrentBook&#34;,&#34;1&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;      onCurrBook := '1'&#13;&#10;    end&#13;&#10;  else&#13;&#10;    begin&#13;&#10;      COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;OnCurrentBook&#34;,&#34;0&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;      onCurrBook := '0'&#13;&#10;    end;&#13;&#10;&#13;&#10;   If sDirDO3DB &#60;&#62; '' then&#13;&#10;     COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;DO3DBDir&#34;,&#34;'+sDirDO3DB+'&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbtnOkOnBeforePrint(Sender: TfrxComponent);&#13;&#10;Var&#13;&#10;  sOrderBy: String;&#13;&#10;  sSortBy: String;&#13;&#10;begin&#13;&#10;  IF UseDateDO3.Checked then DO3Date := FORMATDATETIME('DD/MM/YYYY HH:NN', DateDO3.Date + Time)&#13;&#10;  else DO3Date := FORMATDATETIME('DD/MM/YYYY HH:NN', DATE + TIME);&#13;&#10;&#13;&#10;  with cbtnOk, Engine do&#13;&#10;  begin&#13;&#10;     dtPeriodEnd := Trunc(dtTo.Date) + STRTOTIME('23:59:59');&#13;&#10;     //Проверим галку &#34;Не включать ранее периода&#34;&#13;&#10;     //  if cbxNotInclude.Checked = True then&#13;&#10;     dtPeriodStart := Trunc(dtFrom.Date) + STRTOTIME('00:00:00');&#13;&#10;     // else&#13;&#10;     //  dtPeriodStart := STRTODATE('01.01.1900') + STRTOTIME('00:00:01');&#13;&#10;     //Запомним начало периода отчета&#13;&#10;     PeriodStart := Trunc(dtFrom.Date) + STRTOTIME('00:00:00');&#13;&#10;&#13;&#10;     // &#34;веса&#34;&#13;&#10;     bBrutto := chkBrutto.Checked;&#13;&#10;     bUnits := chkUnits.Checked;&#13;&#10;     bVolume := chkVolume.Checked;&#13;&#10;&#13;&#10;     COMPUTE('WRITEINIFILE(&#34;Print&#34;, &#34;DO3Brutto&#34;, &#34;' + VarToStr(bBrutto) + '&#34;)');&#13;&#10;     COMPUTE('WRITEINIFILE(&#34;Print&#34;, &#34;DO3Units&#34;, &#34;' + VarToStr(bUnits) + '&#34;)');&#13;&#10;     COMPUTE('WRITEINIFILE(&#34;Print&#34;, &#34;DO3Volume&#34;, &#34;' + VarToStr(bVolume) + '&#34;)');&#13;&#10;&#13;&#10;&#13;&#10;     bPartInPlace := chkPartInPlace.Checked;&#13;&#10;     sPartInPlaceText := edPartInPlaceText.Text;&#13;&#10;     bPartOutPlace := chkPartOutPlace.Checked;&#13;&#10;     sPartOutPlaceText := edPartOutPlaceText.Text;&#13;&#10;&#13;&#10;     bStorageDateNoPrint := chkStorageDateNoPrint.Checked;&#13;&#10;     COMPUTE('WRITEINIFILE(&#34;Print&#34;, &#34;StorageDateNoPrint&#34;, &#34;' + VarToStr(bStorageDateNoPrint) + '&#34;)');         &#13;&#10;    &#13;&#10;     bSortByNBD := rbtnSortByNBD.Checked;&#13;&#10;     bSortByBdDate := rbtnSortByBdDate.Checked;&#13;&#10;     bSortByBegKeep := rbtnSortByBegKeep.Checked;&#13;&#10;&#13;&#10;     sSortBy := iif(bSortByNBD, '3', iif(bSortByBdDate, '2', '1'));&#13;&#10;&#13;&#10;     COMPUTE('WRITEINIFILE(&#34;Print&#34;, &#34;SortBy&#34;, &#34;' + sSortBy + '&#34;)');&#13;&#10;&#13;&#10;     bUseConts := chkUseConts.Checked;      &#13;&#10;     bPrintContType := chkPrintContType.Checked;                &#13;&#10;     bPrintPlomb :=  chkPrintPlomb.Checked;        &#13;&#10;     bGoodStoreNumKPS := chkGoodStoreNumKPS.Checked;                &#13;&#10;  &#13;&#10;     //Объявляем переменные&#13;&#10;     NumLines := 0;&#13;&#10;     MAINID := 0;&#13;&#10;     MainG32 := 0;&#13;&#10;     PrintFirstAll := True;&#13;&#10;&#13;&#10;     // номер требования таможни&#13;&#10;     NumCustQuery  := edtNumCust.Text;&#13;&#10;     dtNumCustQuery  := dtNumCust.Date;&#13;&#10;     Compute('WRITEINIFILE(&#34;Print&#34;,&#34;dtNumCust&#34;,&#34;'+DATETOSTR(dtNumCustQuery)+'&#34;)');&#13;&#10;     Compute('WRITEINIFILE(&#34;Print&#34;,&#34;NumCust&#34;,&#34;'+NumCustQuery+'&#34;)');       &#13;&#10;&#13;&#10;     // export&#13;&#10;     vExport := cbExport.Checked;&#13;&#10;&#13;&#10;     // AllowSplit                     &#13;&#10;     bAllowSplit := chkAllowSplit.Checked;&#13;&#10;    &#13;&#10;     // работник склада&#13;&#10;     sStoreKeeper := StoreKeep.Text;&#13;&#10;     Compute('WRITEINIFILE(&#34;Print&#34;,&#34;StoreKeeper&#34;,&#34;'+sStoreKeeper+'&#34;)');&#13;&#10;     Compute('WRITEINIFILE(&#34;Print&#34;,&#34;bG082&#34;,&#34;'+VarToStr(cbxG082.Checked)+'&#34;)');&#13;&#10;       &#13;&#10;     // &#34;итоги&#34;&#13;&#10;     If chkItog.Checked then&#13;&#10;        vprintItog := True&#13;&#10;     else vprintItog := False;&#13;&#10;     If chkG42.Checked then&#13;&#10;        vprintG42 := True&#13;&#10;     else vprintG42 := False;&#13;&#10;     If chkG35.Checked then&#13;&#10;        vprintG35 := True&#13;&#10;     else vprintG35 := False;&#13;&#10;     If chkUSDG42.Checked then&#13;&#10;        vprintUSDG42 := True&#13;&#10;     else vprintUSDG42 := False;&#13;&#10;     If chkEurG42.Checked then&#13;&#10;        vprintEurG42 := True&#13;&#10;     else vprintEurG42 := False;&#13;&#10;     If chkRubG42.Checked then&#13;&#10;        vprintRubG42 := True&#13;&#10;     else vprintRubG42 := False;&#13;&#10;     If chkClearG42.Checked then&#13;&#10;        vprintClearG42 := True&#13;&#10;     else vprintClearG42 := False;&#13;&#10;&#13;&#10;     sInG311 := 0;&#13;&#10;     sOutG311 := 0;&#13;&#10;     sInG35_b := 0;&#13;&#10;     sOutG35_b := 0;&#13;&#10;     sInG35_v := 0;&#13;&#10;     sOutG35_v := 0;&#13;&#10;     sInG35_u := 0;&#13;&#10;     sOutG35_u := 0;&#13;&#10;     sInG35 := '';&#13;&#10;     sOutG35 := '';&#13;&#10;     sInG42 := 0;&#13;&#10;     sOutG42 := 0;&#13;&#10;&#13;&#10;    if rbtnBook.Checked = True then&#13;&#10;      sTempDo2Comm := CREATEDO3COMM(StrToInt(vPlaceId), dtPeriodStart, dtPeriodEnd,'', 2)&#13;&#10;    else if cbxNotInclude.Enabled = True then begin&#13;&#10;      if cbxNotInclude.Checked = True then&#13;&#10;        sTempDo2Comm := CREATEDO3COMM(StrToInt(vPlaceId), dtPeriodStart, dtPeriodEnd,'', 1)&#13;&#10;      else&#13;&#10;        sTempDo2Comm := CREATEDO3COMM(StrToInt(vPlaceId), dtPeriodStart, dtPeriodEnd,'');&#13;&#10;    end&#13;&#10;    else&#13;&#10;      sTempDo2Comm := CREATEDO3COMM(StrToInt(vPlaceId), dtPeriodStart, dtPeriodEnd,'', 3);&#13;&#10;&#13;&#10;     if bSortByNBD then&#13;&#10;       sOrderBy := ' ORDER BY NBD, ACCEPTDATE, GN, OUT_DATE'&#13;&#10;     else if bSortByBdDate then&#13;&#10;       sOrderBy := ' ORDER BY BD_DATE, NBD, GN, OUT_DATE'&#13;&#10;     else&#13;&#10;       sOrderBy := ' ORDER BY ACCEPTDATE, NBD, GN, OUT_DATE';&#13;&#10;&#13;&#10;     if rbtnBook.Checked = True then&#13;&#10;       sqlText:='select  *  from '+ CHR(39)+sTempDo2Comm+CHR(39)+ sOrderBy&#13;&#10;     else&#13;&#10;       if bSTORexists = False then&#13;&#10;         sqlText:='select  *  from '+ CHR(39)+sTempDo2Comm+CHR(39)+ sOrderBy&#13;&#10;       else&#13;&#10;         begin&#13;&#10;           COMPUTE('FIRST(&#34;STOR&#34;)');&#13;&#10;           vPlaceId := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;PLACEID&#34;)');&#13;&#10;           sqlText:='select  *  from '+ CHR(39)+sTempDo2Comm+CHR(39)+' WHERE ((PLACEID= '+ vPlaceId+') ';&#13;&#10;           COMPUTE('Next(&#34;STOR&#34;)');&#13;&#10;           while COMPUTE('EOF(&#34;STOR&#34;)') = '0' do begin&#13;&#10;             vPlaceId := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;PLACEID&#34;)');&#13;&#10;             sqlText := sqlText + ' OR (PLACEID= '+ vPlaceId+') ';&#13;&#10;             COMPUTE('Next(&#34;STOR&#34;)');&#13;&#10;           end;&#13;&#10;           sqlText := sqlText + ')' + sOrderBy;&#13;&#10;         end;&#13;&#10;     //ShowMessage(sqlText) ;&#13;&#10;&#13;&#10;     MainQuery.SQL.Clear;&#13;&#10;     MainQuery.SQL.Add(sqlText);&#13;&#10;     MainQuery.Active:=True;&#13;&#10;&#13;&#10;     // каталог для сохранения DO3Comm.db&#13;&#10;     sDirDO3DB :='';&#13;&#10;     If COMPUTE('DirectoryExists(&#34;'+edtDO3DB.Text+'&#34;)') &#60;&#62; '0' then&#13;&#10;     //If edtDO3DB.Text &#60;&#62; '' then&#13;&#10;       begin&#13;&#10;       // Dir to save DO3Comm.db&#13;&#10;         sDirDO3DB := COMPUTE('INCLUDETRAILINGBACKSLASH(&#34;'+edtDO3DB.Text+'&#34;)');&#13;&#10;         //COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;DO3DBDir&#34;,&#34;'+sDirDO3DB+'&#34;)');&#13;&#10;         SaveSettings(sDirDO3DB+'do3comm.ini');&#13;&#10;         Compute('CopyFile(&#34;'+sTempDo2Comm+'&#34;, &#34;'+sDirDO3DB+'do3comm.db&#34;)');&#13;&#10;       end&#13;&#10;     else&#13;&#10;       begin&#13;&#10;         edtDO3DB.Text := '';&#13;&#10;       end;&#13;&#10;&#13;&#10;     SaveSettings(COMPUTE('INCLUDETRAILINGBACKSLASH(&#34;'+ProgramPath+'&#34;)')+'sts.ini');&#13;&#10;     SaveSettings(COMPUTE('INCLUDETRAILINGBACKSLASH(&#34;'+ProgramPath+'&#34;)')+'stsinsp.ini');&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure btnCallRefOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with btnCallRef, Engine do&#13;&#10;  begin&#13;&#10;    COMPUTE(' globalvar (&#34;strStoreNumLic&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;strStoreNum&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;strStoreName&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;strLicExt&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;sChief&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;sPlaceId&#34;,Integer)');&#13;&#10;    COMPUTE(' globalvar (&#34;sLicenceDate&#34;,DateTime)');&#13;&#10;    COMPUTE('OPENQUERY (&#34;Stors&#34;, &#34;STS_DB&#34;, &#34;Select * from STORES&#34;)');&#13;&#10;&#13;&#10;&#13;&#10;    IF COMPUTE('SelectRecords(&#34;Выбор складских площадок&#34;, &#34;STORS&#34;,'+&#13;&#10;                          '['+&#13;&#10;                           '[&#34;LICENCENO&#34;, &#34;№ лицензии&#34;, 12],'+&#13;&#10;                           '[&#34;STORE_NO&#34;, &#34;№ склада&#34;, 8],'+&#13;&#10;                           '[&#34;NAME&#34;, &#34;Название склада&#34;, 30]'+&#13;&#10;                           '],'+&#13;&#10;                           '&#34;STOR&#34;, &#34;&#34;, &#34;STS_DB&#34;)') = '1' then&#13;&#10;&#13;&#10;      begin&#13;&#10;        bSTORexists := True;&#13;&#10;        COMPUTE('FIRST(&#34;STOR&#34;)');&#13;&#10;        fldStoreLicNum.Text := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;LICENCENO&#34;)');  //   номер  лиценцзии&#13;&#10;        StoreNo := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;STORE_NO&#34;)') ; //   номер склада&#13;&#10;        lblStoreName.Text :=COMPUTE('FieldValue(&#34;Stor&#34;, &#34;NAME&#34;)') ;     //   название склада&#13;&#10;        fldLicExt.Text := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;LICENCENO_EXT&#34;)');     //   Признак перерегистрации&#13;&#10;        If COMPUTE('RECORDCOUNT(&#34;STOR&#34;)') &#60;&#62; '1' then&#13;&#10;          vPlaceId :='0'&#13;&#10;        else vPlaceId := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;PLACEID&#34;)');&#13;&#10;        vChief  := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;Chief&#34;)');   // уполномоченный представитель склада&#13;&#10;&#13;&#10;        vLicenceDate := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;LICENCEDATE&#34;)');&#13;&#10;        fldStoreLicDate.Date := STRTODATEDEF(vLicenceDate, Date);  // дата выдачи лицензии&#13;&#10;        cbtnOk.Enabled := True;&#13;&#10;      end&#13;&#10;    else&#13;&#10;      begin&#13;&#10;        cbtnOk.Enabled := False;&#13;&#10;      end&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbxStoreOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;If cbxStore.Checked = True then&#13;&#10;   begin&#13;&#10;      cbxNotInclude.Enabled:= False&#13;&#10;   end&#13;&#10;else&#13;&#10;   begin&#13;&#10;&#13;&#10;   cbxNotInclude.Enabled:= True&#13;&#10;   end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure PageFooter1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with PageFooter1, Engine do&#13;&#10;  begin&#13;&#10;    if vExport then&#13;&#10;      PageFooter1.Visible := False&#13;&#10;    else&#13;&#10;      If &#60;Page#&#62;=1 then Memo2.Visible:=True else  Memo2.Visible:=False&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ReportTitle1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with ReportTitle1, Engine do&#13;&#10;  begin&#13;&#10;     NumLines := 0;&#13;&#10;     MAINID := 0;&#13;&#10;     MainG32 := 0;&#13;&#10;     PrintFirstAll := True;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure SumOut(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  sTemp := &#34;&#34;;&#13;&#10;&#13;&#10;  if (&#60;MainQuery.&#34;COUNTER&#34;&#62; &#60;&#62; Null) and (&#60;MainQuery.&#34;COUNTER&#34;&#62; &#60;&#62; 0) then begin&#13;&#10;&#13;&#10;    if (onCurrBook =  '1') or (IncludeAllDo2 = '0') then&#13;&#10;      SumOut2(MasterData2)&#13;&#10;    else if &#60;MainQuery.&#34;OUT_DATE&#34;&#62; &#60;&#62; Null then begin&#13;&#10;&#13;&#10;      if &#60;MainQuery.&#34;OUT_DATE&#34;&#62; &#60;= dtPeriodEnd then&#13;&#10;        SumOut2(MasterData2)&#13;&#10;      else&#13;&#10;        sTemp := '';&#13;&#10;&#13;&#10;    end&#13;&#10;    else if &#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#60;&#62; Null then begin&#13;&#10;&#13;&#10;      if &#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#60;= dtPeriodEnd then&#13;&#10;        SumOut2(MasterData2)&#13;&#10;      else&#13;&#10;        sTemp := '';&#13;&#10;&#13;&#10;    end;&#13;&#10;&#13;&#10;  end;&#13;&#10;&#13;&#10;end;&#13;&#10;procedure SumOut2(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  sOutG311 := sOutG311+&#60;MainQuery.&#34;RELEASE_G311&#34;&#62;;&#13;&#10;&#13;&#10;  If vprintG42 then begin                                &#13;&#10;    IF Not UseDateDO3.Checked then begin // пересчет на дату ДО1                                                                 &#13;&#10;      if vprintUSDG42 then begin // в доллары                 &#13;&#10;         if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;           sOutG42 := sOutG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;) + ')'))&#13;&#10;         else&#13;&#10;           sOutG42 := sOutG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;) + ')'));&#13;&#10;      end&#13;&#10;      else if vprintEurG42 then begin // в Euro&#13;&#10;        if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;          sOutG42 := sOutG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;) + ')'))&#13;&#10;        else&#13;&#10;          sOutG42 := sOutG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;) + ')'))&#13;&#10;      end&#13;&#10;      else if vprintRubG42 then begin // в рубли               &#13;&#10;        if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;          sOutG42 := sOutG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;) + ')'))&#13;&#10;        else&#13;&#10;          sOutG42 := sOutG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;) + ')'))&#13;&#10;      end&#13;&#10;      else&#13;&#10;        sOutG42 := sOutG42+&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;  // суммируем как есть                                    &#13;&#10;    end&#13;&#10;    else begin // пересчет на дату отчета, устанавливаем внизу в настройке отчета                                                                                                                                                                  &#13;&#10;      if vprintUSDG42 then begin // в доллары                 &#13;&#10;         if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;           sOutG42 := sOutG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;) + ')'))&#13;&#10;         else&#13;&#10;           sOutG42 := sOutG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;) + ')'));&#13;&#10;      end&#13;&#10;      else if vprintEurG42 then begin // в Euro&#13;&#10;        if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;          sOutG42 := sOutG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;) + ')'))&#13;&#10;        else&#13;&#10;          sOutG42 := sOutG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;) + ')'))&#13;&#10;      end&#13;&#10;      else if vprintRubG42 then begin // в рубли             &#13;&#10;        if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;          sOutG42 := sOutG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;) + ')'))&#13;&#10;        else&#13;&#10;          sOutG42 := sOutG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;) + ')'))&#13;&#10;      end&#13;&#10;      else&#13;&#10;        sOutG42 := sOutG42+&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;;  // суммируем как есть                                      &#13;&#10;    end;              &#13;&#10;&#13;&#10;  end;&#13;&#10;&#13;&#10;  If vprintG35 then begin&#13;&#10;&#13;&#10;    if bVolume and (&#60;MainQuery.&#34;Release_G315C&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;Release_G315C&#34;&#62; &#60;&#62; 0) then&#13;&#10;      sOutG35_v := sOutG35_v+&#60;MainQuery.&#34;Release_G315C&#34;&#62;;&#13;&#10;&#13;&#10;    if bUnits  and (&#60;MainQuery.&#34;Release_G315A&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;Release_G315A&#34;&#62; &#60;&#62; 0)  and (&#60;MainQuery.&#34;G41A&#34;&#62; &#60;&#62; Null) then&#13;&#10;      sOutG35_u := sOutG35_u+&#60;MainQuery.&#34;Release_G315A&#34;&#62;;&#13;&#10;&#13;&#10;    if bBrutto  and (&#60;MainQuery.&#34;Release_G35&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;Release_G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;      sOutG35_b := sOutG35_b+&#60;MainQuery.&#34;Release_G35&#34;&#62;;&#13;&#10;&#13;&#10;    If (not bVolume) and (not bUnits) and (not bBrutto) then begin&#13;&#10;      If vType = 1 then&#13;&#10;        sOutG35_b := sOutG35_b+&#60;MainQuery.&#34;Release_G315C&#34;&#62;&#13;&#10;      else If vType = 2 then&#13;&#10;        sOutG35_b := sOutG35_b+&#60;MainQuery.&#34;Release_G315A&#34;&#62;&#13;&#10;      else If vType = 3 then&#13;&#10;        sOutG35_b := sOutG35_b+&#60;MainQuery.&#34;Release_G35&#34;&#62;&#13;&#10;    end;&#13;&#10;&#13;&#10;  end;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;Procedure SumIn(Sender:TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  if not vUseStoreDocs then begin&#13;&#10;&#13;&#10;    sInG311 := sInG311+&#60;MainQuery.&#34;G311&#34;&#62;;&#13;&#10;      &#13;&#10;    IF Not UseDateDO3.Checked then begin // пересчет на дату ДО1&#13;&#10;      //ShowMessage('BD_DATE');                                                           &#13;&#10;      If vprintG42 then begin&#13;&#10;        if vprintUSDG42 then begin// пересчет в доллары&#13;&#10;          if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;            sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'))&#13;&#10;          else&#13;&#10;            sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'));&#13;&#10;        end&#13;&#10;        else if vprintEurG42 then begin // пересчет в Euro&#13;&#10;          if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;            sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'))&#13;&#10;          else&#13;&#10;            sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'));&#13;&#10;        end&#13;&#10;        else if vprintRubG42 then begin  // пересчет в рубли&#13;&#10;          if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;            sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'))&#13;&#10;          else&#13;&#10;            sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'));&#13;&#10;        end&#13;&#10;        else&#13;&#10;          sInG42 := sInG42+&#60;MainQuery.&#34;G42&#34;&#62;;  // суммируем как есть&#13;&#10;      end;        &#13;&#10;    end&#13;&#10;    else begin // пересчет на дату отчета, устанавливаем внизу в настройке     &#13;&#10;      If vprintG42 then begin                                                                                                                                                   &#13;&#10;        if vprintUSDG42 then begin // пересчет в доллары&#13;&#10;          if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then begin&#13;&#10;            //ShowMessage(FORMATDATETIME('DD.MM.YYYY',DateDO3.Date));                                             &#13;&#10;            sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'))&#13;&#10;            end                    &#13;&#10;          else begin&#13;&#10;            //ShowMessage(FORMATDATETIME('DD.MM.YYYY',DateDO3.Date));              &#13;&#10;            sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'));&#13;&#10;           end;                      &#13;&#10;        end&#13;&#10;        else if vprintEurG42 then begin // пересчет в Euro&#13;&#10;          if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;            sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'))&#13;&#10;          else&#13;&#10;            sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'));&#13;&#10;        end&#13;&#10;        else if vprintRubG42 then begin  // пересчет в рубли&#13;&#10;          if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;            sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'))&#13;&#10;          else&#13;&#10;            sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'));&#13;&#10;        end&#13;&#10;        else&#13;&#10;          sInG42 := sInG42+&#60;MainQuery.&#34;G42&#34;&#62;;  // суммируем как есть&#13;&#10;      end;      &#13;&#10;    end;              &#13;&#10;      &#13;&#10;&#13;&#10;    If vprintG35 then begin&#13;&#10;      if bVolume and (&#60;MainQuery.&#34;G315C&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;G315C&#34;&#62; &#60;&#62; 0) then&#13;&#10;        sInG35_v := sInG35_v+&#60;MainQuery.&#34;G315C&#34;&#62;;&#13;&#10;      if bUnits  and (&#60;MainQuery.&#34;G315A&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;G315A&#34;&#62; &#60;&#62; 0)  and (&#60;MainQuery.&#34;G41A&#34;&#62; &#60;&#62; Null) then&#13;&#10;        sInG35_u := sInG35_u+&#60;MainQuery.&#34;G315A&#34;&#62;;&#13;&#10;      if bBrutto  and (&#60;MainQuery.&#34;G35&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;        sInG35_b := sInG35_b+&#60;MainQuery.&#34;G35&#34;&#62;;&#13;&#10;      If (not bVolume) and (not bUnits) and (not bBrutto) then begin&#13;&#10;        If vType = 1 then&#13;&#10;          sInG35_b := sInG35_b+&#60;MainQuery.&#34;G315C&#34;&#62;&#13;&#10;        else If vType = 2 then&#13;&#10;          sInG35_b := sInG35_b+&#60;MainQuery.&#34;G315A&#34;&#62;&#13;&#10;        else If vType = 3 then&#13;&#10;          sInG35_b := sInG35_b+&#60;MainQuery.&#34;G35&#34;&#62;&#13;&#10;      end;&#13;&#10;    end;&#13;&#10;&#13;&#10;  end&#13;&#10;  else begin&#13;&#10;    if COMPUTE('FINDKEY(&#34;IN_COMM_2&#34;, [' + VarToStr(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + ', ' +&#13;&#10;                                                               VarToStr(&#60;MainQuery.&#34;ID&#34;&#62;) + ', ' +&#13;&#10;                                                               VarToStr(&#60;MainQuery.&#34;G32&#34;&#62;) + '])') then begin&#13;&#10;      sInG311 := sInG311+&#60;IN_COMM_2.&#34;G311&#34;&#62;;&#13;&#10;&#13;&#10;      IF Not UseDateDO3.Checked then begin // пересчет на дату ДО1    &#13;&#10;        If vprintG42 then begin&#13;&#10;          if vprintUSDG42 then begin// пересчет в доллары&#13;&#10;            if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;IN_COMM_2.&#34;G42&#34;&#62;) + ')'))&#13;&#10;            else&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;IN_COMM_2.&#34;G42&#34;&#62;) + ')'));&#13;&#10;          end&#13;&#10;          else if vprintEurG42 then begin // пересчет в Euro&#13;&#10;            if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;IN_COMM_2.&#34;G42&#34;&#62;) + ')'))&#13;&#10;            else&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;IN_COMM_2.&#34;G42&#34;&#62;) + ')'));&#13;&#10;          end&#13;&#10;          else if vprintRubG42 then begin  // пересчет в рубли&#13;&#10;            if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;IN_COMM_2.&#34;G42&#34;&#62;) + ')'))&#13;&#10;            else&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;IN_COMM_2.&#34;G42&#34;&#62;) + ')'));&#13;&#10;          end&#13;&#10;          else&#13;&#10;            sInG42 := sInG42+&#60;IN_COMM_2.&#34;G42&#34;&#62;;  // суммируем как есть&#13;&#10;        end;&#13;&#10;      end&#13;&#10;      else begin // пересчет на дату ДО3&#13;&#10;        If vprintG42 then begin&#13;&#10;          if vprintUSDG42 then begin// пересчет в доллары&#13;&#10;            if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;IN_COMM_2.&#34;G42&#34;&#62;) + ')'))&#13;&#10;            else&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;IN_COMM_2.&#34;G42&#34;&#62;) + ')'));&#13;&#10;          end&#13;&#10;          else if vprintEurG42 then begin // пересчет в Euro&#13;&#10;            if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;IN_COMM_2.&#34;G42&#34;&#62;) + ')'))&#13;&#10;            else&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;IN_COMM_2.&#34;G42&#34;&#62;) + ')'));&#13;&#10;          end&#13;&#10;          else if vprintRubG42 then begin  // пересчет в рубли&#13;&#10;            if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;IN_COMM_2.&#34;G42&#34;&#62;) + ')'))&#13;&#10;            else&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;IN_COMM_2.&#34;G42&#34;&#62;) + ')'));&#13;&#10;          end&#13;&#10;          else&#13;&#10;            sInG42 := sInG42+&#60;IN_COMM_2.&#34;G42&#34;&#62;;  // суммируем как есть&#13;&#10;        end;    &#13;&#10;      end;                &#13;&#10;&#13;&#10;      If vprintG35 then begin&#13;&#10;        if bVolume and (&#60;IN_COMM_2.&#34;G315C&#34;&#62; &#60;&#62; Null) AND (&#60;IN_COMM_2.&#34;G315C&#34;&#62; &#60;&#62; 0) then&#13;&#10;          sInG35_v := sInG35_v+&#60;IN_COMM_2.&#34;G315C&#34;&#62;;&#13;&#10;        if bUnits  and (&#60;IN_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; Null) AND (&#60;IN_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0)  and (&#60;MainQuery.&#34;G41A&#34;&#62; &#60;&#62; Null) then&#13;&#10;          sInG35_u := sInG35_u+&#60;IN_COMM_2.&#34;G315A&#34;&#62;;&#13;&#10;        if bBrutto  and (&#60;IN_COMM_2.&#34;G35&#34;&#62; &#60;&#62; Null) AND (&#60;IN_COMM_2.&#34;G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;          sInG35_b := sInG35_b+&#60;IN_COMM_2.&#34;G35&#34;&#62;;&#13;&#10;        If (not bVolume) and (not bUnits) and (not bBrutto) then begin&#13;&#10;          If vType = 1 then&#13;&#10;            sInG35_b := sInG35_b+&#60;IN_COMM_2.&#34;G315C&#34;&#62;&#13;&#10;          else If vType = 2 then&#13;&#10;            sInG35_b := sInG35_b+&#60;IN_COMM_2.&#34;G315A&#34;&#62;&#13;&#10;          else If vType = 3 then&#13;&#10;            sInG35_b := sInG35_b+&#60;IN_COMM_2.&#34;G35&#34;&#62;;&#13;&#10;        end;&#13;&#10;      end;&#13;&#10;&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;&#13;&#10;      sInG311 := sInG311+&#60;MainQuery.&#34;G311&#34;&#62;;&#13;&#10;      IF Not UseDateDO3.Checked then begin // пересчет на дату ДО1&#13;&#10;        &#13;&#10;        If vprintG42 then begin&#13;&#10;          if vprintUSDG42 then begin// пересчет в доллары&#13;&#10;            if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'))&#13;&#10;            else&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'));&#13;&#10;          end&#13;&#10;          else if vprintEurG42 then begin // пересчет в Euro&#13;&#10;            if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'))&#13;&#10;            else&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'));&#13;&#10;          end&#13;&#10;          else if vprintRubG42 then begin  // пересчет в рубли&#13;&#10;            if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'))&#13;&#10;            else&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;MainQuery.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'));&#13;&#10;          end&#13;&#10;          else&#13;&#10;            sInG42 := sInG42+&#60;MainQuery.&#34;G42&#34;&#62;;  // суммируем как есть&#13;&#10;        end;&#13;&#10;      end&#13;&#10;      else begin // пересчет на дату ДО3                                                          &#13;&#10;        If vprintG42 then begin&#13;&#10;          if vprintUSDG42 then begin// пересчет в доллары&#13;&#10;            if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'))&#13;&#10;            else&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;840&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'));&#13;&#10;          end&#13;&#10;          else if vprintEurG42 then begin // пересчет в Euro&#13;&#10;            if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'))&#13;&#10;            else&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;978&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'));&#13;&#10;          end&#13;&#10;          else if vprintRubG42 then begin  // пересчет в рубли&#13;&#10;            if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'))&#13;&#10;            else&#13;&#10;              sInG42 := sInG42+ StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY',DateDO3.Date) + '&#34;, &#34;' + &#60;MainQuery.&#34;G221&#34;&#62; + '&#34;, &#34;643&#34;, ' + STR(&#60;MainQuery.&#34;G42&#34;&#62;) + ')'));&#13;&#10;          end&#13;&#10;          else&#13;&#10;            sInG42 := sInG42+&#60;MainQuery.&#34;G42&#34;&#62;;  // суммируем как есть&#13;&#10;        end;          &#13;&#10;      end;                &#13;&#10;&#13;&#10;      If vprintG35 then begin&#13;&#10;        if bVolume and (&#60;MainQuery.&#34;G315C&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;G315C&#34;&#62; &#60;&#62; 0) then&#13;&#10;          sInG35_v := sInG35_v+&#60;MainQuery.&#34;G315C&#34;&#62;;&#13;&#10;        if bUnits  and (&#60;MainQuery.&#34;G315A&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;G315A&#34;&#62; &#60;&#62; 0)  and (&#60;MainQuery.&#34;G41A&#34;&#62; &#60;&#62; Null) then&#13;&#10;          sInG35_u := sInG35_u+&#60;MainQuery.&#34;G315A&#34;&#62;;&#13;&#10;        if bBrutto  and (&#60;MainQuery.&#34;G35&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;          sInG35_b := sInG35_b+&#60;MainQuery.&#34;G35&#34;&#62;;&#13;&#10;        If (not bVolume) and (not bUnits) and (not bBrutto) then begin&#13;&#10;          If vType = 1 then&#13;&#10;            sInG35_b := sInG35_b+&#60;MainQuery.&#34;G315C&#34;&#62;&#13;&#10;          else If vType = 2 then&#13;&#10;            sInG35_b := sInG35_b+&#60;MainQuery.&#34;G315A&#34;&#62;&#13;&#10;          else If vType = 3 then&#13;&#10;            sInG35_b := sInG35_b+&#60;MainQuery.&#34;G35&#34;&#62;&#13;&#10;        end;&#13;&#10;      end;&#13;&#10;&#13;&#10;    end&#13;&#10;  end;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;Var        &#13;&#10;  sConts: String;  &#13;&#10;begin  &#13;&#10;  with MasterData2, Engine do&#13;&#10;  begin&#13;&#10;    &#13;&#10;  PrintFirstAll := True;&#13;&#10;  qCSDM.Active := False;&#13;&#10;  qCSDM.Active := True;&#13;&#10;  if qCSDM.Recordcount &#62; 0 then &#13;&#10;    Visible := False&#13;&#10;  else                           &#13;&#10;    Visible := True;&#13;&#10;&#13;&#10;  vtype:=0;{ переменная для определения един. измер. товарва&#13;&#10;            1 - объем&#13;&#10;            2 - доп. единицы&#13;&#10;            3 - брутто&#13;&#10; }&#13;&#10;  if  AistCompatible=1 then&#13;&#10;     vType:=3&#13;&#10;  else&#13;&#10;    begin&#13;&#10;        //Сначала смотрим заполнен ли объем&#13;&#10;        if ((&#60;MainQuery.&#34;G315C&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;G315C&#34;&#62; &#60;&#62; 0)) then&#13;&#10;          vtype:=1&#13;&#10;        else&#13;&#10;          //Затем смотрим заполнены ли доп.ед. измерения&#13;&#10;        if (&#60;MainQuery.&#34;G315A&#34;&#62; &#60;&#62; 0) AND (&#60;MainQuery.&#34;G315A&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;G41A&#34;&#62; &#60;&#62; Null) then&#13;&#10;          vtype:=2&#13;&#10;        else&#13;&#10;         //Если объем и доп.ед. не заполнены, берем брутто&#13;&#10;        if &#60;MainQuery.&#34;G35&#34;&#62; &#60;&#62; Null then&#13;&#10;          vType:=3&#13;&#10;    end;&#13;&#10;&#13;&#10;  if (&#60;MainQuery.&#34;ID&#34;&#62; = MainID) and (&#60;MainQuery.&#34;g32&#34;&#62;=MainG32) then&#13;&#10;    PrintFirstAll := False&#13;&#10;  else PrintFirstAll := True;&#13;&#10;&#13;&#10;  MainID := &#60;MainQuery.&#34;ID&#34;&#62;;&#13;&#10;  MainG32 := &#60;MainQuery.&#34;G32&#34;&#62;;&#13;&#10;&#13;&#10;  if (onCurrBook =  '1') or (IncludeAllDo2 = '0') then&#13;&#10;    begin&#13;&#10;      Visible := True;&#13;&#10;      If Engine.FinalPass and vprintItog  then&#13;&#10;        begin&#13;&#10;          SumOut(MasterData2);&#13;&#10;          If (PrintFirstAll = True) then SumIn(MasterData2)&#13;&#10;        end&#13;&#10;    end&#13;&#10;  else&#13;&#10;    if &#60;MainQuery.&#34;OUT_DATE&#34;&#62; &#60;&#62; Null then&#13;&#10;        if (&#60;MainQuery.&#34;OUT_DATE&#34;&#62; &#62; dtPeriodEnd) and (PrintFirstAll = False) then&#13;&#10;            Visible := False&#13;&#10;        else&#13;&#10;          begin&#13;&#10;            Visible := True;&#13;&#10;            If Engine.FinalPass  and vprintItog then&#13;&#10;              begin&#13;&#10;                SumOut(MasterData2);&#13;&#10;                If (PrintFirstAll = True) then SumIn(MasterData2)&#13;&#10;              end&#13;&#10;          end&#13;&#10;    else&#13;&#10;      if (&#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#60;&#62; Null) and (&#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#62; dtPeriodEnd) and (PrintFirstAll = False) then&#13;&#10;        Visible := False&#13;&#10;      else&#13;&#10;        If (PrintFirstAll = True) and Engine.FinalPass  and vprintItog then&#13;&#10;          SumIn(MasterData2);              &#13;&#10;  end ;&#13;&#10;&#13;&#10;// фактурная стоимость - если в ДО1 не заполнена-печатаем пусто, и в расходе тоже, а не 0.00                                                                                                                                                                                                                               &#13;&#10;nG42 := '';  &#13;&#10;nG42_2 := '';&#13;&#10;Begin            &#13;&#10;  If not vUseStoreDocs then&#13;&#10;    begin                                       &#13;&#10;      If &#60;MainQuery.&#34;G42&#34;&#62; &#60;&#62; NULL then nG42_2 := FORMATFLOAT('0.##', &#60;MainQuery.&#34;G42&#34;&#62;)&#13;&#10;    end                            &#13;&#10;  else if COMPUTE('FINDKEY(&#34;IN_COMM_2&#34;, [' + VarToStr(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + ', ' +&#13;&#10;                                               VarToStr(&#60;MainQuery.&#34;ID&#34;&#62;) + ', ' +&#13;&#10;                                               VarToStr(&#60;MainQuery.&#34;G32&#34;&#62;) + '])') then&#13;&#10;       begin&#13;&#10;         If &#60;IN_COMM_2.&#34;G42&#34;&#62; &#60;&#62; NULL then nG42_2 := FORMATFLOAT('0.##', &#60;IN_COMM_2.&#34;G42&#34;&#62;)&#13;&#10;       end                   &#13;&#10;       else&#13;&#10;         If &#60;MainQuery.&#34;G42&#34;&#62; &#60;&#62; NULL then nG42_2 := FORMATFLOAT('0.##', &#60;MainQuery.&#34;G42&#34;&#62;)              &#13;&#10;end;            &#13;&#10;If MasterData2.Visible and (PrintFirstAll = True) then begin&#13;&#10;  If not vUseStoreDocs then&#13;&#10;    begin                                       &#13;&#10;      If &#60;MainQuery.&#34;G42&#34;&#62; &#60;&#62; NULL then nG42 := FORMATFLOAT('0.##', &#60;MainQuery.&#34;G42&#34;&#62;)&#13;&#10;    end                            &#13;&#10;  else if COMPUTE('FINDKEY(&#34;IN_COMM_2&#34;, [' + VarToStr(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + ', ' +&#13;&#10;                                               VarToStr(&#60;MainQuery.&#34;ID&#34;&#62;) + ', ' +&#13;&#10;                                               VarToStr(&#60;MainQuery.&#34;G32&#34;&#62;) + '])') then&#13;&#10;       begin&#13;&#10;         If &#60;IN_COMM_2.&#34;G42&#34;&#62; &#60;&#62; NULL then nG42 := FORMATFLOAT('0.##', &#60;IN_COMM_2.&#34;G42&#34;&#62;)&#13;&#10;       end                   &#13;&#10;       else&#13;&#10;         If &#60;MainQuery.&#34;G42&#34;&#62; &#60;&#62; NULL then nG42 := FORMATFLOAT('0.##', &#60;MainQuery.&#34;G42&#34;&#62;)              &#13;&#10;end  &#13;&#10;  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;     Text1:='Добавочный лист № '+ STR(&#60;PAGE#&#62;-1) + ' к отчетности по разовому требованию таможенного органа от';&#13;&#10;     If  &#60;PAGE#&#62; = 1 then   Text1:='Отчетность по разовому требованию таможенного органа от';&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo9OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   if rbtnBook.Checked = True then&#13;&#10;//      ReportPeriod := 'на ' + FormatDateTime('DD MMMM YYYY', &#60;Date&#62;) else&#13;&#10;      ReportPeriod := '' else&#13;&#10;      ReportPeriod := 'c ' +  FormatDateTime('DD MMMM YYYY', dtFrom.Date) + ' по ' + FormatDateTime('DD MMMM YYYY', dtTo.Date)&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo2, Engine do&#13;&#10;  begin&#13;&#10; Tex_t:='';&#13;&#10; If &#60;Page#&#62;=1 then Tex_t:='Количество добавочных листов отчета  ' + VARtoSTR(&#60;TOTALPAGES&#62;-1);&#13;&#10;&#13;&#10;  end&#13;&#10;end              ;&#13;&#10;&#13;&#10;procedure Memo15OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  vBegKeep := '';&#13;&#10;&#13;&#10;  if PrintFirstAll = True then begin&#13;&#10;&#13;&#10;    if bSortByNBD or bSortByBegKeep then begin&#13;&#10;&#13;&#10;      if (&#60;MainQuery.&#34;ACCEPTDATE&#34;&#62; &#60;&#62; Null) and (&#60;MainQuery.&#34;ACCEPTDATE&#34;&#62; &#60;&#62; 0) then&#13;&#10;        vBegKeep := FORMATDATETIME(&#34;DD.MM.YYYY HH:NN&#34;, &#60;MainQuery.&#34;ACCEPTDATE&#34;&#62;)          &#13;&#10;      else if (&#60;MainQuery.&#34;BD_DATE&#34;&#62; &#60;&#62; Null) and (&#60;MainQuery.&#34;BD_DATE&#34;&#62; &#60;&#62; 0) then&#13;&#10;        vBegKeep := FORMATDATETIME(&#34;DD.MM.YYYY HH:NN&#34;, &#60;MainQuery.&#34;BD_DATE&#34;&#62;)&#13;&#10;      else&#13;&#10;        vBegKeep := FORMATDATETIME(&#34;DD.MM.YYYY HH:NN&#34;, &#60;MainQuery.&#34;Beg_Keep&#34;&#62;)&#13;&#10;&#13;&#10;    end&#13;&#10;    else if bSortByBdDate then begin&#13;&#10;&#13;&#10;      if (&#60;MainQuery.&#34;BD_DATE&#34;&#62; &#60;&#62; Null) and (&#60;MainQuery.&#34;BD_DATE&#34;&#62; &#60;&#62; 0) then&#13;&#10;        vBegKeep := FORMATDATETIME(&#34;DD.MM.YYYY HH:NN&#34;, &#60;MainQuery.&#34;BD_DATE&#34;&#62;)&#13;&#10;      else if (&#60;MainQuery.&#34;ACCEPTDATE&#34;&#62; &#60;&#62; Null) and (&#60;MainQuery.&#34;ACCEPTDATE&#34;&#62; &#60;&#62; 0) then&#13;&#10;        vBegKeep := FORMATDATETIME(&#34;DD.MM.YYYY HH:NN&#34;, &#60;MainQuery.&#34;ACCEPTDATE&#34;&#62;)&#13;&#10;      else&#13;&#10;        vBegKeep := FORMATDATETIME(&#34;DD.MM.YYYY HH:NN&#34;, &#60;MainQuery.&#34;Beg_Keep&#34;&#62;);&#13;&#10;&#13;&#10;    end;  &#13;&#10;&#13;&#10;  end;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo32OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo32, Engine do&#13;&#10;  begin&#13;&#10;begin&#13;&#10;  vNumLine := &#34;&#34;;&#13;&#10;  if Engine.FINALPASS then&#13;&#10;    if PrintFirstAll then&#13;&#10;      begin&#13;&#10;        NumLines := NumLines + 1;&#13;&#10;        vNumline := VARtoSTR(NumLines);&#13;&#10;      end&#13;&#10;end&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo57OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo57, Engine do&#13;&#10;  begin&#13;&#10;  nuv := &#34;&#34;;&#13;&#10;  if PrintFirstAll = True then&#13;&#10;        nuv := VARtoSTR(&#60;MainQuery.&#34;NBD&#34;&#62;)&#13;&#10;&#13;&#10;  end&#13;&#10;end  ;&#13;&#10;&#13;&#10;procedure Memo70OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  nG312:='';&#13;&#10;&#13;&#10;  if PrintFirstAll = True then&#13;&#10;    nG312:= &#60;MainQuery.&#34;G312&#34;&#62;;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo72OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo72, Engine do&#13;&#10;  begin&#13;&#10;nG33:=  '';&#13;&#10;if PrintFirstAll = True then&#13;&#10;       nG33:=  &#60;MainQuery.&#34;G33&#34;&#62;&#13;&#10;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure Memo78OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  vG311 := &#34;&#34;;&#13;&#10;&#13;&#10;  if PrintFirstAll = True then begin&#13;&#10;&#13;&#10;    If not vUseStoreDocs then&#13;&#10;      vG311 := FORMATFLOAT('0.##', &#60;MainQuery.&#34;G311&#34;&#62;)&#13;&#10;   else if COMPUTE('FINDKEY(&#34;IN_COMM_2&#34;, [' + VarToStr(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + ', ' +&#13;&#10;                                               VarToStr(&#60;MainQuery.&#34;ID&#34;&#62;) + ', ' +&#13;&#10;                                               VarToStr(&#60;MainQuery.&#34;G32&#34;&#62;) + '])') then&#13;&#10;      vG311 := FORMATFLOAT('0.##', &#60;IN_COMM_2.&#34;G311&#34;&#62;)&#13;&#10;    else&#13;&#10;      vG311 := FORMATFLOAT('0.##', &#60;MainQuery.&#34;G311&#34;&#62;);&#13;&#10;        &#13;&#10;    if ((vG311 = '0') or (vG311 = '')) and bPartInPlace then&#13;&#10;      vG311 := sPartInPlaceText;          &#13;&#10;&#13;&#10;  end;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo86OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10; strGTDdate : String;                                               &#13;&#10;begin&#13;&#10;  vReleaseDoc:='';&#13;&#10;&#13;&#10;  If (AistCompatible = 1) and (StoreDocsBlock = 1) and (COMPUTE('TRIM(CUSTOMSNOPART(&#34;'+&#60;MainQuery.&#34;DOC_NO&#34;&#62;+'&#34;,2))') &#60;&#62; '') then&#13;&#10;    strGTDdate := ' от '+ FORMATDATETIME('dd.mm.yyyy', COMPUTE('EXCLUDEDATE(&#34;'+&#60;MainQuery.&#34;DOC_NO&#34;&#62;+'&#34;)'))&#13;&#10;  else            &#13;&#10;    strGTDdate := ' от '+ DATETOSTR(&#60;MainQuery.&#34;RELEASE_DATE&#34;&#62;);  &#13;&#10;  &#13;&#10;   if (&#60;MainQuery.&#34;COUNTER&#34;&#62; &#60;&#62; Null) and (&#60;MainQuery.&#34;COUNTER&#34;&#62; &#60;&#62; 0) then&#13;&#10;      if (&#60;MainQuery.&#34;DOC_NO&#34;&#62; &#60;&#62; Null) and (&#60;MainQuery.&#34;DOC_NO&#34;&#62; &#60;&#62; '') then&#13;&#10;        if (onCurrBook =  '1') or (IncludeAllDo2 = '0') then&#13;&#10;            if  &#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#60;&#62; NULL then&#13;&#10;                 vReleaseDoc := &#60;MainQuery.&#34;Doc_TYPE&#34;&#62; +' №'+&#60;MainQuery.&#34;Doc_NO&#34;&#62; + strGTDdate       &#13;&#10;            else vReleaseDoc := &#60;MainQuery.&#34;Doc_TYPE&#34;&#62; +' №'+&#60;MainQuery.&#34;Doc_NO&#34;&#62;&#13;&#10;        else&#13;&#10;            if &#60;MainQuery.&#34;OUT_DATE&#34;&#62; &#60;&#62; Null then&#13;&#10;               if &#60;MainQuery.&#34;OUT_DATE&#34;&#62; &#60;= dtPeriodEnd then&#13;&#10;                  if  &#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#60;&#62; NULL then&#13;&#10;                       vReleaseDoc := &#60;MainQuery.&#34;Doc_TYPE&#34;&#62; +' №'+&#60;MainQuery.&#34;Doc_NO&#34;&#62; + strGTDdate&#13;&#10;                  else vReleaseDoc := &#60;MainQuery.&#34;Doc_TYPE&#34;&#62; +' №'+&#60;MainQuery.&#34;Doc_NO&#34;&#62;&#13;&#10;               else  vReleaseDoc := ''&#13;&#10;            else&#13;&#10;              if &#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#60;&#62; Null then&#13;&#10;                if &#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#60;= dtPeriodEnd then&#13;&#10;                   vReleaseDoc := &#60;MainQuery.&#34;Doc_TYPE&#34;&#62; +' №'+&#60;MainQuery.&#34;Doc_NO&#34;&#62; + strGTDdate   &#13;&#10;                else   vReleaseDoc := ''&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo88OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo88, Engine do&#13;&#10;  begin&#13;&#10;   vrG311 := &#34;&#34;;&#13;&#10;   if (&#60;MainQuery.&#34;COUNTER&#34;&#62; &#60;&#62; Null) and (&#60;MainQuery.&#34;COUNTER&#34;&#62; &#60;&#62; 0) then begin          &#13;&#10;      if (onCurrBook =  '1') or (IncludeAllDo2 = '0') then&#13;&#10;         vrG311 := FORMATFLOAT('0.##',&#60;MainQuery.&#34;RELEASE_G311&#34;&#62;)&#13;&#10;      else&#13;&#10;          if &#60;MainQuery.&#34;OUT_DATE&#34;&#62; &#60;&#62; Null then&#13;&#10;             if &#60;MainQuery.&#34;OUT_DATE&#34;&#62; &#60;= dtPeriodEnd then begin             &#13;&#10;                 vrG311 := FORMATFLOAT('0.##',&#60;MainQuery.&#34;RELEASE_G311&#34;&#62;);&#13;&#10;                 if (vrG311 = '') and bPartOutPlace then  vrG311 := sPartOutPlaceText;&#13;&#10;             end                         &#13;&#10;             else  vrG311 := ''&#13;&#10;          else&#13;&#10;            if &#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#60;&#62; Null then&#13;&#10;              if &#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#60;= dtPeriodEnd then begin          &#13;&#10;                vrG311 := FORMATFLOAT('0.##',&#60;MainQuery.&#34;RELEASE_G311&#34;&#62;);&#13;&#10;                if (vrG311 = '') and bPartOutPlace then  vrG311 := sPartOutPlaceText;&#13;&#10;              end                         &#13;&#10;              else   vrG311 := '';&#13;&#10;      if (vrG311 = '0') and bPartOutPlace then&#13;&#10;        vrG311 := sPartOutPlaceText;&#13;&#10;    end                &#13;&#10;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo92OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;vrG42:=&#34;&#34;;&#13;&#10;//Showmessage(nG42);                              &#13;&#10;If nG42_2 &#60;&#62; '' then                      &#13;&#10;  if (&#60;MainQuery.&#34;COUNTER&#34;&#62; &#60;&#62; Null) and (&#60;MainQuery.&#34;COUNTER&#34;&#62; &#60;&#62; 0) then&#13;&#10;    if (onCurrBook =  '1') or (IncludeAllDo2 = '0') then&#13;&#10;       vrG42 := FORMATFLOAT('0.##',&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;)&#13;&#10;    else&#13;&#10;      if &#60;MainQuery.&#34;OUT_DATE&#34;&#62; &#60;&#62; Null then&#13;&#10;        if &#60;MainQuery.&#34;OUT_DATE&#34;&#62; &#60;= dtPeriodEnd then&#13;&#10;          vrG42 := FORMATFLOAT('0.##',&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;)&#13;&#10;        else  vrG42 := ''&#13;&#10;      else&#13;&#10;        if &#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#60;&#62; Null then&#13;&#10;          if &#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#60;= dtPeriodEnd then&#13;&#10;            vrG42 := FORMATFLOAT('0.##',&#60;MainQuery.&#34;RELEASE_G42&#34;&#62;)&#13;&#10;          else   vrG42 := ''  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo55OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  vOutdate :=&#34;&#34;;&#13;&#10;  if (&#60;MainQuery.&#34;COUNTER&#34;&#62; &#60;&#62; Null) and (&#60;MainQuery.&#34;COUNTER&#34;&#62; &#60;&#62; 0) then&#13;&#10;    if (onCurrBook =  '1') or (IncludeAllDo2 = '0') then&#13;&#10;      if &#60;MainQuery.&#34;RELEASE_OUT_DATE&#34;&#62; &#60;&#62; Null then&#13;&#10;        vOutdate := &#60;MainQuery.&#34;RELEASE_OUT_DATE&#34;&#62;&#13;&#10;      else                      &#13;&#10;        if &#60;MainQuery.&#34;OUT_DATE&#34;&#62; &#60;&#62; Null then&#13;&#10;          vOutdate := &#60;MainQuery.&#34;OUT_DATE&#34;&#62;&#13;&#10;        else&#13;&#10;          vOutdate :=  &#60;MainQuery.&#34;RELEASE_DATE&#34;&#62;&#13;&#10;    else&#13;&#10;      if &#60;MainQuery.&#34;RELEASE_OUT_DATE&#34;&#62; &#60;&#62; Null then&#13;&#10;        if &#60;MainQuery.&#34;RELEASE_OUT_DATE&#34;&#62; &#60;= dtPeriodEnd then&#13;&#10;          vOutdate := &#60;MainQuery.&#34;RELEASE_OUT_DATE&#34;&#62;&#13;&#10;        else vOutdate :=''                              &#13;&#10;      else               &#13;&#10;        if &#60;MainQuery.&#34;OUT_DATE&#34;&#62; &#60;&#62; Null then&#13;&#10;          if &#60;MainQuery.&#34;OUT_DATE&#34;&#62; &#60;= dtPeriodEnd then&#13;&#10;            vOutdate := &#60;MainQuery.&#34;OUT_DATE&#34;&#62;&#13;&#10;          else  vOutdate :=''&#13;&#10;        else&#13;&#10;          if &#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#60;&#62; Null then&#13;&#10;            if &#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#60;= dtPeriodEnd then&#13;&#10;              vOutdate := &#60;MainQuery.&#34;RELEASE_DATE&#34;&#62;&#13;&#10;            else   vOutdate :='';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo46OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  vG35 := '';&#13;&#10;&#13;&#10;  if PrintFirstAll = True then begin&#13;&#10;&#13;&#10;    if bVolume and (&#60;MainQuery.&#34;G315C&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;G315C&#34;&#62; &#60;&#62; 0) then begin&#13;&#10;      if vG35 &#60;&#62; '' then vG35 := vG35 + CHR(13) + CHR(10);&#13;&#10;      vG35 := vG35 + FORMATFLOAT('0.######',&#60;MainQuery.&#34;G315C&#34;&#62;) + ' КУБ.М.';&#13;&#10;    end;&#13;&#10;&#13;&#10;    if bUnits  and (&#60;MainQuery.&#34;G315A&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;G315A&#34;&#62; &#60;&#62; 0)  and (&#60;MainQuery.&#34;G41A&#34;&#62; &#60;&#62; Null) then begin&#13;&#10;      if vG35 &#60;&#62; '' then vG35 := vG35 + CHR(13) + CHR(10);&#13;&#10;      vG35 := vG35 + FORMATFLOAT('0.######',&#60;MainQuery.&#34;G315A&#34;&#62;) + ' ' + COMPUTE('REFERENCE (&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + &#60;MainQuery.&#34;G41A&#34;&#62; + '&#34;, &#34;UNITNAME&#34;)');&#13;&#10;    end;&#13;&#10;&#13;&#10;    if bBrutto  and (&#60;MainQuery.&#34;G35&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;G35&#34;&#62; &#60;&#62; 0) then begin&#13;&#10;      if vG35 &#60;&#62; '' then vG35 := vG35 + CHR(13) + CHR(10);&#13;&#10;      vG35 := vG35 + FORMATFLOAT('0.######',&#60;MainQuery.&#34;G35&#34;&#62;) + ' КГ';&#13;&#10;      //ShowMessage(vG35);&#13;&#10;    end;&#13;&#10;&#13;&#10;    // если ничего не отмечено&#13;&#10;    If (not bVolume) and (not bUnits) and (not bBrutto) then begin&#13;&#10;      if AistCompatible = 0 then begin&#13;&#10;&#13;&#10;        if vType = 1 then //Сначала смотрим заполнен ли объем&#13;&#10;          vG35 := FORMATFLOAT('0.######', &#60;MainQuery.&#34;G315C&#34;&#62;) + ' КУБ.М.'&#13;&#10;        else if vType = 2  then //Затем смотрим заполнены ли доп.ед. измерения&#13;&#10;          vG35 := FORMATFLOAT('0.######', &#60;MainQuery.&#34;G315A&#34;&#62;) + ' ' + COMPUTE('REFERENCE (&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + &#60;MainQuery.&#34;G41A&#34;&#62; + '&#34;, &#34;UNITNAME&#34;)')&#13;&#10;        else if vType = 3 then&#13;&#10;          vG35 := FORMATFLOAT('0.######', &#60;MainQuery.&#34;G35&#34;&#62;) + ' КГ'&#13;&#10;        else&#13;&#10;          vG35 := VARtoSTR(0);&#13;&#10;&#13;&#10;      end&#13;&#10;      else begin&#13;&#10;&#13;&#10;        //Сначала смотрим заполнен ли объем&#13;&#10;        if &#60;MainQuery.&#34;G35&#34;&#62; &#60;&#62; Null then&#13;&#10;          vG35 := FORMATFLOAT('0.######', &#60;MainQuery.&#34;G35&#34;&#62;) + ' КГ'&#13;&#10;        else&#13;&#10;          vG35 := VarToStr(0);&#13;&#10;&#13;&#10;      end;&#13;&#10;&#13;&#10;    end;&#13;&#10;&#13;&#10;&#13;&#10;    //Далее смотрим складские документы&#13;&#10;    if vUseStoreDocs then&#13;&#10;      if COMPUTE('FINDKEY(&#34;IN_COMM_2&#34;, [' + VarToStr(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + ', ' +&#13;&#10;                                                                 VarToStr(&#60;MainQuery.&#34;ID&#34;&#62;) + ', ' +&#13;&#10;                                                                 VarToStr(&#60;MainQuery.&#34;G32&#34;&#62;) + '])') then begin&#13;&#10;&#13;&#10;        vG35 := '';&#13;&#10;&#13;&#10;        if bVolume and (&#60;IN_COMM_2.&#34;G315C&#34;&#62; &#60;&#62; Null) AND (&#60;IN_COMM_2.&#34;G315C&#34;&#62; &#60;&#62; 0) then begin&#13;&#10;          if vG35 &#60;&#62; '' then vG35 := vG35 + CHR(13) + CHR(10);&#13;&#10;          vG35 := vG35 + FORMATFLOAT('0.######',&#60;IN_COMM_2.&#34;G315C&#34;&#62;) + ' КУБ.М.';&#13;&#10;        end;&#13;&#10;&#13;&#10;        if bUnits  and (&#60;IN_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; Null) AND (&#60;IN_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0)  and (&#60;MainQuery.&#34;G41A&#34;&#62; &#60;&#62; Null) then begin&#13;&#10;          if vG35 &#60;&#62; '' then vG35 := vG35 + CHR(13) + CHR(10);&#13;&#10;          vG35 := vG35 + FORMATFLOAT('0.######',&#60;IN_COMM_2.&#34;G315A&#34;&#62;) + ' ' + COMPUTE('REFERENCE (&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + &#60;MainQuery.&#34;G41A&#34;&#62; + '&#34;, &#34;UNITNAME&#34;)');&#13;&#10;        end;&#13;&#10;&#13;&#10;        if bBrutto  and (&#60;IN_COMM_2.&#34;G35&#34;&#62; &#60;&#62; Null) AND (&#60;IN_COMM_2.&#34;G35&#34;&#62; &#60;&#62; 0) then begin&#13;&#10;          if vG35 &#60;&#62; '' then vG35 := vG35 + CHR(13) + CHR(10);&#13;&#10;          vG35 := vG35 + FORMATFLOAT('0.######',&#60;IN_COMM_2.&#34;G35&#34;&#62;) + ' КГ';&#13;&#10;          //ShowMessage(vG35);&#13;&#10;        end;&#13;&#10;&#13;&#10;        // если ничего не отмечено&#13;&#10;        If (not bVolume) and (not bUnits) and (not bBrutto) then begin&#13;&#10;          if AistCompatible = 0 then begin&#13;&#10;&#13;&#10;            if vType = 1 then //Сначала смотрим заполнен ли объем&#13;&#10;              vG35 := FORMATFLOAT('0.######',&#60;IN_COMM_2.&#34;G315C&#34;&#62;) + ' КУБ.М.'&#13;&#10;            else if vType = 2 then //Затем смотрим заполнены ли доп.ед. измерения&#13;&#10;              vG35 := FORMATFLOAT('0.######',&#60;IN_COMM_2.&#34;G315A&#34;&#62;) + ' ' + COMPUTE('REFERENCE (&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + &#60;MainQuery.&#34;G41A&#34;&#62; + '&#34;, &#34;UNITNAME&#34;)')&#13;&#10;            else if vType = 3 then&#13;&#10;              vG35 := FORMATFLOAT('0.######',&#60;IN_COMM_2.&#34;G35&#34;&#62;) + ' КГ'&#13;&#10;            else&#13;&#10;              vG35 := VARtoSTR(0);&#13;&#10;&#13;&#10;          end&#13;&#10;          else begin&#13;&#10;&#13;&#10;            //Сначала смотрим заполнен ли объем&#13;&#10;            if &#60;IN_COMM_2.&#34;G35&#34;&#62; &#60;&#62; Null then&#13;&#10;              vG35 := FORMATFLOAT('0.######',&#60;IN_COMM_2.&#34;G35&#34;&#62;) + ' КГ'&#13;&#10;            else&#13;&#10;              vG35 := VARtoSTR(0);&#13;&#10;&#13;&#10;          end;&#13;&#10;        end;&#13;&#10;&#13;&#10;      end;&#13;&#10;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo54OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  &#13;&#10;sValBukCode := '';  &#13;&#10;if PrintFirstAll = True and (nG42 &#60;&#62; '') then&#13;&#10;   if &#60;MainQuery.&#34;VALCODE&#34;&#62; &#60;&#62; Null then&#13;&#10;     begin&#13;&#10;       sValBukcode := &#60;MainQuery.&#34;VALCODE&#34;&#62;;&#13;&#10;     end&#13;&#10;   else&#13;&#10;     if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;       begin&#13;&#10;         sValBukcode := COMPUTE('CurrencyAbbr(&#34;'+VarToStr(&#60;MAINQUERY.&#34;G42_CURRENCY&#34;&#62;)+'&#34;)');&#13;&#10;       end&#13;&#10;   else&#13;&#10;        begin&#13;&#10;         sValBukcode := COMPUTE('CurrencyAbbr(&#34;'+VarToStr(&#60;MAINQUERY.&#34;G221&#34;&#62;)+'&#34;)');&#13;&#10;       end    &#13;&#10;end  ;&#13;&#10;&#13;&#10;procedure StandartRelease(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  if bVolume and (&#60;MainQuery.&#34;Release_G315C&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;Release_G315C&#34;&#62; &#60;&#62; 0) then begin&#13;&#10;    if vrG35 &#60;&#62; '' then vrG35 := vrG35 + CHR(13) + CHR(10);&#13;&#10;     vrG35 := vrG35 + FORMATFLOAT('0.######',&#60;MainQuery.&#34;Release_G315C&#34;&#62;) + ' КУБ.М.'&#13;&#10;  end;&#13;&#10;&#13;&#10;  if bUnits  and (&#60;MainQuery.&#34;Release_G315A&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;Release_G315A&#34;&#62; &#60;&#62; 0)  and (&#60;MainQuery.&#34;G41A&#34;&#62; &#60;&#62; Null) then begin&#13;&#10;    if vrG35 &#60;&#62; '' then vrG35 := vrG35 + CHR(13) + CHR(10);&#13;&#10;    vrG35 := vrG35 + FORMATFLOAT('0.######',&#60;MainQuery.&#34;Release_G315A&#34;&#62;) + ' ' + COMPUTE('REFERENCE (&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + &#60;MainQuery.&#34;G41A&#34;&#62; + '&#34;, &#34;UNITNAME&#34;)');&#13;&#10;  end;&#13;&#10;&#13;&#10;  if bBrutto  and (&#60;MainQuery.&#34;Release_G35&#34;&#62; &#60;&#62; Null) AND (&#60;MainQuery.&#34;Release_G35&#34;&#62; &#60;&#62; 0) then begin&#13;&#10;    if vrG35 &#60;&#62; '' then vrG35 := vrG35 + CHR(13) + CHR(10);&#13;&#10;    vrG35 := vrG35 + FORMATFLOAT('0.######',&#60;MainQuery.&#34;Release_G35&#34;&#62;) + ' КГ';&#13;&#10;  end;&#13;&#10;&#13;&#10;  // если ничего не отмечено&#13;&#10;  If (not bVolume) and (not bUnits) and (not bBrutto) then begin&#13;&#10;    if AistCompatible = 0 then begin&#13;&#10;      if vType = 1 then       //Сначала смотрим заполнен ли объем&#13;&#10;        vrG35 := FORMATFLOAT('0.######',&#60;MainQuery.&#34;Release_G315C&#34;&#62;) + ' КУБ.М.'&#13;&#10;      else if vType = 2 then         //Затем смотрим заполнены ли доп.ед. измерения&#13;&#10;        vrG35 := FORMATFLOAT('0.######',&#60;MainQuery.&#34;Release_G315A&#34;&#62;) + ' ' + COMPUTE('REFERENCE (&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + &#60;MainQuery.&#34;G41A&#34;&#62; + '&#34;, &#34;UNITNAME&#34;)')&#13;&#10;      else if vType = 3 then&#13;&#10;        vrG35 := FORMATFLOAT('0.######',&#60;MainQuery.&#34;Release_G35&#34;&#62;) + ' КГ'&#13;&#10;    end&#13;&#10;    else if &#60;MainQuery.&#34;Release_G35&#34;&#62; &#60;&#62; Null then //Сначала смотрим заполнен ли объем&#13;&#10;      vrG35 := FORMATFLOAT('0.######',&#60;MainQuery.&#34;Release_G35&#34;&#62;) + ' КГ'&#13;&#10;  end;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure Memo19OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  vrG35 := '';&#13;&#10;  if (&#60;MainQuery.&#34;COUNTER&#34;&#62; &#60;&#62; Null) and (&#60;MainQuery.&#34;COUNTER&#34;&#62; &#60;&#62; 0) then begin&#13;&#10;    if (onCurrBook =  '1') or (IncludeAllDo2 = '0') then&#13;&#10;      StandartRelease(Memo19)&#13;&#10;    else if (&#60;MainQuery.&#34;OUT_DATE&#34;&#62; &#60;&#62; Null) then begin&#13;&#10;      if  (&#60;MainQuery.&#34;OUT_DATE&#34;&#62; &#60;= dtPeriodEnd) then&#13;&#10;        StandartRelease(Memo19)&#13;&#10;      else&#13;&#10;        vrG35 := '';&#13;&#10;    end&#13;&#10;    else if (&#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#60;&#62; Null) then begin&#13;&#10;      if (&#60;MainQuery.&#34;RELEASE_DATE&#34;&#62; &#60;= dtPeriodEnd) then&#13;&#10;        StandartRelease(Memo19)&#13;&#10;      else&#13;&#10;        vrG35 := '';&#13;&#10;    end&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo10OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  nG32:='';&#13;&#10;&#13;&#10;  if PrintFirstAll = True then begin&#13;&#10;&#13;&#10;    if Trim(&#60;MainQuery.&#34;GN&#34;&#62;) &#60;&#62; '' then&#13;&#10;      nG32:=&#60;MainQuery.&#34;GN&#34;&#62;&#13;&#10;    else&#13;&#10;      nG32:=&#60;MainQuery.&#34;G32&#34;&#62;;&#13;&#10;&#13;&#10;  end;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo38OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  vG082 := '';                                   &#13;&#10;  if cbxG082.Checked = True then                                                                              &#13;&#10;      begin&#13;&#10;        if (&#60;MainQuery.&#34;G082&#34;&#62; &#60;&#62; Null) and (&#60;MainQuery.&#34;G082&#34;&#62; &#60;&#62; '') then&#13;&#10;          vG082 :=  &#60;MainQuery.&#34;G082&#34;&#62;&#13;&#10;        else&#13;&#10;          vG082 :=  &#60;MainQuery.&#34;G082_1&#34;&#62;;                                                       &#13;&#10;      end&#13;&#10;  else&#13;&#10;    if PrintFirstAll = True then                           &#13;&#10;      vG082 :=  &#60;MainQuery.&#34;G082_1&#34;&#62;;&#13;&#10;                      &#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo73OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  vBegKeep2 := '';&#13;&#10;  vBegKeep1 := '';&#13;&#10;    &#13;&#10;  if PrintFirstAll = False then&#13;&#10;    if cbxG082.Checked = False then                                                                          &#13;&#10;      vBegKeep1 := ''&#13;&#10;    else&#13;&#10;      begin&#13;&#10;        if (&#60;MainQuery.&#34;STORAGE_DATE&#34;&#62; &#60;&#62; 0) and (&#60;MainQuery.&#34;STORAGE_DATE&#34;&#62; &#60;&#62; Null) then&#13;&#10;           vBegKeep1 := FORMATDATETIME('DD.MM.YYYY',&#60;MainQuery.&#34;STORAGE_DATE&#34;&#62;);           &#13;&#10;        if (&#60;MainQuery.&#34;STORAGE_DATE&#34;&#62; = 0)  or (&#60;MainQuery.&#34;STORAGE_DATE&#34;&#62; = Null) then&#13;&#10;          if  (&#60;MainQuery.&#34;ACCEPTDATE&#34;&#62; = 0)   or (&#60;MainQuery.&#34;ACCEPTDATE&#34;&#62; = Null) then&#13;&#10;            if  (&#60;MainQuery.&#34;BEG_KEEP&#34;&#62; = 0)   or (&#60;MainQuery.&#34;BEG_KEEP&#34;&#62; = Null) then&#13;&#10;              vBegKeep2 := FORMATDATETIME(&#34;DD.MM.YYYY&#34;, &#60;MainQuery.&#34;BD_DATE&#34;&#62;+60)&#13;&#10;            else    &#13;&#10;              vBegKeep2 := FORMATDATETIME(&#34;DD.MM.YYYY&#34;, &#60;MainQuery.&#34;BEG_KEEP&#34;&#62;+60)&#13;&#10;          else &#13;&#10;            vBegKeep2 := FORMATDATETIME(&#34;DD.MM.YYYY&#34;, &#60;MainQuery.&#34;ACCEPTDATE&#34;&#62;+60)&#13;&#10;        else&#13;&#10;          vBegKeep2 := FORMATDATETIME('DD.MM.YYYY',&#60;MainQuery.&#34;STORAGE_DATE&#34;&#62;);      &#13;&#10;            &#13;&#10;            COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;            COMPUTE('SETRANGE(&#34;KRD_COMM_PAPERS_2&#34;, [&#34;' + VARTOSTR(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;ID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;G32&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#34;13&#34;) + '&#34;])');        &#13;&#10;            if StrToInt(COMPUTE('RECORDCOUNT(&#34;KRD_COMM_PAPERS_2&#34;)')) &#62; 0 then &#13;&#10;              begin&#13;&#10;                COMPUTE('FIRST(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;                While StrToInt(COMPUTE('EOF(&#34;KRD_COMM_PAPERS_2&#34;)')) = 0 do &#13;&#10;                  begin&#13;&#10;                    COMPUTE('SETRANGE(&#34;KRD_PAPERS_2&#34;, [&#34;' + IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' +&#13;&#10;                                                            IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' +&#13;&#10;                                                            IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;DOC_COUNTER&#34;&#62;) + '&#34;])');&#13;&#10;               &#13;&#10;                    If  &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; = 'ЗПСХ' then&#13;&#10;                      begin                  &#13;&#10;                        if  &#60;KRD_PAPERS_2.&#34;PAPERDEND&#34;&#62; &#60;&#62; Null then&#13;&#10;                          vBegKeep1 := VarToStr(&#60;KRD_PAPERS_2.&#34;PAPERDEND&#34;&#62;) + CHR(13) + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + ' №' +&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62; + ' от ' +VarToStr(&#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)&#13;&#10;                        else&#13;&#10;                          vBegKeep1 := &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + ' №' +&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62; + ' от ' +VarToStr(&#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)&#13;&#10;                      end;  &#13;&#10;                    COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');      &#13;&#10;                    COMPUTE('NEXT(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;                  end;&#13;&#10;              end;&#13;&#10;            COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');      &#13;&#10;&#13;&#10;            COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;            COMPUTE('SETRANGE(&#34;KRD_COMM_PAPERS_2&#34;, [&#34;' + VARTOSTR(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;ID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;G32&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#34;35&#34;) + '&#34;])');        &#13;&#10;            if StrToInt(COMPUTE('RECORDCOUNT(&#34;KRD_COMM_PAPERS_2&#34;)')) &#62; 0 then &#13;&#10;              begin&#13;&#10;                COMPUTE('FIRST(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;                While StrToInt(COMPUTE('EOF(&#34;KRD_COMM_PAPERS_2&#34;)')) = 0 do &#13;&#10;                  begin&#13;&#10;                    COMPUTE('SETRANGE(&#34;KRD_PROL_2&#34;, [&#34;' + IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' +&#13;&#10;                                                            IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' +&#13;&#10;                                                            IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;DOC_COUNTER&#34;&#62;) + '&#34;])');&#13;&#10;               &#13;&#10;                    If  &#60;KRD_PROL_2.&#34;DOC_TYPE&#34;&#62; = 'ЗПСХ' then&#13;&#10;                      begin&#13;&#10;                        if  &#60;KRD_PROL_2.&#34;STORAGE_DATE&#34;&#62; &#60;&#62; Null then                          &#13;&#10;                          vBegKeep1 := FormatDateTime('DD.MM.YYYY', &#60;KRD_PROL_2.&#34;STORAGE_DATE&#34;&#62;) + CHR(13) + &#60;KRD_PROL_2.&#34;DOC_TYPE&#34;&#62; + ' №' +&#60;KRD_PROL_2.&#34;DOC_NO&#34;&#62; + ' от ' +FormatDateTime('DD.MM.YYYY', &#60;KRD_PROL_2.&#34;DOC_DATE&#34;&#62;)&#13;&#10;                        else&#13;&#10;                          vBegKeep1 := &#60;KRD_PROL_2.&#34;DOC_TYPE&#34;&#62; + ' №' + &#60;KRD_PROL_2.&#34;DOC_NO&#34;&#62; + ' от ' +FormatDateTime('DD.MM.YYYY', &#60;KRD_PROL_2.&#34;DOC_DATE&#34;&#62;)                                                       &#13;&#10;                      end;  &#13;&#10;                    COMPUTE('CANCELRANGE(&#34;KRD_PROL_2&#34;)');      &#13;&#10;                    COMPUTE('NEXT(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;                  end;&#13;&#10;              end;&#13;&#10;            COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');      &#13;&#10;      &#13;&#10;        If vBegKeep1 = '' then&#13;&#10;          vBegKeep1 := vBegKeep2;                &#13;&#10;           &#13;&#10;        COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');&#13;&#10;        COMPUTE('SETRANGE(&#34;KRD_COMM_2&#34;, [&#34;' + VARTOSTR(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;ID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;G32&#34;&#62;) + '&#34;])');&#13;&#10;    &#13;&#10;        if bStorageDateNoPrint AND (VarToStr(&#60;KRD_COMM_2.&#34;STORAGE_TYPE&#34;&#62;) &#60;&#62; 'ЖИВ') then // Галка включена и не скоропорт - не печатаем                                                                                               &#13;&#10;          vBegKeep1 := '';  &#13;&#10;        COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');  &#13;&#10;      end              &#13;&#10;  else&#13;&#10;    begin&#13;&#10;      if (&#60;MainQuery.&#34;STORAGE_DATE&#34;&#62; &#60;&#62; 0) and (&#60;MainQuery.&#34;STORAGE_DATE&#34;&#62; &#60;&#62; Null) then&#13;&#10;         vBegKeep1 := FORMATDATETIME('DD.MM.YYYY',&#60;MainQuery.&#34;STORAGE_DATE&#34;&#62;);           &#13;&#10;      if (&#60;MainQuery.&#34;STORAGE_DATE&#34;&#62; = 0)  or (&#60;MainQuery.&#34;STORAGE_DATE&#34;&#62; = Null) then&#13;&#10;        if  (&#60;MainQuery.&#34;ACCEPTDATE&#34;&#62; = 0)   or (&#60;MainQuery.&#34;ACCEPTDATE&#34;&#62; = Null) then&#13;&#10;          if  (&#60;MainQuery.&#34;BEG_KEEP&#34;&#62; = 0)   or (&#60;MainQuery.&#34;BEG_KEEP&#34;&#62; = Null) then&#13;&#10;            vBegKeep2 := FORMATDATETIME(&#34;DD.MM.YYYY&#34;, &#60;MainQuery.&#34;BD_DATE&#34;&#62;+60)&#13;&#10;          else    &#13;&#10;            vBegKeep2 := FORMATDATETIME(&#34;DD.MM.YYYY&#34;, &#60;MainQuery.&#34;BEG_KEEP&#34;&#62;+60)&#13;&#10;        else &#13;&#10;          vBegKeep2 := FORMATDATETIME(&#34;DD.MM.YYYY&#34;, &#60;MainQuery.&#34;ACCEPTDATE&#34;&#62;+60)&#13;&#10;      else&#13;&#10;        vBegKeep2 := FORMATDATETIME('DD.MM.YYYY',&#60;MainQuery.&#34;STORAGE_DATE&#34;&#62;);      &#13;&#10;              &#13;&#10;          COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');                                             &#13;&#10;          COMPUTE('SETRANGE(&#34;KRD_COMM_PAPERS_2&#34;, [&#34;' + VARTOSTR(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;ID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;G32&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#34;13&#34;) + '&#34;])');        &#13;&#10;          if StrToInt(COMPUTE('RECORDCOUNT(&#34;KRD_COMM_PAPERS_2&#34;)')) &#62; 0 then &#13;&#10;            begin&#13;&#10;              COMPUTE('FIRST(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;              While StrToInt(COMPUTE('EOF(&#34;KRD_COMM_PAPERS_2&#34;)')) = 0 do &#13;&#10;                begin&#13;&#10;                  COMPUTE('SETRANGE(&#34;KRD_PAPERS_2&#34;, [&#34;' + IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' +&#13;&#10;                                                          IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' +&#13;&#10;                                                          IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;DOC_COUNTER&#34;&#62;) + '&#34;])');&#13;&#10;&#13;&#10;                  If  &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; = 'ЗПСХ' then&#13;&#10;                    begin                  &#13;&#10;                      if  &#60;KRD_PAPERS_2.&#34;PAPERDEND&#34;&#62; &#60;&#62; Null then&#13;&#10;                        vBegKeep1 := VarToStr(&#60;KRD_PAPERS_2.&#34;PAPERDEND&#34;&#62;) + CHR(13) + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + ' №' +&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62; + ' от ' +VarToStr(&#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)&#13;&#10;                      else&#13;&#10;                        vBegKeep1 := &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + ' №' +&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62; + ' от ' +VarToStr(&#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)&#13;&#10;                    end;  &#13;&#10;                  COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');      &#13;&#10;                  COMPUTE('NEXT(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;                end;&#13;&#10;            end;&#13;&#10;          COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;&#13;&#10;            COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;            COMPUTE('SETRANGE(&#34;KRD_COMM_PAPERS_2&#34;, [&#34;' + VARTOSTR(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;ID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;G32&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#34;35&#34;) + '&#34;])');        &#13;&#10;            if StrToInt(COMPUTE('RECORDCOUNT(&#34;KRD_COMM_PAPERS_2&#34;)')) &#62; 0 then &#13;&#10;              begin&#13;&#10;                COMPUTE('FIRST(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;                While StrToInt(COMPUTE('EOF(&#34;KRD_COMM_PAPERS_2&#34;)')) = 0 do &#13;&#10;                  begin&#13;&#10;                    COMPUTE('SETRANGE(&#34;KRD_PROL_2&#34;, [&#34;' + IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' +&#13;&#10;                                                            IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' +&#13;&#10;                                                            IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;DOC_COUNTER&#34;&#62;) + '&#34;])');&#13;&#10;               &#13;&#10;                    If  &#60;KRD_PROL_2.&#34;DOC_TYPE&#34;&#62; = 'ЗПСХ' then&#13;&#10;                      begin&#13;&#10;                        if  &#60;KRD_PROL_2.&#34;STORAGE_DATE&#34;&#62; &#60;&#62; Null then                          &#13;&#10;                          vBegKeep1 := FormatDateTime('DD.MM.YYYY', &#60;KRD_PROL_2.&#34;STORAGE_DATE&#34;&#62;) + CHR(13) + &#60;KRD_PROL_2.&#34;DOC_TYPE&#34;&#62; + ' №' +&#60;KRD_PROL_2.&#34;DOC_NO&#34;&#62; + ' от ' +FormatDateTime('DD.MM.YYYY', &#60;KRD_PROL_2.&#34;DOC_DATE&#34;&#62;)&#13;&#10;                        else&#13;&#10;                          vBegKeep1 := &#60;KRD_PROL_2.&#34;DOC_TYPE&#34;&#62; + ' №' +&#60;KRD_PROL_2.&#34;DOC_NO&#34;&#62; + ' от ' +FormatDateTime('DD.MM.YYYY', &#60;KRD_PROL_2.&#34;DOC_DATE&#34;&#62;)                                                       &#13;&#10;                      end;  &#13;&#10;                    COMPUTE('CANCELRANGE(&#34;KRD_PROL_2&#34;)');      &#13;&#10;                    COMPUTE('NEXT(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;                  end;&#13;&#10;              end;&#13;&#10;            COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');    &#13;&#10;    &#13;&#10;      &#13;&#10;      If vBegKeep1 = '' then&#13;&#10;        vBegKeep1 := vBegKeep2;                &#13;&#10;&#13;&#10;      COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');&#13;&#10;      COMPUTE('SETRANGE(&#34;KRD_COMM_2&#34;, [&#34;' + VARTOSTR(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;ID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;G32&#34;&#62;) + '&#34;])');&#13;&#10;    &#13;&#10;      if bStorageDateNoPrint AND (VarToStr(&#60;KRD_COMM_2.&#34;STORAGE_TYPE&#34;&#62;) &#60;&#62; 'ЖИВ') then // Галка включена и не скоропорт - не печатаем                                                                                               &#13;&#10;        vBegKeep1 := '';  &#13;&#10;      COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');            &#13;&#10;    end&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure Page2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;            &#13;&#10; If vExport then MasterData2.AllowSplit := False&#13;&#10; else MasterData2.AllowSplit := bAllowSplit;      &#13;&#10;    &#13;&#10; sTypeSVH := '';&#13;&#10; sNameSVH := '';&#13;&#10; sTypeDoc := '';&#13;&#10; sDateDoc := '';&#13;&#10; sNumDoc  := '';&#13;&#10;      &#13;&#10; If bSTORexists then begin&#13;&#10;   COMPUTE('FIRST(&#34;Stor&#34;)');&#13;&#10;   vPlaceId := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;PLACEID&#34;)');&#13;&#10; end;&#13;&#10; COMPUTE('SETRANGE(&#34;STORES_2&#34;, [&#34;' + vPlaceId + '&#34;])');&#13;&#10;&#13;&#10;&#13;&#10;    case &#60;STORES_2.&#34;STORE_TYPE&#34;&#62; of&#13;&#10;      '', 'СВХ', Null: begin&#13;&#10;       sTypeSVH := 'СВХ';&#13;&#10;       sNameSVH := lblStoreName.Text;&#13;&#10;       sTypeDoc := 'Свидетельство о включении в реестр владельцев СВХ от';&#13;&#10;       sDateDoc := FormatDateTime('dd.mm.yyyy',fldStoreLicDate.Date);&#13;&#10;       sNumDoc := fldStoreLicNum.Text ;          &#13;&#10;      end;&#13;&#10;      'СП': begin&#13;&#10;       sTypeSVH := 'Склад получателя товаров';&#13;&#10;       sNameSVH := lblStoreName.Text;&#13;&#10;       sTypeDoc := 'Разрешение на временное хранение на складе получателя товаров от';&#13;&#10;       sDateDoc := FormatDateTime('dd.mm.yyyy',fldStoreLicDate.Date);&#13;&#10;       sNumDoc := fldStoreLicNum.Text ;        &#13;&#10;      end;                  &#13;&#10;      'ПЗТК': begin&#13;&#10;       sTypeSVH := 'ПЗТК';&#13;&#10;       sNameSVH := lblStoreName.Text;&#13;&#10;       sTypeDoc := 'Приказ(разрешение) таможни от';&#13;&#10;       sDateDoc := FormatDateTime('dd.mm.yyyy',fldStoreLicDate.Date);&#13;&#10;       sNumDoc := fldStoreLicNum.Text ;        &#13;&#10;      end;&#13;&#10;      'ВЗТК': begin&#13;&#10;       sTypeSVH := 'ВЗТК';&#13;&#10;       sNameSVH := lblStoreName.Text;&#13;&#10;       sTypeDoc := 'Приказ(разрешение) таможни от';&#13;&#10;       sDateDoc := FormatDateTime('dd.mm.yyyy',fldStoreLicDate.Date);&#13;&#10;       sNumDoc := fldStoreLicNum.Text ;        &#13;&#10;      end;          &#13;&#10;      'ЗТК': begin&#13;&#10;       sTypeSVH := 'ЗТК';&#13;&#10;       sNameSVH := lblStoreName.Text;&#13;&#10;       sTypeDoc := 'Приказ(разрешение) таможни от';&#13;&#10;       sDateDoc := FormatDateTime('dd.mm.yyyy',fldStoreLicDate.Date);&#13;&#10;       sNumDoc := fldStoreLicNum.Text ;        &#13;&#10;      end;                  &#13;&#10;      else begin&#13;&#10;       sTypeSVH := &#60;STORES_2.&#34;STORE_TYPE&#34;&#62;;&#13;&#10;       sNameSVH := lblStoreName.Text;&#13;&#10;       sTypeDoc := 'Свидетельство о включении в реестр владельцев СВХ от';&#13;&#10;       sDateDoc := FormatDateTime('dd.mm.yyyy',fldStoreLicDate.Date);&#13;&#10;       sNumDoc := fldStoreLicNum.Text ;        &#13;&#10;      end;  &#13;&#10;    end;                &#13;&#10;        &#13;&#10;  // переопределяем значение переменных sTypeSVH, sTypeDoc если в поле STORES.LICENCETYPE что-то есть&#13;&#10;  if Length(Trim(&#60;STORES_2.&#34;LICENCETYPE&#34;&#62;)) &#62; 0 then&#13;&#10;    begin&#13;&#10;       case &#60;STORES_2.&#34;LICENCETYPE&#34;&#62; of&#13;&#10;         1: begin&#13;&#10;               sTypeSVH := 'СВХ';                                       &#13;&#10;               sTypeDoc := 'Свидетельство о включении в реестр владельцев СВХ от';&#13;&#10;            end;                                    &#13;&#10;         2: begin&#13;&#10;               sTypeSVH := 'СВХ';                                       &#13;&#10;               sTypeDoc := 'Свидетельство о включении в реестр владельцев СВХ от';&#13;&#10;            end;                         &#13;&#10;         3: begin&#13;&#10;               sTypeSVH := 'Иное место временного хранения';                                       &#13;&#10;               sTypeDoc := 'Разрешение ТО на временное хранение в ином месте от';&#13;&#10;            end;                         &#13;&#10;         4: begin&#13;&#10;               sTypeSVH := 'ПЗТК';                                       &#13;&#10;               sTypeDoc := 'Приказ(разрешение) таможни от';&#13;&#10;            end;                         &#13;&#10;         5: begin&#13;&#10;               sTypeSVH := 'ВЗТК';                                       &#13;&#10;               sTypeDoc := 'Приказ(разрешение) таможни от';&#13;&#10;            end;                         &#13;&#10;       end;                            &#13;&#10;    end;	&#13;&#10;      &#13;&#10; COMPUTE('CANCELRANGE(&#34;STORES_2&#34;)');&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure Footer1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If vprintItog then begin&#13;&#10;    Footer1.Visible := True;&#13;&#10;    sInG35 := '';&#13;&#10;    sOutG35 := '';&#13;&#10;    if bVolume then begin&#13;&#10;      if sInG35 &#60;&#62; '' then sInG35 := sInG35 + CHR(13) + CHR(10);&#13;&#10;      if sOutG35 &#60;&#62; '' then sOutG35 := sOutG35 + CHR(13) + CHR(10);&#13;&#10;      sInG35 := sInG35 + FORMATFLOAT('0.######',sInG35_v);&#13;&#10;      sOutG35 := sOutG35 + FORMATFLOAT('0.######',sOutG35_v);&#13;&#10;    end;&#13;&#10;    if bUnits then begin&#13;&#10;      if sInG35 &#60;&#62; '' then sInG35 := sInG35 + CHR(13) + CHR(10);&#13;&#10;      if sOutG35 &#60;&#62; '' then sOutG35 := sOutG35 + CHR(13) + CHR(10);&#13;&#10;      sInG35 := sInG35 + FORMATFLOAT('0.######',sInG35_u);&#13;&#10;      sOutG35 := sOutG35 + FORMATFLOAT('0.######',sOutG35_u);&#13;&#10;    end;&#13;&#10;    if bBrutto then begin&#13;&#10;      if sInG35 &#60;&#62; '' then sInG35 := sInG35 + CHR(13) + CHR(10);&#13;&#10;      if sOutG35 &#60;&#62; '' then sOutG35 := sOutG35 + CHR(13) + CHR(10);&#13;&#10;      sInG35 := sInG35 + FORMATFLOAT('0.######',sInG35_b);&#13;&#10;      sOutG35 := sOutG35 + FORMATFLOAT('0.######',sOutG35_b);&#13;&#10;    end;&#13;&#10;    If (not bVolume) and (not bUnits) and (not bBrutto) then begin&#13;&#10;      if sInG35 &#60;&#62; '' then sInG35 := sInG35 + CHR(13) + CHR(10);&#13;&#10;      if sOutG35 &#60;&#62; '' then sOutG35 := sOutG35 + CHR(13) + CHR(10);&#13;&#10;      sInG35 := sInG35 + FORMATFLOAT('0.######',sInG35_b);&#13;&#10;      sOutG35 := sOutG35 + FORMATFLOAT('0.######',sOutG35_b);&#13;&#10;    end;&#13;&#10;  end&#13;&#10;  else Footer1.Visible := False;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure chkItogOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If chkItog.Checked then&#13;&#10;  begin&#13;&#10;    chkG35.Enabled := True;&#13;&#10;    ChkG42.Enabled := True;&#13;&#10;    If chkG42.Checked then&#13;&#10;    begin&#13;&#10;      chkUSDG42.Enabled := True;&#13;&#10;      chkEurG42.Enabled := True;&#13;&#10;      chkRubG42.Enabled := True;&#13;&#10;      chkClearG42.Enabled := True;&#13;&#10;    end&#13;&#10;    else&#13;&#10;    begin&#13;&#10;      chkUSDG42.Enabled := False;&#13;&#10;      chkEurG42.Enabled := False;&#13;&#10;      chkRubG42.Enabled := False;&#13;&#10;      chkClearG42.Enabled := False;&#13;&#10;    end&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    chkG35.Enabled := False;&#13;&#10;    ChkG42.Enabled := False;&#13;&#10;    chkUSDG42.Enabled := False;&#13;&#10;    chkEurG42.Enabled := False;&#13;&#10;    chkRubG42.Enabled := False;&#13;&#10;    chkClearG42.Enabled := False;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure chkG42OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If chkG42.Checked then&#13;&#10;    begin&#13;&#10;      chkUSDG42.Enabled := True;&#13;&#10;      chkEurG42.Enabled := True;&#13;&#10;      chkRubG42.Enabled := True;&#13;&#10;      chkClearG42.Enabled := True;&#13;&#10;    end&#13;&#10;    else&#13;&#10;    begin&#13;&#10;      chkUSDG42.Enabled := False;&#13;&#10;      chkEurG42.Enabled := False;&#13;&#10;      chkRubG42.Enabled := False;&#13;&#10;      chkClearG42.Enabled := False;&#13;&#10;    end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure PageHeader1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;     if vExport then&#13;&#10;     if &#60;PAGE#&#62; = 1 then&#13;&#10;       begin&#13;&#10;         memo31.visible := False;&#13;&#10;         memo52.visible := False;&#13;&#10;         memo59.visible := False;&#13;&#10;         memo60.visible := False;&#13;&#10;         memo61.visible := False;&#13;&#10;         memo63.visible := False;&#13;&#10;         memo84.visible := False;             &#13;&#10;         memo102.visible := False;&#13;&#10;         Shape1.visible := False;&#13;&#10;&#13;&#10;         memo1.visible := False;&#13;&#10;         memo17.visible := False;&#13;&#10;         memo9.visible := False;&#13;&#10;         PageHeader1.Visible := True&#13;&#10;       end&#13;&#10;     else PageHeader1.Visible := False&#13;&#10;end;&#13;&#10;&#13;&#10;procedure btnDO3DBOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('globalvar (&#34;sDir&#34;,String)');&#13;&#10;  IF COMPUTE('SelectDirectory(&#34;sDir&#34;)') &#60;&#62; '0' then&#13;&#10;    begin&#13;&#10;      sDirDO3DB := COMPUTE('INCLUDETRAILINGBACKSLASH(sDir)');&#13;&#10;      edtDO3DB.Text := sDirDO3DB;&#13;&#10;    end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('OPENQUERY(&#34;QRYREFPAPERS&#34;, &#34;STS_DB&#34;, &#34;SELECT PAPER_DOCG44_CODE, PAPERNAME ' +&#13;&#10;                                               'FROM PAPERS ' + &#13;&#10;                                               'WHERE PAPER_IS_WAYBILL = 1&#34;)');&#13;&#10;  sPaperNames := '|' + COMPUTE('JOINVALUES(&#34;QRYREFPAPERS&#34;, &#34;|&#34;, [&#34;PAPERNAME&#34;])') + '|';&#13;&#10;  sPaperCodes := '|' + COMPUTE('JOINVALUES(&#34;QRYREFPAPERS&#34;, &#34;|&#34;, [&#34;PAPER_DOCG44_CODE&#34;])') + '|';&#13;&#10;  COMPUTE('CLOSEDATASET(&#34;QRYREFPAPERS&#34;)');                                   &#13;&#10;end;&#13;&#10;&#13;&#10;procedure UseDateDO3OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If UseDateDO3.Checked then begin                                       &#13;&#10;     //UseDateDO3.Checked := True;&#13;&#10;     DateDO3.Enabled := True;&#13;&#10;     end&#13;&#10;  Else begin                                       &#13;&#10;     //UseDateDO3.Checked := False;&#13;&#10;     DateDO3.Enabled := False;&#13;&#10;     end  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure chkUseContsOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  chkPrintContType.Enabled := chkUseConts.Checked;&#13;&#10;  chkPrintPlomb.Enabled := chkUseConts.Checked;      &#13;&#10;end;&#13;&#10;&#13;&#10;procedure PrintPlomb (s : integer);                                      &#13;&#10;begin&#13;&#10;  sConstStore :='';    &#13;&#10; COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10; COMPUTE('SETRANGE(&#34;KRD_COMM_PAPERS_2&#34;, [&#34;' + VARtoSTR(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VARtoSTR(&#60;MainQuery.&#34;ID&#34;&#62;) + '&#34;, &#34;' + VARtoSTR(&#60;MainQuery.&#34;G32&#34;&#62;) + '&#34;, &#34;' + VARtoSTR(&#34;11&#34;) + '&#34;])');&#13;&#10;  if StrToInt(COMPUTE('RECORDCOUNT(&#34;KRD_COMM_PAPERS_2&#34;)')) &#62; 0 then begin&#13;&#10;    COMPUTE('FIRST(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;    While StrToInt(COMPUTE('EOF(&#34;KRD_COMM_PAPERS_2&#34;)')) = 0 do begin&#13;&#10;      COMPUTE('SETRANGE(&#34;KRD_CONT_2&#34;, [&#34;' + IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' +&#13;&#10;                                            IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' +&#13;&#10;                                            IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;DOC_COUNTER&#34;&#62;) + '&#34;])');&#13;&#10;      if Length(sConstStore) &#62; 0 then sConstStore := sConstStore + ',';&#13;&#10;      if (COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;PLOMB&#34;)') &#60;&#62; '') and chkPrintPlomb.Checked then begin&#13;&#10;        if chkPrintContType.Checked then                                                                                                                   &#13;&#10;          sConstStore := sConstStore + COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;CONTTYPE&#34;)') + ' ' + COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;CONTNO&#34;)') + ' : '+ COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;PLOMB&#34;)')&#13;&#10;        else&#13;&#10;          sConstStore := sConstStore + COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;CONTNO&#34;)') + ' : '+ COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;PLOMB&#34;)');                      &#13;&#10;      end                                 &#13;&#10;      else begin&#13;&#10;        if chkPrintContType.Checked then              &#13;&#10;          sConstStore := sConstStore + COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;CONTTYPE&#34;)') + ' ' + COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;CONTNO&#34;)')&#13;&#10;        else&#13;&#10;          sConstStore := sConstStore + COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;CONTNO&#34;)');                                               &#13;&#10;      end;&#13;&#10;      COMPUTE('CANCELRANGE(&#34;KRD_CONT_2&#34;)');&#13;&#10;      COMPUTE('NEXT(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;    end;&#13;&#10;  end&#13;&#10;  else begin&#13;&#10;    COMPUTE('SETRANGE(&#34;KRD_CONT_2&#34;, [&#34;' + IntToStr(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' +&#13;&#10;                                          IntToStr(&#60;MainQuery.&#34;ID&#34;&#62;) + '&#34;])');&#13;&#10;    if chkPrintPlomb.Checked then begin                                                                               &#13;&#10;      if chkPrintContType.Checked then                                                  &#13;&#10;      sConstStore := COMPUTE('UNIONVALUES(&#34;KRD_CONT_2&#34;, [&#34;CONTTYPE&#34;, &#34;CONTNO&#34;,&#34;PLOMB&#34;], &#34;, &#34;, &#34; : &#34;)')&#13;&#10;      else&#13;&#10;      sConstStore := COMPUTE('UNIONVALUES(&#34;KRD_CONT_2&#34;, [&#34;CONTNO&#34;,&#34;PLOMB&#34;], &#34;, &#34;, &#34; : &#34;)');&#13;&#10;    end&#13;&#10;    else begin          &#13;&#10;      if chkPrintContType.Checked then                                                  &#13;&#10;      sConstStore := COMPUTE('UNIONVALUES(&#34;KRD_CONT_2&#34;, [&#34;CONTTYPE&#34;, &#34;CONTNO&#34;], &#34;, &#34;, &#34; : &#34; )')&#13;&#10;      else&#13;&#10;      sConstStore := COMPUTE('UNIONVALUES(&#34;KRD_CONT_2&#34;, [&#34;CONTNO&#34;], &#34;, &#34;, &#34; : &#34;)');            &#13;&#10;    end;      &#13;&#10;          &#13;&#10;    COMPUTE('CANCELRANGE(&#34;KRD_CONT_2&#34;)'); &#13;&#10;                        &#13;&#10;  end;&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;  //showmessage(sConstStore);                                &#13;&#10;  if s=1 then sStoreNum := sConstStore ;&#13;&#10;  if s=2 then sConts := sConstStore ;                                     &#13;&#10;end;  &#13;&#10;  &#13;&#10;procedure Memo68OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;sStoreNum := &#34;&#34;;&#13;&#10;  if PrintFirstAll = True then  begin       &#13;&#10;    if not bGoodStoreNumKPS then &#13;&#10;      begin&#13;&#10;        if bUseConts then  // если включена настройка на диалоговой форме - смотрим контейнера                                                                                                                                                                           &#13;&#10;           PrintPlomb(1);&#13;&#10;        if Length(sStoreNum) = 0 then &#13;&#10;          begin&#13;&#10;            if COMPUTE('FIELDEXISTS(&#34;REL_COMM&#34;, &#34;RELEASE_BOXNO&#34;)') then&#13;&#10;              sStoreNum := &#60;MainQuery.&#34;RELEASE_BOXNO&#34;&#62;;&#13;&#10;            //ShowMessage('sstoreNum '+sStoreNum+' G32 '+VARtoSTR(&#60;MainQuery.&#34;G32&#34;&#62;));        &#13;&#10;            if (sStoreNum = NULL) OR (sStoreNum = '') then&#13;&#10;              sStoreNum := &#60;MainQuery.&#34;BOXNO&#34;&#62;;&#13;&#10;            If StoreDocsBlock &#60;&#62; 0 then&#13;&#10;              if (sStoreNum = NULL) OR (sStoreNum = '') then&#13;&#10;                if COMPUTE('FINDKEY(&#34;IN_COMM_2&#34;, [&#34;' + VARtoSTR(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VARtoSTR(&#60;MainQuery.&#34;ID&#34;&#62;) + '&#34;, &#34;' + VARtoSTR(&#60;MainQuery.&#34;G32&#34;&#62;) + '&#34;])') then&#13;&#10;                  sStoreNum := &#60;IN_COMM_2.&#34;BOXNO&#34;&#62;;                &#13;&#10;          end;               &#13;&#10;      end&#13;&#10;    else &#13;&#10;      begin&#13;&#10;        COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');&#13;&#10;        COMPUTE('SETRANGE(&#34;KRD_COMM_2&#34;, [&#34;' + VARTOSTR(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;ID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;G32&#34;&#62;) + '&#34;])');&#13;&#10;          sStoreNum := &#60;MainQuery.&#34;NBD&#34;&#62; + '/' + COMPUTE('LEFTPAD(&#34;' + VarToStr(&#60;KRD_COMM_2.&#34;G32&#34;&#62;) + '&#34;, &#34;6&#34;, &#34;0&#34;)');&#13;&#10;          if Trim(&#60;KRD_COMM_2.&#34;SVHAREA&#34;&#62;) &#60;&#62; '' then&#13;&#10;            sStoreNum := sStoreNum + CHR(13) + 'Зона: ' + &#60;KRD_COMM_2.&#34;SVHAREA&#34;&#62;;&#13;&#10;          if Trim(&#60;KRD_COMM_2.&#34;SVHHANGAR&#34;&#62;) &#60;&#62; '' then&#13;&#10;            sStoreNum := sStoreNum + CHR(13) + 'Анг.: ' + &#60;KRD_COMM_2.&#34;SVHHANGAR&#34;&#62;;&#13;&#10;          if Trim(&#60;KRD_COMM_2.&#34;SVHRACK&#34;&#62;) &#60;&#62; '' then&#13;&#10;            sStoreNum := sStoreNum + CHR(13) + 'Стел.: ' + &#60;KRD_COMM_2.&#34;SVHRACK&#34;&#62;;&#13;&#10;          if Trim(&#60;KRD_COMM_2.&#34;SVHCELL&#34;&#62;) &#60;&#62; '' then&#13;&#10;            sStoreNum := sStoreNum + CHR(13) + 'Яч.: ' + &#60;KRD_COMM_2.&#34;SVHCELL&#34;&#62;;  &#13;&#10;        COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');&#13;&#10;        if bUseConts then &#13;&#10;        begin&#13;&#10;          PrintPlomb(2);      &#13;&#10;          if Trim(sConts) &#60;&#62; '' then&#13;&#10;          sStoreNum := sStoreNum + CHR(13) + 'Конт.: ' + sConts;&#13;&#10;        end;        &#13;&#10;    end; //if not bGoodStoreNumKPS     &#13;&#10;  end; // first all                  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo66OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;TransDocNames := &#34;&#34;;&#13;&#10;COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;COMPUTE('SETRANGE(&#34;KRD_COMM_PAPERS_2&#34;, [&#34;' + VARTOSTR(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;ID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;G32&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#34;13&#34;) + '&#34;])');&#13;&#10;&#13;&#10;if PrintFirstAll = True then   begin&#13;&#10;  if  cbTDByComms.Checked and (COMPUTE('RECORDCOUNT(&#34;KRD_COMM_PAPERS_2&#34;)') &#60;&#62; '0') then&#13;&#10;    begin&#13;&#10;      COMPUTE('FIRST(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;      while  COMPUTE('EOF(&#34;KRD_COMM_PAPERS_2&#34;)') = '0' do&#13;&#10;        begin&#13;&#10;          COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;          COMPUTE('SETRANGE(&#34;KRD_PAPERS_2&#34;, [&#34;' + VARTOSTR(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;ID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;KRD_COMM_PAPERS_2.&#34;DOC_COUNTER&#34;&#62;) + '&#34;])');&#13;&#10;          If (cbxOnlyWaybill.Checked = True) and &#13;&#10;             ((Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;) + '|', sPaperCodes) = 0) or&#13;&#10;              (Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62;) + '|', sPaperNames) = 0))  then&#13;&#10;            COMPUTE('NEXT(&#34;KRD_COMM_PAPERS_2&#34;)')&#13;&#10;          else&#13;&#10;            begin&#13;&#10;              if TransDocNames = &#34;&#34; then&#13;&#10;                  if &#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62; &#60;&#62; NULL then&#13;&#10;                     TransDocNames := &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; №&#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;) + &#34; от &#34; +  DATETOSTR(&#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)&#13;&#10;                  else  TransDocNames := &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; №&#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;)&#13;&#10;              else&#13;&#10;                  if &#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62; &#60;&#62; NULL then&#13;&#10;                       TransDocNames := TransDocNames + ', ' + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; №&#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;) + &#34; от &#34; +  DATETOSTR(&#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)&#13;&#10;                  else TransDocNames := TransDocNames + ', ' + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; №&#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;);&#13;&#10;              COMPUTE('NEXT(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;            end&#13;&#10;        end&#13;&#10;    end&#13;&#10;  else&#13;&#10;    begin&#13;&#10;      COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;      COMPUTE('SETRANGE(&#34;KRD_PAPERS_2&#34;, [&#34;' + VARTOSTR(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;ID&#34;&#62;) + '&#34;])');&#13;&#10;      COMPUTE('FIRST(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;      while COMPUTE('EOF(&#34;KRD_PAPERS_2&#34;)') = '0' do&#13;&#10;        begin&#13;&#10;          If (cbxOnlyWaybill.Checked = True) and &#13;&#10;             ((Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;) + '|', sPaperCodes) = 0) or&#13;&#10;              (Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62;) + '|', sPaperNames) = 0)) then&#13;&#10;            COMPUTE('NEXT(&#34;KRD_PAPERS_2&#34;)')&#13;&#10;          else&#13;&#10;            begin&#13;&#10;              if TransDocNames = &#34;&#34; then&#13;&#10;                  if &#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62; &#60;&#62; NULL then&#13;&#10;                     TransDocNames := &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; № &#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;) + &#34; от &#34; +  DATETOSTR(&#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)&#13;&#10;                  else  TransDocNames := &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; № &#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;)&#13;&#10;              else&#13;&#10;                  if &#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62; &#60;&#62; NULL then&#13;&#10;                       TransDocNames := TransDocNames + ', ' + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; №&#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;) + &#34; от &#34; +  DATETOSTR(&#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)&#13;&#10;                  else TransDocNames := TransDocNames + ', ' + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; №&#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;);&#13;&#10;              COMPUTE('NEXT(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;            end&#13;&#10;        end&#13;&#10;    end&#13;&#10;end;&#13;&#10;COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  //Взяли из ini-шника &#34;Только таможенные документы учета&#34;&#13;&#10;  CustomDocsOnly := StrToInt(IniFile('RegBook', 'CustomsDocsOnly', '0'));&#13;&#10;  //Включена ли настройка &#34;Совместимость с АИСТом&#34;, 1-да, 0-нет&#13;&#10;  AistCompatible := StrToInt(IniFile('Docs', 'AistCompatible', '0'));&#13;&#10;  //Отключен ли блок складских документов&#13;&#10;  StoreDocsBlock := StrToInt(IniFile('Database', 'StoreDocsBlock', '0'));&#13;&#10;  if (StoreDocsBlock = 1) and ((AistCompatible = 1) or ((AistCompatible = 0) and (CustomDocsOnly = 0))) then&#13;&#10;    vUseStoreDocs := True&#13;&#10;  else vUseStoreDocs := False;&#13;&#10;&#13;&#10;  bGoodStoreNumKPS := IniFile('Print', 'GoodStoreNumKPS', 'False') = 'True';    &#13;&#10;  bUseConts := IniFile('Print', 'UseConts', 'False') = 'True';&#13;&#10;  bPrintPlomb := IniFile('Print', 'PrintPlomb', 'True') = 'True';      &#13;&#10;  bPrintContType := IniFile('Print', 'PrintContType', 'False') = 'True';&#13;&#10;&#13;&#10;  bAllowSplit := IniFile('Print', 'AllowSplit', 'True') = 'True';&#13;&#10;    &#13;&#10;  //Что печатать в графе 7&#13;&#10;  bBrutto := COMPUTE('INIFILE(&#34;Print&#34;, &#34;DO3Brutto&#34;, &#34;False&#34;)') = 'True';&#13;&#10;  bUnits := COMPUTE('INIFILE(&#34;Print&#34;, &#34;DO3Units&#34;, &#34;False&#34;)') = 'True';&#13;&#10;  bVolume := COMPUTE('INIFILE(&#34;Print&#34;, &#34;DO3Volume&#34;, &#34;False&#34;)') = 'True';&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;  //Что печатать в графе 8   &#13;&#10;  bPartInPlace := IniFile('Print', 'PartInPlace', 'False') = 'True';&#13;&#10;  sPartInPlaceText := IniFile('Print', 'PartInPlaceText', 'часть места');&#13;&#10;&#13;&#10;  // Что печатать в графе 14                                                                                                     &#13;&#10;  bStorageDateNoPrint := IniFile('Print', 'StorageDateNoPrint', 'False') = 'True';                                                                              &#13;&#10;  &#13;&#10;  //Что печатать в графе 16  &#13;&#10;  bPartOutPlace := IniFile('Print', 'PartOutPlace', 'False') = 'True';&#13;&#10;  sPartOutPlaceText := IniFile('Print', 'PartOutPlaceText', 'часть места');      &#13;&#10;end." OnStartReport="OnStartReport">
  <Datasets>
    <item DataSet="ds_IN_COMM_2" DataSetName="IN_COMM_2"/>
    <item DataSet="ds_KRD_COMM_2" DataSetName="KRD_COMM_2"/>
    <item DataSet="ds_KRD_COMM_PAPERS_2" DataSetName="KRD_COMM_PAPERS_2"/>
    <item DataSet="ds_KRD_CONT_2" DataSetName="KRD_CONT_2"/>
    <item DataSet="ds_KRD_PAPERS_2" DataSetName="KRD_PAPERS_2"/>
    <item DataSet="ds_KRD_PROL_2" DataSetName="KRD_PROL_2"/>
    <item DataSet="MainQuery" DataSetName="MainQuery"/>
    <item DataSet="ds_STORES_2" DataSetName="STORES_2"/>
    <item DataSet="qCSDM" DataSetName="qCSDM"/>
  </Datasets>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxUNIQuery Name="MainQuery" UserName="MainQuery" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Active="False" DatabaseName="DBFDatabase" Filtered="False" IgnoreDupParams="False" SQL.Text="SELECT * &#13;&#10;FROM DO2COMM&#13;&#10;WHERE&#13;&#10;   (PLACEID = :PLACEID) &#13;&#10; AND &#13;&#10;   (ACCEPTDATE &#62;= :PeriodStart) AND (ACCEPTDATE &#60;= :PeriodEnd)&#13;&#10;ORDER BY ACCEPTDATE, NBD , G32" PropData="05704C656674023C0470546F7002140A506172616D65746572730101063A204E616D653D22504C4143454944222044617461547970653D226674496E7465676572222045787072657373696F6E3D2276506C61636549642200010644204E616D653D22506572696F645374617274222044617461547970653D2266744461746554696D65222045787072657373696F6E3D226474506572696F6453746172742200010640204E616D653D22506572696F64456E64222044617461547970653D2266744461746554696D65222045787072657373696F6E3D226474506572696F64456E64220000"/>
    <TfrxUNIQuery Name="qCSDM" UserName="qCSDM" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Active="False" DatabaseName="STS_DB" Filtered="False" IgnoreDupParams="False" SQL.Text="SELECT ID FROM KRD_CSDM WHERE PLACEID=:PLACEID AND ID=:ID AND G32=:G32 AND SDM_KIND='1'                                                                                                                                                                                                           " PropData="05704C6566740398000470546F7002140A506172616D657465727301010657204E616D653D22504C4143454944222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4D61696E51756572792E262333343B504C4143454944262333343B262336323B220001064D204E616D653D224944222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4D61696E51756572792E262333343B4944262333343B262336323B220001064F204E616D653D22473332222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B4D61696E51756572792E262333343B473332262333343B262336323B220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="Page1" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Форма ДО3" Height="616" ClientHeight="577" Left="441" Top="129" Width="793" ClientWidth="777" OnShow="Page1OnBeforePrint">
    <TfrxColorFrameControl Name="ColorFrame3" Left="12" Top="406" Width="316" Height="102" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Печатать итоги" Color="-16777201">
      <TfrxColorFrameControl Name="ColorFrame5" Left="12" Top="38" Width="293" Height="63" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Суммировать стоимость" Color="-16777201">
        <TfrxPanelControl Name="Panel4" Left="8" Top="24" Width="277" Height="33" ShowHint="True" BevelOuter="bvNone" Color="-16777201">
          <TfrxRadioButtonControl Name="chkRubG42" Left="4" Top="16" Width="129" Height="17" Enabled="False" ShowHint="True" Caption="Переводить в рубли" TabStop="False" Color="-16777201"/>
          <TfrxRadioButtonControl Name="chkClearG42" Left="136" Top="16" Width="141" Height="17" Enabled="False" ShowHint="True" Caption="Суммировать &#34;как есть&#34;" Checked="True" Color="-16777201"/>
          <TfrxRadioButtonControl Name="chkUSDG42" Left="4" Top="0" Width="129" Height="17" Enabled="False" ShowHint="True" Caption="Переводить в USD" TabStop="False" Color="-16777201"/>
          <TfrxRadioButtonControl Name="chkEURG42" Left="136" Top="0" Width="141" Height="17" Enabled="False" ShowHint="True" Caption="Переводить в EUR" TabStop="False" Color="-16777201"/>
        </TfrxPanelControl>
      </TfrxColorFrameControl>
      <TfrxCheckBoxControl Name="chkG35" Left="9" Top="21" Width="196" Height="17" Enabled="False" ShowHint="True" Caption="Суммировать графы 9 и 17 (&#34;вес&#34;)" Color="-16777201"/>
      <TfrxCheckBoxControl Name="chkG42" Left="9" Top="41" Width="14" Height="17" Enabled="False" ShowHint="True" Color="-16777201" OnClick="chkG42OnClick"/>
    </TfrxColorFrameControl>
    <TfrxColorFrameControl Name="" Left="330" Top="348" Width="445" Height="58" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201">
      <TfrxLabelControl Name="Label3" Left="6" Top="11" Width="184" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="Уполномоченный  работник склада " Color="-16777201"/>
      <TfrxEditControl Name="StoreKeep" Left="200" Top="9" Width="235" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
      <TfrxCheckBoxControl Name="cbExport" Left="8" Top="33" Width="297" Height="17" ShowHint="True" Caption="Формировать отчет для экспорта в MS Excel" Color="-16777201"/>
    </TfrxColorFrameControl>
    <TfrxColorFrameControl Name="ColorFrame1" Left="4" Top="83" Width="324" Height="126" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201"/>
    <TfrxColorFrameControl Name="ColorFrame8" Left="4" Top="326" Width="324" Height="79" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="В графах 9, 17 печатать" Color="-16777201">
      <TfrxCheckBoxControl Name="chkBrutto" Left="6" Top="22" Width="87" Height="17" ShowHint="True" Caption="Вес брутто" Color="-16777201"/>
      <TfrxCheckBoxControl Name="chkUnits" Left="94" Top="22" Width="136" Height="17" ShowHint="True" Caption="Количество в доп. ед." Color="-16777201"/>
      <TfrxCheckBoxControl Name="chkVolume" Left="237" Top="22" Width="59" Height="17" ShowHint="True" Caption="Объем" Color="-16777201"/>
      <TfrxLabelControl Name="Label1" Left="11" Top="42" Width="307" Height="29" ShowHint="True" AutoSize="False" Caption="(если не включить ни одной отметки, то будет печататься один из параметров, в соответствии с пр. 715)" Color="-16777201" WordWrap="True"/>
    </TfrxColorFrameControl>
    <TfrxColorFrameControl Name="ColorFrame10" Left="4" Top="2" Width="324" Height="80" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Место хранения" Color="-16777201">
      <TfrxLabelControl Name="ed1" Left="50" Top="54" Width="26" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Visible="False" AutoSize="False" Caption="Label" Color="-16777201"/>
      <TfrxEditControl Name="fldStoreLicNum" Left="95" Top="25" Width="106" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
      <TfrxLabelControl Name="lblNumLicence" Left="10" Top="29" Width="65" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="№ лицензии:" Color="-16777201"/>
      <TfrxEditControl Name="fldLicExt" Left="80" Top="25" Width="15" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True"/>
      <TfrxButtonControl Name="btnCallRef" Left="175" Top="26" Width="24" Height="18" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" OnClick="btnCallRefOnBeforePrint"/>
      <TfrxDateEditControl Name="fldStoreLicDate" Left="219" Top="25" Width="87" Height="23" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38247" Time="38247" WeekNumbers="False"/>
      <TfrxLabelControl Name="Label4" Left="205" Top="28" Width="11" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="от" Color="-16777201"/>
      <TfrxEditControl Name="lblStoreName" Left="11" Top="50" Width="295" Height="23" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    </TfrxColorFrameControl>
    <TfrxColorFrameControl Name="ColorFrame9" Left="330" Top="9" Width="445" Height="40" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201">
      <TfrxCheckBoxControl Name="chkDO2" Left="10" Top="8" Width="234" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Не включать ДО2, оформленные позже конца периода" WordWrap="True" Color="-16777201"/>
    </TfrxColorFrameControl>
    <TfrxColorFrameControl Name="ColorFrame2" Left="330" Top="50" Width="445" Height="49" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Графа № 6" Color="-16777201">
      <TfrxCheckBoxControl Name="cbxOnlyWaybill" Left="10" Top="23" Width="321" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Включать в графу только накладные" Color="-16777201"/>
      <TfrxCheckBoxControl Name="cbTDByComms" Left="234" Top="14" Width="201" Height="33" ShowHint="True" Caption="Печатать ТСД к товару по таблице &#34;Товары по документам&#34;" WordWrap="True" Color="-16777201"/>
    </TfrxColorFrameControl>
    <TfrxColorButtonControl Name="cbtnOk" Left="596" Top="549" Width="75" Height="25" ShowHint="True" Caption="Просмотр" Color="-16777201" Flat="False" GradientType="gtNone" ModalResult="1" OnClick="cbtnOkOnBeforePrint"/>
    <TfrxColorButtonControl Name="ColorButton1" Left="694" Top="549" Width="75" Height="25" ShowHint="True" Caption="Отмена" Color="-16777201" Flat="False" GradientType="gtNone" ModalResult="2"/>
    <TfrxColorFrameControl Name="ColorFrame6" Left="330" Top="448" Width="445" Height="80" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Каталог для сохранения ДО3" Color="-16777201">
      <TfrxEditControl Name="edtDO3DB" Left="7" Top="23" Width="389" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
      <TfrxBitBtnControl Name="btnDO3DB" Left="367" Top="25" Width="27" Height="18" ShowHint="True" Glyph.PropData="04446174610A3A03000036030000424D360300000000000036000000280000001000000010000000010018000000000000030000120B0000120B00000000000000000000FF00FF0274AC0274AC0274AC0274AC0274AC0274AC0274AC0274AC0274AC0274AC0274AC0274ACFF00FFFF00FFFF00FF0274AC138AC456B6E16ACBF84BBFF74ABFF74ABFF74ABFF74ABFF64ABFF74ABFF64BC0F72398CC0C81BAFF00FFFF00FF0274AC33AAE02392C489D9FA54C7F854C7F753C7F854C7F754C7F854C7F854C7F853C7F7279DCEBAEBEF0274ACFF00FF0274AC57CAF80274AC99E2FB5ED1FA5ED1FA5ED1FA5ED1FA5ED1FA5FD1FA5ED1F85ED1F82CA1CEBAEBEF0274ACFF00FF0274AC5ED3FA0B81B782D5EF79E0FB6ADCFA69DCFB69DCFB6ADCFB69DCFB69DCFA6ADDFB2FA6CFBAEBEF097EB4FF00FF0274AC68DAFB2BA4D14AB1D796EBFB74E5FB74E5FB74E5FC74E5FC74E5FB74E5FC74E5FB33A9CFBAEBEFBAEBEF0274AC0274AC70E3FB5CD1EF1184B7FEFFFFB8F4FCBAF4FCBAF4FCBAF4FEB8F4FEBAF4FCB8F4FE83C9DEE3FEFEC5EFF60274AC0274AC7AEBFE7AEBFC0A7FB50274AC0274AC0274AC0274AC0274AC0274AC0274AC0274AC0274AC0274AC0274AC0274AC0274AC83F2FE82F3FE82F3FE83F2FC83F3FE82F3FE83F2FE82F3FC83F2FE82F3FE82F3FE036FA7FF00FFFF00FFFF00FF0274ACFEFEFE89FAFF89FAFE89FAFE8AF8FE8AFAFE89F8FE8AFAFE8AFAFF89FAFF8AFAFF036FA7FF00FFFF00FFFF00FFFF00FF0274ACFEFEFE8FFEFF8FFEFF8FFEFF0274AC0274AC0274AC0274AC0274AC0274ACFF00FFFF00FFFF00FFFF00FFFF00FFFF00FF0274AC0274AC0274AC0274ACFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FFFF00FF" Caption="btnDO3DB" Layout="blGlyphBottom" Margin="1" OnClick="btnDO3DBOnClick"/>
      <TfrxLabelControl Name="Label5" Left="10" Top="47" Width="424" Height="32" ShowHint="True" AutoSize="False" Caption="Укажите каталог для записи файлов ДО3(do3comm.db и do3comm.ini). Файлы передаются в ВЭД-Склад(Инспектор) для сверки с ДО1, ДО2 в базе Инспектора" Color="-16777201" WordWrap="True"/>
    </TfrxColorFrameControl>
    <TfrxPanelControl Name="Panel1" Left="7" Top="82" Width="319" Height="117" ShowHint="True" BevelOuter="bvNone" Color="-16777201">
      <TfrxColorFrameControl Name="cfrmPeriod" Left="10" Top="4" Width="298" Height="92" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="За период" Color="-16777201">
        <TfrxCheckBoxControl Name="cbxNotInclude" Left="7" Top="49" Width="287" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" Caption="Не включать оформленные ранее начала периода" Checked="True" State="cbChecked" Color="-16777205" OnClick="cbxNotIncludeOnBeforePrint"/>
        <TfrxLabelControl Name="lblFrom" Left="7" Top="28" Width="11" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="С" Color="-16777201"/>
        <TfrxLabelControl Name="lblTo" Left="150" Top="30" Width="12" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="по" Color="-16777201"/>
        <TfrxDateEditControl Name="dtFrom" Left="26" Top="25" Width="116" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38247" Time="38247" WeekNumbers="False"/>
        <TfrxDateEditControl Name="dtTo" Left="176" Top="26" Width="112" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38247" Time="38247" WeekNumbers="False"/>
        <TfrxCheckBoxControl Name="cbxStore" Left="7" Top="65" Width="289" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" Caption="Включать все хранящиеся на складе товары" Color="-16777201" OnClick="cbxStoreOnBeforePrint"/>
      </TfrxColorFrameControl>
      <TfrxRadioButtonControl Name="rbtnBook" Left="8" Top="101" Width="287" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="По текущей книге учета" TabStop="False" Color="-16777201" OnClick="rbtnBookOnBeforePrint"/>
      <TfrxRadioButtonControl Name="rbtnPeriod" Left="4" Top="4" Width="14" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" TabStop="False" Color="-16777201" OnClick="rbtnPeriodOnBeforePrint"/>
    </TfrxPanelControl>
    <TfrxColorFrameControl Name="ColorFrame4" Left="330" Top="294" Width="445" Height="53" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Сортировка" Color="-16777201">
      <TfrxPanelControl Name="Panel3" Left="7" Top="21" Width="430" Height="24" ShowHint="True" BevelOuter="bvNone" Color="-16777201">
        <TfrxRadioButtonControl Name="rbtnSortByNBD" Left="320" Top="6" Width="97" Height="17" ShowHint="True" Caption="по номеру ДО1" TabStop="False" WordWrap="True" Color="-16777201"/>
        <TfrxRadioButtonControl Name="rbtnSortbyBdDate" Left="203" Top="6" Width="89" Height="17" ShowHint="True" Caption="по дате ДО1" TabStop="False" Color="-16777201"/>
        <TfrxRadioButtonControl Name="rbtnSortByBegKeep" Left="11" Top="6" Width="174" Height="17" ShowHint="True" Caption="по дате помещения на склад" TabStop="False" WordWrap="True" Color="-16777201"/>
      </TfrxPanelControl>
    </TfrxColorFrameControl>
    <TfrxCheckBoxControl Name="chkItog" Left="6" Top="407" Width="12" Height="17" ShowHint="True" Color="-16777201" OnClick="chkItogOnClick"/>
    <TfrxColorFrameControl Name="ColorFrame11" Left="558" Top="160" Width="217" Height="67" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="В графе 16" Color="-16777201">
      <TfrxCheckBoxControl Name="chkPartOutPlace" Left="8" Top="22" Width="147" Height="41" ShowHint="True" Caption="если кол-во выдаваемых мест равно нулю, печатать" WordWrap="True" Color="-16777201"/>
      <TfrxColorEditControl Name="edPartOutPlacetext" Left="140" Top="38" Width="67" Height="21" ShowHint="True" ReadOnly="False" Text="часть места"/>
    </TfrxColorFrameControl>
    <TfrxColorFrameControl Name="ColorFrame12" Left="330" Top="160" Width="229" Height="67" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="В графе 8" Color="-16777201">
      <TfrxCheckBoxControl Name="chkPartInPlace" Left="8" Top="22" Width="131" Height="37" ShowHint="True" Caption="если кол-во принятых мест равно нулю, печатать" WordWrap="True" Color="-16777201"/>
      <TfrxColorEditControl Name="edPartInPlaceText" Left="140" Top="38" Width="79" Height="21" ShowHint="True" ReadOnly="False" Text="часть места"/>
    </TfrxColorFrameControl>
    <TfrxColorFrameControl Name="ColorFrame13" Left="330" Top="104" Width="445" Height="53" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="В графе 14 печатать" Color="-16777201">
      <TfrxCheckBoxControl Name="chkStorageDateNoPrint" Left="8" Top="24" Width="427" Height="25" ShowHint="True" Caption="дату окончания срока хранения только для скоропортящихся товаров (тип хранения &#34;ЖИВ&#34;)" WordWrap="True" Color="-16777201"/>
    </TfrxColorFrameControl>
    <TfrxDateEditControl Name="dtOnDate" Left="52" Top="832" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="39766" Time="39766" WeekNumbers="False"/>
    <TfrxColorFrameControl Name="ColorFrame14" Left="4" Top="209" Width="324" Height="118" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Графа 7" Color="-16777201">
      <TfrxCheckBoxControl Name="chkPrintContType" Left="28" Top="67" Width="221" Height="17" ShowHint="True" Caption="Печатать тип контейнера" Color="-16777201"/>
      <TfrxCheckBoxControl Name="chkUseConts" Left="16" Top="23" Width="273" Height="29" Hint="Если поле &#34;Место размещения на СВХ&#34; не заполнено, будет использоваться информация о контейнерах" ShowHint="True" Caption="Использовать информацию о контейнерах для формирования складского номера" WordWrap="True" Color="-16777201" OnClick="chkUseContsOnClick"/>
      <TfrxCheckBoxControl Name="chkGoodStoreNumKPS" Left="16" Top="85" Width="197" Height="33.56923077" ShowHint="True" Caption="Складской номер товара для КПС &#34;Учет и контроль товаров на ВХ&#34;" WordWrap="True" Color="-16777201"/>
      <TfrxCheckBoxControl Name="chkPrintPlomb" Left="28" Top="49" Width="173" Height="17" ShowHint="True" Caption="Печатать номер пломбы" Color="-16777201"/>
    </TfrxColorFrameControl>
    <TfrxColorFrameControl Name="ColorFrame15" Left="330" Top="408" Width="445" Height="40" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201">
      <TfrxCheckBoxControl Name="chkAllowSplit" Left="10" Top="8" Width="405" Height="25" ShowHint="True" Caption="&#34;Разрывать&#34; строку с товаром и переносить на другой лист, если строка целиком не помещается" WordWrap="True" Color="-16777201"/>
    </TfrxColorFrameControl>
    <TfrxColorFrameControl Name="ColorFrame16" Left="4" Top="511" Width="322" Height="62" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201">
      <TfrxLabelControl Name="Label2" Left="11" Top="10" Width="144" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="№ таможенного требования" Color="-16777201"/>
      <TfrxDateEditControl Name="dtNumCust" Left="209" Top="34" Width="102" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38262" Time="38262" WeekNumbers="False"/>
      <TfrxLabelControl Name="Label6" Left="10" Top="36" Width="159" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="Дата таможенного требования" Color="-16777201"/>
      <TfrxEditControl Name="edtNumCust" Left="164" Top="9" Width="147" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    </TfrxColorFrameControl>
    <TfrxColorFrameControl Name="ColorFrame17" Left="328" Top="228" Width="232" Height="64" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Графа № 13" Color="-16777201">
      <TfrxCheckBoxControl Name="cbxG082" Left="12" Top="32" Width="181" Height="17" ShowHint="True" Caption="Печатать получателя по ДО2" Color="-16777201"/>
    </TfrxColorFrameControl>
    <TfrxColorFrameControl Name="ColorFrame18" Left="560" Top="228" Width="212" Height="64" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201">
      <TfrxCheckBoxControl Name="UseDateDO3" Left="8" Top="12" Width="133" Height="17" ShowHint="True" Caption="Установить дату ДО3" Color="-16777201" OnClick="UseDateDO3OnClick"/>
      <TfrxDateEditControl Name="DateDO3" Left="53" Top="32" Width="116" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" Color="-16777211" Date="38247" Time="38247" WeekNumbers="False"/>
    </TfrxColorFrameControl>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page2" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="7" RightMargin="7" TopMargin="7" BottomMargin="13" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False" OnBeforePrint="Page2OnBeforePrint">
    <TfrxPageHeader Name="PageHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="257.00788134" Left="0" Top="49.13389" Width="1069.60699" OnBeforePrint="PageHeader1OnBeforePrint">
      <TfrxMemoView Name="Memo17" Left="0" Top="71.81102118" Width="1069.60629921" Height="18.8976378" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="о товарах, помещенных на склад и выданных с него"/>
      <TfrxMemoView Name="Memo9" Left="151.18109992" Top="90.70865653" Width="752.12611362" Height="22.67716535" OnBeforePrint="Memo9OnBeforePrint" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[ReportPeriod]"/>
      <TfrxMemoView Name="Memo1" Left="3.173E-5" Top="52.91338582" Width="774.80321551" Height="18.8976378" OnBeforePrint="Memo1OnBeforePrint" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" HAlign="haRight" ParentFont="False" Text="[Text1] [FORMATDATETIME('DD.MM.YYYY', dtNumCustQuery)]"/>
      <TfrxMemoView Name="Memo59" Left="774.80318866" Top="52.91338582" Width="30.23623024" Height="18.8976378" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" ParentFont="False" Text="№"/>
      <TfrxMemoView Name="Memo60" Left="805.03941401" Top="52.91338582" Width="98.26771654" Height="18.8976378" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" ParentFont="False" Underlines="True" Text="[NumCustQuery]"/>
      <TfrxMemoView Name="Memo102" Left="805.03932126" Top="7.55906" Width="98.26771654" Height="30.23622047" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Форма ДО3"/>
      <TfrxMemoView Name="Memo3" Left="2.929E-5" Top="132.28347189" Width="22.67716535" Height="109.60629921" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="N&#13;&#10;п/п"/>
      <TfrxMemoView Name="Memo4" Left="22.67719464" Top="132.44094732" Width="699.21260819" Height="18.8976378" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Приход"/>
      <TfrxMemoView Name="Memo5" Left="22.67719464" Top="151.18110968" Width="41.57480559" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Дата и время помещения на склад"/>
      <TfrxMemoView Name="Memo6" Left="721.88980283" Top="132.44094732" Width="347.71653299" Height="18.8976378" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Расход"/>
      <TfrxMemoView Name="Memo7" Left="64.25200023" Top="151.18110968" Width="56.69291339" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Номер отчета по форме ДО1"/>
      <TfrxMemoView Name="Memo8" Left="120.944881889764" Top="151.18110968" Width="30.2362204724409" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Порядковый номер товаров по форме ДО1"/>
      <TfrxMemoView Name="Memo11" Left="245.66932063" Top="151.18110968" Width="105.82677165" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Вид, дата и номер транспортного документа"/>
      <TfrxMemoView Name="Memo14" Left="351.49609472" Top="151.18110968" Width="52.91338583" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Складской номер товаров"/>
      <TfrxMemoView Name="Memo16" Left="151.181102362205" Top="151.18110968" Width="94.488188976378" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Наименование товара"/>
      <TfrxMemoView Name="Memo18" Left="480.00003173" Top="151.18110968" Width="45.35433071" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Код товара (не менее первых 4-х знаков) в соответствии с ГС или ТН ВЭД ТС"/>
      <TfrxMemoView Name="Memo20" Left="525.35436244" Top="151.18110968" Width="52.91338827" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Стоимость товара в валюте, указанной в трансп. (перевозочн.) или коммерческих документах"/>
      <TfrxMemoView Name="Memo21" Left="404.40948055" Top="151.18110968" Width="30.23622047" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Количество грузовых мест"/>
      <TfrxMemoView Name="Memo22" Left="434.64570102" Top="151.18110968" Width="45.35433071" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Вес товара брутто (в кг) или объем товара (в куб. м) (либо в доп. ед. измерения)"/>
      <TfrxMemoView Name="Memo25" Left="721.88980283" Top="151.18110968" Width="52.91338583" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Дата и время выдачи со склада"/>
      <TfrxMemoView Name="Memo26" Left="903.30712811" Top="151.18110968" Width="166.44094" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Вид, дата и номер документа по которому разрешена выдача товара со склада"/>
      <TfrxMemoView Name="Memo29" Left="774.80318866" Top="151.18110968" Width="30.23622047" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Количество грузовых мест"/>
      <TfrxMemoView Name="Memo33" Left="2.929E-5" Top="241.8897711" Width="22.67716535" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="1."/>
      <TfrxMemoView Name="Memo34" Left="22.67719464" Top="241.8897711" Width="41.57480559" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="2."/>
      <TfrxMemoView Name="Memo35" Left="64.25200023" Top="241.8897711" Width="56.69291339" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="3."/>
      <TfrxMemoView Name="Memo36" Left="120.944881889764" Top="241.8897711" Width="30.2362204724409" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="4."/>
      <TfrxMemoView Name="Memo37" Left="245.66932063" Top="241.8897711" Width="105.82677165" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="6."/>
      <TfrxMemoView Name="Memo40" Left="351.49609472" Top="241.8897711" Width="52.91338583" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="7."/>
      <TfrxMemoView Name="Memo41" Left="151.181102362205" Top="241.8897711" Width="94.488188976378" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="5."/>
      <TfrxMemoView Name="Memo42" Left="480.00003173" Top="241.8897711" Width="45.35433071" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="10."/>
      <TfrxMemoView Name="Memo43" Left="525.35436244" Top="241.8897711" Width="52.91338827" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="11."/>
      <TfrxMemoView Name="Memo44" Left="404.40948055" Top="241.8897711" Width="30.23622047" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="8."/>
      <TfrxMemoView Name="Memo45" Left="434.64570102" Top="241.8897711" Width="45.35433071" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="9."/>
      <TfrxMemoView Name="Memo48" Left="721.88980283" Top="241.8897711" Width="52.91338583" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="15."/>
      <TfrxMemoView Name="Memo49" Left="903.30712811" Top="241.8897711" Width="166.44094" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="19."/>
      <TfrxMemoView Name="Memo50" Left="774.80318866" Top="241.8897711" Width="30.23622047" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="16."/>
      <TfrxMemoView Name="Memo51" Left="805.03940913" Top="241.8897711" Width="45.35433071" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="17."/>
      <TfrxMemoView Name="Memo12" Left="578.26775071" Top="151.18110968" Width="22.67716535" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Буквенный код валюты"/>
      <TfrxMemoView Name="Memo13" Left="578.26775071" Top="241.8897711" Width="22.67716535" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="12."/>
      <TfrxMemoView Name="Memo23" Left="850.39373984" Top="151.18110968" Width="52.91338827" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Стоимость товара в валюте, указанной в трансп. (перевозочн.) или коммерческих документах"/>
      <TfrxMemoView Name="Memo24" Left="850.39373984" Top="241.8897711" Width="52.91338827" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="18."/>
      <TfrxMemoView Name="Memo30" Left="805.03940913" Top="151.18110968" Width="45.35433071" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Вес товара брутто (в кг) или объем товара (в куб. м) (либо в доп. ед. измерения)"/>
      <TfrxMemoView Name="Memo53" Left="600.94491606" Top="151.18110968" Width="71.81102362" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Наименование получателя"/>
      <TfrxMemoView Name="Memo62" Left="600.94491606" Top="241.8897711" Width="71.81102362" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="13."/>
      <TfrxMemoView Name="Memo69" Left="672.75593968" Top="151.18110968" Width="49.13386315" Height="90.70866142" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Дата истечения срока временного хранения"/>
      <TfrxMemoView Name="Memo71" Left="672.75593968" Top="241.8897711" Width="49.13386315" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="14."/>
      <TfrxShapeView Name="Shape1" Left="2.929E-5" Top="7.55906732" Width="721.88977354" Height="45.35432583"/>
      <TfrxMemoView Name="Memo31" Left="2.929E-5" Top="7.55906244" Width="245.66934016" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[sTypeSVH]"/>
      <TfrxMemoView Name="Memo52" Left="245.66932063" Top="7.55906244" Width="476.22044315" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="8" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[sNameSVH]"/>
      <TfrxMemoView Name="Memo61" Left="2.929E-5" Top="22.67717267" Width="351.49606055" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[sTypeDoc]  "/>
      <TfrxMemoView Name="Memo63" Left="351.4960874" Top="22.67717267" Width="370.39389362" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="8" ParentFont="False" VAlign="vaCenter" Text="[sDateDoc]  №  [sNumDoc]"/>
      <TfrxMemoView Name="Memo84" Left="2.197E-5" Top="37.79528291" Width="525.35432827" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text="(при хранении товаров в ином месте хранения указывается номер разрешения таможни)"/>
    </TfrxPageHeader>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="113.38582921" Left="0" Top="491.3389" Width="1069.60699" OnBeforePrint="PageFooter1OnBeforePrint">
      <TfrxMemoView Name="Memo28" Left="404.4094537" Top="3.77953000000002" Width="173.85827504" Height="18.8976378" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" Frame.Typ="8" HAlign="haCenter" ParentFont="False" Text="[DO3Date]"/>
      <TfrxMemoView Name="Memo2" Left="0" Top="3.77953000000002" Width="351.49610205" Height="18.8976378" OnBeforePrint="Memo2OnBeforePrint" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" Frame.Typ="8" ParentFont="False" Text="[Tex_t]"/>
      <TfrxMemoView Name="Memo27" Left="600.94489165" Top="3.77953000000002" Width="468.66141732" Height="18.8976378" OnBeforePrint="Memo27OnBeforePrint" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="3" Frame.Typ="8" ParentFont="False" Text="[sStoreKeeper]"/>
      <TfrxMemoView Name="Memo47" Left="404.40944638" Top="26.45669535" Width="173.85831654" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="(дата)"/>
      <TfrxMemoView Name="Memo56" Left="600.94527244" Top="26.45669535" Width="468.66141732" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="(подпись, инициалы, фамилия и должность уполномоченного работника склада)"/>
      <TfrxShapeView Name="Shape2" Left="873.07086858" Top="37.79527803" Width="75.59055118" Height="75.59055118" Frame.Color="536870912" Frame.Style="fsDot" Shape="skEllipse"/>
      <TfrxMemoView Name="Memo39" Left="774.80365244" Top="68.0314985000001" Width="294.80314472" Height="18.8976378" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Times New Roman" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="печать для таможенных целей склада"/>
    </TfrxPageFooter>
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="7" Left="0" Top="18.89765" Width="1069.60699" OnBeforePrint="ReportTitle1OnBeforePrint"/>
    <TfrxMasterData Name="MasterData2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18" Left="0" Top="366.61441" Width="1069.60699" OnBeforePrint="MasterData2OnBeforePrint" AllowSplit="True" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="MainQuery" DataSetName="MainQuery" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo15" Left="22.67716535" Top="0" Width="41.57480559" Height="18" OnBeforePrint="Memo15OnBeforePrint" StretchMode="smMaxHeight" DisplayFormat.FormatStr="DD.MM.YYY HH:MM" DisplayFormat.Kind="fkDateTime" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[vBegKeep]"/>
      <TfrxMemoView Name="Memo32" Left="2.929E-5" Top="0" Width="22.67716535" Height="18" OnBeforePrint="Memo32OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[vNumLine]"/>
      <TfrxMemoView Name="Memo57" Left="64.25197094" Top="0" Width="56.69291339" Height="18" OnBeforePrint="Memo57OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[nuv]"/>
      <TfrxMemoView Name="Memo70" Left="151.181102362205" Top="0" Width="94.488188976378" Height="18" OnBeforePrint="Memo70OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="11" ParentFont="False" Text="[nG312]"/>
      <TfrxMemoView Name="Memo72" Left="480.00000244" Top="0" Width="45.35433071" Height="18" OnBeforePrint="Memo72OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[nG33]"/>
      <TfrxMemoView Name="Memo76" Left="525.35433315" Top="0" Width="52.91338827" Height="18" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[nG42]"/>
      <TfrxMemoView Name="Memo78" Left="404.40945126" Top="0" Width="30.23622047" Height="18" OnBeforePrint="Memo78OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[vG311]"/>
      <TfrxMemoView Name="Memo86" Left="903.30709882" Top="0" Width="166.44094" Height="18" OnBeforePrint="Memo86OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[vReleaseDoc]"/>
      <TfrxMemoView Name="Memo88" Left="774.80315937" Top="0" Width="30.23622047" Height="18" OnBeforePrint="Memo88OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[vrG311]"/>
      <TfrxMemoView Name="Memo92" Left="850.39371055" Top="0" Width="52.91338827" Height="18" OnBeforePrint="Memo92OnBeforePrint" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[vrG42]"/>
      <TfrxMemoView Name="Memo55" Left="721.88977354" Top="0" Width="52.91338583" Height="18" OnBeforePrint="Memo55OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[vOutdate]"/>
      <TfrxMemoView Name="Memo46" Left="434.64567173" Top="0" Width="45.35433071" Height="18" OnBeforePrint="Memo46OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[vG35]"/>
      <TfrxMemoView Name="Memo54" Left="578.26772142" Top="0" Width="22.67716535" Height="18" OnBeforePrint="Memo54OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[sValBukCode]"/>
      <TfrxMemoView Name="Memo19" Left="805.03937984" Top="0" Width="45.35433071" Height="18" OnBeforePrint="Memo19OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[vrG35]"/>
      <TfrxMemoView Name="Memo10" Left="120.944881889764" Top="0" Width="30.2362204724409" Height="18" OnBeforePrint="Memo10OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[nG32]"/>
      <TfrxMemoView Name="Memo66" Left="245.66929134" Top="0" Width="105.82677165" Height="18" OnBeforePrint="Memo66OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[TransDocNames]"/>
      <TfrxMemoView Name="Memo68" Left="351.49606543" Top="0" Width="52.91338583" Height="18" OnBeforePrint="Memo68OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[sStoreNum]"/>
      <TfrxMemoView Name="Memo38" Left="600.94488677" Top="0" Width="71.81102362" Height="18" OnBeforePrint="Memo38OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[vG082]"/>
      <TfrxMemoView Name="Memo73" Left="672.75591039" Top="0" Width="49.13386315" Height="18" OnBeforePrint="Memo73OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="11" HAlign="haCenter" ParentFont="False" Text="[vBegKeep1]"/>
    </TfrxMasterData>
    <TfrxFooter Name="Footer1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="21.77953" Left="0" Top="408.18924" Width="1069.60699" OnBeforePrint="Footer1OnBeforePrint">
      <TfrxMemoView Name="Memo64" Left="0" Top="0" Width="404.40944882" Height="18" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="Итого :  "/>
      <TfrxMemoView Name="Memo65" Left="480.00000244" Top="0" Width="45.35433071" Height="18" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo67" Left="525.35433315" Top="0" Width="52.91338827" Height="18" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[IIF(vPrintG42, FORMATFLOAT('0.##',sInG42),' ')]"/>
      <TfrxMemoView Name="Memo74" Left="404.40945126" Top="0" Width="30.23622047" Height="18" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[FORMATFLOAT('0.##',sInG311)]"/>
      <TfrxMemoView Name="Memo75" Left="903.30709882" Top="0" Width="166.44094" Height="18" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo77" Left="774.80315937" Top="0" Width="30.23622047" Height="18" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[FORMATFLOAT('0.##',sOutG311)]"/>
      <TfrxMemoView Name="Memo79" Left="850.39371055" Top="0" Width="52.91338827" Height="18" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" HideZeros="True" ParentFont="False" VAlign="vaCenter" Text="[IIF(vPrintG42, FORMATFLOAT('0.##',sOutG42),' ')]"/>
      <TfrxMemoView Name="Memo80" Left="434.64567173" Top="0" Width="45.35433071" Height="18" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[IIF(vprintG35, sInG35,' ')]"/>
      <TfrxMemoView Name="Memo81" Left="578.26772142" Top="0" Width="22.67716535" Height="18" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[IIF(vprintG42, IIF(vprintUSDG42, 'USD', IIF(vprintEurG42,'EUR', IIF(vPrintRubG42,'РУБ',' '))),' ')]"/>
      <TfrxMemoView Name="Memo82" Left="805.03937984" Top="0" Width="45.35433071" Height="18" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[IIF(vprintG35, sOutG35,' ')]"/>
      <TfrxMemoView Name="Memo83" Left="600.94488677" Top="0" Width="173.8582726" Height="18" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
    </TfrxFooter>
  </TfrxReportPage>
</TfrxReport>
