<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.6.78" DotMatrixReport="False" EngineOptions.ConvertNulls="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="41134.6593134491" ReportOptions.Description.Text="" ReportOptions.LastChange="41135.5012149074" ScriptLanguage="PascalScript" ScriptText.Text="VAR&#13;&#10;qryMainSQL : string;&#13;&#10;vPlaceId : string;&#13;&#10;sIniFile : string;                                         &#13;&#10;&#13;&#10;procedure btnCallRefOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with btnCallRef, Engine do&#13;&#10;  begin&#13;&#10;    COMPUTE(' globalvar (&#34;strStoreNumLic&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;strStoreNum&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;strStoreName&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;strLicExt&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;sChief&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;sPlaceId&#34;,Integer)');&#13;&#10;    COMPUTE(' globalvar (&#34;sLicenceDate&#34;,DateTime)');&#13;&#10;    COMPUTE('OPENQUERY (&#34;Stors&#34;, &#34;STS_DB&#34;, &#34;Select * from STORES&#34;)');&#13;&#10;&#13;&#10;&#13;&#10;    IF COMPUTE('SelectRecords(&#34;Выбор складских площадок&#34;, &#34;STORS&#34;,'+&#13;&#10;                          '['+&#13;&#10;                           '[&#34;LICENCENO&#34;, &#34;№ лицензии&#34;, 12],'+ &#13;&#10;                           '[&#34;NAME&#34;, &#34;Название склада&#34;, 30]'+&#13;&#10;                           '],'+&#13;&#10;                           '&#34;STOR&#34;, &#34;&#34;, &#34;STS_DB&#34;)') = '1' then&#13;&#10;&#13;&#10;      begin      &#13;&#10;        COMPUTE('FIRST(&#34;STOR&#34;)');&#13;&#10;        fldStoreLicNum.Text := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;LICENCENO&#34;)');  //   номер  лиценцзии       &#13;&#10;        If COMPUTE('RECORDCOUNT(&#34;STOR&#34;)') &#60;&#62; '1' then begin          &#13;&#10;          While COMPUTE('EOF(&#34;STOR&#34;)') = 0 do begin&#13;&#10;            IF  vPlaceId = '' then&#13;&#10;                vPlaceId := STR(COMPUTE('FieldValue(&#34;Stor&#34;, &#34;PLACEID&#34;)'))&#13;&#10;              else                                                                                                 &#13;&#10;                vPlaceId := vPlaceId + ',' + STR(COMPUTE('FieldValue(&#34;Stor&#34;, &#34;PLACEID&#34;)'));                   &#13;&#10;            COMPUTE('NEXT(&#34;STOR&#34;)');  &#13;&#10;          end&#13;&#10;        end                  &#13;&#10;        else vPlaceId := STR(COMPUTE('FieldValue(&#34;Stor&#34;, &#34;PLACEID&#34;)'));&#13;&#10;      end;  &#13;&#10;  end&#13;&#10;end;    &#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;     &#13;&#10;  qryMainSQL := 'SELECT M.G082, T.CARNO, COUNT(C.ID) ';  &#13;&#10;  qryMainSQL := qryMainSQL + 'FROM KRD_MAIN M ';  &#13;&#10;  qryMainSQL := qryMainSQL + 'LEFT JOIN KRD_CONT C ON ((C.PLACEID = M.PLACEID) AND (C.ID = M.ID)) ';&#13;&#10;  qryMainSQL := qryMainSQL + 'LEFT JOIN KR_TRANS T ON ((T.PLACEID = M.PLACEID) AND (T.ID = M.ID)) ';      &#13;&#10;  qryMainSQL := qryMainSQL + 'LEFT JOIN RELEASE R ON ((R.PLACEID = M.PLACEID) AND (R.ID = M.ID)) ';&#13;&#10;  qryMainSQL := qryMainSQL + 'WHERE (M.PLACEID in ('+vPlaceid+')) AND (T.TRANSP_CODE = 10) AND ';   &#13;&#10;  qryMainSQL := qryMainSQL + ' AND ';       &#13;&#10;  qryMainSQL := qryMainSQL + ' ( ((M.BD_DATE &#62;= '+chr(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtFrom.Date) + chr(39)+') AND (M.BD_DATE &#60;= '+chr(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtTo.Date) + chr(39)+') )OR ';    &#13;&#10;  qryMainSQL := qryMainSQL + '   ( ';     &#13;&#10;  qryMainSQL := qryMainSQL + '     (R.ID is NOT NULL) AND ';&#13;&#10;  qryMainSQL := qryMainSQL + '     (R.RELEASE_DATE &#62;= '+chr(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtFrom.Date) + chr(39)+') AND (R.RELEASE_DATE &#60;= '+chr(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtTo.Date) + chr(39)+') ';                 &#13;&#10;  qryMainSQL := qryMainSQL + '   ) ';      &#13;&#10;  qryMainSQL := qryMainSQL + ' ) ';     &#13;&#10;  qryMainSQL := qryMainSQL + 'GROUP BY M.G082, M.AUTHOR';&#13;&#10;  //showmessage(qryMainSQL);                                &#13;&#10;  qryMain.Active := False;                                                          &#13;&#10;  qryMain.SQL.Text := '';&#13;&#10;  qryMain.SQL.Text := qryMainSQL;&#13;&#10;  qryMain.Active := True;      &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   dtFrom.Date := STRTODATEDEF(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;&#34;)'), DATE);&#13;&#10;   dtTo.Date := STRTODATEDEF(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;&#34;)'), DATE);  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure BitBtn1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  sIniFile := COMPUTE('INCLUDETRAILINGBACKSLASH(&#34;'+ProgramPath+'&#34;)')+'sts.ini';&#13;&#10;  Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PlaceIdFor&#34;,&#34;'+DATETOSTR(dtFrom.Date)+'&#34;,&#34;'+sIniFile+'&#34;)');      &#13;&#10;  Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;'+DATETOSTR(dtFrom.Date)+'&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;  Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;'+DateToStr(dtTo.Date)+'&#34;,&#34;'+sIniFile+'&#34;)');  &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." PropData="08446174617365747301010C2D00000020446174615365743D2264735F4B52445F4D41494E2220446174615365744E616D653D224B52445F4D41494E2200010C2800000020446174615365743D227172794D61696E2220446174615365744E616D653D227172794D61696E220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxBDEQuery Name="qryMain" UserName="qryMain" CloseDataSource="True" FieldAliases.Text="" OpenDataSource="False" IgnoreDupParams="False" SQL.Text="select M.G082, T.CARNO, COUNT(M.ID)&#13;&#10;from krd_main M      &#13;&#10;LEFT JOIN KR_TRANS T ON ((T.PLACEID = M.PLACEID) AND (T.ID = M.ID))    &#13;&#10;where placeid = 1                                     &#13;&#10;group BY M.G082, T.CARNO" DatabaseName="STS_DB" SessionName="Default" PropData="05704C65667402540470546F70020C0A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="0" RightMargin="0" TopMargin="0" BottomMargin="0" ColumnWidth="0" ColumnPositions.Text="" EndlessWidth="True" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False" OnBeforePrint="Page1OnBeforePrint">
    <TfrxDBCrossView Name="DBCross1" Left="30.23624" Top="49.13389" Width="239" Height="126" ShowHint="False" AddHeight="0" AddWidth="0" DownThenAcross="False" NextCrossGap="0" CellFields.Text="COUNT OF ID" ColumnFields.Text="CARNO" DataSet="qryMain" DataSetName="qryMain" RowFields.Text="G082" PropData="054D656D6F730AAD1100003C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D227574662D38223F3E3C63726F73733E3C63656C6C6D656D6F733E3C546672784D656D6F56696577204C6566743D223134332E32333632342220546F703D223131322E3133333839222057696474683D22363222204865696768743D22323122205265737472696374696F6E733D223234222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D2268615269676874222056416C69676E3D22766143656E7465722220546578743D2230222F3E3C546672784D656D6F56696577204C6566743D223134332E32333632342220546F703D223133332E3133333839222057696474683D22363222204865696768743D22323222205265737472696374696F6E733D223234222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D2268615269676874222056416C69676E3D22766143656E7465722220546578743D2230222F3E3C546672784D656D6F56696577204C6566743D223230352E32333632342220546F703D223131322E3133333839222057696474683D22343422204865696768743D22323122205265737472696374696F6E733D223234222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D2268615269676874222056416C69676E3D22766143656E7465722220546578743D2230222F3E3C546672784D656D6F56696577204C6566743D223230352E32333632342220546F703D223133332E3133333839222057696474683D22343422204865696768743D22323222205265737472696374696F6E733D223234222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D2268615269676874222056416C69676E3D22766143656E7465722220546578743D2230222F3E3C546672784D656D6F56696577204C6566743D223138302220546F703D223634222057696474683D22343422204865696768743D22323122205265737472696374696F6E733D223234222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D2268615269676874222056416C69676E3D22766143656E7465722220546578743D2230222F3E3C546672784D656D6F56696577204C6566743D223138302220546F703D223835222057696474683D22343422204865696768743D22323222205265737472696374696F6E733D223234222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D2268615269676874222056416C69676E3D22766143656E7465722220546578743D2230222F3E3C2F63656C6C6D656D6F733E3C63656C6C6865616465726D656D6F733E3C546672784D656D6F56696577204C6566743D2238312220546F703D223433222057696474683D22393322204865696768743D22323122205265737472696374696F6E733D2238222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222056416C69676E3D22766143656E7465722220546578743D22434F554E54204F46204944222F3E3C546672784D656D6F56696577204C6566743D2238312220546F703D223634222057696474683D22393322204865696768743D22323122205265737472696374696F6E733D2238222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222056416C69676E3D22766143656E7465722220546578743D22434F554E54204F46204944222F3E3C546672784D656D6F56696577204C6566743D22302220546F703D2230222057696474683D223022204865696768743D223022205265737472696374696F6E733D2238222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222056416C69676E3D22766143656E7465722220546578743D22222F3E3C2F63656C6C6865616465726D656D6F733E3C636F6C756D6E6D656D6F733E3C546672784D656D6F56696577204C6566743D223134332E32333632342220546F703D2239302E3133333839222057696474683D22363222204865696768743D22323222205265737472696374696F6E733D223234222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D22686143656E746572222056416C69676E3D22766143656E7465722220546578743D22222F3E3C546672784D656D6F56696577204C6566743D2238302220546F703D223432222057696474683D22363222204865696768743D22323222205265737472696374696F6E733D223234222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D22686143656E746572222056416C69676E3D22766143656E7465722220546578743D22222F3E3C2F636F6C756D6E6D656D6F733E3C636F6C756D6E746F74616C6D656D6F733E3C546672784D656D6F56696577204C6566743D223230352E32333632342220546F703D2239302E3133333839222057696474683D22343422204865696768743D22323222205265737472696374696F6E733D2238222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C73652220466F6E742E436861727365743D223230342220466F6E742E436F6C6F723D22302220466F6E742E4865696768743D222D31332220466F6E742E4E616D653D22417269616C2220466F6E742E5374796C653D223122204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D22686143656E7465722220506172656E74466F6E743D2246616C7365222056416C69676E3D22766143656E7465722220546578743D22D098D182D0BED0B3D0BE222F3E3C546672784D656D6F56696577204C6566743D223134322220546F703D223432222057696474683D22333822204865696768743D22323222205265737472696374696F6E733D2238222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C73652220466F6E742E436861727365743D223230342220466F6E742E436F6C6F723D22302220466F6E742E4865696768743D222D31332220466F6E742E4E616D653D22417269616C2220466F6E742E5374796C653D223122204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D22686143656E7465722220506172656E74466F6E743D2246616C7365222056416C69676E3D22766143656E7465722220546578743D22546F74616C222F3E3C2F636F6C756D6E746F74616C6D656D6F733E3C636F726E65726D656D6F733E3C546672784D656D6F56696577204C6566743D2235302E32333632342220546F703D2236392E3133333839222057696474683D22393322204865696768743D22323122205265737472696374696F6E733D2238222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D22686143656E746572222056416C69676E3D22766143656E7465722220546578743D22434F554E54204F46204944222F3E3C546672784D656D6F56696577204C6566743D223134332E32333632342220546F703D2236392E3133333839222057696474683D2231303622204865696768743D22323122205265737472696374696F6E733D2238222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D22686143656E746572222056416C69676E3D22766143656E7465722220546578743D224341524E4F222F3E3C546672784D656D6F56696577204C6566743D22302220546F703D2230222057696474683D2232303022204865696768743D223022205265737472696374696F6E733D2238222056697369626C653D2246616C7365222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D22686143656E746572222056416C69676E3D22766143656E7465722220546578743D22222F3E3C546672784D656D6F56696577204C6566743D2235302E32333632342220546F703D2239302E3133333839222057696474683D22393322204865696768743D22323222205265737472696374696F6E733D2238222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D22686143656E746572222056416C69676E3D22766143656E7465722220546578743D2247303832222F3E3C2F636F726E65726D656D6F733E3C726F776D656D6F733E3C546672784D656D6F56696577204C6566743D2235302E32333632342220546F703D223131322E3133333839222057696474683D22393322204865696768743D22323122205265737472696374696F6E733D223234222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C736522204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D22686143656E746572222056416C69676E3D22766143656E7465722220546578743D22222F3E3C2F726F776D656D6F733E3C726F77746F74616C6D656D6F733E3C546672784D656D6F56696577204C6566743D2235302E32333632342220546F703D223133332E3133333839222057696474683D22393322204865696768743D22323222205265737472696374696F6E733D2238222053686F7748696E743D2246616C73652220416C6C6F7745787072657373696F6E733D2246616C73652220466F6E742E436861727365743D223230342220466F6E742E436F6C6F723D22302220466F6E742E4865696768743D222D31332220466F6E742E4E616D653D22417269616C2220466F6E742E5374796C653D223122204672616D652E5479703D2231352220476170583D22332220476170593D2233222048416C69676E3D22686143656E7465722220506172656E74466F6E743D2246616C7365222056416C69676E3D22766143656E7465722220546578743D22D098D182D0BED0B3D0BE222F3E3C2F726F77746F74616C6D656D6F733E3C63656C6C66756E6374696F6E733E3C6974656D20312F3E3C2F63656C6C66756E6374696F6E733E3C636F6C756D6E736F72743E3C6974656D20302F3E3C6974656D20302F3E3C2F636F6C756D6E736F72743E3C726F77736F72743E3C6974656D20302F3E3C2F726F77736F72743E3C2F63726F73733E"/>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="241" Left="488" Top="125" Width="306" OnActivate="DialogPage1OnActivate">
    <TfrxBitBtnControl Name="BitBtn1" Left="116" Top="172" Width="75" Height="25" ShowHint="True" Caption="ОК" ModalResult="1" OnClick="BitBtn1OnClick"/>
    <TfrxBitBtnControl Name="BitBtn2" Left="204" Top="172" Width="75" Height="25" ShowHint="True" Caption="Отмена" ModalResult="2"/>
    <TfrxColorFrameControl Name="ColorFrame10" Left="12" Top="0" Width="268" Height="56" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Место хранения" Color="-16777201"/>
    <TfrxEditControl Name="fldStoreLicNum" Left="130.45679012" Top="23.75" Width="132.17283951" Height="19.95" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxLabelControl Name="lblNumLicence" Left="24.4691358" Top="27.55" Width="81.04938272" Height="12.35" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="№ лицензии:" Color="-16777201"/>
    <TfrxColorFrameControl Name="ColorFrame1" Left="12" Top="64" Width="268" Height="92" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="За период" Color="-16777201"/>
    <TfrxDateEditControl Name="dtTo" Left="124" Top="124" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="41135" Time="41135"/>
    <TfrxLabelControl Name="Label2" Left="24" Top="124" Width="16" Height="16" ShowHint="True" AutoSize="False" Caption="По" Color="-16777201"/>
    <TfrxButtonControl Name="btnCallRef" Left="236" Top="24" Width="24" Height="18" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" OnClick="btnCallRefOnBeforePrint"/>
    <TfrxDateEditControl Name="dtFrom" Left="124" Top="88" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="41135" Time="41135"/>
    <TfrxLabelControl Name="Label3" Left="24" Top="92" Width="16" Height="16" ShowHint="True" AutoSize="False" Caption="С" Color="-16777201"/>
  </TfrxDialogPage>
</TfrxReport>
