<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.6.78" DotMatrixReport="False" EngineOptions.ConvertNulls="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40822.5728167824" ReportOptions.Description.Text="" ReportOptions.LastChange="40822.7197718982" ScriptLanguage="PascalScript" ScriptText.Text="Var&#13;&#10;sSQL : string;                                       &#13;&#10;iRestG35 : double;&#13;&#10;iG35 : double;&#13;&#10;iInG35 : double;    &#13;&#10;iCount : double;  &#13;&#10;  &#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; // COMPUTE('OPENQUERY(&#34;TNVED&#34;, &#34;STS_DB&#34;, &#34;SELECT DISTINCT(SUBSTRING(G33, 4, LEN(G33))) FROM KRD_COMM&#34;)');&#13;&#10; //sSql := 'SELECT G33 as G33  FROM KRD_COMM ORDER BY G33';   &#13;&#10; sSql := 'SELECT DISTINCT(G33) as G33  FROM KRD_COMM ORDER BY G33';&#13;&#10; qryTNVED.Active := False;&#13;&#10; qryTNVED.SQL.TEXT := '';&#13;&#10; qryTNVED.SQL.TEXT := sSQL;&#13;&#10; qryTNVED.Active := True;     &#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('OPENQUERY(&#34;TN&#34;, &#34;STS_DB&#34;, &#34;SELECT SUM(G35) as G35 FROM KRD_COMM WHERE SUBSTRING(G33 from 1 for 4) = ' + chr(39) + &#60;qryTNVED.&#34;G33&#34;&#62; + chr(39) +'&#34;)');&#13;&#10;  iG35 := COMPUTE('FIELDVALUE(&#34;TN&#34;, &#34;G35&#34;)');                            &#13;&#10;  COMPUTE('OPENQUERY(&#34;REST&#34;, &#34;STS_DB&#34;, &#34;SELECT SUM(KC.G35) as InG35, SUM(RC.RELEASE_G35) as Rest ' +     &#13;&#10;                               'FROM ' +&#13;&#10;                               ' KRD_COMM KC LEFT JOIN REL_COMM RC ON ((KC.PLACEID = RC.PLACEID) AND (KC.ID = RC.ID) AND (KC.G32 = RC.G32)) '+                                       &#13;&#10;                               'WHERE ' +&#13;&#10;                               ' SUBSTRING(G33 from 1 for 4) = ' + chr(39) + &#60;qryTNVED.&#34;G33&#34;&#62; + chr(39) + '&#34;)');                           &#13;&#10;                               //' GROUP BY KC.G35, RC.RELEASE_G35 ' +                                                                                                                                  &#13;&#10;                               //' AND (SUM(KC.G35) &#62; SUM(RC.RELEASE_G35)) &#34;)');&#13;&#10;  COMPUTE('OPENQUERY(&#34;Cou&#34;, &#34;STS_DB&#34;, &#34;SELECT M.NBD as Counter, SUM(KC.G35) as G35, SUM(RC.RELEASE_G35) as RELEASE.G35 ' +     &#13;&#10;                             'FROM ' +&#13;&#10;                             ' KRD_COMM KC LEFT JOIN KRD_MAIN M ON ((KC.PLACEID = M.PLACEID) AND (KC.ID = M.ID))'+&#13;&#10;                             '  LEFT JOIN REL_COMM RC ON ((KC.PLACEID = RC.PLACEID) AND (KC.ID = RC.ID) AND (KC.G32 = RC.G32))  '+                                                                &#13;&#10;                             'WHERE ' +&#13;&#10;                             ' SUBSTRING(KC.G33 from 1 for 4) = ' + chr(39) + &#60;qryTNVED.&#34;G33&#34;&#62; + chr(39) +&#13;&#10;                             ' GROUP BY M.NBD, G35, RELEASE_G35 ' +                                                                                                                       &#13;&#10;                             ' HAVING ' +  &#13;&#10;                             ' (SUM(KC.G35) - SUM(RC.RELEASE_G35)) &#62; 0 &#34;)');&#13;&#10;  iCount := COMPUTE('RECORDCOUNT (&#34;Cou&#34;)');                                                     &#13;&#10;  showmessage('SELECT COUNT(M.PLACEID) as Counter ' +     &#13;&#10;                             'FROM ' +&#13;&#10;                             ' KRD_COMM KC LEFT JOIN REL_COMM RC ON ((KC.PLACEID = RC.PLACEID) AND (KC.ID = RC.ID) AND (KC.G32 = RC.G32)) '+&#13;&#10;                             ' LEFT JOIN KRD_MAIN M ON ((KC.PLACEID = M.PLACEID) AND (KC.ID = M.ID)) '+                                                                &#13;&#10;                             'WHERE ' +&#13;&#10;                             ' SUBSTRING(KC.G33 from 1 for 4) = ' + chr(39) + &#60;qryTNVED.&#34;G33&#34;&#62; + chr(39) + '&#34;)');                           &#13;&#10;                             //' GROUP BY M.NBD ' +                                                                                                                                  &#13;&#10;                             //' AND (KC.G35 &#62; RC.RELEASE_G35) ');                                                             &#13;&#10;                                 &#13;&#10;  iRestG35 := COMPUTE('FIELDVALUE(&#34;REST&#34;, &#34;Rest&#34;)');&#13;&#10;  iInG35 :=  COMPUTE('FIELDVALUE(&#34;REST&#34;, &#34;InG35&#34;)');&#13;&#10;  //iCount :=  COMPUTE('FIELDVALUE(&#34;Cou&#34;, &#34;Counter&#34;)');                            &#13;&#10; {if iRestG35 = 0 then&#13;&#10;   MasterData1.Visible := False&#13;&#10; else&#13;&#10;   MasterData1.Visible := True;}                           &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." PropData="08446174617365747301010C2A00000020446174615365743D22717279544E5645442220446174615365744E616D653D22717279544E564544220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxBDEQuery Name="qryTNVED" UserName="qryTNVED" CloseDataSource="True" FieldAliases.Text="" IgnoreDupParams="False" SQL.Text="Select * from KRD_COMM                                                  " DatabaseName="STS_DB" SessionName="Default" PropData="05704C65667402300470546F7002100A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="0" RightMargin="0" TopMargin="0" BottomMargin="0" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Height="18.89765" Left="0" Top="18.89765" Width="793.7013" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="qryTNVED" DataSetName="qryTNVED" RowCount="0">
      <TfrxMemoView Name="qryTNVEDG33" Left="0" Top="0" Width="253.22851" Height="18.89765" ShowHint="False" DataSet="qryTNVED" DataSetName="qryTNVED" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[qryTNVED.&#34;G33&#34;]"/>
      <TfrxMemoView Name="Memo1" ShiftMode="smWhenOverlapped" Left="449.76407" Top="0" Width="162.51979" Height="18.89765" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[iRestG35]"/>
      <TfrxMemoView Name="Memo2" ShiftMode="smWhenOverlapped" Left="253.22851" Top="0" Width="124.72449" Height="18.89765" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[iG35]"/>
      <TfrxMemoView Name="Memo3" ShiftMode="smWhenOverlapped" Left="377.953" Top="0" Width="71.81107" Height="18.89765" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[iInG35]"/>
      <TfrxMemoView Name="Memo4" ShiftMode="smWhenOverlapped" Left="612.28386" Top="0" Width="181.41744" Height="18.89765" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[iCount]"/>
    </TfrxMasterData>
  </TfrxReportPage>
</TfrxReport>
