<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.6.78" DotMatrixReport="False" EngineOptions.ConvertNulls="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.Author="Алексей Нерченко" ReportOptions.CreateDate="40960.5116099306" ReportOptions.Description.Text="По заказу ved@cosmos2.ru от 21.02.2012" ReportOptions.Name="Отчет по выбранным ДО1" ReportOptions.LastChange="40968.5312109028" ScriptLanguage="PascalScript" ScriptText.Text="VAR&#13;&#10;sNBD, sRemark, sCMR, sCMRDate, sTir, sTirDate, sNTransp, sNCont, sPaperNames, sPaperCodes : string;&#13;&#10;sPLACEID, sID : string;&#13;&#10;dBD_DATE : date;                                    &#13;&#10;&#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; COMPUTE('OPENQUERY(&#34;QRYREFPAPERS&#34;, &#34;STS_DB&#34;, &#34;SELECT PAPER_DOCG44_CODE, PAPERNAME ' + &#13;&#10;                                           'FROM PAPERS ' + &#13;&#10;                                           'WHERE PAPER_IS_WAYBILL = 1&#34;)');&#13;&#10; sPaperNames := chr(39)+  COMPUTE('JOINVALUES(&#34;QRYREFPAPERS&#34;, &#34;'+CHR(39)+','+chr(39)+'&#34;, [&#34;PAPERNAME&#34;])') +chr(39)+;&#13;&#10; sPaperCodes :=  chr(39)+ COMPUTE('JOINVALUES(&#34;QRYREFPAPERS&#34;, &#34;'+CHR(39)+','+chr(39)+'&#34;, [&#34;PAPER_DOCG44_CODE&#34;])') +chr(39)+;                                   &#13;&#10; COMPUTE('CLOSEDATASET(&#34;QRYREFPAPERS&#34;)');                              &#13;&#10; COMPUTE('GETSELECTEDDOCS(&#34;QRYKRDMAIN2&#34;, &#34;PLACEID&#34;, &#34;ID&#34;, &#34;NBD&#34;, &#34;BD_DATE&#34;, &#34;ADDINFO&#34;)');                           &#13;&#10; MasterData1.RowCount := StrToInt(COMPUTE('RECORDCOUNT(&#34;QRYKRDMAIN2&#34;)'));&#13;&#10; COMPUTE('FIRST(&#34;QRYKRDMAIN2&#34;)');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  sPLACEID :=  COMPUTE('FIELDVALUE(&#34;QRYKRDMAIN2&#34;, &#34;PLACEID&#34;)');&#13;&#10;  sID :=  COMPUTE('FIELDVALUE(&#34;QRYKRDMAIN2&#34;, &#34;ID&#34;)');&#13;&#10;  sNBD := COMPUTE('FIELDVALUE(&#34;QRYKRDMAIN2&#34;, &#34;NBD&#34;)');&#13;&#10;  dBD_DATE := COMPUTE('FIELDVALUE(&#34;QRYKRDMAIN2&#34;, &#34;BD_DATE&#34;)');&#13;&#10;  sRemark := COMPUTE('FIELDVALUE(&#34;QRYKRDMAIN2&#34;, &#34;ADDINFO&#34;)');&#13;&#10;&#13;&#10;  // убрана проверка по коду - в некоторых документах коды заполнены криво - смотрим только на названия                                                                                                                                                                                                                                               &#13;&#10;  {COMPUTE('OPENQUERY(&#34;PAPERS&#34;, &#34;STS_DB&#34;, &#34; SELECT PAPERNO, PAPERDATE FROM KR_PAPER '+&#13;&#10;                                         ' WHERE '+&#13;&#10;                                         ' PLACEID= ' +sPLACEID+ ' AND ID= ' +sID+&#13;&#10;                                         ' AND ((PAPERNAME IN (' + sPaperNames +')) OR PAPERCODE IN ('+ sPaperCodes +'))&#34;)');}  &#13;&#10;&#13;&#10;  COMPUTE('OPENQUERY(&#34;PAPERS&#34;, &#34;STS_DB&#34;, &#34; SELECT PAPERNO, PAPERDATE FROM KR_PAPER '+&#13;&#10;                                         ' WHERE '+&#13;&#10;                                         ' PLACEID= ' +sPLACEID+ ' AND ID= ' +sID+&#13;&#10;                                         ' AND (PAPERNAME IN (' + sPaperNames +')) &#34;)');&#13;&#10;    &#13;&#10;  sCMR :=  COMPUTE('UNIONVALUES(&#34;PAPERS&#34;, [&#34;PAPERNO&#34;], &#34;, &#34;, &#34; : &#34;)');&#13;&#10;  sCMRDate := COMPUTE('UNIONVALUES(&#34;PAPERS&#34;, [&#34;PAPERDATE&#34;], &#34;, &#34;, &#34; : &#34;)');&#13;&#10;    &#13;&#10;  //sCMR :=  COMPUTE('JOINVALUES(&#34;PAPERS&#34;, &#34;, &#34;, [&#34;PAPERNO&#34;])');&#13;&#10;  //sCMRDate := COMPUTE('JOINVALUES(&#34;PAPERS&#34;, &#34;, &#34;, [&#34;PAPERDATE&#34;])');&#13;&#10;      &#13;&#10;  COMPUTE('CLOSEDATASET(&#34;PAPERS&#34;)');                        &#13;&#10;  &#13;&#10;  COMPUTE('SETRANGE(&#34;KRD_DCD_2&#34;, [&#34;' + sPLACEID + '&#34;, &#34;' +&#13;&#10;                                          sID + '&#34;])');&#13;&#10;  //COMPUTE('FIRST(&#34;KRD_DCD_2&#34;)');&#13;&#10;  sTir :=  COMPUTE('UNIONVALUES(&#34;KRD_DCD_2&#34;, [&#34;PAPERNO&#34;], &#34;, &#34;, &#34; : &#34;)');&#13;&#10;  sTirDate :=  COMPUTE('UNIONVALUES(&#34;KRD_DCD_2&#34;, [&#34;PAPERCLOSE&#34;], &#34;, &#34;, &#34; : &#34;)');      &#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_DCD_2&#34;)');  &#13;&#10;  &#13;&#10;  COMPUTE('SETRANGE(&#34;KRD_TRANSP_2&#34;, [&#34;' + sPLACEID + '&#34;, &#34;' +&#13;&#10;                                          sID + '&#34;])');&#13;&#10;  //COMPUTE('FIRST(&#34;KRD_TRANSP_2&#34;)');&#13;&#10;  sNTransp :=  COMPUTE('UNIONVALUES(&#34;KRD_TRANSP_2&#34;, [&#34;CARNO&#34;], &#34;, &#34;, &#34; : &#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_TRANSP_2&#34;)');    &#13;&#10;  &#13;&#10;  COMPUTE('SETRANGE(&#34;KRD_CONT_2&#34;, [&#34;' + sPLACEID + '&#34;, &#34;' +&#13;&#10;                                          sID + '&#34;])');&#13;&#10;  //COMPUTE('FIRST(&#34;KRD_CONT_2&#34;)');&#13;&#10;  sNCont :=  COMPUTE('UNIONVALUES(&#34;KRD_CONT_2&#34;, [&#34;CONTNO&#34;], &#34;, &#34;, &#34; : &#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_CONT_2&#34;)');      &#13;&#10;    &#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('NEXT(&#34;QRYKRDMAIN2&#34;)');  &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." PropData="08446174617365747301010C2D00000020446174615365743D2264735F4B52445F4D41494E2220446174615365744E616D653D224B52445F4D41494E2200010C3100000020446174615365743D2264735F4B52445F4D41494E5F322220446174615365744E616D653D224B52445F4D41494E5F32220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="500" PaperHeight="210" PaperSize="256" LeftMargin="0" RightMargin="0" TopMargin="0" BottomMargin="0" ColumnWidth="0" ColumnPositions.Text="" EndlessHeight="True" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Height="22.67718" Left="0" Top="117.16543" Width="1889.765" OnAfterPrint="MasterData1OnAfterPrint" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="ds_KRD_MAIN_2" DataSetName="KRD_MAIN_2" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo1" ShiftMode="smWhenOverlapped" Left="94.48825" Top="6.31439345255558E-16" Width="162.51979" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[sNBD]"/>
      <TfrxMemoView Name="Memo2" ShiftMode="smWhenOverlapped" Left="257.00804" Top="0" Width="162.51979" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[FormatDateTime('DD.MM.YYYY', dBD_DATE)]"/>
      <TfrxMemoView Name="Memo3" ShiftMode="smWhenOverlapped" Left="419.52783" Top="0" Width="192.75603" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[sCMR]"/>
      <TfrxMemoView Name="Memo4" ShiftMode="smWhenOverlapped" Left="612.28386" Top="6.31439345255558E-16" Width="162.51979" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[sCMRDate]"/>
      <TfrxMemoView Name="Memo15" ShiftMode="smWhenOverlapped" Left="0" Top="6.31439345255558E-16" Width="94.48825" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Line#]"/>
      <TfrxMemoView Name="Memo16" ShiftMode="smWhenOverlapped" Left="774.80365" Top="6.31439345255558E-16" Width="192.75603" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[sTIR]"/>
      <TfrxMemoView Name="Memo17" ShiftMode="smWhenOverlapped" Left="967.55968" Top="6.31439345255558E-16" Width="196.53556" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[sTIRDate]"/>
      <TfrxMemoView Name="Memo18" ShiftMode="smWhenOverlapped" Left="1164.09524" Top="6.31439345255558E-16" Width="204.09462" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[sNTransp]"/>
      <TfrxMemoView Name="Memo19" ShiftMode="smWhenOverlapped" Left="1368.18986" Top="6.31439345255558E-16" Width="204.09462" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[sNCont]"/>
      <TfrxMemoView Name="Memo20" ShiftMode="smWhenOverlapped" Left="1572.28448" Top="6.31439345255558E-16" Width="317.48052" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[sRemark]"/>
    </TfrxMasterData>
    <TfrxReportTitle Name="ReportTitle1" Height="37.7953" Left="0" Top="18.89765" Width="1889.765">
      <TfrxMemoView Name="Memo5" ShiftMode="smWhenOverlapped" Left="0" Top="-1.27328703136698E-15" Width="94.48825" Height="37.7953" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– Рї\Рї"/>
      <TfrxMemoView Name="Memo6" ShiftMode="smWhenOverlapped" Left="94.48825" Top="-1.27328703136698E-15" Width="162.51979" Height="37.7953" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– Р”Рћ1"/>
      <TfrxMemoView Name="Memo7" ShiftMode="smWhenOverlapped" Left="257.00804" Top="-1.27328703136698E-15" Width="162.51979" Height="37.7953" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р° Р”Рћ1"/>
      <TfrxMemoView Name="Memo8" ShiftMode="smWhenOverlapped" Left="419.52783" Top="-1.27328703136698E-15" Width="192.75603" Height="37.7953" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– РЅР°РєР»Р°РґРЅРѕР№"/>
      <TfrxMemoView Name="Memo9" ShiftMode="smWhenOverlapped" Left="612.28386" Top="-1.27328703136698E-15" Width="162.51979" Height="37.7953" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р° РЅР°РєР»Р°РґРЅРѕР№"/>
      <TfrxMemoView Name="Memo10" ShiftMode="smWhenOverlapped" Left="774.80365" Top="-1.27328703136698E-15" Width="192.75603" Height="37.7953" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– С‚СЂР°РЅР·РёС‚РЅРѕР№ РґРµРєР»Р°СЂР°С†РёРё"/>
      <TfrxMemoView Name="Memo11" ShiftMode="smWhenOverlapped" Left="967.55968" Top="-1.27328703136698E-15" Width="196.53556" Height="37.7953" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р° С‚СЂР°РЅР·РёС‚РЅРѕР№ РґРµРєР»Р°СЂР°С†РёРё"/>
      <TfrxMemoView Name="Memo12" ShiftMode="smWhenOverlapped" Left="1164.09524" Top="-1.27328703136698E-15" Width="204.09462" Height="37.7953" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– РўРЎ"/>
      <TfrxMemoView Name="Memo13" ShiftMode="smWhenOverlapped" Left="1368.18986" Top="-1.27328703136698E-15" Width="204.09462" Height="37.7953" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– РєРѕРЅС‚РµР№РЅРµСЂР° "/>
      <TfrxMemoView Name="Memo14" ShiftMode="smWhenOverlapped" Left="1572.28448" Top="-1.27328703136698E-15" Width="317.48052" Height="37.7953" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”РѕРї. СЃРІРµРґРµРЅРёСЏ"/>
    </TfrxReportTitle>
  </TfrxReportPage>
</TfrxReport>
