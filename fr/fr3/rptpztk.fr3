<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.5.33" DotMatrixReport="False" EngineOptions.ConvertNulls="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38262.653972662" ReportOptions.Description.Text="" ReportOptions.Name="Периодический отчет ПЗТК" ReportOptions.LastChange="39541.682549213" ScriptLanguage="PascalScript" ScriptText.Text="Var&#13;&#10;  vPlaceId: Integer;&#13;&#10;  DateStart, DateEnd: TDateTime;&#13;&#10;  //Кол-ва на начало периода&#13;&#10;  vStartG311, vStartG315C: Extended;&#13;&#10;  //Кол-ва на конец периода&#13;&#10;  vEndG311, vEndG315C: Extended;&#13;&#10;  //Приход за период&#13;&#10;  vInG311, vInG315C: Extended;&#13;&#10;  //Расход за период&#13;&#10;  vOutG311, vOutG315C: Extended;&#13;&#10;  //Приход до начала периода&#13;&#10;  vStartInG311, vStartInG315C: Extended;&#13;&#10;  //Расход до начала периода&#13;&#10;  vStartOutG311, vStartOutG315C: Extended;&#13;&#10;  //Выражение фильтра&#13;&#10;  vFilterCrit: String;&#13;&#10;  //Кол-во по ПЗТК на начало периода&#13;&#10;  vStartG311PZTKSum, vStartG315CPZTKSum: Extended;&#13;&#10;  //Приход по ПЗТК за период&#13;&#10;  vInG311PZTKSum, vInG315CPZTKSum: Extended;&#13;&#10;  //Расход по ПЗТК за период&#13;&#10;  vOutG311PZTKSum, vOutG315CPZTKSum: Extended;&#13;&#10;  //Кол-во на конец периода по ПЗТК&#13;&#10;  vEndG311PZTKSum, vEndG315CPZTKSum: Extended;&#13;&#10;  //Кол-во по поставщику на начало периода&#13;&#10;  vStartG311SenderSum, vStartG315CSenderSum: Extended;&#13;&#10;  //Приход по поставщику за период&#13;&#10;  vInG311SenderSum, vInG315CSenderSum: Extended;&#13;&#10;  //Расход по поставщику за период&#13;&#10;  vOutG311SenderSum, vOutG315CSenderSum: Extended;&#13;&#10;  //Кол-во на конец периода по поставщику&#13;&#10;  vEndG311SenderSum, vEndG315CSenderSum: Extended;&#13;&#10;&#13;&#10;  vChief, vCustName, vCustCode, vCN :String;&#13;&#10;  dtPeriodEnd, dtPeriodStart, vLicenceDate:TDateTime;&#13;&#10;  vLineCnt, i : Integer;&#13;&#10;&#13;&#10;procedure SetTblFilter(TTable: TfrxBDETable; sFilter: String);&#13;&#10;begin&#13;&#10;  With TTable do begin&#13;&#10;    Active := False;&#13;&#10;    Filter := sFilter;&#13;&#10;    Filtered := True;&#13;&#10;    Active := True;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Page1, Engine do begin&#13;&#10;    DateStart := StrToDateDef(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;&#34;)'), Date);&#13;&#10;    DateEnd := StrToDateDef(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;&#34;)'), Date);&#13;&#10;    dtFrom.Date := DateStart;&#13;&#10;    dtTo.Date := DateEnd;&#13;&#10;&#13;&#10;    vPlaceId := StrToInt(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;1&#34;)'));&#13;&#10;    If COMPUTE('FINDKEY(&#34;STORES_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;])') then begin&#13;&#10;       fldStoreLic.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;       fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;       fldStoreNm.Text := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;       fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;       vChief :=  &#60;STORES_2.&#34;CHIEF&#34;&#62; ;&#13;&#10;       vLicenceDate := &#60;STORES_2.&#34;LICENCEDATE&#34;&#62;;&#13;&#10;       btnOk.Enabled := True;&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      vPlaceId:=StrToInt(COMPUTE('INIFILE(&#34;WorkPlace&#34;,&#34;PlaceNum&#34;,&#34;&#34;)'));&#13;&#10;      If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;])') then begin&#13;&#10;        fldStoreLic.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62;;      //   номер лицензии&#13;&#10;        fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62;; //   номер склада&#13;&#10;        fldStoreNm.Text := &#60;STORES_2.&#34;NAME&#34;&#62;;     //   название склада&#13;&#10;        fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;        vChief:=  &#60;STORES_2.&#34;CHIEF&#34;&#62; ;&#13;&#10;        vLicenceDate := &#60;STORES_2.&#34;LICENCEDATE&#34;&#62;;&#13;&#10;        btnOk.Enabled := True;&#13;&#10;      end&#13;&#10;      else begin&#13;&#10;        btnOk.Enabled := False;&#13;&#10;      end&#13;&#10;    end;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ColorButton1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with ColorButton1, Engine do begin&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreNumLic&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreNum&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreName&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreAddress&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strLicExt&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;sPlaceId&#34;,Integer)');&#13;&#10;    COMPUTE('OPENQUERY(&#34;Stors&#34;, &#34;STS_DB&#34;, &#34;Select * from STORES&#34;)');&#13;&#10;    COMPUTE('SELECTVALUES (&#34;Список складов&#34;, &#34;Stors&#34;, ' +&#13;&#10;                 '[[&#34;LICENCENO&#34;,   &#34;Номер лицензии&#34;, 15], ' +&#13;&#10;                  '[&#34;LICENCEDATE&#34;,   &#34;Дата лицензии&#34;, 15], ' +&#13;&#10;                  '[&#34;LICENCENO_EXT&#34;,   &#34; &#34;, 1], ' +&#13;&#10;                  '[&#34;STORE_NO&#34;,   &#34;Номер склада&#34;, 15], ' +&#13;&#10;                  '[&#34;NAME&#34;,   &#34;Название склада&#34;, 30], ' +&#13;&#10;                  '[&#34;PLACEID&#34;,   &#34;&#34;, 10], ' +&#13;&#10;                  '[&#34;ADDRESS&#34;, &#34;Адрес склада&#34;, 30]], ' +&#13;&#10;                 '[[&#34;LICENCENO&#34;, &#34;strStoreNumLic&#34;], ' +&#13;&#10;                  '[&#34;STORE_NO&#34;, &#34;strStoreNum&#34;], ' +&#13;&#10;                  '[&#34;NAME&#34;, &#34;strStoreName&#34;], ' +&#13;&#10;                  '[&#34;LICENCENO_EXT&#34;, &#34;strLicExt&#34;], ' +&#13;&#10;                  '[&#34;PLACEID&#34;, &#34;sPlaceId&#34;], ' +&#13;&#10;                  '[&#34;ADDRESS&#34;, &#34;strStoreAddress&#34;]], ' +&#13;&#10;                  '&#34;&#34;, &#34;STS_DB&#34;)');&#13;&#10;    fldStoreLic.Text := COMPUTE('Value(&#34;strStoreNumLic&#34;)');  //   номер  лиценцзии&#13;&#10;    fldStoreNum.Text := '№ склада: ' + COMPUTE('Value(&#34;strStoreNum&#34;)') ; //   номер склада&#13;&#10;    fldStoreNm.Text := COMPUTE('Value(&#34;strStoreName&#34;)') ;     //   название склада&#13;&#10;    fldLicExt.Text := COMPUTE('Value(&#34;strLIcExt&#34;)');     //   Признак перерегистрации&#13;&#10;    vPlaceId := StrToInt(COMPUTE('Value(&#34;sPlaceId&#34;)'));&#13;&#10;    COMPUTE('FINDKEY(&#34;STORES_2&#34;, [&#34;' + IntToStr(vPlaceid) + '&#34;])');&#13;&#10;    If FormatDateTime('DD.MM.YYYY', &#60;STORES_2.&#34;LICENCEDATE&#34;&#62;)  &#60;&#62; '..' then begin&#13;&#10;      btnOK.Enabled := True;&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      MessageDlg('Заполните дату выдачи лицензии в &#34;Информации о складе&#34;!',0,0,0);&#13;&#10;      btnOK.Enabled := False;&#13;&#10;    end&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure btnOkOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with btnOk, Engine do begin&#13;&#10;    //Далее см. Params к таблицам&#13;&#10;    dtPeriodEnd := dtTo.Date + STRTOTIME('23:59:59');&#13;&#10;    dtPeriodStart := dtFrom.Date + STRTOTIME('00:00:01');&#13;&#10;&#13;&#10;    //Активируем главный запрос&#13;&#10;    qryOrgsMain.Active := True;&#13;&#10;    qryComms.Active := True;&#13;&#10;&#13;&#10;    //сохраняем настройки&#13;&#10;    Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;' + FormatDateTime('DD.MM.YYYY', dtFROM.Date) + '&#34;)');&#13;&#10;    Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;' + FormatDateTime('DD.MM.YYYY', dtTo.Date) + '&#34;)');&#13;&#10;    Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;' + IntToStr(vPlaceId) + '&#34;)');&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with MasterData1, Engine do begin&#13;&#10;    vStartG311SenderSum := 0;&#13;&#10;    vStartG315CSenderSum := 0;&#13;&#10;    vInG311SenderSum := 0;&#13;&#10;    vInG315CSenderSum := 0;&#13;&#10;    vOutG311SenderSum := 0;&#13;&#10;    vOutG315CSenderSum := 0;&#13;&#10;    vEndG311SenderSum := 0;&#13;&#10;    vEndG315CSenderSum := 0;&#13;&#10;    vLineCnt := 0;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ReportTitle1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with ReportTitle1, Engine do begin&#13;&#10;    vStartG311PZTKSum := 0;&#13;&#10;    vStartG315CPZTKSum := 0;&#13;&#10;    vInG311PZTKSum := 0;&#13;&#10;    vInG315CPZTKSum := 0;&#13;&#10;    vOutG311PZTKSum := 0;&#13;&#10;    vOutG315CPZTKSum := 0;&#13;&#10;    vEndG311PZTKSum := 0;&#13;&#10;    vEndG315CPZTKSum := 0;&#13;&#10;    vLineCnt := 0;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DetailData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with DetailData1, Engine do begin&#13;&#10;    //Кол-ва на начало периода&#13;&#10;    vStartG311 := 0; vStartG315C := 0;&#13;&#10;    //Кол-ва на конец периода&#13;&#10;    vEndG311 := 0; vEndG315C := 0;&#13;&#10;    //Приход за период&#13;&#10;    vInG311 := 0; vInG315C := 0;&#13;&#10;    //Расход за период&#13;&#10;    vOutG311 := 0; vOutG315C := 0;&#13;&#10;    //Приход до начала периода&#13;&#10;    vStartInG311 := 0; vStartInG315C := 0;&#13;&#10;    //Расход до начала периода&#13;&#10;    vStartOutG311 := 0; vStartOutG315C := 0;&#13;&#10;&#13;&#10;    //Поставим фильтры&#13;&#10;    COMPUTE('SETFILTER(&#34;KRD_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;    //KRD_MAIN_2&#13;&#10;    vFilterCrit := 'PLACEID=' + Chr(39) + IntToStr(&#60;qryComms.&#34;PLACEID&#34;&#62;) + Chr(39) +&#13;&#10;                   ' AND ID=' + Chr(39) + IntToStr(&#60;qryComms.&#34;ID&#34;&#62;) + Chr(39);&#13;&#10;    COMPUTE('SETFILTER(&#34;KRD_MAIN_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;    //Пройдемся по KRD_MAIN_2&#13;&#10;    COMPUTE('FIRST(&#34;KRD_MAIN_2&#34;)');&#13;&#10;    while StrToInt(COMPUTE('EOF(&#34;KRD_MAIN_2&#34;)'))=0 do begin&#13;&#10;      //KRD_COMM_2&#13;&#10;      COMPUTE('SETFILTER(&#34;KRD_COMM_2&#34;, &#34;&#34;)');&#13;&#10;      //Составим выражение фильтра&#13;&#10;      vFilterCrit := 'PLACEID=' + CHR(39) + STR(&#60;KRD_MAIN_2.&#34;PLACEID&#34;&#62;) + CHR(39) +&#13;&#10;                ' AND ID=' + CHR(39) + STR(&#60;KRD_MAIN_2.&#34;ID&#34;&#62;) + CHR(39);&#13;&#10;      //Код ТНВЭД&#13;&#10;      if (&#60;qryComms.&#34;G33&#34;&#62; &#60;&#62; '') and (&#60;qryComms.&#34;G33&#34;&#62; &#60;&#62; NULL) then&#13;&#10;        vFilterCrit := vFilterCrit + ' AND G33=' + Chr(39) + &#60;qryComms.&#34;G33&#34;&#62; + Chr(39)&#13;&#10;      else vFilterCrit := vFilterCrit + ' AND G33 IS NULL';&#13;&#10;      //ГОСТ&#13;&#10;      if (VARTOSTR(&#60;qryComms.&#34;FORESTGOST&#34;&#62;) &#60;&#62; '') and (&#60;qryComms.&#34;FORESTGOST&#34;&#62; &#60;&#62; NULL)  then&#13;&#10;        vFilterCrit := vFilterCrit + ' AND FORESTGOST=' + Chr(39) + VARTOSTR(&#60;qryComms.&#34;FORESTGOST&#34;&#62;) + Chr(39)&#13;&#10;      else vFilterCrit := vFilterCrit + ' AND FORESTGOST IS NULL';&#13;&#10;      //Сорт&#13;&#10;      if (VARToStr(&#60;qryComms.&#34;FORESTSORT&#34;&#62;) &#60;&#62; '') and (&#60;qryComms.&#34;FORESTSORT&#34;&#62; &#60;&#62; NULL)  then&#13;&#10;        vFilterCrit := vFilterCrit + ' AND FORESTSORT=' + Chr(39) + VARToStr(&#60;qryComms.&#34;FORESTSORT&#34;&#62;) + Chr(39)&#13;&#10;      else vFilterCrit := vFilterCrit + ' AND FORESTSORT IS NULL';&#13;&#10;      //Длина&#13;&#10;      if (VarToStr(&#60;qryComms.&#34;FORESTLENGTH&#34;&#62;) &#60;&#62; '') and (&#60;qryComms.&#34;FORESTLENGTH&#34;&#62; &#60;&#62; NULL)  then&#13;&#10;        vFilterCrit := vFilterCrit + ' AND FORESTLENGTH=' + Chr(39) + VarToStr(&#60;qryComms.&#34;FORESTLENGTH&#34;&#62;) + Chr(39)&#13;&#10;      else vFilterCrit := vFilterCrit + ' AND FORESTLENGTH IS NULL';&#13;&#10;      //Диаметр&#13;&#10;      if (VARToStr(&#60;qryComms.&#34;FORESTDIAMETER&#34;&#62;) &#60;&#62; '') and (&#60;qryComms.&#34;FORESTDIAMETER&#34;&#62; &#60;&#62; NULL)  then&#13;&#10;        vFilterCrit := vFilterCrit + ' AND FORESTDIAMETER=' + Chr(39) + VARToStr(&#60;qryComms.&#34;FORESTDIAMETER&#34;&#62;) + Chr(39)&#13;&#10;      else vFilterCrit := vFilterCrit + ' AND FORESTDIAMETER IS NULL';&#13;&#10;&#13;&#10;      COMPUTE('SETFILTER(&#34;KRD_COMM_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;      //Пройдемся по KRD_COMM_2&#13;&#10;      COMPUTE('FIRST(&#34;KRD_COMM_2&#34;)');&#13;&#10;      while StrToInt(COMPUTE('EOF(&#34;KRD_COMM_2&#34;)'))=0 do begin&#13;&#10;        //KRD_CMAP_2(приход на начало периода)&#13;&#10;        SetTblfilter(tblCMAP, 'PLACEID=' + Chr(39) + IntToStr(&#60;KRD_MAIN_2.&#34;PLACEID&#34;&#62;) + Chr(39) +&#13;&#10;                              ' AND ID=' + Chr(39) + IntToStr(&#60;KRD_MAIN_2.&#34;ID&#34;&#62;) + Chr(39) +&#13;&#10;                             ' AND G32=' + Chr(39) + IntToStr(&#60;KRD_COMM_2.&#34;G32&#34;&#62;) + CHR(39));&#13;&#10;        //Пройдемся по KRD_CMAP_2&#13;&#10;        tblCMAP.First;&#13;&#10;        while tblCMAP.Eof = False do begin&#13;&#10;          //Приход до начала периода&#13;&#10;          if &#60;tblCmap.&#34;ACT_DATE&#34;&#62; &#60; dtPeriodStart then begin&#13;&#10;            vStartInG311 := vStartInG311 + IIF(&#60;tblCmap.&#34;G311&#34;&#62;=NULL,0,&#60;tblCmap.&#34;G311&#34;&#62;);&#13;&#10;            vStartInG315C := vStartInG315C + IIF(&#60;tblCmap.&#34;G315C&#34;&#62;=NULL,0,&#60;tblCmap.&#34;G315C&#34;&#62;);&#13;&#10;          end;&#13;&#10;&#13;&#10;          //Приход за период&#13;&#10;          if (&#60;tblCmap.&#34;ACT_DATE&#34;&#62; &#62;= dtPeriodStart) AND (&#60;tblCmap.&#34;ACT_DATE&#34;&#62; &#60;= dtPeriodEnd) then begin&#13;&#10;            vInG311 := vInG311 + IIF(&#60;tblCmap.&#34;G311&#34;&#62;=NULL,0,&#60;tblCmap.&#34;G311&#34;&#62;);&#13;&#10;            vInG315C := vInG315C + IIF(&#60;tblCmap.&#34;G315C&#34;&#62;=NULL,0,&#60;tblCmap.&#34;G315C&#34;&#62;);&#13;&#10;          end;&#13;&#10;          tblCMAP.Next;&#13;&#10;        end;&#13;&#10;&#13;&#10;        //REL_COMM_2(расход)&#13;&#10;        COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;&#34;)');&#13;&#10;        vFilterCrit := 'PLACEID=' + Chr(39) + IntToStr(&#60;KRD_MAIN_2.&#34;PLACEID&#34;&#62;) + Chr(39) +&#13;&#10;                      ' AND ID=' + Chr(39) + IntToStr(&#60;KRD_MAIN_2.&#34;ID&#34;&#62;) + Chr(39) +&#13;&#10;                      ' AND G32=' + Chr(39) + IntToStr(&#60;KRD_COMM_2.&#34;G32&#34;&#62;) + Chr(39);&#13;&#10;&#13;&#10;        COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;        //Пройдемся по REL_COMM_2&#13;&#10;        COMPUTE('FIRST(&#34;REL_COMM_2&#34;)');&#13;&#10;        while StrToInt(COMPUTE('EOF(&#34;REL_COMM_2&#34;)'))=0 do begin&#13;&#10;          COMPUTE('SETFILTER(&#34;REL_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;          vFilterCrit := 'PLACEID=' + Chr(39) + IntToStr(&#60;KRD_MAIN_2.&#34;PLACEID&#34;&#62;) + Chr(39) +&#13;&#10;                         ' AND ID=' + Chr(39) + IntToStr(&#60;KRD_MAIN_2.&#34;ID&#34;&#62;) + Chr(39) +&#13;&#10;                    ' AND COUNTER=' + Chr(39) + IntToStr(&#60;REL_COMM_2.&#34;COUNTER&#34;&#62;) + Chr(39);&#13;&#10;          COMPUTE('SETFILTER(&#34;REL_MAIN_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;&#13;&#10;          //Расход до начала периода&#13;&#10;          if &#60;REL_MAIN_2.&#34;OUT_DATE&#34;&#62; &#60; dtPeriodStart then begin&#13;&#10;            vStartOutG311 := vStartOutG311 + IIF(&#60;REL_COMM_2.&#34;RELEASE_G311&#34;&#62;=NULL,0,&#60;REL_COMM_2.&#34;RELEASE_G311&#34;&#62;);&#13;&#10;            vStartOutG315C := vStartOutG315C + IIF(&#60;REL_COMM_2.&#34;RELEASE_G315C&#34;&#62;=NULL,0,&#60;REL_COMM_2.&#34;RELEASE_G315C&#34;&#62;);&#13;&#10;          end;&#13;&#10;&#13;&#10;          //Расход за период&#13;&#10;          if (&#60;REL_MAIN_2.&#34;OUT_DATE&#34;&#62; &#62;= dtPeriodStart) AND (&#60;REL_MAIN_2.&#34;OUT_DATE&#34;&#62; &#60;= dtPeriodEnd) then begin&#13;&#10;            vOutG311 := vOutG311 + IIF(&#60;REL_COMM_2.&#34;RELEASE_G311&#34;&#62;=NULL,0,&#60;REL_COMM_2.&#34;RELEASE_G311&#34;&#62;);&#13;&#10;            vOutG315C := vOutG315C + IIF(&#60;REL_COMM_2.&#34;RELEASE_G315C&#34;&#62;=NULL,0,&#60;REL_COMM_2.&#34;RELEASE_G315C&#34;&#62;);&#13;&#10;          end;&#13;&#10;          COMPUTE('NEXT(&#34;REL_COMM_2&#34;)');&#13;&#10;        end;&#13;&#10;&#13;&#10;        COMPUTE('NEXT(&#34;KRD_COMM_2&#34;)');&#13;&#10;      end;&#13;&#10;&#13;&#10;      COMPUTE('NEXT(&#34;KRD_MAIN_2&#34;)');&#13;&#10;    end;&#13;&#10;&#13;&#10;     //Кол-во на начало периода&#13;&#10;     vStartG311 := vStartInG311 - vStartOutG311;&#13;&#10;     vStartG315C := vStartInG315C - vStartOutG315C;&#13;&#10;&#13;&#10;     //Кол-во на конец периода&#13;&#10;     vEndG311 := (vStartG311 + vInG311) - vOutG311;&#13;&#10;     vEndG315C := (vStartG315C + vInG315C) - vOutG315C;&#13;&#10;&#13;&#10;     //Если в начале все было по нолям и ничего не пришло за период, то строку с товаром не показываем&#13;&#10;     if (vStartG311 &#60;= 0) AND (vInG311 &#60;= 0) AND&#13;&#10;        (StrToFloatDef(FormatFloat('#.###', vStartG315C), 0) &#60;= 0) AND (StrToFloatDef(FormatFloat('#.###', vInG315C), 0) &#60;= 0) then&#13;&#10;       DetailData1.Visible := False&#13;&#10;     else begin&#13;&#10;       vLineCnt := vLineCnt + 1;&#13;&#10;       DetailData1.Visible := True;&#13;&#10;     end;&#13;&#10;&#13;&#10;     //Считаем по поставщику&#13;&#10;     //Кол-во по поставщику на начало периода&#13;&#10;     vStartG311SenderSum := vStartG311SenderSum + vStartG311;&#13;&#10;     vStartG315CSenderSum := vStartG315CSenderSum + vStartG315C;&#13;&#10;&#13;&#10;     //Приход по поставщику за период&#13;&#10;     vInG311SenderSum := vInG311SenderSum + vInG311;&#13;&#10;     vInG315CSenderSum := vInG315CSenderSum + vInG315C;&#13;&#10;&#13;&#10;    //Расход по поставщику за период&#13;&#10;     vOutG311SenderSum := vOutG311SenderSum + vOutG311;&#13;&#10;     vOutG315CSenderSum := vOutG315CSenderSum + vOutG315C;&#13;&#10;&#13;&#10;    //Кол-во на конец периода по поставщику&#13;&#10;     vEndG311SenderSum := vEndG311SenderSum + vEndG311;&#13;&#10;     vEndG315CSenderSum := vEndG315CSenderSum + vEndG315C;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DetailFooter1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with DetailFooter1, Engine do begin&#13;&#10;    //Считаем по ПЗТК&#13;&#10;    //Кол-во по поставщику на начало периода&#13;&#10;    vStartG311PZTKSum := vStartG311PZTKSum + vStartG311SenderSum;&#13;&#10;    vStartG315CPZTKSum := vStartG315CPZTKSum + vStartG315CSenderSum;&#13;&#10;&#13;&#10;    //Приход по поставщику за период&#13;&#10;    vInG311PZTKSum := vInG311PZTKSum + vInG311SenderSum;&#13;&#10;    vInG315CPZTKSum := vInG315CPZTKSum + vInG315CSenderSum;&#13;&#10;&#13;&#10;   //Расход по поставщику за период&#13;&#10;    vOutG311PZTKSum := vOutG311PZTKSum + vOutG311SenderSum;&#13;&#10;    vOutG315CPZTKSum := vOutG315CPZTKSum + vOutG315CSenderSum;&#13;&#10;&#13;&#10;   //Кол-во на конец периода по поставщику&#13;&#10;    vEndG311PZTKSum := vEndG311PZTKSum + vEndG311SenderSum;&#13;&#10;    vEndG315CPZTKSum := vEndG315CPZTKSum + vEndG315CSenderSum;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ReportSummary1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with ReportSummary1, Engine do begin&#13;&#10;    COMPUTE('SETFILTER(&#34;KRD_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;    COMPUTE('SETFILTER(&#34;KRD_COMM_2&#34;, &#34;&#34;)');&#13;&#10;    COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;&#34;)');&#13;&#10;    COMPUTE('SETFILTER(&#34;REL_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;    SetTblFilter(tblCMAP, '');&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo45OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo45, Engine do begin&#13;&#10;    vCustName := &#34;&#34;; vCustCode := &#34;&#34;; vCN := &#34;&#34;;&#13;&#10;    i := 0;&#13;&#10;    vCustCode := Copy(&#60;STORES_2.&#34;CUSTOMS_CODE&#34;&#62;, 1, 5) + &#34;000&#34;;&#13;&#10;    vCustName := COMPUTE('REFERENCE(&#34;CUSTOMS&#34;, &#34;CUSTOMS_CODE&#34;, &#34;' + vCustCode + '&#34;, &#34;CUSTOMS_NAME&#34;)');&#13;&#10;    for i := 1 to Length(vCustName) do begin&#13;&#10;      vCN := vCN + Copy(vCustName,i,1);&#13;&#10;      if Rightcopy(vCN,2) = &#34;АЯ&#34; then vCN := Copy(vCN,1,LENGTH(vCN)-2) + &#34;ОЙ&#34;;&#13;&#10;    end;&#13;&#10;    vCustName := vCN;&#13;&#10;    if Rightcopy(vCustName,7) = &#34;ТАМОЖНЯ&#34; then vCustName := Copy(vCustName,1,LENGTH(vCustName)-8);&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="OnStartReport" PropData="08446174617365747301010C2D00000020446174615365743D2264735F53544F5245535F322220446174615365744E616D653D2253544F5245535F322200010C3100000020446174615365743D2264735F4B52445F4D41494E5F322220446174615365744E616D653D224B52445F4D41494E5F322200010C3100000020446174615365743D2264735F4B52445F434F4D4D5F322220446174615365744E616D653D224B52445F434F4D4D5F322200010C3100000020446174615365743D2264735F52454C5F4D41494E5F322220446174615365744E616D653D2252454C5F4D41494E5F322200010C3100000020446174615365743D2264735F52454C5F434F4D4D5F322220446174615365744E616D653D2252454C5F434F4D4D5F322200010C2A00000020446174615365743D22717279436F6D6D732220446174615365744E616D653D22717279436F6D6D732200010C3000000020446174615365743D227172794F5247534D61696E2220446174615365744E616D653D227172794F5247534D61696E2200010C2800000020446174615365743D2274626C436D61702220446174615365744E616D653D2274626C436D6170220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxBDEQuery Name="qryComms" UserName="qryComms" CloseDataSource="True" FieldAliases.Text="" Master="qryORGSMain" IgnoreDupParams="False" SQL.Text="SELECT DISTINCT&#13;&#10;   KC.G33, KC.FORESTGOST, KC.FORESTSORT, KC.FORESTLENGTH, KC.FORESTDIAMETER,&#13;&#10;   KC.PLACEID, KC.ID&#13;&#10;FROM KRD_COMM KC&#13;&#10;WHERE&#13;&#10;    KC.PLACEID = :PLACEID&#13;&#10;AND KC.ID = :ID&#13;&#10;ORDER BY&#13;&#10;   KC.G33, KC.FORESTGOST, KC.FORESTSORT, KC.FORESTLENGTH, KC.FORESTDIAMETER" DatabaseName="STS_DB" SessionName="Default" PropData="05704C656674023C0470546F7002140A506172616D657465727301010C24000000204E616D653D22504C4143454944222044617461547970653D226674496E74656765722200010C1F000000204E616D653D224944222044617461547970653D226674496E7465676572220000"/>
    <TfrxBDEQuery Name="qryORGSMain" UserName="qryORGSMain" CloseDataSource="True" FieldAliases.Text="PLACEID=PLACEID&#13;&#10;ID=ID&#13;&#10;G022=G022&#13;&#10;G023=G023" IgnoreDupParams="False" SQL.Text="SELECT KM.PLACEID,&#13;&#10;       KM.ID,&#13;&#10;       KM.G022,&#13;&#10;       KM.G023&#13;&#10;FROM KRD_MAIN KM&#13;&#10;WHERE KM.PLACEID = :PLACEID" DatabaseName="STS_DB" SessionName="Default" PropData="05704C656674027C0470546F7002140A506172616D657465727301010C3A000000204E616D653D22504C4143454944222044617461547970653D226674496E7465676572222045787072657373696F6E3D2276506C6163654964220000"/>
    <TfrxBDETable Name="tblCmap" UserName="tblCmap" CloseDataSource="True" FieldAliases.Text="" TableName="KRD_CMAP" DatabaseName="STS_DB" SessionName="Default" PropData="05704C65667403BC000470546F700214"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="Page1" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Отчет о движении товаров на ПЗТК" Height="152" Left="399" Top="173" Width="341" OnActivate="Page1OnBeforePrint">
    <TfrxColorEditControl Name="fldStoreLic" Left="112" Top="4" Width="121" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" ReadOnly="True"/>
    <TfrxColorButtonControl Name="ColorButton1" Left="201" Top="5" Width="31" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777216" Flat="False" GradientType="gtTopToBottom" OnClick="ColorButton1OnBeforePrint"/>
    <TfrxColorFrameControl Name="cfrmPeriod" Left="31" Top="52" Width="268" Height="36" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201"/>
    <TfrxColorEditControl Name="fldStoreNm" Left="96" Top="28" Width="229" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" ReadOnly="True"/>
    <TfrxColorEditControl Name="fldLicExt" Left="96" Top="4" Width="17" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" ReadOnly="True"/>
    <TfrxColorEditControl Name="fldStoreNum" Left="235" Top="4" Width="90" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" ReadOnly="True"/>
    <TfrxLabelControl Name="lblNumLicence" Left="28" Top="7" Width="65" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="№ лицензии:" Color="-16777201"/>
    <TfrxLabelControl Name="Label1" Left="40" Top="31" Width="53" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="Название:" Color="-16777201"/>
    <TfrxLabelControl Name="lblFrom" Left="39" Top="63" Width="11" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="С" Color="-16777201"/>
    <TfrxLabelControl Name="lblTo" Left="166" Top="64" Width="12" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="по" Color="-16777201"/>
    <TfrxDateEditControl Name="dtTo" Left="183" Top="60" Width="105" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38262" Time="38262"/>
    <TfrxDateEditControl Name="dtFrom" Left="51" Top="60" Width="109" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38262" Time="38262"/>
    <TfrxColorButtonControl Name="btnOk" Left="168" Top="96" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" Caption="Просмотр" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="1" OnClick="btnOkOnBeforePrint"/>
    <TfrxColorButtonControl Name="ColorButton2" Left="248" Top="96" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Отмена" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="2"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page2" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="8" RightMargin="8" TopMargin="7" BottomMargin="13" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False">
    <TfrxMasterData Name="MasterData1" Height="42" Left="0" Top="208" Width="1062.04793" OnBeforePrint="MasterData1OnBeforePrint" AllowSplit="True" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="qryORGSMain" DataSetName="qryORGSMain" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo4" Left="25" Top="6" Width="668" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" Frame.Typ="15" ParentFont="False" Text="Р­РєСЃРїРѕСЂС‚РµСЂ: [qryORGSMain.&#34;G022&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="25" Top="24" Width="668" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" Frame.Typ="15" ParentFont="False" Text="[qryORGSMain.&#34;G023&#34;]"/>
    </TfrxMasterData>
    <TfrxReportTitle Name="ReportTitle1" Height="86" Left="0" Top="20" Width="1062.04793" OnBeforePrint="ReportTitle1OnBeforePrint">
      <TfrxShapeView Name="Shape1" Left="28" Top="1" Width="568" Height="81" ShowHint="False"/>
      <TfrxMemoView Name="Memo37" Left="36" Top="65" Width="109" Height="14" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text="Рѕ СЃРѕР·РґР°РЅРёРё РџР—РўРљ РѕС‚"/>
      <TfrxMemoView Name="Memo38" Left="227" Top="64" Width="16" Height="14" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text="в„–"/>
      <TfrxMemoView Name="Memo43" Left="74" Top="7" Width="496" Height="14" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="8" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[STORES_2.&#34;NAME&#34;]"/>
      <TfrxMemoView Name="Memo111" Left="150" Top="65" Width="72" Height="14" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="8" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[FormatDateTime('DD.MM.YYYY', &#60;STORES_2.&#34;LICENCEDATE&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo112" Left="246" Top="64" Width="156" Height="14" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="8" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[STORES_2.&#34;LICENCENO&#34;]"/>
      <TfrxMemoView Name="Memo113" Left="35" Top="7" Width="35" Height="14" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџР—РўРљ"/>
      <TfrxMemoView Name="Memo44" Left="36" Top="45" Width="41" Height="15" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" ParentFont="False" Text="РџСЂРёРєР°Р·"/>
      <TfrxMemoView Name="Memo45" Left="80" Top="45" Width="210" Height="15" OnBeforePrint="Memo45OnBeforePrint" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="8" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vCustName]"/>
      <TfrxMemoView Name="Memo114" Left="292" Top="45" Width="68" Height="15" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" ParentFont="False" Text="С‚Р°РјРѕР¶РЅРё"/>
      <TfrxMemoView Name="Memo46" Left="74" Top="25" Width="496" Height="15" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="8" HAlign="haCenter" ParentFont="False" Text="[STORES_2.&#34;ADDRESS&#34;]"/>
    </TfrxReportTitle>
    <TfrxDetailData Name="DetailData1" Height="18" Left="0" Top="484" Width="1062.04793" OnBeforePrint="DetailData1OnBeforePrint" AllowSplit="True" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="qryComms" DataSetName="qryComms" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo2" Left="53" Top="0" Width="76" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[qryComms.&#34;G33&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="197" Top="0" Width="32" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[qryComms.&#34;FORESTSORT&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="129" Top="0" Width="68" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[qryComms.&#34;FORESTGOST&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="229" Top="0" Width="56" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[qryComms.&#34;FORESTLENGTH&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="285" Top="0" Width="56" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[qryComms.&#34;FORESTDIAMETER&#34;]"/>
      <TfrxMemoView Name="Memo65" Left="25" Top="0" Width="28" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[vLineCnt]"/>
      <TfrxMemoView Name="Memo14" Left="341" Top="0" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[vStartG311]"/>
      <TfrxMemoView Name="Memo15" Left="429" Top="0" Width="88" Height="18" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.3f" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" HAlign="haCenter" Text="[vStartG315C]"/>
      <TfrxMemoView Name="Memo16" Left="517" Top="0" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[vInG311]"/>
      <TfrxMemoView Name="Memo17" Left="605" Top="0" Width="88" Height="18" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.3f" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" HAlign="haCenter" Text="[vInG315C]"/>
      <TfrxMemoView Name="Memo20" Left="693" Top="0" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[vOutG311]"/>
      <TfrxMemoView Name="Memo21" Left="781" Top="0" Width="88" Height="18" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.3f" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" HAlign="haCenter" Text="[vOutG315C]"/>
      <TfrxMemoView Name="Memo22" Left="869" Top="0" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[vEndG311]"/>
      <TfrxMemoView Name="Memo23" Left="957" Top="0" Width="88" Height="18" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.3f" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" HAlign="haCenter" Text="[vEndG315C]"/>
    </TfrxDetailData>
    <TfrxPageHeader Name="PageHeader1" Height="54" Left="0" Top="132" Width="1062.04793">
      <TfrxMemoView Name="Memo7" Left="383" Top="4" Width="304" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="РћС‚С‡РµС‚ Рѕ РґРІРёР¶РµРЅРёРё С‚РѕРІР°СЂРѕРІ"/>
      <TfrxMemoView Name="Memo8" Left="327" Top="32" Width="416" Height="20" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="Р·Р° РїРµСЂРёРѕРґ СЃ [FORMATDATETIME(&#34;DD.MM.YYYY&#34;, dtPeriodStart)] РїРѕ [FORMATDATETIME(&#34;DD.MM.YYYY&#34;, dtPeriodEnd)]"/>
      <TfrxLineView Name="Line1" Left="28" Top="28" Width="1016" Height="0" ShowHint="False" Frame.Typ="4" Frame.Width="2"/>
    </TfrxPageHeader>
    <TfrxHeader Name="DetailHeader1" Height="36" Left="0" Top="428" Width="1062.04793" ReprintOnNewPage="True">
      <TfrxMemoView Name="Memo11" Left="25" Top="0" Width="316" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="РћРїРёСЃР°РЅРёРµ С‚РѕРІР°СЂРѕРІ"/>
      <TfrxMemoView Name="Memo12" Left="517" Top="0" Width="176" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="РџСЂРёС…РѕРґ Р·Р° РїРµСЂРёРѕРґ"/>
      <TfrxMemoView Name="Memo13" Left="693" Top="0" Width="176" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="Р Р°СЃС…РѕРґ Р·Р° РїРµСЂРёРѕРґ"/>
      <TfrxMemoView Name="Memo18" Left="341" Top="0" Width="176" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="РќР° РЅР°С‡Р°Р»Рѕ РїРµСЂРёРѕРґР°"/>
      <TfrxMemoView Name="Memo19" Left="869" Top="0" Width="176" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="РќР° РєРѕРЅРµС† РїРµСЂРёРѕРґР°"/>
      <TfrxMemoView Name="Memo24" Left="517" Top="18" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="РњРµСЃС‚"/>
      <TfrxMemoView Name="Memo25" Left="605" Top="18" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="РћР±СЉРµРј"/>
      <TfrxMemoView Name="Memo26" Left="693" Top="18" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="РњРµСЃС‚"/>
      <TfrxMemoView Name="Memo27" Left="781" Top="18" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="РћР±СЉРµРј"/>
      <TfrxMemoView Name="Memo28" Left="341" Top="18" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="РњРµСЃС‚"/>
      <TfrxMemoView Name="Memo29" Left="429" Top="18" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="РћР±СЉРµРј"/>
      <TfrxMemoView Name="Memo30" Left="869" Top="18" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="РњРµСЃС‚"/>
      <TfrxMemoView Name="Memo31" Left="957" Top="18" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="РћР±СЉРµРј"/>
      <TfrxMemoView Name="Memo32" Left="53" Top="18" Width="76" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РљРѕРґ РўРќР’Р­Р”"/>
      <TfrxMemoView Name="Memo33" Left="129" Top="18" Width="68" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Р“РћРЎРў"/>
      <TfrxMemoView Name="Memo34" Left="197" Top="18" Width="32" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РЎРѕСЂС‚"/>
      <TfrxMemoView Name="Memo35" Left="229" Top="18" Width="56" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Р”Р»РёРЅР°"/>
      <TfrxMemoView Name="Memo36" Left="285" Top="18" Width="56" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Р”РёР°РјРµС‚СЂ"/>
      <TfrxMemoView Name="Memo64" Left="25" Top="18" Width="28" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="в„–"/>
    </TfrxHeader>
    <TfrxFooter Name="DetailFooter1" Height="18" Left="0" Top="528" Width="1062.04793" OnBeforePrint="DetailFooter1OnBeforePrint">
      <TfrxMemoView Name="Memo55" Left="25" Top="0" Width="316" Height="18" ShowHint="False" Frame.Typ="15" Text="РС‚РѕРіРѕ РїРѕ СЌРєСЃРїРѕСЂС‚РµСЂСѓ:"/>
      <TfrxMemoView Name="Memo40" Left="341" Top="0" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[vStartG311SenderSum]"/>
      <TfrxMemoView Name="Memo41" Left="429" Top="0" Width="88" Height="18" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.3f" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" HAlign="haCenter" Text="[vStartG315CSenderSum]"/>
      <TfrxMemoView Name="Memo42" Left="517" Top="0" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[vInG311SenderSum]"/>
      <TfrxMemoView Name="Memo47" Left="605" Top="0" Width="88" Height="18" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.3f" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" HAlign="haCenter" Text="[vInG315CSenderSum]"/>
      <TfrxMemoView Name="Memo48" Left="693" Top="0" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[vOutG311SenderSum]"/>
      <TfrxMemoView Name="Memo49" Left="781" Top="0" Width="88" Height="18" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.3f" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" HAlign="haCenter" Text="[vOutG315CSenderSum]"/>
      <TfrxMemoView Name="Memo50" Left="869" Top="0" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[vEndG311SenderSum]"/>
      <TfrxMemoView Name="Memo51" Left="957" Top="0" Width="88" Height="18" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.3f" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" HAlign="haCenter" Text="[vEndG315CSenderSum]"/>
    </TfrxFooter>
    <TfrxFooter Name="MasterFooter1" Height="82" Left="0" Top="284" Width="1062.04793">
      <TfrxMemoView Name="Memo58" Left="25" Top="5" Width="316" Height="18" ShowHint="False" Frame.Typ="15" Text="РС‚РѕРіРѕ РїРѕ РџР—РўРљ:"/>
      <TfrxMemoView Name="Memo62" Left="28" Top="36" Width="184" Height="18" ShowHint="False" Text="Р СѓРєРѕРІРѕРґРёС‚РµР»СЊ РѕСЂРіР°РЅРёР·Р°С†РёРё:"/>
      <TfrxMemoView Name="Memo63" Left="212" Top="36" Width="328" Height="18" ShowHint="False" Frame.Typ="8" Text=""/>
      <TfrxMemoView Name="Memo66" Left="28" Top="60" Width="48" Height="18" ShowHint="False" Text="&#34;         &#34;"/>
      <TfrxMemoView Name="Memo52" Left="341" Top="5" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[vStartG311PZTKSum]"/>
      <TfrxMemoView Name="Memo53" Left="429" Top="5" Width="88" Height="18" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.3f" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" HAlign="haCenter" Text="[vStartG315CPZTKSum]"/>
      <TfrxMemoView Name="Memo54" Left="517" Top="5" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[vInG311PZTKSum]"/>
      <TfrxMemoView Name="Memo56" Left="605" Top="5" Width="88" Height="18" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.3f" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" HAlign="haCenter" Text="[vInG315CPZTKSum]"/>
      <TfrxMemoView Name="Memo57" Left="693" Top="5" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[vOutG311PZTKSum]"/>
      <TfrxMemoView Name="Memo59" Left="781" Top="5" Width="88" Height="18" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.3f" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" HAlign="haCenter" Text="[vOutG315CPZTKSum]"/>
      <TfrxMemoView Name="Memo60" Left="869" Top="5" Width="88" Height="18" ShowHint="False" Frame.Typ="15" HAlign="haCenter" Text="[vEndG311PZTKSum]"/>
      <TfrxMemoView Name="Memo61" Left="957" Top="5" Width="88" Height="18" ShowHint="False" DisplayFormat.DecimalSeparator="." DisplayFormat.FormatStr="%2.3f" DisplayFormat.Kind="fkNumeric" Frame.Typ="15" HAlign="haCenter" Text="[vEndG315CPZTKSum]"/>
      <TfrxMemoView Name="Memo39" Left="76" Top="60" Width="108" Height="18" ShowHint="False" Frame.Typ="8" Text=""/>
      <TfrxMemoView Name="Memo69" Left="184" Top="60" Width="28" Height="18" ShowHint="False" Text="200"/>
      <TfrxMemoView Name="Memo70" Left="212" Top="60" Width="16" Height="18" ShowHint="False" Frame.Typ="8" Text=""/>
      <TfrxMemoView Name="Memo71" Left="228" Top="60" Width="36" Height="18" ShowHint="False" Text="РіРѕРґР°"/>
    </TfrxFooter>
    <TfrxReportSummary Name="ReportSummary1" Height="0" Left="0" Top="572" Width="1062.04793" OnBeforePrint="ReportSummary1OnBeforePrint"/>
    <TfrxPageFooter Name="PageFooter1" Height="42" Left="0" Top="652" Width="1062.04793">
      <TfrxMemoView Name="Memo1" Left="853" Top="14" Width="188" Height="20" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="РЎС‚СЂР°РЅРёС†Р° [PAGE#]"/>
      <TfrxMemoView Name="Memo67" Left="29" Top="14" Width="213" Height="20" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" ParentFont="False" VAlign="vaCenter" Text="[FORMATDATETIME('DD/MM/YYYY HH:NN:SS', DATE + TIME)]"/>
      <TfrxMemoView Name="Memo68" Left="265" Top="14" Width="540" Height="20" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р’Р­Р”-РЎРєР»Р°Рґ CopyRight (C) РћРћРћ &#34;РЎРўРњ&#34;, 1996-[FORMATDATETIME(&#34;YYYY&#34;, DATE)]."/>
      <TfrxLineView Name="Line2" Left="27" Top="8" Width="1016" Height="0" ShowHint="False" Frame.Typ="4" Frame.Width="2"/>
    </TfrxPageFooter>
  </TfrxReportPage>
</TfrxReport>
