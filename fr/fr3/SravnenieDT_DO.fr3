<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.6.78" DotMatrixReport="False" EngineOptions.ConvertNulls="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="42101.4170042014" ReportOptions.Description.Text="" ReportOptions.Name="Сравнение ДТ с ДО2" ReportOptions.LastChange="42101.6649417245" ScriptLanguage="PascalScript" ScriptText.Text="VAR&#13;&#10;sDO_G35, sDO_G311, sDO_G42:string;&#13;&#10;sUV_G35, sUV_G311, sUV_G42:string;&#13;&#10;sResultText:string;                                            &#13;&#10;  &#13;&#10;procedure DialogPage1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  dtDateFrom.Date:=IncMonth(Date(),-3);&#13;&#10;  dtDateTo.Date:=Date();      &#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure btOkOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  qryUv.Params[0].Value:=dtDateFrom.Date;&#13;&#10;  qryUv.Params[1].Value:=dtDateTo.Date;&#13;&#10;  qryUv.Active:=true;                                          &#13;&#10;end;    &#13;&#10;&#13;&#10;procedure PaintedSilver;&#13;&#10;begin&#13;&#10;  Memo1.Color:=clSilver;&#13;&#10;  Memo2.Color:=clSilver;&#13;&#10;  Memo3.Color:=clSilver;&#13;&#10;  Memo4.Color:=clSilver;&#13;&#10;  Memo5.Color:=clSilver;&#13;&#10;  Memo6.Color:=clSilver;&#13;&#10;  Memo7.Color:=clSilver;&#13;&#10;  Memo8.Color:=clSilver;&#13;&#10;  Memo10.Color:=clSilver;&#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure PaintedFuchsia;&#13;&#10;begin&#13;&#10;  Memo1.Color:=clFuchsia;&#13;&#10;  Memo2.Color:=clFuchsia;&#13;&#10;  Memo3.Color:=clFuchsia;&#13;&#10;  Memo4.Color:=clFuchsia;&#13;&#10;  Memo5.Color:=clFuchsia;&#13;&#10;  Memo6.Color:=clFuchsia;&#13;&#10;  Memo7.Color:=clFuchsia;&#13;&#10;  Memo8.Color:=clFuchsia;&#13;&#10;  Memo10.Color:=clFuchsia;&#13;&#10;    &#13;&#10;end;    &#13;&#10;&#13;&#10;procedure PaintedNone;&#13;&#10;begin&#13;&#10;  Memo1.Color:=clNone;&#13;&#10;  Memo2.Color:=clNone;&#13;&#10;  Memo3.Color:=clNone;&#13;&#10;  Memo4.Color:=clNone;&#13;&#10;  Memo5.Color:=clNone;&#13;&#10;  Memo6.Color:=clNone;&#13;&#10;  Memo7.Color:=clNone;&#13;&#10;  Memo8.Color:=clNone;&#13;&#10;  Memo10.Color:=clNone;&#13;&#10;end;          &#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  sDO_G35:=''; sDO_G311:=''; sDO_G42:='';          &#13;&#10;  sUV_G35:=''; sUV_G311:=''; sUV_G42:='';&#13;&#10;                                       &#13;&#10;  sResultText := '';                             &#13;&#10;  {  &#13;&#10;  sUV_G35:=FORMATFLOAT('0.####',&#60;qryUV.&#34;UV_G35&#34;&#62;); &#13;&#10;  sUV_G311:=FORMATFLOAT('0.####',&#60;qryUV.&#34;UV_G311&#34;&#62;); &#13;&#10;  sUV_G42:=FORMATFLOAT('0.####',&#60;qryUV.&#34;UV_G42&#34;&#62;);&#13;&#10;  }                                                  &#13;&#10;  sUV_G35:=FORMATFLOAT('0.####',&#60;qryUV.&#34;SumBruttoVolQuantity&#34;&#62;); &#13;&#10;  sUV_G311:=FORMATFLOAT('0.####',&#60;qryUV.&#34;SumPlaceNumber&#34;&#62;); &#13;&#10;  sUV_G42:=FORMATFLOAT('0.####',&#60;qryUV.&#34;SumInvoiceCost&#34;&#62;);      &#13;&#10;  &#13;&#10;  COMPUTE('OPENQUERY(&#34;GET_DO2&#34;, &#34;STS_DB&#34;, &#34;SELECT MAX(ID) As ID, MIN(R.OUT_DATE) AS OUT_DATE, SUM(RC.RELEASE_G35) AS RELEASE_G35, '+&#13;&#10;                                          'SUM(RC.RELEASE_G311) AS RELEASE_G311, SUM(RC.RELEASE_G42) AS RELEASE_G42 '+&#13;&#10;                                          'FROM RELEASE R LEFT JOIN REL_COMM RC ON (RC.PLACEID=R.PLACEID AND R.ID=RC.ID AND R.COUNTER=RC.COUNTER) '+&#13;&#10;                                          'WHERE R.DOC_NO='+chr(39)+&#60;qryUV.&#34;PrDocumentNumber&#34;&#62;+chr(39)+&#13;&#10;                                          '&#34;)');&#13;&#10;  IF COMPUTE('GET_DO2.ID') &#60;&#62; 0 then&#13;&#10;  begin              &#13;&#10;                                         &#13;&#10;        sDO_G35:=FORMATFLOAT('0.####',COMPUTE(&#34;GET_DO2.RELEASE_G35&#34;));&#13;&#10;        sDO_G311:=FORMATFLOAT('0.####',COMPUTE(&#34;GET_DO2.RELEASE_G311&#34;)); &#13;&#10;        sDO_G42:=FORMATFLOAT('0.####',COMPUTE(&#34;GET_DO2.RELEASE_G42&#34;));&#13;&#10;      &#13;&#10;      &#13;&#10;        IF COMPUTE('GET_DO2.OUT_DATE') &#60; &#60;qryUV.&#34;PrDocumentDate&#34;&#62; then                                                 &#13;&#10;           begin&#13;&#10;                   &#13;&#10;             PaintedSilver;&#13;&#10;             Memo10.Color:=clRed;                                               &#13;&#10;             sResultText := 'Дата первого ДО2 меньше даты ДТ';                                    &#13;&#10;           end;&#13;&#10;             &#13;&#10;        IF sDO_G35&#60;&#62;sUV_G35 then&#13;&#10;           begin&#13;&#10;             IF (sResultText = '') then                 &#13;&#10;               PaintedSilver;&#13;&#10;             Memo2.Color:=clRed;&#13;&#10;             Memo3.Color:=clRed;                                               &#13;&#10;             sResultText := IIF(sResultText&#60;&#62;'',sResultText + ';','') + 'Вес';                                    &#13;&#10;           end;&#13;&#10;      &#13;&#10;        IF sDO_G42&#60;&#62;sUV_G42 then&#13;&#10;           begin&#13;&#10;             IF (sResultText = '') then                                                                                                                                                          &#13;&#10;               PaintedSilver;&#13;&#10;             Memo6.Color:=clRed;&#13;&#10;             Memo7.Color:=clRed;                                               &#13;&#10;             sResultText := IIF(sResultText&#60;&#62;'',sResultText + ';','') + 'Стоимость';                                    &#13;&#10;           end;&#13;&#10;      &#13;&#10;       { IF sDO_G42&#60;&#62;sUV_G42 then&#13;&#10;           begin&#13;&#10;             IF (sResultText = '') then  //Если осталась окраска от старой строчки&#13;&#10;               PaintedSilver;                 &#13;&#10;             Memo4.Color:=clRed;&#13;&#10;             Memo5.Color:=clRed;                                               &#13;&#10;             sResultText := IIF(sResultText&#60;&#62;'',sResultText + ';','') + 'Кол-во мест';                                    &#13;&#10;           end;  }               &#13;&#10;   end&#13;&#10;   else  begin&#13;&#10;     PaintedFuchsia;&#13;&#10;     sResultText := 'ДО2 не найдено'                                                          &#13;&#10;   end;             &#13;&#10;   IF (sResultText = '') and ((Memo1.Color=clFuchsia) or (Memo1.Color=clSilver)) then&#13;&#10;      PaintedNone;                                                  &#13;&#10;        &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." PropData="08446174617365747301010C2400000020446174615365743D2271727955762220446174615365744E616D653D227172795576220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxUNIQuery Name="qryUv" UserName="qryUv" Active="False" DatabaseName="dbJournals" Filtered="False" SQL.Text="Select &#13;&#10; JG.JOURNAL_MASTER_ID,&#13;&#10; JG.PrDocumentDate, JG.PrDocumentNumber, JG.SumPlaceNumber, JG.SumInvoiceCost, &#13;&#10; JG.SumBruttoVolQuantity,&#13;&#10; SUM(GI.PLACENUMBER) AS UV_G311, SUM(GI.BRUTTOVOLQUANTITY) AS UV_G35, &#13;&#10; SUM(GI.INVOICECOST) AS UV_G42 &#13;&#10;FROM &#13;&#10;  JrGoodOut2  as JG &#13;&#10;     LEFT JOIN GOODINFO2 AS GI &#13;&#10;       ON (JG.JOURNAL_MASTER_ID=GI.JOURNAL_MASTER_ID)&#13;&#10;WHERE  JG.PrDocumentDate&#62;=:DateFrom And JG.PrDocumentDate&#60;=:DateTo&#13;&#10;GROUP BY &#13;&#10;   JG.JOURNAL_MASTER_ID,&#13;&#10;   JG.PrDocumentDate, JG.PrDocumentNumber, JG.SumPlaceNumber, JG.SumInvoiceCost, &#13;&#10;   JG.SumBruttoVolQuantity&#13;&#10;ORDER BY JG.PrDocumentDate, JG.JOURNAL_MASTER_ID" PropData="05704C65667402580470546F7002200A506172616D657465727301010C26000000204E616D653D224461746546726F6D222044617461547970653D2266744461746554696D652200010C24000000204E616D653D2244617465546F222044617461547970653D2266744461746554696D65220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Caption="Период отчета" Height="155" Left="445" Top="121" Width="409" OnActivate="DialogPage1OnActivate">
    <TfrxDateEditControl Name="dtDateFrom" Left="40" Top="24" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="42101" Time="42101"/>
    <TfrxDateEditControl Name="dtDateTo" Left="232" Top="24" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="42101" Time="42101"/>
    <TfrxButtonControl Name="btOk" Left="180" Top="84" Width="75" Height="25" ShowHint="True" Caption="OK" ModalResult="1" OnClick="btOkOnClick"/>
    <TfrxButtonControl Name="btCancel" Left="272" Top="84" Width="107" Height="25" ShowHint="True" Caption="Cancel" ModalResult="2"/>
    <TfrxLabelControl Name="Label1" Left="20" Top="28" Width="16" Height="16" ShowHint="True" AutoSize="False" Caption="C" Color="-16777201"/>
    <TfrxLabelControl Name="Label2" Left="200" Top="29" Width="16" Height="16" ShowHint="True" AutoSize="False" Caption="по" Color="-16777201"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="279.4" PaperHeight="215.9" PaperSize="1" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Height="18.89765" Left="0" Top="124.72449" Width="980.410082" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="qryUv" DataSetName="qryUv" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo1" ShiftMode="smWhenOverlapped" Left="7.55906" Top="0" Width="200.31509" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[&#60;qryUv.&#34;PrDocumentNumber&#34;&#62;]"/>
      <TfrxMemoView Name="Memo2" ShiftMode="smWhenOverlapped" Left="385.51206" Top="0" Width="71.81107" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[sDO_G35]"/>
      <TfrxMemoView Name="Memo3" ShiftMode="smWhenOverlapped" Left="313.70099" Top="0" Width="71.81107" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[sUV_G35]"/>
      <TfrxMemoView Name="Memo4" ShiftMode="smWhenOverlapped" Left="672.75634" Top="0" Width="71.81107" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[sDO_G311]"/>
      <TfrxMemoView Name="Memo5" ShiftMode="smWhenOverlapped" Left="600.94527" Top="0" Width="71.81107" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[sUV_G311]"/>
      <TfrxMemoView Name="Memo6" ShiftMode="smWhenOverlapped" Left="529.1342" Top="0" Width="71.81107" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[sDO_G42]"/>
      <TfrxMemoView Name="Memo7" ShiftMode="smWhenOverlapped" Left="457.32313" Top="0" Width="71.81107" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[sUV_G42]"/>
      <TfrxMemoView Name="Memo8" ShiftMode="smWhenOverlapped" Left="744.56741" Top="0" Width="230.55133" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[sResultText]"/>
      <TfrxMemoView Name="Memo10" ShiftMode="smWhenOverlapped" Left="207.87415" Top="0" Width="105.82684" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[&#60;qryUv.&#34;PrDocumentDate&#34;&#62;]"/>
    </TfrxMasterData>
    <TfrxReportTitle Name="ReportTitle1" Height="45.35436" Left="0" Top="18.89765" Width="980.410082">
      <TfrxMemoView Name="Memo11" ShiftMode="smWhenOverlapped" Left="7.55906" Top="0" Width="200.31509" Height="45.35436" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„– Р”Рў"/>
      <TfrxMemoView Name="Memo12" ShiftMode="smWhenOverlapped" Left="207.87415" Top="0" Width="105.82684" Height="45.35436" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р° Р”Рў"/>
      <TfrxMemoView Name="Memo13" ShiftMode="smWhenOverlapped" Left="313.70099" Top="0" Width="143.62214" Height="22.67718" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р’РµСЃ"/>
      <TfrxMemoView Name="Memo14" ShiftMode="smWhenOverlapped" Left="313.70099" Top="22.67718" Width="71.81107" Height="22.67718" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Рў"/>
      <TfrxMemoView Name="Memo15" ShiftMode="smWhenOverlapped" Left="385.51206" Top="22.67718" Width="71.81107" Height="22.67718" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Рћ"/>
      <TfrxMemoView Name="Memo9" ShiftMode="smWhenOverlapped" Left="457.32313" Top="0" Width="143.62214" Height="22.67718" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎС‚РѕРёРјРѕСЃС‚СЊ"/>
      <TfrxMemoView Name="Memo16" ShiftMode="smWhenOverlapped" Left="457.32313" Top="22.67718" Width="71.81107" Height="22.67718" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Рў"/>
      <TfrxMemoView Name="Memo17" ShiftMode="smWhenOverlapped" Left="529.1342" Top="22.67718" Width="71.81107" Height="22.67718" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Рћ"/>
      <TfrxMemoView Name="Memo18" ShiftMode="smWhenOverlapped" Left="600.94527" Top="0" Width="143.62214" Height="22.67718" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РњРµСЃС‚"/>
      <TfrxMemoView Name="Memo19" ShiftMode="smWhenOverlapped" Left="600.94527" Top="22.67718" Width="71.81107" Height="22.67718" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Рў"/>
      <TfrxMemoView Name="Memo20" ShiftMode="smWhenOverlapped" Left="672.75634" Top="22.67718" Width="71.81107" Height="22.67718" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Рћ"/>
      <TfrxMemoView Name="Memo21" ShiftMode="smWhenOverlapped" Left="744.56741" Top="0" Width="230.55133" Height="45.35436" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р§С‚Рѕ РЅРµ СЃРѕРІРїР°Р»Рѕ"/>
    </TfrxReportTitle>
  </TfrxReportPage>
</TfrxReport>
