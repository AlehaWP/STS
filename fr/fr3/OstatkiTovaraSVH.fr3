<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.6.78" DotMatrixReport="False" EngineOptions.ConvertNulls="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Ïî óìîë÷àíèþ" PrintOptions.PrintOnSheet="0" ReportOptions.Author="Àëåêñåé Íåð÷åíêî" ReportOptions.CreateDate="40875.6458553819" ReportOptions.Description.Text="" ReportOptions.Name="Îñòàòêè òîâàðîâ íà ÑÂÕ ñ ãðóïïèðîâêîé ïî ïëîùàäêàì" ReportOptions.LastChange="41114.5760932407" ScriptLanguage="PascalScript" ScriptText.Text="VAR&#13;&#10;qryMainSQL, qryStoresSQL, sIniFile : string;&#13;&#10;vNBD, sPapers, sTransp, vRelNo, sReleaseText, vG312, vCod, sPaperNames, sPaperCodes, sDocNames: string;&#13;&#10;vPlaceId : integer;&#13;&#10;vSumG35, vSumG42, vSumG311 : Double;                                                   &#13;&#10;vOst_G311, vOst_G35, vOst_G42, vOst_G42_Rub : Double;                                            &#13;&#10;     &#13;&#10;  &#13;&#10;&#13;&#10;  &#13;&#10;    &#13;&#10;  &#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; { qryStoresSQL := 'SELECT';    &#13;&#10;  qryStoresSQL := qryStoresSQL + ' S.PLACEID, S.NAME, S.LICENCENO, SUM(C.G35) as G35, SUM(C.G311) as G311,  SUM(C.G42) as G42 ';&#13;&#10;  //qryStoresSQL := qryStoresSQL + '(SELECT SUM(RELEASE_G35) FROM REL_COMM RC WHERE (S.PLACEID = RC.PLACEID)) as SumRelG35, ';&#13;&#10;  //qryStoresSQL := qryStoresSQL + '(SELECT SUM(RELEASE_G311) FROM REL_COMM RC WHERE (S.PLACEID = RC.PLACEID)) as SumRelG311, ';&#13;&#10;  //qryStoresSQL := qryStoresSQL + '(SELECT MIN(RELEASE_NO) FROM RELEASE R WHERE (S.PLACEID = R.PLACEID)) as RelNo, ';&#13;&#10;  //qryStoresSQL := qryStoresSQL + '(SELECT MAX(PLACEID) FROM RELEASE R WHERE (S.PLACEID = R.PLACEID)) as RelPL ';      &#13;&#10;  qryStoresSQL := qryStoresSQL + 'FROM  ';&#13;&#10;  qryStoresSQL := qryStoresSQL + ' Stores S ';&#13;&#10;  qryStoresSQL := qryStoresSQL + ' LEFT JOIN KRD_COMM C ON (S.PLACEID = C.PLACEID) ';           &#13;&#10;  qryStoresSQL := qryStoresSQL + 'GROUP BY ';&#13;&#10;  qryStoresSQL := qryStoresSQL + ' PLACEID, NAME, LICENCENO '; &#13;&#10;  qryStoresSQL := qryStoresSQL + 'HAVING  ( ';                           &#13;&#10;  qryStoresSQL := qryStoresSQL + ' ((SELECT MAX(RELEASE_NO) FROM RELEASE R WHERE (S.PLACEID = R.PLACEID)) is NULL)';&#13;&#10;  qryStoresSQL := qryStoresSQL + ' OR( ';                          &#13;&#10;  qryStoresSQL := qryStoresSQL + '   ( SUM(C.G35) &#62; (SELECT SUM(RELEASE_G35) FROM REL_COMM RC WHERE (S.PLACEID = RC.PLACEID)) ) ';&#13;&#10;  qryStoresSQL := qryStoresSQL + '   OR ';      &#13;&#10;  qryStoresSQL := qryStoresSQL + '   ( SUM(C.G311) &#62; (SELECT SUM(RELEASE_G311) FROM REL_COMM RC WHERE (S.PLACEID = RC.PLACEID)) )';      &#13;&#10;  qryStoresSQL := qryStoresSQL + '  ) ';  //OR                  &#13;&#10;  qryStoresSQL := qryStoresSQL + ') '; //Having          &#13;&#10;  qryStoresSQL := qryStoresSQL + 'ORDER BY PLACEID ';       &#13;&#10;         &#13;&#10;  showmessage(qryStoresSQL);      &#13;&#10;  qryStores.Active := False;&#13;&#10;  qryStores.SQL.Text := '';&#13;&#10;  qryStores.SQL.Text := qryStoresSQL;&#13;&#10;  qryStores.Active := True;  }  &#13;&#10;&#13;&#10;&#13;&#10;  {COMPUTE('OPENQUERY(&#34;QRYREFPAPERS&#34;, &#34;STS_DB&#34;, &#34;SELECT PAPER_DOCG44_CODE, PAPERNAME ' + &#13;&#10;                                               'FROM PAPERS ' + &#13;&#10;                                               'WHERE PAPER_IS_WAYBILL = 1&#34;)');  &#13;&#10;  sPaperNames := '|' + COMPUTE('JOINVALUES(&#34;QRYREFPAPERS&#34;, &#34;|&#34;, [&#34;PAPERNAME&#34;])') + '|';&#13;&#10;  sPaperCodes := '|' + COMPUTE('JOINVALUES(&#34;QRYREFPAPERS&#34;, &#34;|&#34;, [&#34;PAPER_DOCG44_CODE&#34;])') + '|';&#13;&#10;  COMPUTE('CLOSEDATASET(&#34;QRYREFPAPERS&#34;)');}        &#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  &#13;&#10;  COMPUTE('OPENQUERY(&#34;IN&#34;, &#34;STS_DB&#34;, &#34;SELECT SUM(C.G35) as G35, SUM(C.G311) as G311 FROM KRD_COMM C WHERE C.PLACEID = '+STR(&#60;STORES_2.&#34;PLACEID&#34;&#62;)+' &#34;)');&#13;&#10;  COMPUTE('OPENQUERY(&#34;OUT&#34;, &#34;STS_DB&#34;, &#34;SELECT SUM(RC.RELEASE_G35) as G35, SUM(RC.RELEASE_G311) as G311 FROM REL_COMM  RC WHERE RC.PLACEID = '+STR(&#60;STORES_2.&#34;PLACEID&#34;&#62;)+' &#34;)');      &#13;&#10;  &#13;&#10;  IF ((COMPUTE('FIELDVALUE(&#34;IN&#34;, &#34;G35&#34;)') - COMPUTE('FIELDVALUE(&#34;OUT&#34;, &#34;G35&#34;)')) = 0) AND ((COMPUTE('FIELDVALUE(&#34;IN&#34;, &#34;G311&#34;)') - COMPUTE('FIELDVALUE(&#34;OUT&#34;, &#34;G311&#34;)')) = 0) then begin&#13;&#10;    MasterData1.visible := False;&#13;&#10;    DetailData1.visible := False;&#13;&#10;    Footer1.visible := False;                                                          &#13;&#10;    qryMain.Active := False;&#13;&#10;      &#13;&#10;  end            &#13;&#10;  else begin&#13;&#10;    MasterData1.visible := True;                                  &#13;&#10;    DetailData1.visible := True;&#13;&#10;    Footer1.visible := True;                                                              &#13;&#10;    qryMainSQL := 'SELECT';&#13;&#10;    qryMainSQL := qryMainSQL + ' M.NBD, M.BD_DATE, C.ID, M.G082, M.G022, M.G221, C.G32, C.STORAGE_DATE, C.G33, C.G35,  C.G42, ';&#13;&#10;    qryMainSQL := qryMainSQL + ' C.ACCEPTDATE, C.G42_CURRENCY, C.BOXNO, SUM(RC.RELEASE_G35) as  RELEASE_G35, ';               &#13;&#10;    qryMainSQL := qryMainSQL + ' C.G311 as G311, SUM(RC.RELEASE_G311) as  RELEASE_G311,  SUM(RC.RELEASE_G42) as  RELEASE_G42 ';&#13;&#10;    qryMainSQL := qryMainSQL + 'FROM  ';&#13;&#10;    qryMainSQL := qryMainSQL + ' KRD_COMM C ';&#13;&#10;    qryMainSQL := qryMainSQL + ' LEFT JOIN KRD_MAIN M ON ((M.PLACEID = C.PLACEID) AND (M.ID = C.ID)) ';&#13;&#10;    qryMainSQL := qryMainSQL + ' LEFT JOIN REL_COMM RC ON ((C.PLACEID = RC.PLACEID) AND (C.ID = RC.ID) AND (C.G32 = RC.G32)) ';&#13;&#10;    qryMainSQL := qryMainSQL + ' LEFT JOIN RELEASE R ON ((RC.PLACEID = R.PLACEID) AND (RC.ID = R.ID) AND (RC.COUNTER = R.COUNTER)) ';      &#13;&#10;    //IF vPlaceId &#60;&#62; 0 then begin                                                             &#13;&#10;      qryMainSQL := qryMainSQL + 'WHERE ';&#13;&#10;      qryMainSQL := qryMainSQL + ' M.PLACEID ='  + STR(&#60;Stores_2.&#34;PLACEID&#34;&#62;) +  ;      &#13;&#10;    //end;                                                &#13;&#10;    qryMainSQL := qryMainSQL + ' GROUP BY ';&#13;&#10;    qryMainSQL := qryMainSQL + ' ID, G32, G221, G42_CURRENCY, G33, G35, G42, G311, ACCEPTDATE, STORAGE_DATE, NBD, BD_DATE, G082, G022, BOXNO '; //, RELEASE_NO, RELEASE_DATE  '; &#13;&#10;    qryMainSQL := qryMainSQL + 'HAVING ( ';                           &#13;&#10;    qryMainSQL := qryMainSQL + ' ( MAX(R.RELEASE_NO) is NULL) OR (';&#13;&#10;    qryMainSQL := qryMainSQL + '  ( (MAX(C.G35) - SUM(RC.RELEASE_G35)) &#62; 0 ) ';&#13;&#10;    qryMainSQL := qryMainSQL + '  OR ';      &#13;&#10;    qryMainSQL := qryMainSQL + '  ( (MAX(C.G311) - SUM(RC.RELEASE_G311)) &#62; 0 )';      &#13;&#10;    qryMainSQL := qryMainSQL + '  ) ';  //OR                  &#13;&#10;    qryMainSQL := qryMainSQL + ') '; //Having       &#13;&#10;    qryMainSQL := qryMainSQL + 'ORDER BY BD_DATE, NBD ';                    &#13;&#10;                   &#13;&#10;    //showmessage(qryMainSQL);                              &#13;&#10;    //showmessage(qryMain.SQL.Text);      &#13;&#10;    qryMain.Active := False;&#13;&#10;    qryMain.SQL.Text := '';&#13;&#10;    qryMain.SQL.Text := qryMainSQL;         &#13;&#10;    qryMain.Active := True;          &#13;&#10;    vSumG35 := 0;&#13;&#10;    vSumG42 := 0;&#13;&#10;    vSumG311 := 0;&#13;&#10;  end;&#13;&#10;  COMPUTE('CLOSEDATASET(&#34;IN&#34;)');&#13;&#10;  COMPUTE('CLOSEDATASET(&#34;OUT&#34;)');      &#13;&#10;end;  &#13;&#10;  &#13;&#10;procedure DetailData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  &#13;&#10;    vG312 := '';&#13;&#10;    vCod := '';&#13;&#10;    vOst_G311 := 0;&#13;&#10;    vOst_G35 := 0;&#13;&#10;    vOst_G42 := 0;        &#13;&#10;    {COMPUTE('OPENQUERY(&#34;Rel&#34;, &#34;STS_DB&#34;, &#34; SELECT RELEASE_NO, RELEASE_DATE  FROM RELEASE ' +&#13;&#10;                                            ' WHERE PLACEID = ' + VarToStr(&#60;qryMain.&#34;PLACEID&#34;&#62;) +&#13;&#10;                                            ' AND ID = ' + VarToStr(&#60;qryMain.&#34;ID&#34;&#62;) + &#13;&#10;                                            ' GROUP BY RELEASE_NO, RELEASE_DATE '+                                                                           &#13;&#10;                                            ' &#34;)');&#13;&#10;    sReleaseText := COMPUTE('UNIONVALUES(&#34;Rel&#34;, [&#34;RELEASE_NO&#34;, &#34;RELEASE_DATE&#34;], &#34;; &#34;, &#34; îò &#34;)'); }                                                                                          &#13;&#10;    &#13;&#10;    COMPUTE('OPENQUERY(&#34;OPISANIE&#34;, &#34;STS_DB&#34;, &#34; SELECT G312 FROM KRD_COMM ' +&#13;&#10;                                             ' WHERE PLACEID = ' + VarToStr(&#60;STORES_2.&#34;PLACEID&#34;&#62;) +&#13;&#10;                                             ' AND ID = ' + VarToStr(&#60;qryMain.&#34;ID&#34;&#62;) +&#13;&#10;                                             ' AND G32 = ' + VarToStr(&#60;qryMain.&#34;G32&#34;&#62;) +                                                                                               &#13;&#10;                                             ' &#34;)');&#13;&#10;    vG312 := COMPUTE('FIELDVALUE(&#34;OPISANIE&#34;, &#34;G312&#34;)');&#13;&#10;&#13;&#10;    IF  &#60;qryMain.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; '' then                                   &#13;&#10;      vCod := COMPUTE('CURRENCYABBR (&#34;'+ &#60;qryMain.&#34;G42_CURRENCY&#34;&#62; +'&#34;)')&#13;&#10;      else   &#13;&#10;        vCod := COMPUTE('CURRENCYABBR (&#34;'+ &#60;qryMain.&#34;G221&#34;&#62; +'&#34;)');&#13;&#10;&#13;&#10;    vOst_G311 := &#60;qryMain.&#34;G311&#34;&#62; - &#60;qryMain.&#34;RELEASE_G311&#34;&#62;;&#13;&#10;    vOst_G35 := &#60;qryMain.&#34;G35&#34;&#62; - &#60;qryMain.&#34;RELEASE_G35&#34;&#62;;&#13;&#10;    vOst_G42 := &#60;qryMain.&#34;G42&#34;&#62; - &#60;qryMain.&#34;RELEASE_G42&#34;&#62;;&#13;&#10;    IF ((&#60;qryMain.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; '') and (&#60;qryMain.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; NULL)) or ((&#60;qryMain.&#34;G221&#34;&#62; &#60;&#62; '') and (&#60;qryMain.&#34;G221&#34;&#62; &#60;&#62; Null)) then &#13;&#10;    begin&#13;&#10;     IF  &#60;qryMain.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; '' then                                   &#13;&#10;      vCod := COMPUTE('CURRENCYABBR (&#34;'+ &#60;qryMain.&#34;G42_CURRENCY&#34;&#62; +'&#34;)')&#13;&#10;      else   &#13;&#10;        vCod := COMPUTE('CURRENCYABBR (&#34;'+ &#60;qryMain.&#34;G221&#34;&#62; +'&#34;)');                  &#13;&#10;      vOst_G42_Rub := StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + STR(&#60;qryMain.&#34;BD_DATE&#34;&#62;) + '&#34;, &#34;' + IIF(&#60;qryMain.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; '', &#60;qryMain.&#34;G42_CURRENCY&#34;&#62;, &#60;qryMain.&#34;G221&#34;&#62;) + '&#34;, &#34;643&#34;, ' + STR(vOst_G42) + ')'));  &#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      if vOst_G42 &#60;&#62; NULL then                                                                         &#13;&#10;       vCod := 'RUB'&#13;&#10;      else vCod := '';                               &#13;&#10;       vOst_G42_Rub := vOst_G42;&#13;&#10;    end;                 &#13;&#10;&#13;&#10;           &#13;&#10;   COMPUTE('OPENQUERY(&#34;Transp&#34;, &#34;STS_DB&#34;, &#34; SELECT CARNO FROM KR_TRANS ' +&#13;&#10;                                          ' WHERE PLACEID = ' + VarToStr(&#60;STORES_2.&#34;PLACEID&#34;&#62;) +&#13;&#10;                                          ' AND ID = ' + VarToStr(&#60;qryMain.&#34;ID&#34;&#62;) + &#13;&#10;                                          ' &#34;)');&#13;&#10;   sTransp := COMPUTE('UNIONVALUES(&#34;TRANSP&#34;, [&#34;CARNO&#34;], &#34;; ' + chr(13) + '&#34;, &#34;¹ &#34;)');                                  &#13;&#10;   //showmessage(Compute('Fieldvalue(&#34;PAPERS&#34;, &#34;PAPERNO&#34;)'));&#13;&#10;&#13;&#10;    vSumG35 := vSumG35 +  vOst_G35;&#13;&#10;    vSumG311 := vSumG311 +  vOst_G311;            &#13;&#10;    vSumG42 := vSumG42+ vOst_G42_Rub;                                              &#13;&#10;                         &#13;&#10;end;   &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;procedure Memo7OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    sDocNames := '';                               &#13;&#10;    COMPUTE('SETFILTER(&#34;KRD_COMM_PAPERS_2&#34;, &#34;PLACEID = ' + IntToStr(&#60;STORES_2.&#34;PLACEID&#34;&#62;) +&#13;&#10;                                            ' AND ID = ' + IntToStr(&#60;qryMain.&#34;ID&#34;&#62;) +&#13;&#10;                                            ' AND G32 = ' + IntToStr(&#60;qryMain.&#34;G32&#34;&#62;) +&#13;&#10;                                            ' AND DOC_TYPE = 13&#34;)');        &#13;&#10;&#13;&#10;    if StrToInt(COMPUTE('RECORDCOUNT(&#34;KRD_COMM_PAPERS_2&#34;)')) &#62; 0 then begin&#13;&#10;      COMPUTE('FIRST(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;      While StrToInt(COMPUTE('EOF(&#34;KRD_COMM_PAPERS_2&#34;)')) = 0 do begin&#13;&#10;        COMPUTE('SETRANGE(&#34;KRD_PAPERS_2&#34;, [&#34;' + IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' +&#13;&#10;                                                IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' +&#13;&#10;                                                IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;DOC_COUNTER&#34;&#62;) + '&#34;])');&#13;&#10;        if (Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;) + '|', sPaperCodes) &#62; 0) or&#13;&#10;            (Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62;) + '|', sPaperNames) &#62; 0) then begin                                                   &#13;&#10;              if Length(VarToStr(&#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)) &#62; 2 then&#13;&#10;              sDocNames := sDocNames + IIF(sDocNames &#60;&#62;'' , ', ', '' )+ &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + ' ¹' + &#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62; + ' îò ' + FormatDateTime('DD.MM.YYYY', &#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)&#13;&#10;              else sDocNames := sDocNames + IIF(sDocNames &#60;&#62;'' , ', ', '' )+ &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + ' ¹' + &#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;;                                                                                                                                                                           &#13;&#10;           end;  &#13;&#10;                       &#13;&#10;        COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;        COMPUTE('NEXT(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;              &#13;&#10;      end;&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      COMPUTE('SETRANGE(&#34;KRD_PAPERS_2&#34;, [&#34;' + IntToStr(&#60;STORES_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' +&#13;&#10;                                              IntToStr(&#60;qryMain.&#34;ID&#34;&#62;) + '&#34;])');&#13;&#10;      COMPUTE('FIRST(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;      While StrToInt(COMPUTE('EOF(&#34;KRD_PAPERS_2&#34;)')) = 0 do begin&#13;&#10;        if (Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;) + '|', sPaperCodes) &#62; 0) or&#13;&#10;           (Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62;) + '|', sPaperNames) &#62; 0) then begin                                                   &#13;&#10;             if Length(VarToStr(&#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)) &#62; 2 then&#13;&#10;             sDocNames := sDocNames + IIF(sDocNames &#60;&#62;'' , ', ', '' ) + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + ' ¹' + &#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62; + ' îò ' + FormatDateTime('DD.MM.YYYY', &#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)&#13;&#10;             else sDocNames := sDocNames + IIF(sDocNames &#60;&#62;'' , ', ', '' )+ &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + ' ¹' + &#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;;&#13;&#10;         end;                                    &#13;&#10;      COMPUTE('NEXT(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;      end;&#13;&#10;      COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;    end;&#13;&#10;&#13;&#10;    COMPUTE('SETFILTER(&#34;KRD_COMM_PAPERS_2&#34;,&#34;&#34;)');        &#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." PropData="08446174617365747301010C3F00000020446174615365743D2264735F4B52445F434F4D4D5F5041504552535F322220446174615365744E616D653D224B52445F434F4D4D5F5041504552535F322200010C3500000020446174615365743D2264735F4B52445F5041504552535F322220446174615365744E616D653D224B52445F5041504552535F322200010C2800000020446174615365743D227172794D61696E2220446174615365744E616D653D227172794D61696E2200010C2C00000020446174615365743D2271727953746F7265732220446174615365744E616D653D2271727953746F7265732200010C2900000020446174615365743D2264735F53544F5245532220446174615365744E616D653D2253544F5245532200010C2D00000020446174615365743D2264735F53544F5245535F322220446174615365744E616D653D2253544F5245535F32220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxBDEQuery Name="qryMain" UserName="qryMain" CloseDataSource="True" FieldAliases.Text="" OpenDataSource="False" IgnoreDupParams="False" SQL.Text="select * from krd_main                                                                                                             " DatabaseName="STS_DB" SessionName="Default" PropData="05704C65667402140470546F7002080A506172616D65746572730100"/>
    <TfrxBDEQuery Name="qryStores" UserName="qryStores" CloseDataSource="True" FieldAliases.Text="" OpenDataSource="False" IgnoreDupParams="False" SQL.Text="select * from stores              " DatabaseName="STS_DB" SessionName="Default" PropData="05704C65667402500470546F7002080A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Height="18.89765" Left="0" Top="166.29932" Width="1046.92981" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="ds_STORES_2" DataSetName="STORES_2" RowCount="0" Stretched="True">
      <TfrxMemoView Name="STORES_2PLACEID" Left="3.77953" Top="0" Width="1303.93785" Height="18.89765" ShowHint="False" DataSet="ds_STORES_2" DataSetName="STORES_2" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="['Ð¡ÐºÐ»Ð°Ð´ ' + STR(&#60;STORES_2.&#34;NAME&#34;&#62;) + '(ÑÐ²Ð¸Ð´ÐµÑ‚-Ð²Ð¾ â„–' + &#60;STORES_2.&#34;LICENCENO&#34;&#62;+ ')']"/>
    </TfrxMasterData>
    <TfrxFooter Name="Footer1" Height="18.89765" Left="0" Top="253.22851" Width="1046.92981" Stretched="True">
      <TfrxMemoView Name="Memo42" ShiftMode="smWhenOverlapped" Left="3.77953" Top="0" Width="313.70099" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð˜Ñ‚Ð¾Ð³Ð¾ :"/>
      <TfrxMemoView Name="Memo5" Left="317.48052" Top="0" Width="60.47248" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vSumG311]"/>
      <TfrxMemoView Name="Memo35" Left="377.953" Top="0" Width="56.69295" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vSumG35]"/>
      <TfrxMemoView Name="Memo36" Left="434.64595" Top="0" Width="540.47279" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo37" Left="975.11874" Top="0" Width="68.03154" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vSumG42]"/>
    </TfrxFooter>
    <TfrxDetailData Name="DetailData1" Height="22.67718" Left="0" Top="207.87415" Width="1046.92981" OnBeforePrint="DetailData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="qryMain" DataSetName="qryMain" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo15" Left="34.01577" Top="0" Width="79.37013" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[qryMain.&#34;ACCEPTDATE&#34;]"/>
      <TfrxMemoView Name="Memo21" ShiftMode="smWhenOverlapped" Left="3.77953" Top="0" Width="30.23624" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[LINE#]"/>
      <TfrxMemoView Name="Memo2" Left="113.3859" Top="0" Width="136.06308" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vG312]"/>
      <TfrxMemoView Name="Memo24" Left="555.59091" Top="0" Width="45.35436" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vCod]"/>
      <TfrxMemoView Name="Memo25" Left="483.77984" Top="0" Width="71.81107" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vOst_G42]"/>
      <TfrxMemoView Name="Memo26" Left="600.94527" Top="0" Width="75.5906" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[FormatDateTime('DD.MM.YYYY HH:MM', &#60;qryMain.&#34;STORAGE_DATE&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo7" Left="249.44898" Top="0" Width="68.03154" Height="22.67718" OnBeforePrint="Memo7OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[sDocNames]"/>
      <TfrxMemoView Name="Memo30" Left="317.48052" Top="0" Width="60.47248" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vOst_G311]"/>
      <TfrxMemoView Name="Memo31" Left="377.953" Top="0" Width="56.69295" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vOst_G35]"/>
      <TfrxMemoView Name="Memo32" Left="434.64595" Top="0" Width="49.13389" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[qryMain.&#34;G33&#34;]"/>
      <TfrxMemoView Name="Memo13" Left="676.53587" Top="0" Width="60.47248" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo3" Left="737.00835" Top="0" Width="41.57483" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo1" Left="778.58318" Top="0" Width="71.81107" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo23" Left="850.39425" Top="0" Width="60.47248" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo33" Left="910.86673" Top="0" Width="64.25201" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo34" Left="975.11874" Top="0" Width="68.03154" Height="22.67718" ShowHint="False" StretchMode="smMaxHeight" DataSet="qryMain" DataSetName="qryMain" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vOst_G42_rub]"/>
    </TfrxDetailData>
    <TfrxReportTitle Name="ReportTitle1" Height="86.92919" Left="0" Top="18.89765" Width="1046.92981">
      <TfrxMemoView Name="Memo8" ShiftMode="smWhenOverlapped" Left="910.86673" Top="0" Width="64.25201" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð”ÐµÐºÐ»Ð°Ñ€Ð°Ð½Ñ‚"/>
      <TfrxMemoView Name="Memo9" ShiftMode="smWhenOverlapped" Left="34.01577" Top="0" Width="79.37013" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð”Ð°Ñ‚Ð° Ð¸ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ð¾Ð¼ÐµÑ‰ÐµÐ½Ð¸Ñ Ð½Ð° ÑÐºÐ»Ð°Ð´"/>
      <TfrxMemoView Name="Memo10" ShiftMode="smWhenOverlapped" Left="113.3859" Top="0" Width="136.06308" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð°"/>
      <TfrxMemoView Name="Memo12" ShiftMode="smWhenOverlapped" Left="483.77984" Top="0" Width="71.81107" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ"/>
      <TfrxMemoView Name="Memo14" ShiftMode="smWhenOverlapped" Left="737.00835" Top="0" Width="41.57483" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐÐ”Ð¡"/>
      <TfrxMemoView Name="Memo20" ShiftMode="smWhenOverlapped" Left="3.77953" Top="0" Width="30.23624" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="â„– Ð¿/Ð¿"/>
      <TfrxMemoView Name="Memo11" ShiftMode="smWhenOverlapped" Left="555.59091" Top="0" Width="45.35436" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð‘ÑƒÐºÐ²ÐµÐ½Ð½Ñ‹Ð¹ ÐºÐ¾Ð´"/>
      <TfrxMemoView Name="Memo16" ShiftMode="smWhenOverlapped" Left="600.94527" Top="0" Width="75.5906" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð”Ð°Ñ‚Ð° Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ñ ÑÑ€Ð¾ÐºÐ° Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ"/>
      <TfrxMemoView Name="Memo18" ShiftMode="smWhenOverlapped" Left="676.53587" Top="0" Width="60.47248" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐŸÐ¾ÑˆÐ»Ð¸Ð½Ð°"/>
      <TfrxMemoView Name="Memo6" ShiftMode="smWhenOverlapped" Left="249.44898" Top="0" Width="68.03154" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð’Ð¸Ð´ Ð´Ð°Ñ‚Ð° Ð¸ Ð½Ð¾Ð¼ÐµÑ€ Ñ‚Ñ€Ð°Ð½ÑÐ¿Ð¾Ñ€Ñ‚Ð½Ð¾Ð³Ð¾ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°"/>
      <TfrxMemoView Name="Memo27" ShiftMode="smWhenOverlapped" Left="317.48052" Top="0" Width="60.47248" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐšÐ¾Ð»-Ð²Ð¾ Ð³Ñ€ÑƒÐ·Ð¾Ð²Ñ‹Ñ… Ð¼ÐµÑÑ‚"/>
      <TfrxMemoView Name="Memo28" ShiftMode="smWhenOverlapped" Left="377.953" Top="0" Width="56.69295" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð’ÐµÑ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð±Ñ€ÑƒÑ‚Ñ‚Ð¾"/>
      <TfrxMemoView Name="Memo29" ShiftMode="smWhenOverlapped" Left="434.64595" Top="0" Width="49.13389" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐšÐ¾Ð´ Ñ‚Ð¾Ð²Ð°Ñ€Ð°"/>
      <TfrxMemoView Name="Memo17" ShiftMode="smWhenOverlapped" Left="778.58318" Top="0" Width="71.81107" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð”Ð¾Ð¿. Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ñ‹"/>
      <TfrxMemoView Name="Memo19" ShiftMode="smWhenOverlapped" Left="850.39425" Top="0" Width="60.47248" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð˜Ð½Ð¶ÐµÐ½ÐµÑ€"/>
      <TfrxMemoView Name="Memo22" ShiftMode="smWhenOverlapped" Left="975.11874" Top="0" Width="68.03154" Height="86.92919" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð¤Ð°ÐºÑ‚ÑƒÑ€Ð½Ð°Ñ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð² Ñ€ÑƒÐ±."/>
    </TfrxReportTitle>
  </TfrxReportPage>
</TfrxReport>
