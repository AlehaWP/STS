<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.6.78" DotMatrixReport="False" EngineOptions.ConvertNulls="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="42402.7229907523" ReportOptions.Description.Text="" ReportOptions.Name="СТМ-Журналы (СТМ-Журналы (Бронка разнарядка №18))" ReportOptions.LastChange="42467.4626315278" ScriptLanguage="PascalScript" ScriptText.Text="VAR&#13;&#10;iMasterID : integer;&#13;&#10;sSQL : string;&#13;&#10;vCounter, vDate : string;&#13;&#10;sFileCounterPath : string;&#13;&#10;sProgPath, sPaperNo : string;                                          &#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin                            &#13;&#10;  COMPUTE('EXECUTESCRIPT(PROGRAMPATH()+&#34;PROCDOCS\selectuvAll.prd&#34;)');&#13;&#10;  COMPUTE('TRYEXCEPT (VAR(&#34;iJrMastId&#34;, integer, JRGoodOut2.JOURNAL_MASTER_ID),,OPENTABLE (&#34;JRGOODOUT2&#34;, &#34;JRGOODOUT2&#34;, , &#34;dbJournals&#34;))');                &#13;&#10;  COMPUTE('TRYEXCEPT (VAR(&#34;iJrMastId&#34;, integer, TRANSPORT2.JOURNAL_MASTER_ID),,OPENTABLE (&#34;TRANSPORT2&#34;, &#34;TRANSPORT2&#34;, , &#34;dbJournals&#34;))');    &#13;&#10;  COMPUTE('LOCATE(&#34;JRGOODOUT2&#34;,&#34;JOURNAL_MASTER_ID&#34;, vJMID)');&#13;&#10;  COMPUTE('SETFILTER(&#34;TRANSPORT2&#34;,&#34;JOURNAL_MASTER_ID=&#34;+vJMID)');                                                    &#13;&#10;&#13;&#10;  &#13;&#10;  &#13;&#10;  If VarToStr(COMPUTE('JRGOODOUT2.journal_master_id')) &#60;&#62; '' then                        &#13;&#10;    iMasterID := COMPUTE('JRGOODOUT2.journal_master_id')&#13;&#10;  else iMasterId := 0;                             &#13;&#10;&#13;&#10;  IF iMasterID &#60;&#62; 0 then begin&#13;&#10;      sSQL :=   ' SELECT * FROM GOODINFO2' +&#13;&#10;                 ' WHERE JOURNAL_MASTER_ID = ' +  STR(iMasterID) ;                                                                                                                              &#13;&#10;      qryComm.SQL.Text := sSQL;                                                           &#13;&#10;      qryComm.Active := True;&#13;&#10;      sSQL :=   ' SELECT * FROM JRGOODOUT2' +&#13;&#10;                 ' WHERE JOURNAL_MASTER_ID = ' +  STR(iMasterID) ;                                                                                                                              &#13;&#10;      qryWHGOODOUT.SQL.Text := sSQL;         &#13;&#10;      qryWHGOODOUT.Active := true;&#13;&#10;              &#13;&#10;      sSQL :=   ' SELECT * FROM TRANSPORT2' +&#13;&#10;                 ' WHERE JOURNAL_MASTER_ID = ' +  STR(iMasterID) ;                                                                                                                              &#13;&#10;      qryTransport.SQL.Text := sSQL;         &#13;&#10;      qryTransport.Active := true;&#13;&#10;&#13;&#10;      sSQL := 'SELECT * FROM JRGoodOut2Raznoriadka '+&#13;&#10;              ' WHERE JOURNAL_MASTER_ID = ' +  STR(iMasterID) ;&#13;&#10;      qryNo.SQL.Text := sSQL;&#13;&#10;      qryNo.Active := true;                                                    &#13;&#10;      IF qryNO.Recordcount &#60;&#62; 0 then begin             &#13;&#10;         vCounter := STR(&#60;qryNO.&#34;RAZNARIADKA_NO&#34;&#62;);&#13;&#10;         vDate := FormatDateTime ('DD.MM.YYYY HH:MM', &#60;qryNO.&#34;DT_CREATE&#34;&#62;);             &#13;&#10;      end                 &#13;&#10;      else begin&#13;&#10;          qryNo.Active := false;                                                    &#13;&#10;          sSQL := 'SELECT MAX(RAZNARIADKA_NO) as R_NO FROM JRGoodOut2Raznoriadka ';&#13;&#10;          qryNo.SQL.Text := sSQL;&#13;&#10;          qryNo.Active := true;&#13;&#10;            &#13;&#10;          vCounter := STR(&#60;qryNO.&#34;R_NO&#34;&#62; + 1);&#13;&#10;          IF vCounter = 'NULL' then vCounter := '1';              &#13;&#10;          vDate := FormatDateTime ('DD.MM.YYYY HH:MM', NOW());                                                                      &#13;&#10;          COMPUTE('EXECUTESQL(&#34;dbJournals&#34;, &#34;INSERT INTO JRGoodOut2Raznoriadka (JOURNAL_MASTER_ID, RAZNARIADKA_NO, DT_CREATE) VALUES ('+STR(iMasterID)+','+vCounter+','+chr(39)+vDate+chr(39)+')&#34;)')&#13;&#10;      end;&#13;&#10;      qryNo.Active := false;                                                      &#13;&#10;  end;&#13;&#10;        &#13;&#10;end;  &#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;      sPaperNO := '';                                       &#13;&#10;      sSQL :=   ' SELECT * FROM TRANSPORTDOC2 ' +&#13;&#10;                ' WHERE JOURNAL_MASTER_ID = ' +  STR(&#60;qryComm.&#34;JOURNAL_MASTER_ID&#34;&#62;) +&#13;&#10;                ' AND JOURNAL_CHILD_ID = ' + STR(&#60;qryComm.&#34;JOURNAL_CHILD_ID&#34;&#62;);&#13;&#10;      qryWBL.SQL.Text := sSQL;         &#13;&#10;      qryWBL.Active := true;&#13;&#10;      //showmessage (&#60;qryWBL.&#34;PrDocumentNumber&#34;&#62;);                                       &#13;&#10;      WHILE qryWBL.Eof=false do begin&#13;&#10;            COMPUTE ('OPENQUERY(&#34;GET_WBL_ID&#34;, &#34;STS_DB&#34;, &#34;SELECT PLACEID, ID FROM KR_PAPER WHERE PAPERNO='+chr(39)+&#60;qryWBL.&#34;PrDocumentNumber&#34;&#62;+chr(39)+' AND COUNTER=1&#34;)');&#13;&#10;            IF COMPUTE ('RECORDCOUNT(&#34;GET_WBL_ID&#34;)') &#60;&#62; 0 then&#13;&#10;               sPaperNo := &#60;qryWBL.&#34;PrDocumentNumber&#34;&#62;;                                                                                            &#13;&#10;            qryWBL.Next;                                                                                         &#13;&#10;      end;&#13;&#10;      if sPaperNO = '' then begin&#13;&#10;          qryWBL.First;                                                                            &#13;&#10;          sPaperNO := &#60;qryWBL.&#34;PrDocumentNumber&#34;&#62;;                                                                                &#13;&#10;      end;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." PropData="08446174617365747301010C2800000020446174615365743D22717279436F6D6D2220446174615365744E616D653D22717279436F6D6D2200010C2400000020446174615365743D227172794E4F2220446174615365744E616D653D227172794E4F2200010C3200000020446174615365743D227172795472616E73706F72742220446174615365744E616D653D227172795472616E73706F72742200010C2600000020446174615365743D2271727957424C2220446174615365744E616D653D2271727957424C2200010C3200000020446174615365743D227172795748474F4F444F55542220446174615365744E616D653D227172795748474F4F444F5554220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxUNIQuery Name="qryWHGOODOUT" UserName="qryWHGOODOUT" Active="False" DatabaseName="dbJournals" Filtered="False" SQL.Text="SELECT * FROM JRGOODOUT2 WHERE JOURNAL_MASTER_ID=1" PropData="05704C65667402780470546F7002480A506172616D65746572730100"/>
    <TfrxUNIQuery Name="qryComm" UserName="qryComm" Active="False" DatabaseName="dbJournals" Filtered="False" SQL.Text="SELECT * FROM GOODINFO2 WHERE JOURNAL_MASTER_ID=1" PropData="05704C65667403EC000470546F7002480A506172616D65746572730100"/>
    <TfrxUNIQuery Name="qryTransport" UserName="qryTransport" Active="False" DatabaseName="dbJournals" Filtered="False" SQL.Text="SELECT * FROM Transport2 WHERE JOURNAL_MASTER_ID=1" PropData="05704C6566740354010470546F7002480A506172616D65746572730100"/>
    <TfrxUNIQuery Name="qryNO" UserName="qryNO" Active="False" DatabaseName="dbJournals" Filtered="False" SQL.Text="Select * from JRGoodOut2Raznoriadka WHERE JOURNAL_MASTER_ID=1" PropData="05704C6566740378010470546F7003E0000A506172616D65746572730100"/>
    <TfrxUNIQuery Name="qryWBL" UserName="qryWBL" Active="False" DatabaseName="dbJournals" Filtered="False" SQL.Text="SELECT * FROM TransportDoc2 WHERE JOURNAL_MASTER_ID=1" PropData="05704C65667403B0010470546F7002440A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False" OnBeforePrint="Page1OnBeforePrint">
    <TfrxReportTitle Name="ReportTitle1" Height="230.55133" Left="0" Top="18.89765" Width="718.1107">
      <TfrxMemoView Name="Memo1" ShiftMode="smWhenOverlapped" Left="7.55906" Top="7.55906" Width="340.1577" Height="30.23624" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-21" Font.Name="Calibri" Font.Style="3" ParentFont="False" Text="ММПК «БРОНКА»"/>
      <TfrxMemoView Name="Memo2" ShiftMode="smWhenOverlapped" Left="7.55906" Top="79.37013" Width="340.1577" Height="22.67718" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Calibri" Font.Style="1" ParentFont="False" Text="ПЗТК ООО «ФЕНИКС»"/>
      <TfrxMemoView Name="Memo3" ShiftMode="smWhenOverlapped" Left="7.55906" Top="105.82684" Width="340.1577" Height="56.69295" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Calibri" Font.Style="1" ParentFont="False" Text="Разрешение балтийской таможни &#13;&#10;№ [&#60;qryWHGOODOUT.&#34;SVHDocNumber&#34;&#62;]  от [&#60;qryWHGOODOUT.&#34;SVHDocDate&#34;&#62;] "/>
      <TfrxMemoView Name="Memo4" ShiftMode="smWhenOverlapped" Left="400.63018" Top="79.37013" Width="86.92919" Height="22.67718" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Calibri" Font.Style="1" ParentFont="False" Text="Разнарядка"/>
      <TfrxMemoView Name="Memo26" ShiftMode="smWhenOverlapped" Left="0" Top="204.09462" Width="718.1107" Height="26.45671" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Судно : [&#60;qryTransport.&#34;TransportIdentifier&#34;&#62;]"/>
      <TfrxMemoView Name="Memo5" ShiftMode="smWhenOverlapped" Left="514.01608" Top="79.37013" Width="192.75603" Height="22.67718" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Calibri" Font.Style="1" ParentFont="False" Text="[vCounter]"/>
      <TfrxMemoView Name="Memo6" ShiftMode="smWhenOverlapped" Left="400.63018" Top="105.82684" Width="86.92919" Height="22.67718" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Calibri" Font.Style="1" ParentFont="False" Text="по [qryWHGOODOUT.&#34;PrDocumentName&#34;]"/>
      <TfrxMemoView Name="Memo7" ShiftMode="smWhenOverlapped" Left="514.01608" Top="105.82684" Width="192.75603" Height="22.67718" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Calibri" Font.Style="1" ParentFont="False" Text="[qryWHGOODOUT.&#34;PrDocumentNumber&#34;]"/>
      <TfrxMemoView Name="Memo8" ShiftMode="smWhenOverlapped" Left="491.3389" Top="79.37013" Width="22.67718" Height="22.67718" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Calibri" Font.Style="1" ParentFont="False" Text="№"/>
      <TfrxMemoView Name="Memo9" ShiftMode="smWhenOverlapped" Left="491.3389" Top="105.82684" Width="22.67718" Height="22.67718" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Calibri" Font.Style="1" ParentFont="False" Text="№"/>
      <TfrxMemoView Name="Memo10" ShiftMode="smWhenOverlapped" Left="400.63018" Top="15.11812" Width="113.3859" Height="22.67718" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Calibri" Font.Style="1" ParentFont="False" Text="Дата "/>
      <TfrxMemoView Name="Memo11" ShiftMode="smWhenOverlapped" Left="514.01608" Top="15.11812" Width="192.75603" Height="22.67718" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-16" Font.Name="Calibri" Font.Style="1" ParentFont="False" Text="[vDate]"/>
    </TfrxReportTitle>
    <TfrxHeader Name="Header1" Height="30.23624" Left="0" Top="309.92146" Width="718.1107">
      <TfrxMemoView Name="Memo13" ShiftMode="smWhenOverlapped" Left="0" Top="0" Width="37.7953" Height="30.23624" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="№ п/п"/>
      <TfrxMemoView Name="Memo14" ShiftMode="smWhenOverlapped" Left="166.29932" Top="0" Width="94.48825" Height="30.23624" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Тип"/>
      <TfrxMemoView Name="Memo15" ShiftMode="smWhenOverlapped" Left="260.78757" Top="0" Width="75.5906" Height="30.23624" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Кол-во мест"/>
      <TfrxMemoView Name="Memo16" ShiftMode="smWhenOverlapped" Left="336.37817" Top="0" Width="83.14966" Height="30.23624" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Вес &#13;&#10;(кг)"/>
      <TfrxMemoView Name="Memo17" ShiftMode="smWhenOverlapped" Left="419.52783" Top="0" Width="298.58287" Height="30.23624" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Наименование товара"/>
      <TfrxMemoView Name="Memo18" ShiftMode="smWhenOverlapped" Left="37.7953" Top="0" Width="128.50402" Height="30.23624" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="№ Накладной"/>
    </TfrxHeader>
    <TfrxMasterData Name="MasterData1" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Height="30.23624" Left="0" ParentFont="False" Top="362.83488" Width="718.1107" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="qryComm" DataSetName="qryComm" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo20" ShiftMode="smWhenOverlapped" Left="166.29932" Top="0" Width="94.48825" Height="30.23624" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[&#60;qryComm.&#34;GoodsTNVEDCODE&#34;&#62;]"/>
      <TfrxMemoView Name="Memo21" ShiftMode="smWhenOverlapped" Left="260.78757" Top="0" Width="75.5906" Height="30.23624" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[&#60;qryComm.&#34;PlaceNumber&#34;&#62;]"/>
      <TfrxMemoView Name="Memo22" ShiftMode="smWhenOverlapped" Left="336.37817" Top="0" Width="83.14966" Height="30.23624" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[&#60;qryComm.&#34;BruttoVolQuantity&#34;&#62;]"/>
      <TfrxMemoView Name="Memo19" ShiftMode="smWhenOverlapped" Left="419.52783" Top="0" Width="298.58287" Height="30.23624" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[&#60;qryComm.&#34;GoodsDescription&#34;&#62;]"/>
      <TfrxMemoView Name="Memo23" ShiftMode="smWhenOverlapped" Left="37.7953" Top="0" Width="128.50402" Height="30.23624" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[sPaperNo]"/>
      <TfrxMemoView Name="Memo24" ShiftMode="smWhenOverlapped" Left="0" Top="0" Width="37.7953" Height="30.23624" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-15" Font.Name="Calibri" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[LINE#]"/>
    </TfrxMasterData>
  </TfrxReportPage>
</TfrxReport>
