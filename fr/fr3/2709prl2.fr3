<?xml version="1.0" encoding="utf-8" standalone="no"?><TfrxReport Version="5.3.1" DotMatrixReport="False" EngineOptions.ConvertNulls="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38287.7802357292" ReportOptions.Description.Text="Отчет экономического оператора о товарах, помещенных на временное хранение" ReportOptions.Name="Отчет экономического оператора по приказу 2709 прил.2" ReportOptions.LastChange="42783.3245211111" ScriptLanguage="PascalScript" ScriptText.Text="Var&#13;&#10;  CustomDocsOnly, AistCompatible, StoreDocsBlock: Integer;&#13;&#10;  NoArchive: Integer;&#13;&#10;  vPlaceID, vID, vG32: Integer;&#13;&#10;  dtPeriodEnd, dtPeriodStart: TDateTime;&#13;&#10;  NotInclude, datestart, dateend, vWaybill, vInv, vKont : String;&#13;&#10;&#13;&#10;  vG311, vG35, vG42, vG38: Double;&#13;&#10;  RelG311, RelG35, RelG42: Double;&#13;&#10;  dRestG311, dRestG35, dRestG42: Double;&#13;&#10;  vLastReleaseDate: TDateTime;&#13;&#10;&#13;&#10;  vFilterCrit, vSQL: String;&#13;&#10;  NumLines: Integer; vNumLine: String;&#13;&#10;  vStoreDate: String;&#13;&#10;  vCountry, vDONum, vOwner, vCustomName, vLicenceNo: String;&#13;&#10;  sPaperNames, sPaperCodes, dateReport, dateCertif: String;  &#13;&#10;  vCanPrint, vUseStoreDocs: Boolean;&#13;&#10;  sValCode : String;                          &#13;&#10;&#13;&#10;procedure btnCallRefOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with btnCallRef, Engine do&#13;&#10;  begin&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreNumLic&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreNum&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreName&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strLicExt&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;sPlaceId&#34;,Integer)');&#13;&#10;    COMPUTE('OPENQUERY(&#34;Stors&#34;, &#34;STS_DB&#34;, &#34;Select * from STORES&#34;)');&#13;&#10;    COMPUTE('SELECTVALUES(&#34;Список складов&#34;, &#34;Stors&#34;, ' +&#13;&#10;                                                    '[[&#34;LICENCENO&#34;,   &#34;Номер лицензии&#34;, 15], ' +&#13;&#10;                                                    ' [&#34;LICENCENO_EXT&#34;,   &#34; &#34;, 1], ' +&#13;&#10;                                                    ' [&#34;STORE_NO&#34;,   &#34;Номер склада&#34;, 15], ' +&#13;&#10;                                                    ' [&#34;NAME&#34;,   &#34;Название склада&#34;, 30], ' +&#13;&#10;                                                    ' [&#34;PlaceId&#34;,   &#34;&#34;, 10]], ' +&#13;&#10;                                                    '[[&#34;LICENCENO&#34;, &#34;strStoreNumLic&#34;], ' + &#13;&#10;                                                    ' [&#34;STORE_NO&#34;, &#34;strStoreNum&#34;], ' +&#13;&#10;                                                    ' [&#34;NAME&#34;, &#34;strStoreName&#34;], ' +&#13;&#10;                                                    ' [&#34;LICENCENO_EXT&#34;, &#34;strLicExt&#34;], ' +&#13;&#10;                                                    ' [&#34;PlaceId&#34;, &#34;sPlaceId&#34;]], ' +&#13;&#10;    '&#34;&#34;, &#34;STORES&#34;)');&#13;&#10;&#13;&#10;    fldStoreLicNum.Text := COMPUTE('Value(&#34;strStoreNumLic&#34;)') ;      //   номер лицензии&#13;&#10;    fldStoreNum.Text := '№ склада: ' + COMPUTE('value(&#34;strStoreNum&#34;)') ; //   номер склада&#13;&#10;    lblStoreName.Caption := COMPUTE('Value(&#34;strStoreName&#34;)') ;     //   название склада&#13;&#10;    fldLicExt.Text := COMPUTE('Value(&#34;strLIcExt&#34;)');     //   Признак перерегистрации&#13;&#10;    vPlaceId := StrToInt(COMPUTE('Value(&#34;sPlaceId&#34;)'));&#13;&#10;    if Length(COMPUTE('Value(&#34;strStoreNumLic&#34;)')) &#62; 0 then&#13;&#10;      cbtnOk.Enabled := True &#13;&#10;    else cbtnOk.Enabled := False;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure cbtnOkOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with cbtnOk, Engine do begin&#13;&#10;    //сохраняем настройки&#13;&#10;    WriteIniFile('Print','AllStores',  VarToStr(cbxAllStores.Checked));&#13;&#10;    WriteIniFile('Print','PlaceId',    IntToStr(vPlaceId));&#13;&#10;    WriteIniFile('Print','PeriodStart',DATETOSTR(dtFrom.Date));&#13;&#10;    WriteIniFile('Print','DateReport', DateToStr(dtReport.Date));&#13;&#10;    WriteIniFile('Print','DateCertif', DATETOSTR(dtCertif.Date));&#13;&#10;    WriteIniFile('Print','PeriodEnd',  DateToStr(dtTo.Date));        &#13;&#10;    WriteIniFile('Print','Import',     VarToStr(rbtImport.Checked));&#13;&#10;    WriteIniFile('Print','Export',     VarToStr(rbtExport.Checked));&#13;&#10;    WriteIniFile('Print','AuthOperat', VarToStr(AuthOperat.Text));&#13;&#10;    WriteIniFile('Print','NumCertif',  VarToStr(NumCertif.Text));&#13;&#10;    WriteIniFile('Print','FioWorker',  VarToStr(FioWorker.Text));&#13;&#10;    WriteIniFile('Print','FunctWorker',VarToStr(FunctWorker.Text));&#13;&#10;    WriteIniFile('Print','NumReport',  VarToStr(NumReport.Text));&#13;&#10;    WriteIniFile('Print','cbxSaveXML', VarToStr(cbxSaveXML.Checked));&#13;&#10;    WriteIniFile('Print','DirSaveXML', VarToStr(DirSaveXML.Text));                        &#13;&#10;    WriteIniFile('Print','INN',        VarToStr(INN.Text));                        &#13;&#10;    &#13;&#10;  if cbxSaveXML.Checked = True&#13;&#10;     then &#13;&#10;       COMPUTE('IF (FileExists (INCLUDETRAILINGBACKSLASH(PROGRAMPATH())+&#34;ProcDocs\2709_2.prd&#34;)=1,  EXECUTESCRIPT(INCLUDETRAILINGBACKSLASH(PROGRAMPATH())+&#34;ProcDocs\2709_2.prd&#34;),)');&#13;&#10;    //Если надо, включим архивы&#13;&#10;   { if not cbxArchive.Checked then&#13;&#10;      NoArchive := 1&#13;&#10;    else NoArchive := 3;}  &#13;&#10;&#13;&#10;    dtPeriodEnd := Trunc(dtTo.Date) + STRTOTIME('23:59:59');&#13;&#10;    dtPeriodStart := Trunc(dtFrom.Date) + STRTOTIME('00:00:00');    &#13;&#10;    //Запомним начало периода отчета&#13;&#10;    // PeriodStart := Trunc(dtFrom.Date) + STRTOTIME('00:00:01');&#13;&#10;&#13;&#10;&#13;&#10;    vSQL := 'SELECT KRD_COMM.PLACEID, KRD_COMM.ID, Acceptdate, G312, G33, G35, G38, G42, G311, G144, G32, G221, G42_CURRENCY, VALCODE ';&#13;&#10;    vSQL := vSQL + ' FROM KRD_MAIN LEFT JOIN KRD_COMM ON ( KRD_MAIN.PLACEID = KRD_COMM.PLACEID )  AND  ( KRD_MAIN.ID = KRD_COMM.ID ) WHERE ' ;                &#13;&#10;     if not cbxAllStores.Checked then vSQL := vSQL + 'KRD_MAIN.PLACEID = ' + IntToStr(vPlaceId) + ' AND ';        &#13;&#10;    vSQL := vSQL + ' KRD_COMM.ACCEPTDATE  &#60;= ' + CHR(39) + VarToStr(dtPeriodEnd) + CHR(39) +&#13;&#10;                   ' AND KRD_COMM.ACCEPTDATE &#62;= ' + CHR(39) + VarToStr(dtPeriodStart) + CHR(39);  &#13;&#10;    If not(rbtExport.Checked) and rbtImport.Checked then vSQL := vSQL+' AND KRD_MAIN.G011 =' + CHR(39) +'ИМ' + CHR(39);&#13;&#10;    If not(rbtImport.Checked) and rbtExport.Checked then vSQL := vSQL+' AND KRD_MAIN.G011 =' + CHR(39) +'ЭК' + CHR(39);&#13;&#10;    vSQL := vSQL + ' AND (KRD_MAIN.SPEC_PRC_CODE &#60;&#62; ' + CHR(39) +'1' + CHR(39) +' or KRD_MAIN.SPEC_PRC_CODE is Null)';  &#13;&#10;    //vSQL := vSQL + ' AND (KRD_COMM.PLACEID=KRD_MAIN.PLACEID) AND (KRD_COMM.ID=KRD_MAIN.ID) ';   &#13;&#10;    vSQL := vSQL + ' ORDER BY KRD_COMM.ID';&#13;&#10;    {' AND ((KRD_COMM.STORAGE_TYPE = &#34;OTВ&#34;) OR  (KRD_COMM.STORAGE_TYPE = &#34;ОТВ&#34;)) '+}        &#13;&#10;    //ShowMessage(vsql);                    &#13;&#10;    MainQuery.SQL.Clear;&#13;&#10;    MainQuery.SQL.Add(vSql);&#13;&#10;    MainQuery.Active:=True;&#13;&#10;&#13;&#10;    //Чтобы взять информацию о складе&#13;&#10;    COMPUTE('FINDKEY(&#34;STORES_2&#34;, [&#34;' + IntToStr(vPlaceId) + '&#34;])');&#13;&#10;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;procedure Page1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;                                                            &#13;&#10;  fldLicExt.Text := '';&#13;&#10;  fldStoreLicNum.Text := '';&#13;&#10;  fldStoreNum.Text := '';&#13;&#10;  vPlaceId:=StrToInt(IniFile('Print','PlaceId','0'));        &#13;&#10;//  vPlaceId:=StrToInt(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;0&#34;)'));&#13;&#10;  If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;])') then begin&#13;&#10;     fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;     fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;     lblStoreName.Caption := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;     fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;     vCanPrint := True;&#13;&#10;     cbtnOk.Enabled := True;&#13;&#10;  end&#13;&#10;  else begin&#13;&#10;    //vPlaceId:=StrToInt(COMPUTE('INIFILE(&#34;WorkPlace&#34;,&#34;PlaceNum&#34;,&#34;0&#34;)'));&#13;&#10;    vPlaceId:=StrToInt(IniFile('WorkPlace','PlaceNum','0'));        &#13;&#10;    If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;])') then begin&#13;&#10;      fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;      fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;      lblStoreName.Caption := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;      fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;      vCanPrint := True;&#13;&#10;      cbtnOk.Enabled := True;&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      fldStoreLicNum.Text := '';&#13;&#10;      fldStoreNum.Text := '№ склада: ';&#13;&#10;      lblStoreName.Caption := '';&#13;&#10;      fldLicExt.Text := '';&#13;&#10;      vCanPrint := False;&#13;&#10;      cbtnOk.Enabled := False;&#13;&#10;    end&#13;&#10;  end;&#13;&#10;    &#13;&#10;  cbxSaveXML.Checked := IniFile('Print','cbxSaveXML', 'False');&#13;&#10;  DirSaveXML.Text := IniFile('Print','DirSaveXML', '');                        &#13;&#10;  INN.Text := IniFile('Print','INN', '');                        &#13;&#10;        &#13;&#10;  cbxAllStores.Checked := IniFile('Print','AllStores', 'False');&#13;&#10;  rbtImport.Checked := IniFile('Print','Import', 'False');&#13;&#10;  rbtExport.Checked := IniFile('Print','Export', 'False');         &#13;&#10;  datestart:= IniFile('Print','PeriodStart', '');&#13;&#10;  dateend := IniFile('Print','PeriodEnd', ''); &#13;&#10;  dtFrom.Date := STRTODATEDEF(datestart, DATE);&#13;&#10;  dtTo.Date := STRTODATEDEF(dateend, DATE);&#13;&#10;  dateReport:= IniFile('Print','dateReport', ''); &#13;&#10;  dateCertif := IniFile('Print','dateCertif', '');&#13;&#10;  dtReport.Date := STRTODATEDEF(dateReport, DATE);&#13;&#10;  dtCertif.Date := STRTODATEDEF(dateCertif, DATE);      &#13;&#10;  AuthOperat.Text  :=  IniFile('Print','AuthOperat', '');&#13;&#10;  NumCertif.Text  := IniFile('Print','NumCertif', ''); &#13;&#10;  FioWorker.Text  := IniFile('Print','FioWorker', ''); &#13;&#10;  FunctWorker.Text  := IniFile('Print','FunctWorker', '');&#13;&#10;  NumReport.Text  :=  IniFile('Print','NumReport', '');   &#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;              &#13;&#10;  //Запомним ID для установки номера текущей строки&#13;&#10;  vID := &#60;MainQuery.&#34;ID&#34;&#62;;&#13;&#10;  vPlaceId := &#60;MainQuery.&#34;PLACEID&#34;&#62;;&#13;&#10;  vG32 :=&#60;MainQuery.&#34;G32&#34;&#62;;&#13;&#10;&#13;&#10;&#13;&#10;  vLicenceNo := '';&#13;&#10;  COMPUTE('FINDKEY(&#34;STORES_2&#34;, [&#34;' + VarToStr(vPlaceId) + '&#34;])');&#13;&#10;  //№ лицензии СВХ&#13;&#10;  if Length(&#60;MainQuery.&#34;G144&#34;&#62;) &#62; 0 then&#13;&#10;    vLicenceNo := &#60;MainQuery.&#34;G144&#34;&#62;&#13;&#10;  else vLicenceNo := &#60;STORES_2.&#34;LICENCENO&#34;&#62;;&#13;&#10;  //Название таможенного поста&#13;&#10;  vCustomName := &#60;STORES_2.&#34;CUSTOMS_NAME&#34;&#62;;&#13;&#10;&#13;&#10;  //Номер по порядку&#13;&#10;  NumLines := NumLines + 1;&#13;&#10;  vNumline := VARtoSTR(NumLines);&#13;&#10;&#13;&#10;  vWayBill:='';&#13;&#10;  vInv:='';&#13;&#10;  vKont:='';    &#13;&#10;  COMPUTE('OPENQUERY(&#34;QRYREFPAPERS&#34;, &#34;STS_DB&#34;, &#34;SELECT PAPER_DOCG44_CODE, PAPERNAME ' + &#13;&#10;                                               'FROM PAPERS ' + &#13;&#10;                                               'WHERE PAPER_IS_WAYBILL = 1&#34;)');&#13;&#10;  sPaperNames := '|' + COMPUTE('JOINVALUES(&#34;QRYREFPAPERS&#34;, &#34;|&#34;, [&#34;PAPERNAME&#34;])') + '|';&#13;&#10;  sPaperCodes := '|' + COMPUTE('JOINVALUES(&#34;QRYREFPAPERS&#34;, &#34;|&#34;, [&#34;PAPER_DOCG44_CODE&#34;])') + '|';&#13;&#10;  COMPUTE('CLOSEDATASET(&#34;QRYREFPAPERS&#34;)');&#13;&#10;  &#13;&#10;  &#13;&#10;  COMPUTE('SETRANGE(&#34;KRD_COMM_PAPERS_2&#34;, [&#34;' + VARTOSTR(&#60;MainQuery.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;ID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;MainQuery.&#34;G32&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#34;13&#34;) + '&#34;])');&#13;&#10;     if StrToInt(COMPUTE('RECORDCOUNT(&#34;KRD_COMM_PAPERS_2&#34;)')) &#62; 0 then begin&#13;&#10;       // есть привязанные ТСД к товару                                                                                       &#13;&#10;       COMPUTE('FIRST(&#34;KRD_COMM_PAPERS_2&#34;)');                               &#13;&#10;       While StrToInt(COMPUTE('EOF(&#34;KRD_COMM_PAPERS_2&#34;)')) = 0 do begin &#13;&#10;         //showmessage(&#60;KRD_COMM_PAPERS_2.&#34;DOC_COUNTER&#34;&#62;);                                                          &#13;&#10;         COMPUTE('SETFILTER(&#34;KRD_PAPERS_2&#34;,  &#34;PLACEID =' + IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;PLACEID&#34;&#62;) +&#13;&#10;                                             'AND ID =' + IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;ID&#34;&#62;) + &#13;&#10;                                             'AND COUNTER =' + IntToStr(&#60;KRD_COMM_PAPERS_2.&#34;DOC_COUNTER&#34;&#62;) + '&#34;)'); &#13;&#10;         IF ((Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;) + '|', sPaperCodes) = 0) and (Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62;) + '|', sPaperNames) = 0)) then&#13;&#10;         begin                                                 &#13;&#10;           if &#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;='03011' then begin &#13;&#10;             if Length(vKont) &#62; 0 then vKont := vKont + ', ';&#13;&#10;             If &#60;KRD_PAPERS_2.&#34;PaperDate&#34;&#62; &#60;&#62; Null then&#13;&#10;               vKont := vKont +  &#60;KRD_PAPERS_2.&#34;PaperNo&#34;&#62; + ' от '+ FormatDateTime('DD.MM.YYYY', &#60;KRD_PAPERS_2.&#34;PaperDate&#34;&#62;)&#13;&#10;             else                         &#13;&#10;               vKont := vKont +  &#60;KRD_PAPERS_2.&#34;PaperNo&#34;&#62;;&#13;&#10;           end;  &#13;&#10;           If (&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;='04021') or (&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;='04022') or (&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;='04023') then begin                                                                                &#13;&#10;             if Length(vInv) &#62; 0 then vInv := vInv + ', ';            &#13;&#10;             If &#60;KRD_PAPERS_2.&#34;PaperDate&#34;&#62; &#60;&#62; Null then&#13;&#10;               vInv := vInv +  &#60;KRD_PAPERS_2.&#34;PaperNo&#34;&#62; + ' от '+ FormatDateTime('DD.MM.YYYY', &#60;KRD_PAPERS_2.&#34;PaperDate&#34;&#62;)                &#13;&#10;             else&#13;&#10;               vInv := vInv + &#60;KRD_PAPERS_2.&#34;PaperNo&#34;&#62;;                &#13;&#10;           end;                      &#13;&#10;         end               &#13;&#10;         else begin                                   &#13;&#10;          if Length(vWayBill) &#62; 0 then vWayBill := vWayBill + ', ';&#13;&#10;          vWayBill:= vWayBill + &#60;KRD_PAPERS_2.&#34;PaperName&#34;&#62; + ' ' + &#60;KRD_PAPERS_2.&#34;PaperNo&#34;&#62;;                                                 &#13;&#10;         end;    &#13;&#10;         COMPUTE('SetFilter(&#34;KRD_PAPERS_2&#34;,&#34;&#34;)');&#13;&#10;         COMPUTE('NEXT(&#34;KRD_COMM_PAPERS_2&#34;)');            &#13;&#10;       end;&#13;&#10;       If (vInv = '') or (vKont = '') or (vWaybill = '') then&#13;&#10;         PrintOnAllPapers();         &#13;&#10;     end    &#13;&#10;     else // нет привязанных к товару ТСД                                                                                   &#13;&#10;       PrintOnAllPapers();                                                          &#13;&#10;       &#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');    &#13;&#10;&#13;&#10;  vG311:= 0; vG35 := 0; vG42 := 0;vG38:=0;&#13;&#10;    //Кол-во при помещении&#13;&#10;  if vUseStoreDocs and (StrToInt(COMPUTE('FINDKEY(&#34;IN_COMM_2&#34;, [&#34;' + IntToStr(vPLaceId) + '&#34;, &#34;' + IntToStr(vID) + '&#34;, &#34;' + IntToStr(vG32) +'&#34;])')) &#60;&#62; 0) then begin&#13;&#10;    vG35 := IIF(&#60;IN_COMM_2.&#34;G35&#34;&#62;&#60;&#62;NULL,&#60;IN_COMM_2.&#34;G35&#34;&#62;,IIF(&#60;MainQuery.&#34;G35&#34;&#62;&#60;&#62;NULL,&#60;MainQuery.&#34;G35&#34;&#62;,0));&#13;&#10;    vG38 := IIF(&#60;IN_COMM_2.&#34;G38&#34;&#62;&#60;&#62;NULL,&#60;IN_COMM_2.&#34;G38&#34;&#62;,IIF(&#60;MainQuery.&#34;G38&#34;&#62;&#60;&#62;NULL,&#60;MainQuery.&#34;G38&#34;&#62;,0));          &#13;&#10;    vG311 := IIF(&#60;IN_COMM_2.&#34;G311&#34;&#62;&#60;&#62;NULL,&#60;IN_COMM_2.&#34;G311&#34;&#62;,IIF(&#60;MainQuery.&#34;G311&#34;&#62;&#60;&#62;NULL,&#60;MainQuery.&#34;G311&#34;&#62;,0));&#13;&#10;    vG42 := IIF(&#60;IN_COMM_2.&#34;G42&#34;&#62;&#60;&#62;NULL,&#60;IN_COMM_2.&#34;G42&#34;&#62;,IIF(&#60;MainQuery.&#34;G42&#34;&#62;&#60;&#62;NULL,&#60;MainQuery.&#34;G42&#34;&#62;,0));&#13;&#10;  end&#13;&#10;  else begin&#13;&#10;   //Кол-во при помещении &#13;&#10;    vG35 := IIF(&#60;MainQuery.&#34;G35&#34;&#62;&#60;&#62;NULL,&#60;MainQuery.&#34;G35&#34;&#62;,0);&#13;&#10;    vG38 := IIF(&#60;MainQuery.&#34;G38&#34;&#62;&#60;&#62;NULL,&#60;MainQuery.&#34;G38&#34;&#62;,0);          &#13;&#10;    vG311 := IIF(&#60;MainQuery.&#34;G311&#34;&#62;&#60;&#62;NULL,&#60;MainQuery.&#34;G311&#34;&#62;,0);&#13;&#10;    vG42 := IIF(&#60;MainQuery.&#34;G42&#34;&#62;&#60;&#62;NULL,&#60;MainQuery.&#34;G42&#34;&#62;,0);        &#13;&#10; end;&#13;&#10;end;  &#13;&#10;&#13;&#10;Procedure PrintOnAllPapers;&#13;&#10;Var&#13;&#10;  bInv, bWayBill, bKont : Boolean;                                                                                  &#13;&#10;begin&#13;&#10;  bInv := (vInv = '');     &#13;&#10;  bKont := (vKont = '');&#13;&#10;  bWaybill := (vWayBill = '');&#13;&#10;    &#13;&#10;  // печатаем все документы                                                                                                                                                  &#13;&#10;  COMPUTE('SETFILTER(&#34;KRD_PAPERS_2&#34;,  &#34;PLACEID =' + IntToStr(&#60;Mainquery.&#34;PLACEID&#34;&#62;) +&#13;&#10;                                      'AND ID =' + IntToStr(&#60;Mainquery.&#34;ID&#34;&#62;) + '&#34;)');   &#13;&#10;  COMPUTE('FIRST(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;  While StrToInt(COMPUTE('EOF(&#34;KRD_PAPERS_2&#34;)')) = 0 do begin&#13;&#10;    //ShowMessage(&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;);                                                &#13;&#10;    IF ((Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;) + '|', sPaperCodes) = 0) and (Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62;) + '|', sPaperNames) = 0)) then&#13;&#10;    begin                             &#13;&#10;      if bKont and (&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;='03011') then &#13;&#10;      begin&#13;&#10;        if Length(vKont) &#62; 0 then vKont := vKont + ', ';&#13;&#10;        If &#60;KRD_PAPERS_2.&#34;PaperDate&#34;&#62; &#60;&#62; Null then&#13;&#10;          vKont := vKont +  &#60;KRD_PAPERS_2.&#34;PaperNo&#34;&#62; + ' от '+ FormatDateTime('DD.MM.YYYY', &#60;KRD_PAPERS_2.&#34;PaperDate&#34;&#62;)&#13;&#10;        else                         &#13;&#10;          vKont := vKont +  &#60;KRD_PAPERS_2.&#34;PaperNo&#34;&#62;;&#13;&#10;      end;                                                     &#13;&#10;      If bInv and ((&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;='04021') or (&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;='04022') or (&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;='04023')) then&#13;&#10;      begin                 &#13;&#10;       if Length(vInv) &#62; 0 then vInv := vInv + ', ';&#13;&#10;       If &#60;KRD_PAPERS_2.&#34;PaperDate&#34;&#62; &#60;&#62; Null then&#13;&#10;         vInv := vInv +  &#60;KRD_PAPERS_2.&#34;PaperNo&#34;&#62; + ' от '+ FormatDateTime('DD.MM.YYYY', &#60;KRD_PAPERS_2.&#34;PaperDate&#34;&#62;)                &#13;&#10;       else&#13;&#10;         vInv := vInv +  &#60;KRD_PAPERS_2.&#34;PaperNo&#34;&#62;;                &#13;&#10;&#13;&#10;      end;                        &#13;&#10;    end               &#13;&#10;    else&#13;&#10;    If bWayBill then begin                             &#13;&#10;      if Length(vWayBill) &#62; 0 then vWayBill := vWayBill + ', ';&#13;&#10;      vWayBill:= vWayBill + &#60;KRD_PAPERS_2.&#34;PaperName&#34;&#62; + ' ' + &#60;KRD_PAPERS_2.&#34;PaperNo&#34;&#62;;                                                 &#13;&#10;    end;         &#13;&#10;    COMPUTE('Next(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;  end;&#13;&#10;  COMPUTE('SetFilter(&#34;KRD_PAPERS_2&#34;,&#34;&#34;)');&#13;&#10;         &#13;&#10;end;          &#13;&#10;&#13;&#10;procedure CheckBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if cbxAllStores.Checked then begin&#13;&#10;    fldStoreLicNum.Enabled := False;&#13;&#10;    fldStoreNum.Enabled := False;&#13;&#10;    lblStoreName.Enabled := False;&#13;&#10;    fldLicExt.Enabled := False;&#13;&#10;    btnCallRef.Enabled := False;&#13;&#10;    lblNumLicence.Enabled := False;&#13;&#10;    cbtnOk.Enabled := True;          &#13;&#10;  end&#13;&#10;  else begin&#13;&#10;    fldStoreLicNum.Enabled := True;&#13;&#10;    fldStoreNum.Enabled := True;&#13;&#10;    lblStoreName.Enabled := True;&#13;&#10;    fldLicExt.Enabled := True;&#13;&#10;    btnCallRef.Enabled := True;&#13;&#10;    lblNumLicence.Enabled := True;&#13;&#10;    if Length(fldStoreLicNum.Text) &#62; 0 then&#13;&#10;      cbtnOk.Enabled := True &#13;&#10;    else cbtnOk.Enabled := False;        &#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;{procedure Band2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;     NumLines := 0;&#13;&#10;end; }  &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;procedure Memo30OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   sValCode := '';                               &#13;&#10;   if &#60;MainQuery.&#34;VALCODE&#34;&#62; &#60;&#62; Null then&#13;&#10;       sValcode := &#60;MainQuery.&#34;VALCODE&#34;&#62;&#13;&#10;   else&#13;&#10;     if  &#60;MainQuery.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; Null then&#13;&#10;         sValcode := COMPUTE('CurrencyAbbr(&#34;'+VarToStr(&#60;MAINQUERY.&#34;G42_CURRENCY&#34;&#62;)+'&#34;)')&#13;&#10;   else&#13;&#10;         sValcode := COMPUTE('CurrencyAbbr(&#34;'+VarToStr(&#60;MAINQUERY.&#34;G221&#34;&#62;)+'&#34;)');  &#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;procedure rbtImportOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; if rbtImport.Checked then&#13;&#10; rbtExport.Checked := False;  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure rbtExportOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; if rbtExport.Checked then&#13;&#10; rbtImport.Checked := False;  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('VAR(&#34;sDir&#34;, String, &#34;&#34;)');&#13;&#10;  COMPUTE('sDir := &#34;&#34;');&#13;&#10;  if COMPUTE('SELECTDIRECTORY (&#34;sDir&#34;)') &#60;&#62; '0' then DirSaveXML.Text := COMPUTE('sDir')  ;&#13;&#10;        &#13;&#10;  &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  //Взяли из ini-шника &#34;Только таможенные документы учета&#34;&#13;&#10;  CustomDocsOnly := StrToInt(IniFile('RegBook','CustomsDocsOnly','0'));                &#13;&#10;  //Включена ли настройка &#34;Совместимость с АИСТом&#34;, 1-да, 0-нет&#13;&#10;  AistCompatible := StrToInt(IniFile('Docs', 'AistCompatible', '0'));      &#13;&#10;  //Отключен ли блок складских документов&#13;&#10;  StoreDocsBlock := StrToInt(IniFile('Database', 'StoreDocsBlock', '0'));      &#13;&#10;  if AistCompatible = 1 then&#13;&#10;    vUseStoreDocs := True&#13;&#10;  else vUseStoreDocs := False;&#13;&#10;end.&#13;&#10;  " OnStartReport="OnStartReport"><Datasets><item DataSet="ds_IN_COMM_2" DataSetName="IN_COMM_2"/><item DataSet="ds_KRD_COMM_PAPERS_2" DataSetName="KRD_COMM_PAPERS_2"/><item DataSet="ds_KRD_PAPERS_2" DataSetName="KRD_PAPERS_2"/><item DataSet="MainQuery" DataSetName="MainQuery"/><item DataSet="ds_STORES_2" DataSetName="STORES_2"/></Datasets><TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"><TfrxBDEQuery Name="MainQuery" UserName="MainQuery" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT &#13;&#10; KRD_COMM.PLACEID, &#13;&#10; KRD_COMM.ID, &#13;&#10; Acceptdate, &#13;&#10; G312, &#13;&#10; G33, &#13;&#10; G35, &#13;&#10; G38, &#13;&#10; G42, &#13;&#10; G311, &#13;&#10; G144, &#13;&#10; G32, &#13;&#10; G221, &#13;&#10; G42_CURRENCY, &#13;&#10; VALCODE&#13;&#10;FROM KRD_MAIN LEFT JOIN KRD_COMM ON &#13;&#10;     (( KRD_MAIN.PLACEID = KRD_COMM.PLACEID )  AND  ( KRD_MAIN.ID = KRD_COMM.ID ))&#13;&#10;WHERE KRD_MAIN.PLACEID =-1                                 " DatabaseName="STS_DB" SessionName="Default" PropData="05704C656674023C0470546F7002140A506172616D65746572730100"/></TfrxDataPage><TfrxDialogPage Name="Page1" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Экономический оператор" Height="436" ClientHeight="397" Left="456" Top="196" Width="537" ClientWidth="521" OnActivate="Page1OnActivate"><TfrxColorButtonControl Name="cbtnOk" Left="340" Top="370" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" Caption="Просмотр" Color="-16777201" Flat="False" GradientType="gtNone" ModalResult="1" OnClick="cbtnOkOnBeforePrint"/><TfrxColorFrameControl Name="ColorFrame1" Left="1" Top="2" Width="288" Height="228" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201"><TfrxEditControl Name="fldStoreLicNum" Left="90" Top="14" Width="106" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="039/000049"/><TfrxLabelControl Name="lblNumLicence" Left="5" Top="18" Width="65" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="№ лицензии:" Color="-16777201"/><TfrxButtonControl Name="btnCallRef" Left="170" Top="16" Width="24" Height="18" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" OnClick="btnCallRefOnBeforePrint"/><TfrxEditControl Name="fldStoreNum" Left="199" Top="14" Width="81" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777212" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="№ склада: 8"/><TfrxEditControl Name="fldLicExt" Left="75" Top="14" Width="15" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="А"/><TfrxLabelControl Name="lblStoreName" Left="3" Top="38" Width="273" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" Alignment="taCenter" AutoSize="False" Caption="ЗАО &#34;КОМИНА&#34;" Color="-16777201"/><TfrxCheckBoxControl Name="cbxAllStores" Left="15" Top="58" Width="109" Height="17" ShowHint="True" Caption="По всем складам" Color="-16777201" OnClick="CheckBox1OnClick"/><TfrxColorFrameControl Name="ColorFrame3" Left="11" Top="86" Width="268" Height="60" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="За период" Color="-16777201"><TfrxLabelControl Name="Label1" Left="8" Top="31" Width="11" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="С" Color="-16777201"/><TfrxLabelControl Name="Label2" Left="139" Top="32" Width="12" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="по" Color="-16777201"/><TfrxDateEditControl Name="dtFrom" Left="24" Top="28" Width="109" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="40633" Time="40633" WeekNumbers="False"/><TfrxDateEditControl Name="dtTo" Left="156" Top="28" Width="105" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="40633" Time="40633" WeekNumbers="False"/></TfrxColorFrameControl><TfrxDateEditControl Name="DtReport" Left="163" Top="158" Width="105" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="40633" Time="40633" WeekNumbers="False"/><TfrxLabelControl Name="Label9" Left="19" Top="162" Width="88" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="Дата отчета" Color="-16777201"/><TfrxEditControl Name="NumReport" Left="163" Top="194" Width="107" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/><TfrxLabelControl Name="Label10" Left="19" Top="198" Width="76" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="Номер отчета" Color="-16777201"/></TfrxColorFrameControl><TfrxColorButtonControl Name="cBtnCancel" Left="432" Top="370" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Отмена" Color="-16777201" Flat="False" GradientType="gtNone" ModalResult="2"/><TfrxColorFrameControl Name="ColorFrame4" Left="300" Top="180" Width="216" Height="52" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Направление перемещения" Color="-16777201"><TfrxCheckBoxControl Name="rbtImport" Left="16" Top="24" Width="69" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Импорт" Color="-16777201" OnClick="rbtImportOnClick"/><TfrxCheckBoxControl Name="rbtExport" Left="112" Top="24" Width="61" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Экспорт" Color="-16777201" OnClick="rbtExportOnClick"/></TfrxColorFrameControl><TfrxColorFrameControl Name="ColorFrame5" Left="4" Top="240" Width="512" Height="68" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Работник склада" Color="-16777201"><TfrxEditControl Name="FunctWorker" Left="276" Top="40" Width="231" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/><TfrxLabelControl Name="Label6" Left="276" Top="16" Width="204" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="Должность работника склада" Color="-16777201"/><TfrxEditControl Name="FioWorker" Left="8" Top="40" Width="235" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/><TfrxLabelControl Name="Label7" Left="8" Top="20" Width="204" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="ФИО работника склада" Color="-16777201"/></TfrxColorFrameControl><TfrxColorFrameControl Name="ColorFrame6" Left="300" Top="4" Width="216" Height="172" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Экономический оператор" Color="-16777201"><TfrxEditControl Name="AuthOperat" Left="4" Top="68" Width="207" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/><TfrxLabelControl Name="Label3" Left="4" Top="51" Width="204" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="Уполномоченный  экон.  оператор" Color="-16777201"/><TfrxEditControl Name="NumCertif" Left="4" Top="108" Width="207" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/><TfrxLabelControl Name="Label5" Left="4" Top="90" Width="204" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="№ свидетельства" Color="-16777201"/><TfrxDateEditControl Name="DtCertif" Left="4" Top="146" Width="105" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="40633" Time="40633" WeekNumbers="False"/><TfrxLabelControl Name="Label8" Left="4" Top="129" Width="204" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="Дата свидетельства" Color="-16777201"/><TfrxEditControl Name="INN" Left="4" Top="29" Width="207" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/><TfrxLabelControl Name="Label11" Left="4" Top="15" Width="204" Height="12" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="ИНН" Color="-16777201"/></TfrxColorFrameControl><TfrxColorFrameControl Name="ColorFrame2" Left="4" Top="312" Width="512" Height="56" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Файл XML для ФТС России" Color="-16777201"><TfrxCheckBoxControl Name="cbxSaveXML" Left="12" Top="22" Width="105" Height="18" ShowHint="True" Caption="Выгружать файл" Color="-16777201"/><TfrxEditControl Name="DirSaveXML" Left="204" Top="21" Width="273" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/><TfrxButtonControl Name="Button1" Left="477" Top="20" Width="27" Height="23" ShowHint="True" Caption="..." OnClick="Button1OnClick"/><TfrxLabelControl Name="Label4" Left="124" Top="25" Width="80" Height="16" ShowHint="True" AutoSize="False" Caption="Папка для XML:" Color="-16777201"/></TfrxColorFrameControl></TfrxDialogPage><TfrxReportPage Name="Page2" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="8" RightMargin="8" TopMargin="6" BottomMargin="6" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False" OnBeforePrint="Page2OnBeforePrint"><TfrxReportTitle Name="Band2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="192.75603" Left="0" Top="16" Width="1062.04793"><TfrxMemoView Name="Memo2" ShiftMode="smWhenOverlapped" Left="903.30767" Top="3.77953000000001" Width="136.06308" Height="41.57483" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Приложение №2&#13;&#10;к приказу ФТС России&#13;&#10;от 30.12.2010 № 2709"/><TfrxMemoView Name="Memo12" ShiftMode="smWhenOverlapped" Left="11.33859" Top="45.35436" Width="287.24428" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Уполномоченный экономический оператор"/><TfrxLineView Name="Line1" Left="306.14193" Top="64.25201" Width="317.48052" Height="0" Color="0" Frame.Typ="4"/><TfrxMemoView Name="Memo14" ShiftMode="smWhenOverlapped" Left="11.33859" Top="75.5906" Width="260.78757" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Свидетельство о включении в реестр от"/><TfrxLineView Name="Line3" Left="279.68522" Top="94.48825" Width="94.48825" Height="0" Color="0" Frame.Typ="4"/><TfrxMemoView Name="Memo17" ShiftMode="smWhenOverlapped" Left="381.73253" Top="75.5906" Width="18.89765" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="№"/><TfrxLineView Name="Line4" Left="408.18924" Top="94.48825" Width="215.43321" Height="0" Color="0" Frame.Typ="4"/><TfrxMemoView Name="Memo20" ShiftMode="smWhenOverlapped" Left="249.44898" Top="105.82684" Width="287.24428" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="Отчетность экономического оператора от"/><TfrxLineView Name="Line5" Left="548.03185" Top="124.72449" Width="86.92919" Height="0" Color="0" Frame.Typ="4"/><TfrxMemoView Name="Memo24" ShiftMode="smWhenOverlapped" Left="642.5201" Top="105.82684" Width="18.89765" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="№"/><TfrxLineView Name="Line6" Left="672.75634" Top="124.72449" Width="139.84261" Height="0" Color="0" Frame.Typ="4"/><TfrxMemoView Name="Memo25" ShiftMode="smWhenOverlapped" Left="11.33859" Top="136.06308" Width="1043.15028" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="о товарах помещенных на временное хранение"/><TfrxMemoView Name="Memo27" ShiftMode="smWhenOverlapped" Left="393.07112" Top="162.51979" Width="15.11812" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="c"/><TfrxLineView Name="Line7" Left="411.96877" Top="181.41744" Width="117.16543" Height="0" Color="0" Frame.Typ="4"/><TfrxMemoView Name="Memo33" ShiftMode="smWhenOverlapped" Left="540.47279" Top="162.51979" Width="26.45671" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="по"/><TfrxLineView Name="Line8" Left="566.9295" Top="181.41744" Width="113.3859" Height="0" Color="0" Frame.Typ="4"/><TfrxMemoView Name="Memo34" ShiftMode="smWhenOverlapped" Left="411.96877" Top="162.51979" Width="120.94496" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[FormatDateTime('DD.MM.YYYY', dtPeriodStart)]"/><TfrxMemoView Name="Memo37" ShiftMode="smWhenOverlapped" Left="566.9295" Top="162.51979" Width="113.3859" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[FormatDateTime('DD.MM.YYYY', dtPeriodEnd)]"/><TfrxMemoView Name="Memo38" ShiftMode="smWhenOverlapped" Left="408.18924" Top="75.5906" Width="219.21274" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[NumCertif.text]"/><TfrxMemoView Name="Memo39" ShiftMode="smWhenOverlapped" Left="272.12616" Top="75.5906" Width="105.82684" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[FormatDateTime('DD.MM.YYYY', DtCertif.date)]"/><TfrxMemoView Name="Memo40" ShiftMode="smWhenOverlapped" Left="306.14193" Top="45.35436" Width="321.26005" Height="18.89765" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" ParentFont="False" Text="[AuthOperat.text]"/><TfrxMemoView Name="Memo41" ShiftMode="smWhenOverlapped" Left="548.03185" Top="105.82684" Width="86.92919" Height="18.89765" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[FormatDateTime('DD.MM.YYYY',DtReport.date)]"/><TfrxMemoView Name="Memo43" ShiftMode="smWhenOverlapped" Left="672.75634" Top="105.82684" Width="139.84261" Height="18.89765" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="8" HAlign="haCenter" ParentFont="False" Text="[NumReport.Text]"/></TfrxReportTitle><TfrxReportSummary Name="Band3" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="66.47248" Left="0" Top="380" Width="1062.04793"><TfrxMemoView Name="Memo36" Left="7.55905024" Top="15.1181078" Width="415.7480315" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="8" HAlign="haCenter" ParentFont="False" Underlines="True" Text="[FunctWorker.Text]"/><TfrxMemoView Name="Memo42" Left="464.88188976" Top="15.1181078" Width="151.18110236" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" ParentFont="False" Underlines="True" Text=""/><TfrxMemoView Name="Memo44" ShiftMode="smWhenOverlapped" Left="11.33859" Top="30.23624" Width="419.52783" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="(должность уполномоченного работника склада)"/><TfrxMemoView Name="Memo45" ShiftMode="smWhenOverlapped" Left="464.88219" Top="30.23624" Width="151.1812" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="(подпись)"/><TfrxMemoView Name="Memo46" ShiftMode="smWhenOverlapped" Left="650.07916" Top="30.23624" Width="151.1812" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="(инициалы, фамилия)"/><TfrxMemoView Name="Memo47" ShiftMode="smWhenOverlapped" Left="839.05566" Top="30.23624" Width="151.1812" Height="18.89765" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="(дата)"/><TfrxMemoView Name="Memo16" Left="650.07916" Top="15.11812" Width="151.18110236" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="8" HAlign="haBlock" ParentFont="False" Underlines="True" Text="[FioWorker.Text]"/><TfrxMemoView Name="Memo35" Left="839.05566" Top="15.11812" Width="151.18110236" Height="15.11811024" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="8" HAlign="haCenter" ParentFont="False" Underlines="True" Text="[FormatDateTime('DD.MM.YYYY',DtReport.date)]"/></TfrxReportSummary><TfrxPageHeader Name="PageHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="90.70863457" Left="0" Top="228" Width="1062.04793"><TfrxMemoView Name="Memo63" Left="7.55905268" Top="0" Width="34.01574594" Height="71.81098457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="№ п/п"/><TfrxMemoView Name="Memo13" Left="695.43313921" Top="0" Width="68.03149362" Height="71.81098457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Вес нетто товара, кг"/><TfrxMemoView Name="Memo23" Left="41.57480559" Top="0" Width="86.92911433" Height="71.81098457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Дата помещения товара на хранение"/><TfrxMemoView Name="Memo26" Left="128.50391992" Top="0" Width="154.9606885" Height="71.81098457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Наименование и номер транспортного документа"/><TfrxMemoView Name="Memo11" Left="627.40169685" Top="0" Width="68.03149362" Height="71.81098457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Вес брутто товара, кг"/><TfrxMemoView Name="Memo21" Left="283.46460598" Top="0" Width="275.90556919" Height="71.81098457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Наименование товара"/><TfrxMemoView Name="Memo1" Left="559.37019835" Top="0" Width="68.03150094" Height="71.81098457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Код товара в соответст- вии с ГС или ТН ВЭД"/><TfrxMemoView Name="Memo19" Left="763.46463283" Top="0" Width="79.37003377" Height="71.81098457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Фактурная стоимость товара"/><TfrxMemoView Name="Memo15" Left="842.83519" Top="0" Width="109.60631452" Height="71.81098457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Номер и дата документа,&#13;&#10;подтверждающего фактурную&#13;&#10;стоимость товара"/><TfrxMemoView Name="Memo6" ShiftMode="smWhenOverlapped" Left="952.44156" Top="0" Width="98.26778" Height="71.81098457" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Номер внешнеторгового договора"/><TfrxMemoView Name="Memo5" Left="7.55906" Top="71.81107" Width="34.01574594" Height="18.89756457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="1"/><TfrxMemoView Name="Memo48" Left="41.57483" Top="71.81107" Width="86.92916594" Height="18.89756457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="2"/><TfrxMemoView Name="Memo49" Left="128.50402" Top="71.81107" Width="154.96070594" Height="18.89756457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="3"/><TfrxMemoView Name="Memo50" Left="283.46475" Top="71.81107" Width="275.90566594" Height="18.89756457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="4"/><TfrxMemoView Name="Memo51" Left="559.37044" Top="71.81107" Width="68.03151594" Height="18.89756457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="5"/><TfrxMemoView Name="Memo52" Left="627.40198" Top="71.81107" Width="68.03151594" Height="18.89756457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="6"/><TfrxMemoView Name="Memo53" Left="695.43352" Top="71.81107" Width="68.03151594" Height="18.89756457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="7"/><TfrxMemoView Name="Memo54" Left="763.46506" Top="71.81107" Width="79.37010594" Height="18.89756457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="8"/><TfrxMemoView Name="Memo55" Left="842.83519" Top="71.81107" Width="109.60634594" Height="18.89756457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="9"/><TfrxMemoView Name="Memo56" Left="952.44156" Top="71.81107" Width="98.26775594" Height="18.89756457" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="10"/></TfrxPageHeader><TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="30" Left="0" Top="468" Width="1062.04793"><TfrxMemoView Name="Memo9" Left="852" Top="8.00000000000011" Width="196" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haRight" ParentFont="False" Text="Страница [PAGE#]"/><TfrxMemoView Name="Memo7" Left="191.02018547" Top="8.00000000000011" Width="660" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ВЭД-Склад   Copyright (C) ООО &#34;СТМ&#34;,1999-[FORMATDATETIME(&#34;YYYY&#34;, DATE)].            Internet: www.ctm.ru"/><TfrxLineView Name="Line2" Left="5" Top="4.00000000000011" Width="1050" Height="0" Color="0" Frame.Typ="4" Frame.Width="2"/><TfrxMemoView Name="Memo8" Left="12" Top="8.00000000000011" Width="176" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="[Date] [Time]"/></TfrxPageFooter><TfrxMasterData Name="MasterData2" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18.8976378" Left="0" Top="340" Width="1062.04793" OnBeforePrint="MasterData2OnBeforePrint" Columns="1" ColumnWidth="200.314960629921" ColumnGap="18.8976377952756" DataSet="MainQuery" DataSetName="MainQuery" RowCount="0" Stretched="True"><TfrxMemoView Name="Memo3" ShiftMode="smWhenOverlapped" Left="7.55906209" Top="0" Width="34.01576791" Height="18.8976378" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vNumLine]"/><TfrxMemoView Name="Memo4" ShiftMode="smWhenOverlapped" Left="41.57480559" Top="0" Width="86.92919" Height="18.8976378" StretchMode="smMaxHeight" DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[MainQuery.&#34;Acceptdate&#34;]"/><TfrxMemoView Name="Memo10" ShiftMode="smWhenOverlapped" Left="128.50391992" Top="0" Width="154.96073" Height="18.8976378" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[vWayBill]"/><TfrxMemoView Name="Memo18" ShiftMode="smWhenOverlapped" Left="283.46460598" Top="0" Width="275.90569" Height="18.8976378" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[MainQuery.&#34;G312&#34;]"/><TfrxMemoView Name="Memo22" ShiftMode="smWhenOverlapped" Left="559.37019835" Top="0" Width="68.03150094" Height="18.8976378" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[MainQuery.&#34;G33&#34;]"/><TfrxMemoView Name="Memo28" ShiftMode="smWhenOverlapped" Left="627.40169685" Top="0" Width="68.03149362" Height="18.8976378" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[vG35]"/><TfrxMemoView Name="Memo29" ShiftMode="smWhenOverlapped" Left="695.43313921" Top="0" Width="68.03149362" Height="18.8976378" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[vG38]"/><TfrxMemoView Name="Memo30" ShiftMode="smWhenOverlapped" Left="763.46510496" Top="0" Width="79.37008504" Height="18.8976378" OnBeforePrint="Memo30OnBeforePrint" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[vG42] [sValCode]"/><TfrxMemoView Name="Memo31" ShiftMode="smWhenOverlapped" Left="842.83519" Top="0" Width="109.60637" Height="18.8976378" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vInv]"/><TfrxMemoView Name="Memo32" ShiftMode="smWhenOverlapped" Left="952.44156" Top="0" Width="98.26778" Height="18.8976378" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vKont]"/></TfrxMasterData></TfrxReportPage></TfrxReport>