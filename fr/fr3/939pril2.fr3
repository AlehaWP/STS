<?xml version="1.0" encoding="utf-8" standalone="no"?><TfrxReport Version="4.6.78" DotMatrixReport="False" EngineOptions.ConvertNulls="False" EngineOptions.DoublePass="True" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38262.5345068287" ReportOptions.Description.Text="" ReportOptions.LastChange="40940.6535589583" ScriptLanguage="PascalScript" ScriptText.Text="VAR&#13;&#10;   dtPeriodEnd, dtPeriodStart, dtDateReport1: TDATETIME;&#13;&#10;   vFilterCrit, datestart, dateend, sStoreDate, sStoreNum, vPlaceId, vLdate,&#13;&#10;   sUnName, vG46, vOldCurrency, vG46Rest, vRestG311: String;&#13;&#10;   sDeclCnt, StoreDocsBlock, CustomDocsOnly, AistCompatible, vNumLine: Integer;&#13;&#10;   vG311, vSumRelG311, vG35, vRest, vSumRelG35, vSumRelG315C, vSumRelG315A,&#13;&#10;   vG42, vSumRelG42, fG46Rest: Double;&#13;&#10;   bSTORexists : Boolean;&#13;&#10;   sqlText, sqlText1, sqlText2, sqlText3, sWhere, sWhere1, sWhere2, sOrderBy : String;                                                                    &#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Page1, Engine do&#13;&#10;  begin&#13;&#10;  rbtnConst.Checked := True;&#13;&#10;  dtSvidEnd.Enabled := False;&#13;&#10;&#13;&#10;  DateStart:=COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;&#34;)');&#13;&#10;  DateEnd := COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;&#34;)');&#13;&#10;  dtFrom.Date := STRTODATEDEF(datestart, DATE);&#13;&#10;  dtTo.Date := STRTODATEDEF(dateend, DATE);&#13;&#10;  dtDateReport.Date := Date;                         &#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ColorButton1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    COMPUTE(' globalvar (&#34;strStoreNumLic&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;strStoreNum&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;strStoreName&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;strLicExt&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;sChief&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;sPlaceId&#34;,Integer)');&#13;&#10;    COMPUTE(' globalvar (&#34;sLicenceDate&#34;,DateTime)');&#13;&#10;    COMPUTE('OPENQUERY (&#34;Stors&#34;, &#34;STS_DB&#34;, &#34;Select * from STORES&#34;)');&#13;&#10;  &#13;&#10;    IF COMPUTE('SelectRecords(&#34;Выбор складских площадок&#34;, &#34;STORS&#34;,'+&#13;&#10;                          '['+&#13;&#10;                           '[&#34;LICENCENO&#34;, &#34;№ лицензии&#34;, 12],'+&#13;&#10;                           '[&#34;STORE_NO&#34;, &#34;№ склада&#34;, 8],'+&#13;&#10;                           '[&#34;NAME&#34;, &#34;Название склада&#34;, 30]'+&#13;&#10;                           '],'+&#13;&#10;                           '&#34;STOR&#34;, &#34;&#34;, &#34;STS_DB&#34;)') = '1' then&#13;&#10;&#13;&#10;      begin&#13;&#10;        bSTORexists := True;&#13;&#10;        COMPUTE('FIRST(&#34;STOR&#34;)');&#13;&#10;        fldStoreLic.Text := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;LICENCENO&#34;)');  //   номер  лиценцзии&#13;&#10;        fldStoreNum := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;STORE_NO&#34;)') ; //   номер склада&#13;&#10;        fldStoreNm.Text :=COMPUTE('FieldValue(&#34;Stor&#34;, &#34;NAME&#34;)') ;     //   название склада&#13;&#10;        fldLicExt.Text := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;LICENCENO_EXT&#34;)');     //   Признак перерегистрации&#13;&#10;        vPlaceId := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;PLACEID&#34;)');&#13;&#10;        //vChief  := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;Chief&#34;)');   // уполномоченный представитель склада&#13;&#10;&#13;&#10;        //vLdate := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;LICENCEDATE&#34;)');&#13;&#10;        COMPUTE('FINDKEY(&#34;STORES_2&#34;, [&#34;' + VARTOSTR(vPlaceid) + '&#34;])');&#13;&#10;        vLdate:=  VARTOSTR(&#60;STORES_2.&#34;LICENCEDATE&#34;&#62;);&#13;&#10;        If COMPUTE('RECORDCOUNT(&#34;STOR&#34;)') &#60;&#62; '1' then&#13;&#10;          vPlaceId :='0'&#13;&#10;        else vPlaceId := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;PLACEID&#34;)');            &#13;&#10;        //fldStoreLicDate.Date := STRTODATEDEF(vLDate, Date);  // дата выдачи лицензии&#13;&#10;        If vLDate  &#60;&#62; '' then&#13;&#10;        //If (vLDate  &#60;&#62; '..') or (vLDate  &#60;&#62; '') or (vLDate &#60;&#62; Null) then            &#13;&#10;          btnOK.Enabled := True&#13;&#10;        else&#13;&#10;          begin&#13;&#10;            ShowMessage('Заполните дату выдачи лицензии в &#34;Информации о складе&#34;!');&#13;&#10;            btnOK.Enabled := False&#13;&#10;          end&#13;&#10;      end&#13;&#10;    else&#13;&#10;      begin&#13;&#10;        btnOk.Enabled := False;&#13;&#10;      end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure btnOkOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with btnOk, Engine do&#13;&#10;  begin&#13;&#10;     //Взяли из ini-шника &#34;Только таможенные документы учета&#34;&#13;&#10;     CustomDocsOnly := STRTOINT(COMPUTE('INIFILE(&#34;RegBook&#34;, &#34;CustomsDocsOnly&#34;, 0)'));&#13;&#10;     //Совместимость с аистом&#13;&#10;     AistCompatible := STRTOINT(COMPUTE('INIFILE(&#34;Docs&#34;, &#34;AistCompatible&#34;, 0)'));&#13;&#10;&#13;&#10;     //Складские документы&#13;&#10;     StoreDocsBlock := StrToInt(COMPUTE('INIFILE(&#34;Database&#34;, &#34;StoreDocsBlock&#34;, 0)'));&#13;&#10;&#13;&#10;     dtDateReport1 := Trunc(dtDateReport.Date);    &#13;&#10;     //Далее см. Params к таблицам&#13;&#10;     if rbtnConst.Checked = True then&#13;&#10;       begin&#13;&#10;         dtPeriodEnd := Trunc(dtTo.Date) + STRTOTIME('23:59:59');&#13;&#10;         dtPeriodStart := Trunc(dtFrom.Date) + STRTOTIME('00:00:00')&#13;&#10;       end&#13;&#10;     else&#13;&#10;       begin&#13;&#10;         dtPeriodEnd := Trunc(dtSvidEnd.Date) + STRTOTIME('23:59:59');&#13;&#10;         COMPUTE('FINDKEY(&#34;STORES_2&#34;, [&#34;' + VARTOSTR(vPlaceid) + '&#34;])');&#13;&#10;         //dtPeriodStart := &#60;STORES_2.&#34;LICENCEDATE&#34;&#62; + STRTOTIME('00:00:00')&#13;&#10;         dtPeriodStart:= STRTODATEDEF(vLDate, Date)  + STRTOTIME('00:00:00');                         &#13;&#10;       end;&#13;&#10;&#13;&#10;&#13;&#10;       sqlText:='SELECT stores.licenceno as licenceno, stores.placeid as s_placeid, '+     &#13;&#10;         'krd_comm.g32, krd_comm.G315CN, krd_comm.G41A, krd_comm.G315A, krd_comm.G315C, '+  &#13;&#10;         'krd_comm.FACT_G35, krd_comm.G35, krd_comm.G42_CURRENCY, krd_comm.G42, krd_comm.G311, '+  &#13;&#10;         'krd_comm.G33, krd_comm.BOXNO, krd_comm.acceptdate, '+  &#13;&#10;         'krd_main.placeid, krd_main.id, krd_main.nbd, '+  &#13;&#10;         'krd_main.G221, krd_main.G19, krd_main.BD_DATE, krd_main.BEG_KEEP, '+  &#13;&#10;         'stores.G142, stores.address '+  &#13;&#10;         'FROM (stores LEFT JOIN krd_main ON (krd_main.placeid = stores.placeid)) '+  &#13;&#10;                       'LEFT JOIN krd_comm ON (krd_main.placeid = krd_comm.placeid '+  &#13;&#10;                                          'AND krd_main.id = krd_comm.id) ';&#13;&#10;       sqlText1:='SELECT COUNT (DISTINCT STORE_CONTRACT_NO) AS COUNT_CONTRACTS FROM KRD_MAIN ';&#13;&#10;       sqlText2:='SELECT COUNT (DISTINCT ND_GTD) AS COUNT_GTD '+    &#13;&#10;         'FROM out_main LEFT JOIN out_comm ON ((out_main.placeid = out_comm.placeid) '+  &#13;&#10;                                          'AND (out_main.id = out_comm.id) '+&#13;&#10;                                          'AND (out_main.actoutid = out_comm.actoutid)) ';                                                &#13;&#10;       sqlText3:='SELECT COUNT (DISTINCT DOC_NO) AS COUNT_GTD FROM  '+CorrectTableName('RELEASE') + ' r ';                                                &#13;&#10;             &#13;&#10;       sOrderBy:='ORDER BY krd_comm.ACCEPTDATE, krd_main.NBD, krd_comm.g32';  &#13;&#10;       sWhere := ' WHERE (krd_main.notice_rw_only = 0) '+&#13;&#10;                         'AND (krd_comm.acceptdate &#60;= ' + CHR(39) + VarToStr(dtPeriodEnd) + CHR(39) + ' ) '+        &#13;&#10;                         'AND (krd_comm.acceptdate &#62;= ' + CHR(39) + VarToStr(dtPeriodStart) + CHR(39) +' )';&#13;&#10;       sWhere1 := ' WHERE (out_main.g542 &#60;= ' + CHR(39) + VarToStr(dtPeriodEnd) + CHR(39) + ' ) '+        &#13;&#10;                         'AND (out_main.g542 &#62;= ' + CHR(39) + VarToStr(dtPeriodStart) + CHR(39) +' )';&#13;&#10;       sWhere2 := ' WHERE (r.RELEASE_DATE &#60;= ' + CHR(39) + VarToStr(dtPeriodEnd) + CHR(39) + ' ) '+        &#13;&#10;                         'AND (r.RELEASE_DATE &#62;= ' + CHR(39) + VarToStr(dtPeriodStart) + CHR(39) +' )';                                 &#13;&#10;                             &#13;&#10;                             &#13;&#10;       if vPlaceId &#60;&#62; '0' then&#13;&#10;         begin&#13;&#10;           sqlText:=sqlText+sWhere+' AND (krd_main.placeid = '+ vPlaceId+') '+ sOrderBy;&#13;&#10;           sqlText1:=sqlText1+sWhere+' AND (krd_main.placeid = '+ vPlaceId+') ';&#13;&#10;           sqlText2:=sqlText2+sWhere1+' AND (out_main.placeid = '+ vPlaceId+') ';&#13;&#10;           sqlText3:=sqlText3+sWhere2+' AND (r.placeid = '+ vPlaceId+') ';               &#13;&#10;         end&#13;&#10;       else&#13;&#10;         begin&#13;&#10;           COMPUTE('FIRST(&#34;STOR&#34;)');&#13;&#10;           vPlaceId := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;PLACEID&#34;)');&#13;&#10;           sWhere:=sWhere+' AND ((krd_main.placeid = '+ vPlaceId+') ';&#13;&#10;           sWhere1:=sWhere1+' AND ((out_main.placeid = '+ vPlaceId+') ';&#13;&#10;           sWhere2:=sWhere2+' AND ((r.placeid = '+ vPlaceId+') ';               &#13;&#10;           COMPUTE('Next(&#34;STOR&#34;)');&#13;&#10;           while COMPUTE('EOF(&#34;STOR&#34;)') = '0' do begin&#13;&#10;             vPlaceId := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;PLACEID&#34;)');&#13;&#10;             sWhere := sWhere + ' OR (krd_main.PLACEID= '+ vPlaceId+') ';&#13;&#10;             sWhere1 := sWhere1 + ' OR (out_main.PLACEID= '+ vPlaceId+') ';&#13;&#10;             sWhere2 := sWhere2 + ' OR (r.PLACEID= '+ vPlaceId+') ';                 &#13;&#10;             COMPUTE('Next(&#34;STOR&#34;)');&#13;&#10;           end;&#13;&#10;           sqlText := sqlText + sWhere +')' + sOrderBy;&#13;&#10;           sqlText1 := sqlText1 + sWhere + ')' ;&#13;&#10;           sqlText2 := sqlText2 + sWhere1 + ')' ;&#13;&#10;           sqlText3 := sqlText3 + sWhere2 + ')' ;               &#13;&#10;         end;&#13;&#10;     tblMain.SQL.Clear;&#13;&#10;     tblMain.SQL.Add(sqlText);&#13;&#10;     //ShowMessage(CorrectTableName('Release'));                            &#13;&#10;     //Активируем главный запрос&#13;&#10;     tblMain.Active := True;&#13;&#10;&#13;&#10;     //Активируем таблицы  &#13;&#10;    &#13;&#10;     qryContracts.Active := True;&#13;&#10;     tblRelComm.Active := True;&#13;&#10;     tblRelCommFull.SQL.Clear;&#13;&#10;     tblRelCommFull.SQL.Add(sqlText3);         &#13;&#10;     tblRelCommFull.Active := True;&#13;&#10;     if StoreDocsBlock = 1 then&#13;&#10;       begin&#13;&#10;         tblOutCommFull.SQL.Clear;&#13;&#10;         tblOutCommFull.SQL.Add(sqlText2);           &#13;&#10;         tblOutComm.Active := True;&#13;&#10;         tblOutCommFull.Active := True&#13;&#10;       end;&#13;&#10;&#13;&#10;       //сохраняем настройки&#13;&#10;      Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;'+DATETOSTR(dtFROM.Date)+'&#34;)');&#13;&#10;      Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;'+DateToStr(dtTo.Date)+'&#34;)');&#13;&#10;end&#13;&#10;  end&#13;&#10;;&#13;&#10;&#13;&#10;procedure rbtnConstOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with rbtnConst, Engine do&#13;&#10;  begin&#13;&#10;  dtSvidEnd.Enabled := False;&#13;&#10;  dtFrom.Enabled := True;&#13;&#10;  dtTo.Enabled := True;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure rbtnTempOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with rbtnTemp, Engine do&#13;&#10;  begin&#13;&#10;  dtSvidEnd.Enabled := True;&#13;&#10;  dtFrom.Enabled := False;&#13;&#10;  dtTo.Enabled := False;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Page2, Engine do&#13;&#10;  begin&#13;&#10;  if chkTable1.Checked then&#13;&#10;    Page2.Visible := True&#13;&#10;  else&#13;&#10;    Page2.Visible := False&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with MasterData1, Engine do&#13;&#10;  begin&#13;&#10;  if chkTable1.Checked then&#13;&#10;    Visible := True&#13;&#10;  else&#13;&#10;    Visible := False&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterHeader1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with MasterHeader1, Engine do&#13;&#10;  begin&#13;&#10;  if chkTable1.Checked then&#13;&#10;    Visible := True&#13;&#10;  else&#13;&#10;    Visible := False&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure PageHeader1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with PageHeader1, Engine do&#13;&#10;  begin&#13;&#10;  if chkTable1.Checked then&#13;&#10;    Visible := True&#13;&#10;  else&#13;&#10;    Visible := False&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ReportSummary1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;COMPUTE('SETFILTER(&#34;KRD_COMM_PAPERS_2&#34;, &#34;&#34;)');&#13;&#10;COMPUTE('SETFILTER(&#34;KRD_CONT_2&#34;, &#34;&#34;)');    &#13;&#10;if chkTable2.Checked then&#13;&#10;    ReportSummary1.Visible := False&#13;&#10;  else&#13;&#10;    ReportSummary1.Visible := True&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo17OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo17, Engine do&#13;&#10;  begin&#13;&#10;  sDeclCnt := 0;&#13;&#10;  if (CustomDocsOnly = 0) and (StoreDocsBlock = 1) then&#13;&#10;    sDeclCnt := &#60;tblOutCommFull.&#34;Count_GTD&#34;&#62;    &#13;&#10;  else&#13;&#10;    sDeclCnt := &#60;tblRelCommFull.&#34;Count_GTD&#34;&#62;    &#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo22OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo22, Engine do&#13;&#10;  begin&#13;&#10;    sUnName := '';&#13;&#10;    vG35 := 0;&#13;&#10;    if (StoreDocsBlock = 1) and (CustomDocsOnly = 0) then&#13;&#10;      if (&#60;tblInComm.&#34;G315C&#34;&#62; &#60;&#62; Null) AND (&#60;tblInComm.&#34;G315C&#34;&#62; &#60;&#62; 0) then&#13;&#10;        begin&#13;&#10;          vG35 := &#60;tblInComm.&#34;G315C&#34;&#62;;&#13;&#10;          vRest := vG35 - vSumRelG315C;&#13;&#10;          if (&#60;tblMain.&#34;G315CN&#34;&#62; &#60;&#62; '') and (&#60;tblMain.&#34;G315CN&#34;&#62; &#60;&#62; Null) then&#13;&#10;            sUnName := COMPUTE('REFERENCE(&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;G315CN&#34;&#62;) + '&#34;, &#34;UNITNAME&#34;)')&#13;&#10;          else&#13;&#10;            sUnName := 'M3'&#13;&#10;        end&#13;&#10;      else&#13;&#10;        begin&#13;&#10;          if (&#60;tblInComm.&#34;G315A&#34;&#62; &#60;&#62; Null) AND (&#60;tblInComm.&#34;G315A&#34;&#62; &#60;&#62; 0) then&#13;&#10;            begin&#13;&#10;              vG35 := &#60;tblInComm.&#34;G315A&#34;&#62;;&#13;&#10;              sUnName := COMPUTE('REFERENCE(&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;G41A&#34;&#62;) + '&#34;, &#34;UNITNAME&#34;)')&#13;&#10;            end&#13;&#10;          else&#13;&#10;            begin&#13;&#10;              if (&#60;tblInComm.&#34;G35&#34;&#62; &#60;&#62; Null) and (&#60;tblInComm.&#34;G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;                begin&#13;&#10;                  vG35 := &#60;tblInComm.&#34;G35&#34;&#62;;&#13;&#10;                  sUnName := 'КГ'&#13;&#10;                end&#13;&#10;              else&#13;&#10;                begin&#13;&#10;                  if (&#60;tblMain.&#34;G315C&#34;&#62; &#60;&#62; Null) AND (&#60;tblMain.&#34;G315C&#34;&#62; &#60;&#62; 0) then&#13;&#10;                    begin&#13;&#10;                      vG35 := &#60;tblMain.&#34;G315C&#34;&#62;;&#13;&#10;                      if (&#60;tblMain.&#34;G315CN&#34;&#62; &#60;&#62; '') and (&#60;tblMain.&#34;G315CN&#34;&#62; &#60;&#62; Null) then&#13;&#10;                        sUnName := COMPUTE('REFERENCE(&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;G315CN&#34;&#62;) + '&#34;, &#34;UNITNAME&#34;)')&#13;&#10;                      else&#13;&#10;                        sUnName := 'M3'&#13;&#10;                    end&#13;&#10;                  else&#13;&#10;                    if (&#60;tblMain.&#34;G315A&#34;&#62; &#60;&#62; Null) AND (&#60;tblMain.&#34;G315A&#34;&#62; &#60;&#62; 0) AND (&#60;tblMain.&#34;G41A&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G41A&#34;&#62; &#60;&#62; 0) then&#13;&#10;                      begin&#13;&#10;                        vG35 := &#60;tblMain.&#34;G315A&#34;&#62;;&#13;&#10;                        sUnName := COMPUTE('REFERENCE(&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;G41A&#34;&#62;) + '&#34;, &#34;UNITNAME&#34;)')&#13;&#10;                      end&#13;&#10;                    else&#13;&#10;                      begin&#13;&#10;                        if (&#60;tblMain.&#34;FACT_G35&#34;&#62;) &#60;&#62; Null and (&#60;tblMain.&#34;FACT_G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;                          begin&#13;&#10;                            vG35 := &#60;tblMain.&#34;FACT_G35&#34;&#62;;&#13;&#10;                            sUnName := 'КГ'&#13;&#10;                          end&#13;&#10;                        else&#13;&#10;                          if (&#60;tblMain.&#34;G35&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;                            begin&#13;&#10;                              vG35 := &#60;tblMain.&#34;G35&#34;&#62;;&#13;&#10;                              sUnName := 'КГ'&#13;&#10;                            end&#13;&#10;                       end&#13;&#10;                end&#13;&#10;            end&#13;&#10;        end&#13;&#10;    else&#13;&#10;      if (&#60;tblMain.&#34;G315C&#34;&#62; &#60;&#62; Null) AND (&#60;tblMain.&#34;G315C&#34;&#62; &#60;&#62; 0) then&#13;&#10;        begin&#13;&#10;          vG35 := &#60;tblMain.&#34;G315C&#34;&#62;;&#13;&#10;          if (&#60;tblMain.&#34;G315CN&#34;&#62; &#60;&#62; '') and (&#60;tblMain.&#34;G315CN&#34;&#62; &#60;&#62; Null) then&#13;&#10;            sUnName := COMPUTE('REFERENCE(&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;G315CN&#34;&#62;) + '&#34;, &#34;UNITNAME&#34;)')&#13;&#10;          else&#13;&#10;            sUnName := 'M3'&#13;&#10;        end&#13;&#10;      else&#13;&#10;        begin&#13;&#10;          if (&#60;tblMain.&#34;G315A&#34;&#62; &#60;&#62; Null) AND (&#60;tblMain.&#34;G315A&#34;&#62; &#60;&#62; 0) AND (&#60;tblMain.&#34;G41A&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G41A&#34;&#62; &#60;&#62; 0)then&#13;&#10;            begin&#13;&#10;              vG35 := &#60;tblMain.&#34;G315A&#34;&#62;;&#13;&#10;              sUnName := COMPUTE('REFERENCE(&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;G41A&#34;&#62;) + '&#34;, &#34;UNITNAME&#34;)')&#13;&#10;            end&#13;&#10;          else&#13;&#10;            begin&#13;&#10;              if (&#60;tblMain.&#34;FACT_G35&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;FACT_G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;                begin&#13;&#10;                  vG35 := &#60;tblMain.&#34;FACT_G35&#34;&#62;;&#13;&#10;                  sUnName := 'КГ'&#13;&#10;                end&#13;&#10;              else&#13;&#10;                if (&#60;tblMain.&#34;G35&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;                  begin&#13;&#10;                    vG35 := &#60;tblMain.&#34;G35&#34;&#62;;&#13;&#10;                    sUnName := 'КГ'&#13;&#10;                  end&#13;&#10;            end&#13;&#10;        end&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo23OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo23, Engine do&#13;&#10;  begin&#13;&#10;&#13;&#10;  vG46 := '';&#13;&#10;  vG42 := 0;&#13;&#10;  vOldCurrency := '';&#13;&#10;  if (&#60;tblMain.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; NULL) and (&#60;tblMain.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; '') then&#13;&#10;    vOldCurrency := VARTOSTR(&#60;tblMain.&#34;G42_CURRENCY&#34;&#62;)&#13;&#10;  else&#13;&#10;    if (&#60;tblMain.&#34;G221&#34;&#62; &#60;&#62; NULL) and (&#60;tblMain.&#34;G221&#34;&#62; &#60;&#62; '') then&#13;&#10;      vOldCurrency := VARTOSTR(&#60;tblMain.&#34;G221&#34;&#62;);&#13;&#10;&#13;&#10;  if &#60;tblMain.&#34;G42&#34;&#62; &#60;&#62; NULL then&#13;&#10;    vG42 := &#60;tblMain.&#34;G42&#34;&#62;&#13;&#10;  else&#13;&#10;    vG42 := 0;&#13;&#10;&#13;&#10;  if vOldCurrency &#60;&#62; '' then&#13;&#10;    vG46 := FormatFloat('#####',StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + VarToStr(&#60;tblMain.&#34;BD_DATE&#34;&#62;)+ '&#34;, &#34;' + VARTOSTR(vOldCurrency) + '&#34;, &#34;840&#34;, &#34;' + VARTOSTR(vG42) + '&#34;)')))&#13;&#10;  else&#13;&#10;    vG46 := '';&#13;&#10;&#13;&#10; // ShowMessage('cod '+voldCurrency+' data '+VarToStr(&#60;tblMain.&#34;BD_DATE&#34;&#62;)+ ' vG46='+vG46);&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo13OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo13, Engine do&#13;&#10;  begin&#13;&#10;  vG311 := 0;&#13;&#10;  if (CustomDocsOnly = 0) and (StoreDocsBlock = 1) then&#13;&#10;    if (&#60;tblInComm.&#34;G311&#34;&#62; &#60;&#62; Null) and (&#60;tblInComm.&#34;G311&#34;&#62; &#60;&#62; 0) then&#13;&#10;      vG311 := &#60;tblInComm.&#34;G311&#34;&#62;&#13;&#10;    else   vG311 := &#60;tblMain.&#34;G311&#34;&#62;&#13;&#10;  else   vG311 := &#60;tblMain.&#34;G311&#34;&#62;;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo47OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo47, Engine do&#13;&#10;  begin&#13;&#10;  sStoreNum := '';&#13;&#10;&#13;&#10;  if (CustomDocsOnly = 0) and (StoreDocsBlock = 1) then&#13;&#10;    if &#60;tblInComm.&#34;BOXNO&#34;&#62; &#60;&#62; NULL then&#13;&#10;      sStoreNum := &#60;tblInComm.&#34;BOXNO&#34;&#62;&#13;&#10;    else   sStoreNum := &#60;tblMain.&#34;BOXNO&#34;&#62;&#13;&#10;  else   sStoreNum := &#60;tblMain.&#34;BOXNO&#34;&#62;;&#13;&#10;&#13;&#10;  if (sStoreNum = NULL) OR (sStoreNum = '') then&#13;&#10;    begin&#13;&#10;&#13;&#10;      COMPUTE('SETFILTER(&#34;KRD_COMM_PAPERS_2&#34;, &#34;&#34;)');&#13;&#10;      if (&#60;tblMain.&#34;G32&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G32&#34;&#62; &#60;&#62; 0) then&#13;&#10;        vFilterCrit := &#34;PlaceID=&#34; + VARTOSTR(&#60;tblMain.&#34;placeid&#34;&#62;) + &#34; AND &#34; + &#34;ID=&#34; + VARTOSTR(&#60;tblMain.&#34;id&#34;&#62;) + &#34; AND &#34; + &#34;DOC_TYPE=11&#34; + &#34; AND &#34; + &#34;G32=&#34; + VARTOSTR(&#60;tblMain.&#34;G32&#34;&#62;)&#13;&#10;      else&#13;&#10;        vFilterCrit := &#34;PlaceID=&#34; + VARTOSTR(&#60;tblMain.&#34;placeid&#34;&#62;) + &#34; AND &#34; + &#34;ID=&#34; + VARTOSTR(&#60;tblMain.&#34;id&#34;&#62;) + &#34; AND &#34; + &#34;DOC_TYPE=11&#34; + &#34; AND &#34; + &#34;G32=&#34; + VARTOSTR(1);&#13;&#10;      COMPUTE('SETFILTER(&#34;KRD_COMM_PAPERS_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;&#13;&#10;      COMPUTE('SETFILTER(&#34;KRD_CONT_2&#34;, &#34;&#34;)');&#13;&#10;      vFilterCrit := &#34;PlaceID=&#34; + VARTOSTR(&#60;tblMain.&#34;placeid&#34;&#62;) + &#34; AND &#34; + &#34;ID=&#34; + VARTOSTR(&#60;tblMain.&#34;id&#34;&#62;);&#13;&#10;      COMPUTE('SETFILTER(&#34;KRD_CONT_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;&#13;&#10;      if (&#60;tblMain.&#34;G19&#34;&#62; = 1) then //and (tblCP.RecordCount &#62; 0) then&#13;&#10;        begin&#13;&#10;          COMPUTE('FIRST(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;          while COMPUTE('EOF(&#34;KRD_COMM_PAPERS_2&#34;)') = '0' do&#13;&#10;            begin&#13;&#10;              COMPUTE('SETFILTER(&#34;KRD_CONT_2&#34;, &#34;&#34;)');&#13;&#10;              vFilterCrit := &#34;PlaceID=&#34; + VARTOSTR(&#60;tblMain.&#34;placeid&#34;&#62;) + &#34; AND &#34; + &#34;ID=&#34; + VARTOSTR(&#60;tblMain.&#34;id&#34;&#62;) + &#34; AND COUNTER=&#34; + VARTOSTR(COMPUTE('FIELDVALUE(&#34;KRD_COMM_PAPERS_2&#34;, &#34;DOC_COUNTER&#34;)'));&#13;&#10;              COMPUTE('SETFILTER(&#34;KRD_CONT_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;              if (sStoreNum = &#34;&#34;) OR (sStoreNum = NULL) then&#13;&#10;                sStoreNum := VARTOSTR(COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;CONTNO&#34;)'))&#13;&#10;              else&#13;&#10;                sStoreNum := sStoreNum + &#34;, &#34; + VARTOSTR(COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;CONTNO&#34;)'));&#13;&#10;              COMPUTE('NEXT(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;            end;&#13;&#10;        end&#13;&#10;      else&#13;&#10;          begin&#13;&#10;            COMPUTE('FIRST(&#34;KRD_CONT_2&#34;)');&#13;&#10;            while COMPUTE('EOF(&#34;KRD_CONT_2&#34;)') = '0' do&#13;&#10;              begin&#13;&#10;                if (sStoreNum = &#34;&#34;) OR (sStoreNum = NULL) then&#13;&#10;                  sStoreNum := VARTOSTR(COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;CONTNO&#34;)'))&#13;&#10;                else&#13;&#10;                  sStoreNum := sStoreNum + &#34;, &#34; + VARTOSTR(COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;CONTNO&#34;)'));&#13;&#10;                COMPUTE('NEXT(&#34;KRD_CONT_2&#34;)');&#13;&#10;              end;&#13;&#10;          end&#13;&#10;    end&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo70OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo70, Engine do&#13;&#10;  begin&#13;&#10;  COMPUTE('FINDKEY(&#34;STORES_2&#34;, [&#34;' + VARTOSTR(vPlaceid) + '&#34;])');&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page3OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Page3, Engine do&#13;&#10;  begin&#13;&#10;  if chkTable2.Checked then&#13;&#10;    Page3.Visible := True&#13;&#10;  else&#13;&#10;    Page3.Visible := False&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Band1, Engine do&#13;&#10;  begin&#13;&#10;  if chkTable2.Checked then&#13;&#10;    Visible := True&#13;&#10;  else&#13;&#10;    Visible := False&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Band2, Engine do&#13;&#10;  begin&#13;&#10;&#13;&#10;   vSumRelG35 := 0;&#13;&#10;   vSumRelG311 := 0;&#13;&#10;   vSumRelG42 := 0;&#13;&#10;   vSumRelG315A := 0;&#13;&#10;   vSumRelG315C := 0;&#13;&#10;&#13;&#10;   vG311 := 0;&#13;&#10;   vG42 := 0;&#13;&#10;&#13;&#10;   if (CustomDocsonly = 0) and (StoreDocsBlock = 1) then&#13;&#10;     begin&#13;&#10;       if (&#60;tblInComm.&#34;G311&#34;&#62; &#60;&#62; Null) and (&#60;tblInComm.&#34;G311&#34;&#62; &#60;&#62; 0) then&#13;&#10;         vG311 := &#60;tblInComm.&#34;G311&#34;&#62;&#13;&#10;       else&#13;&#10;         vG311 := 0;&#13;&#10;       if (&#60;tblInComm.&#34;G42&#34;&#62; &#60;&#62; Null) and (&#60;tblInComm.&#34;G42&#34;&#62; &#60;&#62; 0) then&#13;&#10;         vG42 := &#60;tblInComm.&#34;G42&#34;&#62;&#13;&#10;       else&#13;&#10;         vG42 := 0;&#13;&#10;       tblOutComm.First;&#13;&#10;       While tblOutComm.EOF = False do&#13;&#10;         begin&#13;&#10;           if (&#60;tblOutComm.&#34;OUT_G311&#34;&#62; &#60;&#62; NULL) and (&#60;tblOutComm.&#34;OUT_G311&#34;&#62; &#60;&#62; 0) then&#13;&#10;             vSumRelG311 := vSumRelG311 + &#60;tblOutComm.&#34;OUT_G311&#34;&#62;;&#13;&#10;           if (&#60;tblOutComm.&#34;OUT_G35&#34;&#62; &#60;&#62; NULL) and (&#60;tblOutComm.&#34;OUT_G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;             vSumRelG35 := vSumRelG35 + &#60;tblOutComm.&#34;OUT_G35&#34;&#62;;&#13;&#10;           if (&#60;tblOutComm.&#34;OUT_G42&#34;&#62; &#60;&#62; NULL) and (&#60;tblOutComm.&#34;OUT_G42&#34;&#62; &#60;&#62; 0) then&#13;&#10;             vSumRelG42 := vSumRelG42 + &#60;tblOutComm.&#34;OUT_G42&#34;&#62;;&#13;&#10;           if (&#60;tblOutComm.&#34;OUT_G315C&#34;&#62; &#60;&#62; NULL) and (&#60;tblOutComm.&#34;OUT_G315C&#34;&#62; &#60;&#62; 0) then&#13;&#10;             vSumRelG315C := vSumRelG315C + &#60;tblOutComm.&#34;OUT_G315C&#34;&#62;;&#13;&#10;           if (&#60;tblOutComm.&#34;OUT_G315A&#34;&#62; &#60;&#62; NULL) and (&#60;tblOutComm.&#34;OUT_G315A&#34;&#62; &#60;&#62; 0) then&#13;&#10;             vSumRelG315A := vSumRelG315A + &#60;tblOutComm.&#34;OUT_G315A&#34;&#62;;&#13;&#10;           tblOutComm.Next;&#13;&#10;         end;&#13;&#10;       if (&#60;tblInComm.&#34;G315A&#34;&#62; &#60;&#62; Null) and (&#60;tblInComm.&#34;G315A&#34;&#62; &#60;&#62; 0) then&#13;&#10;         begin&#13;&#10;           if ((&#60;tblInComm.&#34;G315A&#34;&#62;-vSumRelG315A) &#62; 0) then&#13;&#10;             begin&#13;&#10;                Band2.Visible := True;&#13;&#10;                vNumLine := vNumLine + 1&#13;&#10;             end&#13;&#10;           else&#13;&#10;             Band2.Visible := False;&#13;&#10;         end&#13;&#10;       else&#13;&#10;         begin&#13;&#10;           if (&#60;tblMain.&#34;G315A&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G315A&#34;&#62; &#60;&#62; 0) then&#13;&#10;             begin&#13;&#10;               if ((&#60;tblMain.&#34;G315A&#34;&#62;-vSumRelG315A) &#62; 0) then&#13;&#10;                 begin&#13;&#10;                   Band2.Visible := True;&#13;&#10;                   vNumLine := vNumLine + 1&#13;&#10;                 end&#13;&#10;               else&#13;&#10;                 Band2.Visible := False;&#13;&#10;             end&#13;&#10;           else&#13;&#10;             begin&#13;&#10;               if (&#60;tblInComm.&#34;G35&#34;&#62; &#60;&#62; Null) and (&#60;tblInComm.&#34;G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;                 begin&#13;&#10;                   if ((&#60;tblInComm.&#34;G35&#34;&#62;-vSumRelG35) &#62; 0) then&#13;&#10;                     begin&#13;&#10;                       Band2.Visible := True;&#13;&#10;                       vNumLine := vNumLine + 1&#13;&#10;                     end&#13;&#10;                   else&#13;&#10;                     Band2.Visible := False;&#13;&#10;                 end&#13;&#10;               else&#13;&#10;                 if (&#60;tblMain.&#34;G35&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;                   begin&#13;&#10;                     if ((&#60;tblMain.&#34;G35&#34;&#62;-vSumRelG35) &#62; 0) then&#13;&#10;                       begin&#13;&#10;                         Band2.Visible := True;&#13;&#10;                         vNumLine := vNumLine + 1&#13;&#10;                       end&#13;&#10;                     else&#13;&#10;                       Band2.Visible := False;&#13;&#10;                   end&#13;&#10;                 else&#13;&#10;                   begin&#13;&#10;                     Band2.Visible := True;&#13;&#10;                     vNumLine := vNumLine + 1&#13;&#10;                   end&#13;&#10;             end&#13;&#10;         end&#13;&#10;     end&#13;&#10;   else&#13;&#10;     begin&#13;&#10;       if (&#60;tblMain.&#34;G311&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G311&#34;&#62; &#60;&#62; 0) then&#13;&#10;         vG311 := &#60;tblMain.&#34;G311&#34;&#62;&#13;&#10;       else&#13;&#10;         vG311 := 0;&#13;&#10;       if (&#60;tblMain.&#34;G42&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G42&#34;&#62; &#60;&#62; 0) then&#13;&#10;         vG42 := &#60;tblMain.&#34;G42&#34;&#62;&#13;&#10;       else&#13;&#10;         vG42 := 0;&#13;&#10;       tblRelComm.First;&#13;&#10;       While tblRelComm.EOF = False do&#13;&#10;         begin&#13;&#10;           if (&#60;tblRelComm.&#34;RELEASE_G311&#34;&#62; &#60;&#62; NULL) and (&#60;tblRelComm.&#34;RELEASE_G311&#34;&#62; &#60;&#62; 0) then&#13;&#10;             vSumRelG311 := vSumRelG311 + &#60;tblRelComm.&#34;RELEASE_G311&#34;&#62;;&#13;&#10;           if (&#60;tblRelComm.&#34;RELEASE_G35&#34;&#62; &#60;&#62; NULL) and (&#60;tblRelComm.&#34;RELEASE_G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;             vSumRelG35 := vSumRelG35 + &#60;tblRelComm.&#34;RELEASE_G35&#34;&#62;;&#13;&#10;           if (&#60;tblRelComm.&#34;RELEASE_G42&#34;&#62; &#60;&#62; NULL) and (&#60;tblRelComm.&#34;RELEASE_G42&#34;&#62; &#60;&#62; 0) then&#13;&#10;             vSumRelG42 := vSumRelG42 + &#60;tblRelComm.&#34;RELEASE_G42&#34;&#62;;&#13;&#10;           if (&#60;tblRelComm.&#34;RELEASE_G315C&#34;&#62; &#60;&#62; NULL) and (&#60;tblRelComm.&#34;RELEASE_G315C&#34;&#62; &#60;&#62; 0) then&#13;&#10;             vSumRelG315C := vSumRelG315C + &#60;tblRelComm.&#34;RELEASE_G315C&#34;&#62;;&#13;&#10;           if (&#60;tblRelComm.&#34;RELEASE_G315A&#34;&#62; &#60;&#62; NULL) and (&#60;tblRelComm.&#34;RELEASE_G315A&#34;&#62; &#60;&#62; 0) then&#13;&#10;             vSumRelG315A := vSumRelG315A + &#60;tblRelComm.&#34;RELEASE_G315A&#34;&#62;;&#13;&#10;           tblRelComm.Next;&#13;&#10;         end;&#13;&#10;       if (&#60;tblMain.&#34;G315A&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G315A&#34;&#62; &#60;&#62; 0) then&#13;&#10;         begin&#13;&#10;           if ((&#60;tblMain.&#34;G315A&#34;&#62;-vSumRelG315A) &#62; 0) then&#13;&#10;             begin&#13;&#10;                Band2.Visible := True;&#13;&#10;                vNumLine := vNumLine + 1&#13;&#10;             end&#13;&#10;           else&#13;&#10;             Band2.Visible := False;&#13;&#10;         end&#13;&#10;       else&#13;&#10;         if (&#60;tblMain.&#34;G35&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;           begin&#13;&#10;             if ((&#60;tblMain.&#34;G35&#34;&#62;-vSumRelG35) &#62; 0) then&#13;&#10;               begin&#13;&#10;                  Band2.Visible := True;&#13;&#10;                  vNumLine := vNumLine + 1&#13;&#10;               end&#13;&#10;             else&#13;&#10;               Band2.Visible := False;&#13;&#10;           end&#13;&#10;         else&#13;&#10;           begin&#13;&#10;             Band2.Visible := True;&#13;&#10;             vNumLine := vNumLine + 1&#13;&#10;           end&#13;&#10;     end&#13;&#10;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band3OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Band3, Engine do&#13;&#10;  begin&#13;&#10;  if chkTable2.Checked then&#13;&#10;    Visible := True&#13;&#10;  else&#13;&#10;    Visible := False&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band4OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Band4, Engine do&#13;&#10;  begin&#13;&#10;  if chkTable2.Checked then&#13;&#10;    Visible := True&#13;&#10;  else&#13;&#10;    Visible := False&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band6OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Band6, Engine do&#13;&#10;  begin&#13;&#10;  if chkTable1.Checked then&#13;&#10;    Band6.Visible := False&#13;&#10;  else&#13;&#10;    Band6.Visible := True;&#13;&#10;  vNumLine := 0;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo55OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo55, Engine do&#13;&#10;  begin&#13;&#10;begin&#13;&#10;  sUnName := '';&#13;&#10;  vG35 := 0;&#13;&#10;  vRest := 0;&#13;&#10;  if (CustomDocsOnly = 0) and (StoreDocsBlock = 1) then&#13;&#10;    if (&#60;tblInComm.&#34;G315C&#34;&#62; &#60;&#62; Null) AND (&#60;tblInComm.&#34;G315C&#34;&#62; &#60;&#62; 0) then&#13;&#10;      begin&#13;&#10;        vG35 := &#60;tblInComm.&#34;G315C&#34;&#62;;&#13;&#10;        vRest := vG35 - vSumRelG315C;&#13;&#10;        if (&#60;tblMain.&#34;G315CN&#34;&#62; &#60;&#62; '') and (&#60;tblMain.&#34;G315CN&#34;&#62; &#60;&#62; Null) then&#13;&#10;          sUnName := COMPUTE('REFERENCE(&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;G315CN&#34;&#62;) + '&#34;, &#34;UNITNAME&#34;)')&#13;&#10;        else&#13;&#10;          sUnName := 'M3'&#13;&#10;      end&#13;&#10;    else&#13;&#10;      begin&#13;&#10;        if (&#60;tblInComm.&#34;G315A&#34;&#62; &#60;&#62; Null) AND (&#60;tblInComm.&#34;G315A&#34;&#62; &#60;&#62; 0) then&#13;&#10;          begin&#13;&#10;            vG35 := &#60;tblInComm.&#34;G315A&#34;&#62;;&#13;&#10;            vRest := vG35 - vSumRelG315A;&#13;&#10;            sUnName := COMPUTE('REFERENCE(&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;G41A&#34;&#62;) + '&#34;, &#34;UNITNAME&#34;)')&#13;&#10;          end&#13;&#10;        else&#13;&#10;          begin&#13;&#10;            if (&#60;tblInComm.&#34;G35&#34;&#62; &#60;&#62; Null) and (&#60;tblInComm.&#34;G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;              begin&#13;&#10;                vG35 := &#60;tblInComm.&#34;G35&#34;&#62;;&#13;&#10;                vRest := vG35 - vSumRelG35;&#13;&#10;                sUnName := 'КГ'&#13;&#10;              end&#13;&#10;            else&#13;&#10;              begin&#13;&#10;                if (&#60;tblMain.&#34;G315C&#34;&#62; &#60;&#62; Null) AND (&#60;tblMain.&#34;G315C&#34;&#62; &#60;&#62; 0) then&#13;&#10;                  begin&#13;&#10;                    vG35 := &#60;tblMain.&#34;G315C&#34;&#62;;&#13;&#10;                    vRest := vG35 - vSumRelG315C;&#13;&#10;                    if (&#60;tblMain.&#34;G315CN&#34;&#62; &#60;&#62; '') and (&#60;tblMain.&#34;G315CN&#34;&#62; &#60;&#62; Null) then&#13;&#10;                      sUnName := COMPUTE('REFERENCE(&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;G315CN&#34;&#62;) + '&#34;, &#34;UNITNAME&#34;)')&#13;&#10;                    else&#13;&#10;                      sUnName := 'M3'&#13;&#10;                  end&#13;&#10;                else&#13;&#10;                  if (&#60;tblMain.&#34;G315A&#34;&#62; &#60;&#62; Null) AND (&#60;tblMain.&#34;G315A&#34;&#62; &#60;&#62; 0) AND (&#60;tblMain.&#34;G41A&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G41A&#34;&#62; &#60;&#62; 0) then&#13;&#10;                    begin&#13;&#10;                      vG35 := &#60;tblMain.&#34;G315A&#34;&#62;;&#13;&#10;                      vRest := vG35 - vSumRelG315A;&#13;&#10;                      sUnName := COMPUTE('REFERENCE(&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;G41A&#34;&#62;) + '&#34;, &#34;UNITNAME&#34;)')&#13;&#10;                    end&#13;&#10;                  else&#13;&#10;                    begin&#13;&#10;                      if (&#60;tblMain.&#34;FACT_G35&#34;&#62;) &#60;&#62; Null and (&#60;tblMain.&#34;FACT_G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;                        begin&#13;&#10;                          vG35 := &#60;tblMain.&#34;FACT_G35&#34;&#62;;&#13;&#10;                          vRest := vG35 - vSumRelG35;&#13;&#10;                          sUnName := 'КГ'&#13;&#10;                        end&#13;&#10;                      else&#13;&#10;                        if (&#60;tblMain.&#34;G35&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;                          begin&#13;&#10;                            vG35 := &#60;tblMain.&#34;G35&#34;&#62;;&#13;&#10;                            vRest := vG35 - vSumRelG35;&#13;&#10;                            sUnName := 'КГ'&#13;&#10;                          end&#13;&#10;                     end&#13;&#10;              end&#13;&#10;          end&#13;&#10;      end&#13;&#10;&#13;&#10;  else&#13;&#10;&#13;&#10;    begin&#13;&#10;      if (&#60;tblMain.&#34;G315C&#34;&#62; &#60;&#62; Null) AND (&#60;tblMain.&#34;G315C&#34;&#62; &#60;&#62; 0) then&#13;&#10;        begin&#13;&#10;          vG35 := &#60;tblMain.&#34;G315C&#34;&#62;;&#13;&#10;          vRest := vG35 - vSumRelG315C;&#13;&#10;          if (&#60;tblMain.&#34;G315CN&#34;&#62; &#60;&#62; '') and (&#60;tblMain.&#34;G315CN&#34;&#62; &#60;&#62; Null) then&#13;&#10;            sUnName := COMPUTE('REFERENCE(&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;G315CN&#34;&#62;) + '&#34;, &#34;UNITNAME&#34;)')&#13;&#10;          else&#13;&#10;            sUnName := 'M3'&#13;&#10;        end&#13;&#10;      else&#13;&#10;        if (&#60;tblMain.&#34;G315A&#34;&#62; &#60;&#62; Null) AND (&#60;tblMain.&#34;G315A&#34;&#62; &#60;&#62; 0) AND (&#60;tblMain.&#34;G41A&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G41A&#34;&#62; &#60;&#62; 0) then&#13;&#10;          begin&#13;&#10;            vG35 := &#60;tblMain.&#34;G315A&#34;&#62;;&#13;&#10;            vRest := vG35 - vSumRelG315A;&#13;&#10;            sUnName := COMPUTE('REFERENCE(&#34;UNITS&#34;, &#34;UNITCODE&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;G41A&#34;&#62;) + '&#34;, &#34;UNITNAME&#34;)')&#13;&#10;          end&#13;&#10;        else&#13;&#10;          begin&#13;&#10;            if (&#60;tblMain.&#34;FACT_G35&#34;&#62;) &#60;&#62; Null and (&#60;tblMain.&#34;FACT_G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;              begin&#13;&#10;                vG35 := &#60;tblMain.&#34;FACT_G35&#34;&#62;;&#13;&#10;                vRest := vG35 - vSumRelG35;&#13;&#10;                sUnName := 'КГ'&#13;&#10;              end&#13;&#10;            else&#13;&#10;              if (&#60;tblMain.&#34;G35&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;                begin&#13;&#10;                  vG35 := &#60;tblMain.&#34;G35&#34;&#62;;&#13;&#10;                  vRest := vG35 - vSumRelG35;&#13;&#10;                  sUnName := 'КГ'&#13;&#10;                end&#13;&#10;          end&#13;&#10;    end&#13;&#10;end&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo56OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo56, Engine do&#13;&#10;  begin&#13;&#10;  vG46Rest := '0';&#13;&#10;  vOldCurrency := '';&#13;&#10;  if (&#60;tblMain.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; NULL) and (&#60;tblMain.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; '') then&#13;&#10;    vOldCurrency := VARTOSTR(&#60;tblMain.&#34;G42_CURRENCY&#34;&#62;)&#13;&#10;  else&#13;&#10;    if (&#60;tblMain.&#34;G221&#34;&#62; &#60;&#62; NULL) and (&#60;tblMain.&#34;G221&#34;&#62; &#60;&#62; '') then&#13;&#10;      vOldCurrency := VARTOSTR(&#60;tblMain.&#34;G221&#34;&#62;);&#13;&#10;&#13;&#10;  if (vOldCurrency &#60;&#62; NULL) and (vOldCurrency &#60;&#62; '') and (&#60;tblMain.&#34;G42&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G42&#34;&#62; &#60;&#62; 0) and (vSumRelG42 &#60;&#62; Null) and (vSumrelG42 &#60;&#62; 0) then&#13;&#10;    begin&#13;&#10;      fG46Rest := StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + VArToStr(&#60;tblMain.&#34;BD_DATE&#34;&#62;) +  '&#34;, &#34;' + VARTOSTR(vOldCurrency) + '&#34;, &#34;840&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;G42&#34;&#62;) + '&#34;)'));&#13;&#10;      fG46Rest := fG46Rest - StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + VarToStr(&#60;tblMain.&#34;BD_DATE&#34;&#62;)+  '&#34;, &#34;' + VARTOSTR(vOldCurrency) + '&#34;, &#34;840&#34;, &#34;' + VARTOSTR(vG42 - vSumRelG42) + '&#34;)'));&#13;&#10;      vG46Rest := FormatFloat('#####', fG46Rest);&#13;&#10;    end&#13;&#10;  else&#13;&#10;    vG46Rest := VARTOSTR(&#60;tblMain.&#34;G42&#34;&#62;);&#13;&#10;&#13;&#10;//  ShowMessage('cod '+voldCurrency+' data '+VarToStr(&#60;tblMain.&#34;BD_DATE&#34;&#62;)+ ' vG46R='+vG46Rest);&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo57OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo57, Engine do&#13;&#10;  begin&#13;&#10;  sStoreDate := '';&#13;&#10;&#13;&#10;  if (StoreDocsBlock = 1) and (CustomDocsOnly = 0) then&#13;&#10;    begin&#13;&#10;      COMPUTE('FINDKEY(&#34;IN_MAIN_2&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;placeid&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;id&#34;&#62;) + '&#34;)');&#13;&#10;      sStoreDate := FORMATDATETIME(&#34;DD.MM.YYYY&#34;, &#60;IN_MAIN_2.&#34;G542&#34;&#62;)&#13;&#10;    end&#13;&#10;  else&#13;&#10;    sStoreDate := FORMATDATETIME(&#34;DD.MM.YYYY&#34;, &#60;tblMain.&#34;BEG_KEEP&#34;&#62;)&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo62OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo62, Engine do&#13;&#10;  begin&#13;&#10;  vRestG311 := '';&#13;&#10;  if (vG311 &#60;&#62; Null) and (vG311 &#60;&#62; 0) and (vSumRelG311 &#60;&#62; Null) and (vSumRelG311 &#60;&#62; 0) then&#13;&#10;    vRestG311 := VARTOSTR(vG311 - vSumRelG311)&#13;&#10;  else&#13;&#10;    vRestG311 := VARTOSTR(vG311)&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo63OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo63, Engine do&#13;&#10;  begin&#13;&#10;  sStoreNum := '';&#13;&#10;&#13;&#10;  if (CustomDocsOnly = 0) and (StoreDocsBlock = 1) then&#13;&#10;    if &#60;tblInComm.&#34;BOXNO&#34;&#62; &#60;&#62; NULL then&#13;&#10;      sStoreNum := &#60;tblInComm.&#34;BOXNO&#34;&#62;&#13;&#10;    else   sStoreNum := &#60;tblMain.&#34;BOXNO&#34;&#62;&#13;&#10;  else   sStoreNum := &#60;tblMain.&#34;BOXNO&#34;&#62;;&#13;&#10;&#13;&#10;  if (sStoreNum = NULL) OR (sStoreNum = '') then&#13;&#10;    begin&#13;&#10;&#13;&#10;      COMPUTE('SETFILTER(&#34;KRD_COMM_PAPERS_2&#34;, &#34;&#34;)');&#13;&#10;      if (&#60;tblMain.&#34;G32&#34;&#62; &#60;&#62; Null) and (&#60;tblMain.&#34;G32&#34;&#62; &#60;&#62; 0) then&#13;&#10;        vFilterCrit := &#34;PlaceID=&#34; + VARTOSTR(&#60;tblMain.&#34;placeid&#34;&#62;) + &#34; AND &#34; + &#34;ID=&#34; + VARTOSTR(&#60;tblMain.&#34;id&#34;&#62;) + &#34; AND &#34; + &#34;DOC_TYPE=11&#34; + &#34; AND &#34; + &#34;G32=&#34; + VARTOSTR(&#60;tblMain.&#34;G32&#34;&#62;)&#13;&#10;      else&#13;&#10;        vFilterCrit := &#34;PlaceID=&#34; + VARTOSTR(&#60;tblMain.&#34;placeid&#34;&#62;) + &#34; AND &#34; + &#34;ID=&#34; + VARTOSTR(&#60;tblMain.&#34;id&#34;&#62;) + &#34; AND &#34; + &#34;DOC_TYPE=11&#34; + &#34; AND &#34; + &#34;G32=&#34; + VARTOSTR(1);&#13;&#10;      COMPUTE('SETFILTER(&#34;KRD_COMM_PAPERS_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;&#13;&#10;      COMPUTE('SETFILTER(&#34;KRD_CONT_2&#34;, &#34;&#34;)');&#13;&#10;      vFilterCrit := &#34;PlaceID=&#34; + VARTOSTR(&#60;tblMain.&#34;placeid&#34;&#62;) + &#34; AND &#34; + &#34;ID=&#34; + VARTOSTR(&#60;tblMain.&#34;id&#34;&#62;);&#13;&#10;      COMPUTE('SETFILTER(&#34;KRD_CONT_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;&#13;&#10;      if (&#60;tblMain.&#34;G19&#34;&#62; = 1) then //and (tblCP.RecordCount &#62; 0) then&#13;&#10;        begin&#13;&#10;          COMPUTE('FIRST(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;          while COMPUTE('EOF(&#34;KRD_COMM_PAPERS_2&#34;)') = '0' do&#13;&#10;            begin&#13;&#10;              COMPUTE('SETFILTER(&#34;KRD_CONT_2&#34;, &#34;&#34;)');&#13;&#10;              vFilterCrit := &#34;PlaceID=&#34; + VARTOSTR(&#60;tblMain.&#34;placeid&#34;&#62;) + &#34; AND &#34; + &#34;ID=&#34; + VARTOSTR(&#60;tblMain.&#34;id&#34;&#62;) + &#34; AND COUNTER=&#34; + VARTOSTR(COMPUTE('FIELDVALUE(&#34;KRD_COMM_PAPERS_2&#34;, &#34;DOC_COUNTER&#34;)'));&#13;&#10;              COMPUTE('SETFILTER(&#34;KRD_CONT_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;              if (sStoreNum = &#34;&#34;) OR (sStoreNum = NULL) then&#13;&#10;                sStoreNum := VARTOSTR(COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;CONTNO&#34;)'))&#13;&#10;              else&#13;&#10;                sStoreNum := sStoreNum + &#34;, &#34; + VARTOSTR(COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;CONTNO&#34;)'));&#13;&#10;              COMPUTE('NEXT(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;            end;&#13;&#10;        end&#13;&#10;      else&#13;&#10;          begin&#13;&#10;            COMPUTE('FIRST(&#34;KRD_CONT_2&#34;)');&#13;&#10;            while COMPUTE('EOF(&#34;KRD_CONT_2&#34;)') = '0' do&#13;&#10;              begin&#13;&#10;                if (sStoreNum = &#34;&#34;) OR (sStoreNum = NULL) then&#13;&#10;                  sStoreNum := VARTOSTR(COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;CONTNO&#34;)'))&#13;&#10;                else&#13;&#10;                  sStoreNum := sStoreNum + &#34;, &#34; + VARTOSTR(COMPUTE('FIELDVALUE(&#34;KRD_CONT_2&#34;, &#34;CONTNO&#34;)'));&#13;&#10;                COMPUTE('NEXT(&#34;KRD_CONT_2&#34;)');&#13;&#10;              end;&#13;&#10;          end&#13;&#10;    end&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo73OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo73, Engine do&#13;&#10;  begin&#13;&#10;  COMPUTE('FINDKEY(&#34;STORES_2&#34;, [&#34;' + VARTOSTR(vPlaceid) + '&#34;])');&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo86OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo86, Engine do&#13;&#10;  begin&#13;&#10;  sDeclCnt := 0;&#13;&#10;  if (CustomDocsOnly = 0) and (StoreDocsBlock = 1) then&#13;&#10;    sDeclCnt := tblOutCommFull.RecordCount&#13;&#10;  else&#13;&#10;    sDeclCnt := tblRelCommFull.RecordCount&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band5OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('SETFILTER(&#34;KRD_COMM_PAPERS_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('SETFILTER(&#34;KRD_CONT_2&#34;, &#34;&#34;)');  &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="OnStartReport" PropData="08446174617365747301010C2F00000020446174615365743D2264735F494E5F4D41494E5F322220446174615365744E616D653D22494E5F4D41494E5F322200010C2D00000020446174615365743D2264735F4B52445F434F4D4D2220446174615365744E616D653D224B52445F434F4D4D2200010C2D00000020446174615365743D2264735F4B52445F4D41494E2220446174615365744E616D653D224B52445F4D41494E2200010C3200000020446174615365743D22717279436F6E7472616374732220446174615365744E616D653D22717279436F6E7472616374732200010C2D00000020446174615365743D2264735F53544F5245535F322220446174615365744E616D653D2253544F5245535F322200010C2C00000020446174615365743D2274626C496E436F6D6D2220446174615365744E616D653D2274626C496E436F6D6D2200010C2800000020446174615365743D2274626C4D61696E2220446174615365744E616D653D2274626C4D61696E2200010C2E00000020446174615365743D2274626C4F7574436F6D6D2220446174615365744E616D653D2274626C4F7574436F6D6D2200010C3600000020446174615365743D2274626C4F7574436F6D6D46756C6C2220446174615365744E616D653D2274626C4F7574436F6D6D46756C6C2200010C2E00000020446174615365743D2274626C52656C436F6D6D2220446174615365744E616D653D2274626C52656C436F6D6D2200010C3600000020446174615365743D2274626C52656C436F6D6D46756C6C2220446174615365744E616D653D2274626C52656C436F6D6D46756C6C220000095661726961626C65730100055374796C650100"><TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"><TfrxBDEQuery Name="tblMain" UserName="tblMain" CloseDataSource="True" FieldAliases.Text="" IgnoreDupParams="False" SQL.Text="SELECT stores.licenceno as licenceno,&#13;&#10;       stores.placeid as s_placeid,&#13;&#10;       krd_comm.g32,&#13;&#10;       krd_comm.G315CN,&#13;&#10;       krd_comm.G41A,&#13;&#10;       krd_comm.G315A,&#13;&#10;       krd_comm.G315C,&#13;&#10;       krd_comm.FACT_G35,&#13;&#10;       krd_comm.G35,&#13;&#10;       krd_comm.G42_CURRENCY,&#13;&#10;       krd_comm.G42,&#13;&#10;       krd_comm.G311,&#13;&#10;       krd_comm.G33,&#13;&#10;       krd_comm.BOXNO,&#13;&#10;       krd_comm.ACCEPTDATE,           &#13;&#10;       krd_main.placeid,&#13;&#10;       krd_main.id,&#13;&#10;       krd_main.nbd,&#13;&#10;       krd_main.G221,&#13;&#10;       krd_main.G19,&#13;&#10;       krd_main.BD_DATE,&#13;&#10;       krd_main.BEG_KEEP,&#13;&#10;       stores.G142,&#13;&#10;       stores.address&#13;&#10;FROM (stores&#13;&#10;  LEFT JOIN krd_main ON (krd_main.placeid = stores.placeid))&#13;&#10;  LEFT JOIN krd_comm ON (krd_main.placeid = krd_comm.placeid&#13;&#10;                    AND krd_main.id = krd_comm.id)&#13;&#10;WHERE (krd_main.placeid = :P1)&#13;&#10;  AND (krd_main.notice_rw_only = 0)&#13;&#10;  AND (krd_main.beg_keep &#60;= :P2)&#13;&#10;  AND (krd_main.bd_date &#62;= :P3)&#13;&#10;ORDER BY krd_main.BD_DATE, krd_main.NBD, krd_comm.g32" DatabaseName="STS_DB" SessionName="Default" PropData="05704C656674023C0470546F7002140A506172616D657465727301010C35000000204E616D653D225031222044617461547970653D226674496E7465676572222045787072657373696F6E3D2276506C61636549642200010C39000000204E616D653D225032222044617461547970653D2266744461746554696D65222045787072657373696F6E3D226474506572696F64456E642200010C3B000000204E616D653D225033222044617461547970653D2266744461746554696D65222045787072657373696F6E3D226474506572696F645374617274220000"/><TfrxBDETable Name="tblRelComm" UserName="tblRelComm" CloseDataSource="True" FieldAliases.Text="" Master="tblMain" MasterFields="PLACEID=placeid;ID=id;G32=G32" TableName="REL_COMM" IndexFieldNames="PlaceId;Id;G32" DatabaseName="STS_DB" SessionName="Default" PropData="05704C65667402340470546F700254"/><TfrxBDEQuery Name="qryContracts" UserName="qryContracts" CloseDataSource="True" FieldAliases.Text="" IgnoreDupParams="False" SQL.Text="SELECT COUNT (DISTINCT STORE_CONTRACT_NO) AS COUNT_CONTRACTS                                        &#13;&#10;FROM KRD_MAIN&#13;&#10;WHERE (krd_main.placeid = :P1)&#13;&#10;  AND (krd_main.notice_rw_only = 0)&#13;&#10;  AND (krd_main.beg_keep &#60;= :P2)&#13;&#10;  AND (krd_main.bd_date &#62;= :P3)" DatabaseName="STS_DB" SessionName="Default" PropData="05704C65667403FC000470546F7002140A506172616D657465727301010C35000000204E616D653D225031222044617461547970653D226674496E7465676572222045787072657373696F6E3D2276506C61636549642200010C39000000204E616D653D225032222044617461547970653D2266744461746554696D65222045787072657373696F6E3D226474506572696F64456E642200010C3B000000204E616D653D225033222044617461547970653D2266744461746554696D65222045787072657373696F6E3D226474506572696F645374617274220000"/><TfrxBDETable Name="tblInComm" UserName="tblInComm" CloseDataSource="True" FieldAliases.Text="" Master="tblMain" MasterFields="PLACEID=placeid;ID=id;G32=G32" TableName="IN_COMM" IndexFieldNames="PLACEID;ID;G32" DatabaseName="STS_DB" SessionName="Default" PropData="05704C65667403A4010470546F700214"/><TfrxBDETable Name="tblOutComm" UserName="tblOutComm" CloseDataSource="True" FieldAliases.Text="" Master="tblMain" MasterFields="PLACEID=placeid;ID=id;G32=G32" TableName="OUT_COMM" IndexFieldNames="PlaceId;Id;G32" DatabaseName="STS_DB" SessionName="Default" PropData="05704C65667403E4010470546F700214"/><TfrxBDEQuery Name="tblRelCommFull" UserName="tblRelCommFull" CloseDataSource="True" FieldAliases.Text="" IgnoreDupParams="False" SQL.Text="select placeid from rel_comm                                                             " DatabaseName="STS_DB" SessionName="Default" PropData="05704C65667403B0000470546F70039C000A506172616D65746572730100"/><TfrxBDEQuery Name="tblOutCommFull" UserName="tblOutCommFull" CloseDataSource="True" FieldAliases.Text="" IgnoreDupParams="False" SQL.Text="select placeid from out_comm  " DatabaseName="STS_DB" SessionName="Default" PropData="05704C65667403F8000470546F70039C000A506172616D65746572730100"/></TfrxDataPage><TfrxDialogPage Name="Page1" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Параметры отчета" Height="314" Left="475" Top="170" Width="321" OnShow="Page1OnBeforePrint"><TfrxColorFrameControl Name="ColorFrame2" Left="4" Top="184" Width="300" Height="36" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" BorderWidth="2" FormCaption="False" RectCaption="False" Color="-16777201"/><TfrxColorFrameControl Name="ColorFrame1" Left="3" Top="112" Width="300" Height="72" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" BorderWidth="2" FormCaption="False" RectCaption="False" Color="-16777201"/><TfrxColorFrameControl Name="cfrmPeriod" Left="3" Top="56" Width="300" Height="52" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201"/><TfrxColorEditControl Name="fldStoreLic" Left="88" Top="4" Width="121" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" ReadOnly="True"/><TfrxColorEditControl Name="fldStoreNm" Left="72" Top="28" Width="229" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" ReadOnly="True"/><TfrxColorEditControl Name="fldLicExt" Left="72" Top="4" Width="17" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" ReadOnly="True"/><TfrxColorEditControl Name="fldStoreNum" Left="211" Top="4" Width="90" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" ReadOnly="True"/><TfrxLabelControl Name="lblNumLicence" Left="4" Top="7" Width="65" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="№ лицензии:" Color="-16777201"/><TfrxLabelControl Name="Label1" Left="16" Top="31" Width="53" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="Название:" Color="-16777201"/><TfrxColorButtonControl Name="ColorButton1" Left="177" Top="5" Width="31" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777216" Flat="False" GradientType="gtTopToBottom" OnClick="ColorButton1OnBeforePrint"/><TfrxLabelControl Name="lblFrom" Left="15" Top="83" Width="11" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="С" Color="-16777201"/><TfrxLabelControl Name="lblTo" Left="142" Top="84" Width="12" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="по" Color="-16777201"/><TfrxDateEditControl Name="dtTo" Left="159" Top="80" Width="105" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38263" Time="38263"/><TfrxDateEditControl Name="dtFrom" Left="27" Top="80" Width="109" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38263" Time="38263"/><TfrxColorButtonControl Name="btnOk" Left="148" Top="240" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" Caption="Просмотр" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="1" OnClick="btnOkOnBeforePrint"/><TfrxColorButtonControl Name="ColorButton2" Left="228" Top="240" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Отмена" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="2"/><TfrxLabelControl Name="Label2" Left="16" Top="144" Width="86" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="Дата окончания" Color="-16777201"/><TfrxLabelControl Name="Label3" Left="16" Top="160" Width="134" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="функционирования ЗТК" Color="-16777201"/><TfrxRadioButtonControl Name="rbtnConst" Left="12" Top="60" Width="277" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="За период (постоянная ЗТК)" TabStop="False" Color="-16777201" OnClick="rbtnConstOnBeforePrint"/><TfrxRadioButtonControl Name="rbtnTemp" Left="12" Top="120" Width="281" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="За время функционирования (временная ЗТК)" TabStop="False" Color="-16777201" OnClick="rbtnTempOnBeforePrint"/><TfrxDateEditControl Name="dtSvidEnd" Left="152" Top="156" Width="129" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38263" Time="38263"/><TfrxCheckBoxControl Name="chkTable1" Left="16" Top="192" Width="121" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Печатать таблицу 1" Checked="True" State="cbChecked" Color="-16777201"/><TfrxCheckBoxControl Name="chkTable2" Left="160" Top="192" Width="133" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Печатать таблицу 2" Color="-16777201"/><TfrxColorFrameControl Name="ColorFrame3" Left="4" Top="220" Width="128" Height="52" ShowHint="True" BorderWidth="2" FormCaption="False" RectCaption="False" Caption="Дата отчета" Color="-16777201"/><TfrxDateEditControl Name="dtDateReport" Left="18" Top="244" Width="101" Height="21" ShowHint="True" Color="-16777211" Date="40561" Time="40561"/></TfrxDialogPage><TfrxReportPage Name="Page2" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="7" RightMargin="7" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False" OnBeforePrint="Page2OnBeforePrint"><TfrxReportTitle Name="ReportTitle1" Height="178" Left="0" Top="16" Width="1069.60699"><TfrxMemoView Name="Memo1" Left="201" Top="4" Width="632" Height="38" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћС‚С‡РµС‚ Рѕ С‚РѕРІР°СЂР°С…, РІ РѕС‚РЅРѕС€РµРЅРёРё РєРѕС‚РѕСЂС‹С… РїСЂРѕРІРѕРґРёР»РёСЃСЊ РіСЂСѓР·РѕРІС‹Рµ РѕРїРµСЂР°С†РёРё Рё РєРѕС‚РѕСЂС‹Рµ С…СЂР°РЅРёР»РёСЃСЊ РІ Р·РѕРЅРµ С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ РєРѕРЅС‚СЂРѕР»СЏ"/><TfrxMemoView Name="Memo6" Left="14" Top="44" Width="345.35436" Height="18" ShowHint="False" Text="1. Р›РёС†Рѕ, РѕСЃСѓС‰РµСЃС‚РІР»СЏСЋС‰РµРµ РіСЂСѓР·РѕРІС‹Рµ РѕРїРµСЂР°С†РёРё РІ РїРѕСЂС‚Сѓ:"/><TfrxMemoView Name="Memo8" Left="14" Top="84" Width="312" Height="18" ShowHint="False" Text="3. РћС‚С‡РµС‚РЅС‹Р№ РїРµСЂРёРѕРґ (СѓРєР°Р·С‹РІР°СЋС‚СЃСЏ СЃСЂРѕРєРё РѕС‚С‡РµС‚Р°): "/><TfrxMemoView Name="Memo9" Left="355.57483" Top="44" Width="654.42517" Height="18" ShowHint="False" Frame.Typ="8" Text="[tblMain.&#34;G142&#34;]"/><TfrxMemoView Name="Memo10" Left="472.67718" Top="64" Width="537.32282" Height="18" ShowHint="False" Frame.Typ="8" Text="[tblMain.&#34;ADDRESS&#34;]"/><TfrxMemoView Name="Memo11" Left="326" Top="84" Width="684" Height="18" ShowHint="False" Frame.Typ="8" Text="c    [FORMATDATETIME(&#34;dd.mm.yyyy&#34;, dtPeriodStart)]    РїРѕ    [FORMATDATETIME(&#34;dd.mm.yyyy&#34;, dtPeriodEnd)]"/><TfrxMemoView Name="Memo12" Left="14" Top="64" Width="458.67718" Height="18" ShowHint="False" Text="2. РўРµСЂСЂРёС‚РѕСЂРёР°Р»СЊРЅРѕРµ СЂР°СЃРїРѕР»РѕР¶РµРЅРёРµ Р·РѕРЅС‹ С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ РєРѕРЅС‚СЂРѕР»СЏ (Р°РґСЂРµСЃ):"/><TfrxMemoView Name="Memo14" Left="14" Top="104" Width="559.11812" Height="18" ShowHint="False" Text="4. РљРѕР»РёС‡РµСЃС‚РІРѕ Р»РёС†, РёРјРµРІС€РёС… РґРѕРіРѕРІРѕСЂРЅС‹Рµ РѕС‚РЅРѕС€РµРЅРёСЏ СЃ РѕСЂРіР°РЅРёР·Р°С†РёРµР№ Р·Р° РѕС‚С‡РµС‚РЅС‹Р№ РїРµСЂРёРѕРґ:"/><TfrxMemoView Name="Memo15" Left="580.67718" Top="104" Width="429.32282" Height="18" ShowHint="False" Frame.Typ="8" Text="[qryContracts.&#34;COUNT_CONTRACTS&#34;]"/><TfrxMemoView Name="Memo16" Left="14" Top="124" Width="638.23624" Height="18" ShowHint="False" Text="5. РљРѕР»РёС‡РµСЃС‚РІРѕ С‚Р°РјРѕР¶РµРЅРЅС‹С… РґРµРєР»Р°СЂР°С†РёР№ (С‚СЂР°РЅР·РёС‚РЅС‹С… РґРµРєР»Р°СЂР°С†РёР№), РѕС„РѕСЂРјР»РµРЅРЅС‹С… Р·Р° РѕС‚С‡РµС‚РЅС‹Р№ РїРµСЂРёРѕРґ:"/><TfrxMemoView Name="Memo17" Left="652.23624" Top="124" Width="357.76376" Height="18" OnBeforePrint="Memo17OnBeforePrint" ShowHint="False" Frame.Typ="8" Text="[sDeclCnt]"/><TfrxMemoView Name="Memo18" Left="14" Top="144" Width="604" Height="34" ShowHint="False" Text="6. РљРѕР»РёС‡РµСЃС‚РІРѕ РЅР°СЂСѓС€РµРЅРёР№ С‚Р°РјРѕР¶РµРЅРЅС‹С… РїСЂР°РІРёР» (РќРўРџ), СЃРѕРІРµСЂС€РµРЅРЅС‹С… РѕСЂРіР°РЅРёР·Р°С†РёРµР№, Р° С‚Р°РєР¶Рµ Р»РёС†Р°РјРё, РёРјРµРІС€РёРјРё РґРѕРіРѕРІРѕСЂРЅС‹Рµ РѕС‚РЅРѕС€РµРЅРёСЏ СЃ РЅРµР№ Р·Р° РѕС‚С‡РµС‚РЅС‹Р№ РїРµСЂРёРѕРґ:"/><TfrxMemoView Name="Memo19" Left="627.88992" Top="160" Width="232" Height="18" ShowHint="False" Frame.Typ="8" Text="0"/></TfrxReportTitle><TfrxMasterData Name="MasterData1" Height="18" Left="0" Top="472" Width="1069.60699" OnBeforePrint="MasterData1OnBeforePrint" AllowSplit="True" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="tblMain" DataSetName="tblMain" RowCount="0" Stretched="True"><TfrxMemoView Name="Memo20" Left="61.66141" Top="0" Width="39.33859" Height="18" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="[LINE#]"/><TfrxMemoView Name="Memo21" Left="101" Top="0" Width="156" Height="18" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="[COPY(&#60;tblMain.&#34;G33&#34;&#62;, 1, 4)]"/><TfrxMemoView Name="Memo22" Left="257" Top="0" Width="196" Height="18" OnBeforePrint="Memo22OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="[vG35] [sUnName]"/><TfrxMemoView Name="Memo23" Left="453" Top="0" Width="228" Height="18" OnBeforePrint="Memo23OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="[vG46]"/><TfrxMemoView Name="Memo24" Left="681" Top="0" Width="84" Height="18" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="[FORMATDATETIME(&#34;DD.MM.YYYY&#34;, &#60;tblMain.&#34;ACCEPTDATE&#34;&#62;)]"/><TfrxMemoView Name="Memo13" Left="765" Top="0" Width="84" Height="18" OnBeforePrint="Memo13OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="[vG311]"/><TfrxMemoView Name="Memo47" Left="849" Top="0" Width="112" Height="18" OnBeforePrint="Memo47OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="[sStoreNum]"/></TfrxMasterData><TfrxHeader Name="MasterHeader1" Height="126" Left="0" Top="328" Width="1069.60699" OnBeforePrint="MasterHeader1OnBeforePrint"><TfrxMemoView Name="Memo25" Left="61.66141" Top="60" Width="39.33859" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="в„– Рї/Рї"/><TfrxMemoView Name="Memo26" Left="101" Top="60" Width="156" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РљРѕРґ РїРѕ РўРќ Р’Р­Р” Р РѕСЃСЃРёРё (4 Р·РЅР°РєР°)"/><TfrxMemoView Name="Memo28" Left="257" Top="60" Width="196" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РњР°СЃСЃР° Р±СЂСѓС‚С‚Рѕ, РІ РєРі (Р»РёР±Рѕ РІ РґРѕРї. РµРґРёРЅРёС†Р°С… РёР·РјРµСЂРµРЅРёСЏ)"/><TfrxMemoView Name="Memo29" Left="453" Top="60" Width="228" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="Р¤Р°РєС‚СѓСЂРЅР°СЏ СЃС‚РѕРёРјРѕСЃС‚СЊ С‚РѕРІР°СЂР°, РґРѕР»Р». РЎРЁРђ"/><TfrxMemoView Name="Memo30" Left="681" Top="60" Width="84" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="Р”Р°С‚Р° РїРѕРјРµС‰РµРЅРёСЏ С‚РѕРІР°СЂРѕРІ РІ Р—РўРљ"/><TfrxMemoView Name="Memo44" Left="294" Top="36" Width="500" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text="РўРѕРІР°СЂС‹, РїРѕРјРµС‰РµРЅРЅС‹Рµ Р·Р° РѕС‚С‡РµС‚РЅС‹Р№ РїРµСЂРёРѕРґ РІ Р·РѕРЅСѓ С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ РєРѕРЅС‚СЂРѕР»СЏ"/><TfrxMemoView Name="Memo2" Left="765" Top="60" Width="84" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ РіСЂСѓР·РѕРІС‹С… РјРµСЃС‚"/><TfrxMemoView Name="Memo7" Left="849" Top="60" Width="112" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РЎРєР»Р°РґСЃРєРѕР№ РЅРѕРјРµСЂ С‚РѕРІР°СЂР°"/><TfrxMemoView Name="Memo39" Left="73" Top="8" Width="184" Height="18" ShowHint="False" VAlign="vaCenter" Text="РўР°Р±Р»РёС†Р° 1"/></TfrxHeader><TfrxPageFooter Name="PageFooter1" Height="26" Left="0" Top="576" Width="1069.60699"><TfrxMemoView Name="Memo46" Left="895" Top="8" Width="128" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" ParentFont="False" Text="РЎС‚СЂР°РЅРёС†Р° [PAGE#]"/><TfrxLineView Name="Line3" Left="11" Top="8" Width="1004" Height="0" ShowHint="False" Frame.Typ="4" Frame.Width="2"/><TfrxMemoView Name="Memo43" Left="178" Top="8" Width="704" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р’Р­Р”-РЎРєР»Р°Рґ  Copyright (C)  РћРћРћ &#34;РЎРўРњ&#34;,1996-[FORMATDATETIME(&#34;YYYY&#34;, DATE)].Internet: www.ctm.ru"/><TfrxMemoView Name="Memo52" Left="15" Top="8" Width="160" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" ParentFont="False" VAlign="vaCenter" Text="[FORMATDATETIME(&#34;DD.MM.YYYY&#34;, dtDateReport1)]"/></TfrxPageFooter><TfrxPageHeader Name="PageHeader1" Height="94" Left="0" Top="216" Width="1069.60699" OnBeforePrint="PageHeader1OnBeforePrint" PrintOnFirstPage="False"><TfrxMemoView Name="Memo27" Left="77" Top="8" Width="184" Height="18" ShowHint="False" VAlign="vaCenter" Text="РўР°Р±Р»РёС†Р° 1 (РїСЂРѕРґРѕР»Р¶РµРЅРёРµ)"/><TfrxMemoView Name="Memo31" Left="61.66141" Top="28" Width="39.33859" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="в„– Рї/Рї"/><TfrxMemoView Name="Memo32" Left="101" Top="28" Width="156" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РљРѕРґ РїРѕ РўРќ Р’Р­Р” Р РѕСЃСЃРёРё (4 Р·РЅР°РєР°)"/><TfrxMemoView Name="Memo34" Left="257" Top="28" Width="196" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РњР°СЃСЃР° Р±СЂСѓС‚С‚Рѕ, РІ РєРі (Р»РёР±Рѕ РІ РґРѕРї. РµРґРёРЅРёС†Р°С… РёР·РјРµСЂРµРЅРёСЏ)"/><TfrxMemoView Name="Memo35" Left="453" Top="28" Width="228" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="Р¤Р°РєС‚СѓСЂРЅР°СЏ СЃС‚РѕРёРјРѕСЃС‚СЊ С‚РѕРІР°СЂР°, РґРѕР»Р». РЎРЁРђ"/><TfrxMemoView Name="Memo36" Left="681" Top="28" Width="84" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="Р”Р°С‚Р° РїРѕРјРµС‰РµРЅРёСЏ С‚РѕРІР°СЂРѕРІ РІ Р—РўРљ"/><TfrxMemoView Name="Memo37" Left="765" Top="28" Width="84" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ РіСЂСѓР·РѕРІС‹С… РјРµСЃС‚"/><TfrxMemoView Name="Memo38" Left="849" Top="28" Width="112" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РЎРєР»Р°РґСЃРєРѕР№ РЅРѕРјРµСЂ С‚РѕРІР°СЂР°"/></TfrxPageHeader><TfrxReportSummary Name="ReportSummary1" Height="44.66141" Left="0" Top="512" Width="1069.60699" OnBeforePrint="ReportSummary1OnBeforePrint"><TfrxMemoView Name="Memo68" Left="502" Top="8.44093999999996" Width="172" Height="18" ShowHint="False" Text="Р СѓРєРѕРІРѕРґРёС‚РµР»СЊ РѕСЂРіР°РЅРёР·Р°С†РёРё:"/><TfrxMemoView Name="Memo69" Left="674" Top="8.44093999999996" Width="120" Height="18" ShowHint="False" Frame.Typ="8" Text=""/><TfrxMemoView Name="Memo70" Left="798" Top="8.44093999999996" Width="180" Height="18" OnBeforePrint="Memo70OnBeforePrint" ShowHint="False" Text="([STORES_2.&#34;CHIEF&#34;])"/><TfrxMemoView Name="Memo74" Left="686" Top="24.44094" Width="96" Height="14.22047" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="(РїРѕРґРїРёСЃСЊ)"/></TfrxReportSummary></TfrxReportPage><TfrxReportPage Name="Page3" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="7" RightMargin="7" TopMargin="7" BottomMargin="7" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False" OnBeforePrint="Page3OnBeforePrint"><TfrxHeader Name="Band1" Height="126" Left="0" Top="374.17347" Width="1069.60699" OnBeforePrint="Band1OnBeforePrint"><TfrxMemoView Name="Memo3" Left="59.66141" Top="60" Width="39.33859" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="в„– Рї/Рї"/><TfrxMemoView Name="Memo4" Left="99" Top="60" Width="156" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РљРѕРґ РїРѕ РўРќ Р’Р­Р” Р РѕСЃСЃРёРё (4 Р·РЅР°РєР°)"/><TfrxMemoView Name="Memo5" Left="679" Top="60" Width="88" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="Р”Р°С‚Р° РїРѕРјРµС‰РµРЅРёСЏ С‚РѕРІР°СЂРѕРІ РІ Р—РўРљ"/><TfrxMemoView Name="Memo33" Left="71" Top="12" Width="96" Height="18" ShowHint="False" VAlign="vaCenter" Text="РўР°Р±Р»РёС†Р° 2"/><TfrxMemoView Name="Memo58" Left="190" Top="36" Width="704" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text="РўРѕРІР°СЂС‹, РЅР°С…РѕРґСЏС‰РёРµСЃСЏ РІ Р·РѕРЅРµ С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ РєРѕРЅС‚СЂРѕР»СЏ РЅР° РјРѕРјРµРЅС‚ РѕРєРѕРЅС‡Р°РЅРёСЏ РµРµ С„СѓРЅРєС†РёРѕРЅРёСЂРѕРІР°РЅРёСЏ"/><TfrxMemoView Name="Memo60" Left="767" Top="60" Width="84" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ РіСЂСѓР·РѕРІС‹С… РјРµСЃС‚"/><TfrxMemoView Name="Memo61" Left="851" Top="60" Width="112" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РЎРєР»Р°РґСЃРєРѕР№ РЅРѕРјРµСЂ С‚РѕРІР°СЂР°"/><TfrxMemoView Name="Memo64" Left="451" Top="60" Width="228" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="Р¤Р°РєС‚СѓСЂРЅР°СЏ СЃС‚РѕРёРјРѕСЃС‚СЊ С‚РѕРІР°СЂР°, РґРѕР»Р». РЎРЁРђ"/><TfrxMemoView Name="Memo65" Left="255" Top="60" Width="196" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РњР°СЃСЃР° Р±СЂСѓС‚С‚Рѕ, РІ РєРі (Р»РёР±Рѕ РІ РґРѕРї. РµРґРёРЅРёС†Р°С… РёР·РјРµСЂРµРЅРёСЏ)"/></TfrxHeader><TfrxMasterData Name="Band2" Height="18" Left="0" Top="521.57514" Width="1069.60699" OnBeforePrint="Band2OnBeforePrint" AllowSplit="True" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="tblMain" DataSetName="tblMain" RowCount="0" Stretched="True"><TfrxMemoView Name="Memo53" Left="59.66141" Top="3.30846461338297E-14" Width="39.33859" Height="18" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="[vNumLine]"/><TfrxMemoView Name="Memo54" Left="99" Top="3.30846461338297E-14" Width="156" Height="18" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="[COPY(&#60;tblMain.&#34;G33&#34;&#62;, 1, 4)]"/><TfrxMemoView Name="Memo55" Left="255" Top="3.30846461338297E-14" Width="196" Height="18" OnBeforePrint="Memo55OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="[vRest] [sUnName]"/><TfrxMemoView Name="Memo56" Left="451" Top="3.30846461338297E-14" Width="228" Height="18" OnBeforePrint="Memo56OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="[vG46Rest]"/><TfrxMemoView Name="Memo57" Left="679" Top="0" Width="88" Height="18" OnBeforePrint="Memo57OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="[FORMATDATETIME(&#34;DD.MM.YYYY&#34;, &#60;tblMain.&#34;ACCEPTDATE&#34;&#62;)]"/><TfrxMemoView Name="Memo62" Left="767" Top="3.30846461338297E-14" Width="84" Height="18" OnBeforePrint="Memo62OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="[vRestG311]"/><TfrxMemoView Name="Memo63" Left="851" Top="3.30846461338297E-14" Width="112" Height="18" OnBeforePrint="Memo63OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="[sStoreNum]"/></TfrxMasterData><TfrxPageFooter Name="Band3" Height="26" Left="0" Top="668.97681" Width="1069.60699" OnBeforePrint="Band3OnBeforePrint"><TfrxMemoView Name="Memo59" Left="895" Top="8" Width="128" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" ParentFont="False" Text="РЎС‚СЂР°РЅРёС†Р° [PAGE#]"/><TfrxLineView Name="Line1" Left="11" Top="8" Width="1004" Height="0" ShowHint="False" Frame.Typ="4" Frame.Width="2"/><TfrxMemoView Name="Memo66" Left="178" Top="8" Width="704" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р’Р­Р”-РЎРєР»Р°Рґ  Copyright (C)  РћРћРћ &#34;РЎРўРњ&#34;,1996-[FORMATDATETIME(&#34;YYYY&#34;, DATE)].Internet: www.ctm.ru"/><TfrxMemoView Name="Memo67" Left="15" Top="8" Width="160" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" ParentFont="False" VAlign="vaCenter" Text="[FORMATDATETIME(&#34;DD.MM.YYYY&#34;, dtDateReport1)]"/></TfrxPageFooter><TfrxPageHeader Name="Band4" Height="94" Left="0" Top="219.21274" Width="1069.60699" OnBeforePrint="Band4OnBeforePrint" PrintOnFirstPage="False"><TfrxMemoView Name="Memo40" Left="71" Top="8" Width="184" Height="18" ShowHint="False" VAlign="vaCenter" Text="РўР°Р±Р»РёС†Р° 2 (РїСЂРѕРґРѕР»Р¶РµРЅРёРµ)"/><TfrxMemoView Name="Memo41" Left="59.66141" Top="28" Width="39.33859" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="в„– Рї/Рї"/><TfrxMemoView Name="Memo42" Left="99" Top="28" Width="156" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РљРѕРґ РїРѕ РўРќ Р’Р­Р” Р РѕСЃСЃРёРё (4 Р·РЅР°РєР°)"/><TfrxMemoView Name="Memo45" Left="255" Top="28" Width="196" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РњР°СЃСЃР° Р±СЂСѓС‚С‚Рѕ, РІ РєРі (Р»РёР±Рѕ РІ РґРѕРї. РµРґРёРЅРёС†Р°С… РёР·РјРµСЂРµРЅРёСЏ)"/><TfrxMemoView Name="Memo48" Left="451" Top="28" Width="228" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="Р¤Р°РєС‚СѓСЂРЅР°СЏ СЃС‚РѕРёРјРѕСЃС‚СЊ С‚РѕРІР°СЂР°, РґРѕР»Р». РЎРЁРђ"/><TfrxMemoView Name="Memo49" Left="679" Top="28" Width="88" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="Р”Р°С‚Р° РїРѕРјРµС‰РµРЅРёСЏ С‚РѕРІР°СЂРѕРІ РІ Р—РўРљ"/><TfrxMemoView Name="Memo50" Left="767" Top="28" Width="84" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ РіСЂСѓР·РѕРІС‹С… РјРµСЃС‚"/><TfrxMemoView Name="Memo51" Left="851" Top="28" Width="112" Height="66" ShowHint="False" Frame.Typ="15" HAlign="haCenter" VAlign="vaCenter" Text="РЎРєР»Р°РґСЃРєРѕР№ РЅРѕРјРµСЂ С‚РѕРІР°СЂР°"/></TfrxPageHeader><TfrxReportSummary Name="Band5" Height="46" Left="0" Top="600.94527" Width="1069.60699" OnBeforePrint="Band5OnBeforePrint"><TfrxMemoView Name="Memo71" Left="502" Top="16.0000000000004" Width="172" Height="18" ShowHint="False" Text="Р СѓРєРѕРІРѕРґРёС‚РµР»СЊ РѕСЂРіР°РЅРёР·Р°С†РёРё:"/><TfrxMemoView Name="Memo72" Left="674" Top="16.0000000000004" Width="120" Height="18" ShowHint="False" Frame.Typ="8" Text=""/><TfrxMemoView Name="Memo73" Left="798" Top="16.0000000000004" Width="204" Height="18" OnBeforePrint="Memo73OnBeforePrint" ShowHint="False" Text="([STORES_2.&#34;CHIEF&#34;])"/><TfrxMemoView Name="Memo75" Left="686" Top="32.0000000000004" Width="96" Height="14" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="(РїРѕРґРїРёСЃСЊ)"/></TfrxReportSummary><TfrxReportTitle Name="Band6" Height="178" Left="0" Top="18.89765" Width="1069.60699" OnBeforePrint="Band6OnBeforePrint"><TfrxMemoView Name="Memo76" Left="201" Top="4" Width="632" Height="38" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћС‚С‡РµС‚ Рѕ С‚РѕРІР°СЂР°С…, РІ РѕС‚РЅРѕС€РµРЅРёРё РєРѕС‚РѕСЂС‹С… РїСЂРѕРІРѕРґРёР»РёСЃСЊ РіСЂСѓР·РѕРІС‹Рµ РѕРїРµСЂР°С†РёРё Рё РєРѕС‚РѕСЂС‹Рµ С…СЂР°РЅРёР»РёСЃСЊ РІ Р·РѕРЅРµ С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ РєРѕРЅС‚СЂРѕР»СЏ"/><TfrxMemoView Name="Memo77" Left="14" Top="44" Width="341.57483" Height="18" ShowHint="False" Text="1. Р›РёС†Рѕ, РѕСЃСѓС‰РµСЃС‚РІР»СЏСЋС‰РµРµ РіСЂСѓР·РѕРІС‹Рµ РѕРїРµСЂР°С†РёРё РІ РїРѕСЂС‚Сѓ:"/><TfrxMemoView Name="Memo78" Left="14" Top="84" Width="312" Height="18" ShowHint="False" Text="3. РћС‚С‡РµС‚РЅС‹Р№ РїРµСЂРёРѕРґ (СѓРєР°Р·С‹РІР°СЋС‚СЃСЏ СЃСЂРѕРєРё РѕС‚С‡РµС‚Р°): "/><TfrxMemoView Name="Memo79" Left="359.35436" Top="44" Width="650.64564" Height="18" ShowHint="False" Frame.Typ="8" Text="[tblMain.&#34;G142&#34;]"/><TfrxMemoView Name="Memo80" Left="468.89765" Top="64" Width="541.10235" Height="18" ShowHint="False" Frame.Typ="8" Text="[tblMain.&#34;ADDRESS&#34;]"/><TfrxMemoView Name="Memo81" Left="326" Top="84" Width="684" Height="18" ShowHint="False" Frame.Typ="8" Text="c    [FORMATDATETIME(&#34;dd.mm.yyyy&#34;, dtPeriodStart)]    РїРѕ    [FORMATDATETIME(&#34;dd.mm.yyyy&#34;, dtPeriodEnd)]"/><TfrxMemoView Name="Memo82" Left="14" Top="64" Width="454.89765" Height="18" ShowHint="False" Text="2. РўРµСЂСЂРёС‚РѕСЂРёР°Р»СЊРЅРѕРµ СЂР°СЃРїРѕР»РѕР¶РµРЅРёРµ Р·РѕРЅС‹ С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ РєРѕРЅС‚СЂРѕР»СЏ (Р°РґСЂРµСЃ):"/><TfrxMemoView Name="Memo83" Left="14" Top="104" Width="566.67718" Height="18" ShowHint="False" Text="4. РљРѕР»РёС‡РµСЃС‚РІРѕ Р»РёС†, РёРјРµРІС€РёС… РґРѕРіРѕРІРѕСЂРЅС‹Рµ РѕС‚РЅРѕС€РµРЅРёСЏ СЃ РѕСЂРіР°РЅРёР·Р°С†РёРµР№ Р·Р° РѕС‚С‡РµС‚РЅС‹Р№ РїРµСЂРёРѕРґ:"/><TfrxMemoView Name="Memo84" Left="584.45671" Top="104" Width="425.54329" Height="18" ShowHint="False" Frame.Typ="8" Text="[qryContracts.&#34;COUNT_CONTRACTS&#34;]"/><TfrxMemoView Name="Memo85" Left="14" Top="124" Width="638.23624" Height="18" ShowHint="False" Text="5. РљРѕР»РёС‡РµСЃС‚РІРѕ С‚Р°РјРѕР¶РµРЅРЅС‹С… РґРµРєР»Р°СЂР°С†РёР№ (С‚СЂР°РЅР·РёС‚РЅС‹С… РґРµРєР»Р°СЂР°С†РёР№), РѕС„РѕСЂРјР»РµРЅРЅС‹С… Р·Р° РѕС‚С‡РµС‚РЅС‹Р№ РїРµСЂРёРѕРґ:"/><TfrxMemoView Name="Memo86" Left="652.23624" Top="124" Width="357.76376" Height="18" OnBeforePrint="Memo86OnBeforePrint" ShowHint="False" Frame.Typ="8" Text="[sDeclCnt]"/><TfrxMemoView Name="Memo87" Left="14" Top="144" Width="604" Height="34" ShowHint="False" Text="6. РљРѕР»РёС‡РµСЃС‚РІРѕ РЅР°СЂСѓС€РµРЅРёР№ С‚Р°РјРѕР¶РµРЅРЅС‹С… РїСЂР°РІРёР» (РќРўРџ), СЃРѕРІРµСЂС€РµРЅРЅС‹С… РѕСЂРіР°РЅРёР·Р°С†РёРµР№, Р° С‚Р°РєР¶Рµ Р»РёС†Р°РјРё, РёРјРµРІС€РёРјРё РґРѕРіРѕРІРѕСЂРЅС‹Рµ РѕС‚РЅРѕС€РµРЅРёСЏ СЃ РЅРµР№ Р·Р° РѕС‚С‡РµС‚РЅС‹Р№ РїРµСЂРёРѕРґ:"/><TfrxMemoView Name="Memo88" Left="635.44898" Top="160" Width="232" Height="18" ShowHint="False" Frame.Typ="8" Text=""/></TfrxReportTitle></TfrxReportPage></TfrxReport>