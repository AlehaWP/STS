<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.6.78" DotMatrixReport="False" EngineOptions.ConvertNulls="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Ïî óìîë÷àíèþ" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38262.532863669" ReportOptions.Description.Text="" ReportOptions.Name="Îò÷åò î òîâàðàõ(ïðèêàç 1352 ïðèë.15)" ReportOptions.LastChange="40815.4323865278" ScriptLanguage="PascalScript" ScriptText.Text="Var&#13;&#10;   MAINID, vFilterCrit, vPlaceId, vNBD,  vChief,&#13;&#10;   vPapers, reportPeriod : String;&#13;&#10;   dtSvidetEnd, vLicenceDate: TDateTime;&#13;&#10;   vLine: Integer;&#13;&#10;   vRestG35, vRestG311, vRestG42: Double;&#13;&#10;   Do2RemsByActIn, CustomDocsOnly, StoreDocsBlock, AistCompatible: Integer;&#13;&#10;   dSumRelAtPeriodG35, dSumRelAtPeriodG42 : Double;&#13;&#10;   sSQL : String;&#13;&#10;   sPaperNames, sPaperCodes: String;&#13;&#10;   sRestG35, sRestG42 : String;                                                                    &#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Page1, Engine do&#13;&#10;  begin&#13;&#10;  dtSvidEnd.Date := STRTODATEDEF(COMPUTE('INIFILE(&#34;Print&#34;,&#34;SvidEnd&#34;,&#34;&#34;)'), DATE);&#13;&#10;  vPlaceId:=COMPUTE('INIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;1&#34;)');&#13;&#10;  If COMPUTE('INIFILE(&#34;Print&#34;,&#34;Archive&#34;,&#34;False&#34;)') = 'False' then&#13;&#10;    chkArchive.Checked := False&#13;&#10;  else chkArchive.Checked := True;&#13;&#10;&#13;&#10;  If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + VarToSTR(vPlaceId) + '&#34;])') = '1' then&#13;&#10;    begin&#13;&#10;       fldStoreLic.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   íîìåð ëèöåíçèè&#13;&#10;       fldStoreNum.Text := '¹ ñêëàäà: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   íîìåð ñêëàäà&#13;&#10;       fldStoreNm.Text := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   íàçâàíèå ñêëàäà&#13;&#10;       fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Ïðèçíàê ïåðåðåãèñòðàöèè&#13;&#10;       vChief:=  &#60;STORES_2.&#34;CHIEF&#34;&#62; ;&#13;&#10;       vLicenceDate := &#60;STORES_2.&#34;LICENCEDATE&#34;&#62;;&#13;&#10;       cbtnOk.Enabled := True;&#13;&#10;    end&#13;&#10;  else&#13;&#10;    begin&#13;&#10;      vPlaceId:=COMPUTE('INIFILE(&#34;WorkPlace&#34;,&#34;PlaceNum&#34;,&#34;&#34;)');&#13;&#10;      If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + VarToSTR(vPlaceId) + '&#34;])') = '1' then&#13;&#10;        begin&#13;&#10;          fldStoreLic.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   íîìåð ëèöåíçèè&#13;&#10;          fldStoreNum.Text := '¹ ñêëàäà: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   íîìåð ñêëàäà&#13;&#10;          fldStoreNm.Text := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   íàçâàíèå ñêëàäà&#13;&#10;          fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Ïðèçíàê ïåðåðåãèñòðàöèè&#13;&#10;          vChief:=  &#60;STORES_2.&#34;CHIEF&#34;&#62; ;&#13;&#10;          vLicenceDate := &#60;STORES_2.&#34;LICENCEDATE&#34;&#62;;&#13;&#10;          cbtnOk.Enabled := True;&#13;&#10;        end&#13;&#10;      else&#13;&#10;        cbtnOk.Enabled := False&#13;&#10;    end;&#13;&#10;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ColorButton1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with ColorButton1, Engine do&#13;&#10;  begin&#13;&#10;    COMPUTE(' globalvar (&#34;strStoreNumLic&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;strStoreNum&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;strStoreName&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;strLicExt&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;sPlaceId&#34;,Integer)');&#13;&#10;    COMPUTE('OPENQUERY (&#34;Stors&#34;, &#34;STS_DB&#34;, &#34;Select * from STORES&#34;)');&#13;&#10;&#13;&#10;    IF COMPUTE('SelectRecords(&#34;Âûáîð ñêëàäñêèõ ïëîùàäîê&#34;, &#34;STORS&#34;,'+&#13;&#10;                          '['+&#13;&#10;                           '[&#34;LICENCENO&#34;, &#34;¹ ëèöåíçèè&#34;, 12],'+&#13;&#10;                           '[&#34;STORE_NO&#34;, &#34;¹ ñêëàäà&#34;, 8],'+&#13;&#10;                           '[&#34;NAME&#34;, &#34;Íàçâàíèå ñêëàäà&#34;, 30]'+&#13;&#10;                           '],'+&#13;&#10;                           '&#34;STOR&#34;, &#34;&#34;, &#34;STS_DB&#34;)') = '1' then&#13;&#10;&#13;&#10;      begin&#13;&#10;        COMPUTE('FIRST(&#34;STOR&#34;)');&#13;&#10;        fldStoreLic.Text := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;LICENCENO&#34;)');  //   íîìåð  ëèöåíöçèè&#13;&#10;        fldStoreNum.Text := '¹ ñêëàäà: ' + COMPUTE('FieldValue(&#34;Stor&#34;, &#34;STORE_NO&#34;)') ; //   íîìåð ñêëàäà&#13;&#10;        fldStoreNm.Text :=COMPUTE('FieldValue(&#34;Stor&#34;, &#34;NAME&#34;)') ;     //   íàçâàíèå ñêëàäà&#13;&#10;        fldLicExt.Text := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;LICENCENO_EXT&#34;)');     //   Ïðèçíàê ïåðåðåãèñòðàöèè&#13;&#10;        vPlaceId := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;PLACEID&#34;)');&#13;&#10;        vChief  := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;Chief&#34;)');   // óïîëíîìî÷åííûé ïðåäñòàâèòåëü ñêëàäà&#13;&#10;        cbtnOk.Enabled := True;&#13;&#10;      end&#13;&#10;    else&#13;&#10;      begin&#13;&#10;        cbtnOk.Enabled := False;&#13;&#10;      end&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbtnOkOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with cbtnOk, Engine do&#13;&#10;  begin&#13;&#10;    CustomDocsOnly := STRtoInt(COMPUTE('INIFILE(&#34;RegBook&#34;, &#34;CustomsDocsOnly&#34;, &#34;0&#34;)'));&#13;&#10;     //Ñêëàäñêèå äîêóìåíòû&#13;&#10;    StoreDocsBlock := StrToInt(COMPUTE('INIFILE(&#34;Database&#34;, &#34;StoreDocsBlock&#34;, 0)'));&#13;&#10;     {âêëþ÷åíà ëè íàñòðîéêà &#34;Ñîâìåñòèìîñòü ñ ÀÈÑÒîì&#34;, 1-äà, 0-íåò}&#13;&#10;    AistCompatible := STRtoINT(COMPUTE('INIFILE(&#34;Docs&#34;, &#34;AistCompatible&#34;, &#34;0&#34;)'));&#13;&#10;&#13;&#10;    // ðàñ÷åò îñòàòêîâ â ÄÎ2 ïî àêòàì ïðèíÿòèÿ                                                                                                       &#13;&#10;    Do2RemsByActIn := STRtoINT(COMPUTE('INIFILE(&#34;Docs&#34;, &#34;Do2RemsByActIn&#34;, &#34;0&#34;)'));        &#13;&#10;&#13;&#10;    //Äàòà îêîí÷àíèÿ äåéñòâèÿ ñâèäåòåëüñòâà&#13;&#10;    dtSvidetEnd := Trunc(dtSvidEnd.Date) + STRTOTIME('23:59:59');&#13;&#10;                                    &#13;&#10;    vFilterCrit := 'PLACEID=' + CHR(39) + VarToSTR(vPlaceId) + CHR(39) +&#13;&#10;               ' AND BEG_KEEP&#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY HH:NN:SS',dtSvidetEnd) + CHR(39);&#13;&#10;&#13;&#10;    if chkArchive.Checked = False then&#13;&#10;      vFilterCrit := vFilterCrit + ' AND ((IN_ARCHIVE &#60;&#62; ' + CHR(39) + '1' + CHR(39)+') OR (IN_ARCHIVE IS NULL))';&#13;&#10;&#13;&#10;    sSQL := 'SELECT * FROM KRD_MAIN WHERE '+vFilterCrit+' ORDER BY BEG_KEEP, NBD';&#13;&#10;    qryMain.Active := False;        &#13;&#10;    qryMain.SQL.Clear;&#13;&#10;    qryMain.SQL.Add(sSql);&#13;&#10;    qryMain.Active := True;        &#13;&#10;      &#13;&#10;    //COMPUTE('SETFILTER(&#34;KRD_MAIN_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;    COMPUTE('SETRANGE(&#34;STORES_2&#34;, [&#34;' + vPlaceId + '&#34;])');&#13;&#10;&#13;&#10;    //Îáúÿâèì ïåðåìåííûå&#13;&#10;    MAINID := '';&#13;&#10;    vNBD := '';&#13;&#10;    vLine := 0;&#13;&#10;    vRestG35 := 0;&#13;&#10;    vRestG311 := 0;&#13;&#10;    vPapers := &#34;&#34;;&#13;&#10;&#13;&#10;    Compute('WRITEINIFILE(&#34;Print&#34;,&#34;SvidEnd&#34;,&#34;' + DateToStr(dtSvidEnd.Date) + '&#34;)');&#13;&#10;    Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;' + vPlaceId + '&#34;)');&#13;&#10;    Compute('WRITEINIFILE(&#34;Print&#34;,&#34;Archive&#34;,&#34;' + VarToStr(chkArchive.Checked) + '&#34;)');&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with MasterData1, Engine do&#13;&#10;  begin&#13;&#10;      COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');&#13;&#10;      COMPUTE('SETRANGE(&#34;KRD_COMM_2&#34;, [&#34;' + VarToStr(&#60;qryMAIN.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VarToSTR(&#60;qryMAIN.&#34;ID&#34;&#62;) + '&#34;])');&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DetailData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  dSumRelAtPeriodG35 := 0;&#13;&#10;  dSumRelAtPeriodG42 := 0;&#13;&#10;  &#13;&#10;  if ((StoreDocsBlock=1) and not((AistCompatible=0)and (CustomDocsOnly=1))) then      &#13;&#10;  begin&#13;&#10;    COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;&#34;)');&#13;&#10;    vFilterCrit := 'PLACEID=' + IntToStr(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + ' AND ID=' + IntToStr(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + ' AND G32=' + IntToStr(&#60;KRD_COMM_2.&#34;G32&#34;&#62;);&#13;&#10;    COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;&#13;&#10;    COMPUTE('FIRST(&#34;OUT_COMM_2&#34;)');&#13;&#10;    while COMPUTE('EOF(&#34;OUT_COMM_2&#34;)') = '0' do begin&#13;&#10;      if COMPUTE('FINDKEY(&#34;OUT_MAIN_2&#34;, [&#34;' + IntToStr(&#60;OUT_COMM_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;OUT_COMM_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;OUT_COMM_2.&#34;ACTOUTID&#34;&#62;) + '&#34;])') &#60;&#62; '0' then begin&#13;&#10;        if (&#60;OUT_MAIN_2.&#34;G542&#34;&#62; &#60;&#62; NULL) and (&#60;OUT_MAIN_2.&#34;G542&#34;&#62; &#60;= dtSvidetEnd) then begin&#13;&#10;          //Ñ÷èòàåì ñóììû&#13;&#10;          dSumRelAtPeriodG42 := dSumRelAtPeriodG42 + IIF(&#60;OUT_COMM_2.&#34;OUT_G42&#34;&#62;&#60;&#62;Null, &#60;OUT_COMM_2.&#34;OUT_G42&#34;&#62;, 0);&#13;&#10;          dSumRelAtPeriodG35 := dSumRelAtPeriodG35 + IIF(&#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;&#60;&#62;Null, &#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;, 0);&#13;&#10;        end;&#13;&#10;      end;&#13;&#10;      COMPUTE('NEXT(&#34;OUT_COMM_2&#34;)');&#13;&#10;    end;&#13;&#10;    COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;&#34;)');&#13;&#10;&#13;&#10;    If Do2RemsByActIn = 1 then&#13;&#10;    begin&#13;&#10;      COMPUTE('SETFILTER(&#34;IN_COMM_2&#34;, &#34;&#34;)');&#13;&#10;      vFilterCrit := 'PLACEID=' + IntToStr(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + ' AND ID=' + IntToStr(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + ' AND G32=' + IntToStr(&#60;KRD_COMM_2.&#34;G32&#34;&#62;);&#13;&#10;      COMPUTE('SETFILTER(&#34;IN_COMM_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;        &#13;&#10;      if &#60;IN_COMM_2.&#34;G35&#34;&#62; &#60;&#62; NULL then&#13;&#10;        vRestG35 := &#60;IN_COMM_2.&#34;G35&#34;&#62; - dSumRelAtPeriodG35&#13;&#10;      else&#13;&#10;        if &#60;KRD_COMM_2.&#34;G35&#34;&#62; &#60;&#62; NULL then&#13;&#10;          vRestG35 := &#60;KRD_COMM_2.&#34;G35&#34;&#62; - dSumRelAtPeriodG35&#13;&#10;        else                    &#13;&#10;          vRestG35 := 0;&#13;&#10;      if &#60;IN_COMM_2.&#34;G42&#34;&#62; &#60;&#62; NULL then&#13;&#10;        vRestG42 := &#60;IN_COMM_2.&#34;G42&#34;&#62; - dSumRelAtPeriodG42          &#13;&#10;      else&#13;&#10;        if &#60;KRD_COMM_2.&#34;G42&#34;&#62; &#60;&#62; NULL then&#13;&#10;          vRestG42 := &#60;KRD_COMM_2.&#34;G42&#34;&#62; - dSumRelAtPeriodG42&#13;&#10;        else                    &#13;&#10;          vRestG42 := 0;&#13;&#10;      COMPUTE('SETFILTER(&#34;IN_COMM_2&#34;, &#34;&#34;)');            &#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      if &#60;KRD_COMM_2.&#34;G35&#34;&#62; &#60;&#62; NULL then&#13;&#10;        vRestG35 := &#60;KRD_COMM_2.&#34;G35&#34;&#62; - dSumRelAtPeriodG35&#13;&#10;      else&#13;&#10;          vRestG35 := 0;&#13;&#10;      if &#60;KRD_COMM_2.&#34;G42&#34;&#62; &#60;&#62; NULL then&#13;&#10;        vRestG42 := &#60;KRD_COMM_2.&#34;G42&#34;&#62; - dSumRelAtPeriodG42&#13;&#10;      else&#13;&#10;        vRestG42 := 0;        &#13;&#10;    end;              &#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;&#34;)');&#13;&#10;    vFilterCrit := 'PLACEID=' + IntToStr(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + ' AND ID=' + IntToStr(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + ' AND G32=' + IntToStr(&#60;KRD_COMM_2.&#34;G32&#34;&#62;);&#13;&#10;    COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;&#13;&#10;    COMPUTE('FIRST(&#34;REL_COMM_2&#34;)');&#13;&#10;    while COMPUTE('EOF(&#34;REL_COMM_2&#34;)') = '0' do begin&#13;&#10;      if COMPUTE('FINDKEY(&#34;REL_MAIN_2&#34;, [&#34;' + IntToStr(&#60;REL_COMM_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;REL_COMM_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;REL_COMM_2.&#34;COUNTER&#34;&#62;) + '&#34;])') &#60;&#62; '0' then begin&#13;&#10;        if (&#60;REL_MAIN_2.&#34;OUT_DATE&#34;&#62; &#60;&#62; NULL) and (&#60;REL_MAIN_2.&#34;OUT_DATE&#34;&#62; &#60;= dtSvidetEnd) then begin&#13;&#10;          //Ñ÷èòàåì ñóììû&#13;&#10;          dSumRelAtPeriodG42 := dSumRelAtPeriodG42 + IIF(&#60;REL_COMM_2.&#34;RELEASE_G42&#34;&#62;&#60;&#62;Null, &#60;REL_COMM_2.&#34;RELEASE_G42&#34;&#62;, 0);&#13;&#10;          dSumRelAtPeriodG35 := dSumRelAtPeriodG35 + IIF(&#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;&#60;&#62;Null, &#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;, 0);&#13;&#10;        end;&#13;&#10;      end;&#13;&#10;      COMPUTE('NEXT(&#34;REL_COMM_2&#34;)');&#13;&#10;    end;&#13;&#10;    COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;&#34;)');&#13;&#10;&#13;&#10;    if &#60;KRD_COMM_2.&#34;FACT_G35&#34;&#62; &#60;&#62; NULL then&#13;&#10;      vRestG35 := &#60;KRD_COMM_2.&#34;FACT_G35&#34;&#62; - dSumRelAtPeriodG35&#13;&#10;    else&#13;&#10;      if &#60;KRD_COMM_2.&#34;G35&#34;&#62; &#60;&#62; NULL then&#13;&#10;        vRestG35 := &#60;KRD_COMM_2.&#34;G35&#34;&#62; - dSumRelAtPeriodG35&#13;&#10;      else&#13;&#10;        vRestG35 := 0;&#13;&#10;    if &#60;KRD_COMM_2.&#34;FACT_G42&#34;&#62; &#60;&#62; NULL then&#13;&#10;      vRestG42 := &#60;KRD_COMM_2.&#34;FACT_G42&#34;&#62; - dSumRelAtPeriodG42&#13;&#10;    else&#13;&#10;      if &#60;KRD_COMM_2.&#34;G42&#34;&#62; &#60;&#62; NULL then&#13;&#10;        vRestG42 := &#60;KRD_COMM_2.&#34;G42&#34;&#62; - dSumRelAtPeriodG42&#13;&#10;      else&#13;&#10;        vRestG42 := 0;  &#13;&#10;  end;&#13;&#10;    &#13;&#10;  if vRestG35 &#60; 0.000001 then vRestG35 := 0;&#13;&#10;  sRestG35 := FORMATFLOAT('0.######', vRestG35);&#13;&#10;  sRestG42 := FORMATFLOAT('0.##', vRestG42);&#13;&#10;  If sRestG42 = '0' then sRestG42 := '';      &#13;&#10;      &#13;&#10;  if vRestG35 &#62; 0 then&#13;&#10;    DetailData1.Visible := True&#13;&#10;  else&#13;&#10;    DetailData1.Visible := False;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ReportSummary1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with ReportSummary1, Engine do&#13;&#10;  begin&#13;&#10;  IF Engine.FINALPASS then&#13;&#10;    begin&#13;&#10;      //COMPUTE('SETFILTER(&#34;KRD_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;      COMPUTE('CANCELRANGE(&#34;STORES_2&#34;)');&#13;&#10;      COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');&#13;&#10;      If AistCompatible = 0 then&#13;&#10;        COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;&#34;)')&#13;&#10;      else   COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;&#34;)');&#13;&#10;      COMPUTE('SETFILTER(&#34;KRD_PAPERS_2&#34;, &#34;&#34;)');&#13;&#10;      COMPUTE('SETFILTER(&#34;KRD_COMM_PAPERS_2&#34;, &#34;&#34;)');&#13;&#10;    end&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo20OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo20, Engine do&#13;&#10;  begin&#13;&#10;begin&#13;&#10;  if Engine.FINALPASS then&#13;&#10;    vLine := vLine + 1&#13;&#10;end&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo27OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;      vPapers := '';&#13;&#10;&#13;&#10;      COMPUTE('SETFILTER(&#34;KRD_COMM_PAPERS_2&#34;, &#34;&#34;)');&#13;&#10;      vFilterCrit := 'PLACEID=' + CHR(39) + VarToSTR(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + CHR(39) +&#13;&#10;                 ' AND ID=' + CHR(39) + VarToSTR(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + CHR(39) +&#13;&#10;                 ' AND G32=' + CHR(39) + VarToSTR(&#60;KRD_COMM_2.&#34;G32&#34;&#62;) + CHR(39) +&#13;&#10;                 ' AND DOC_TYPE=' + CHR(39) + '13' + CHR(39);&#13;&#10;      COMPUTE('SETFILTER(&#34;KRD_COMM_PAPERS_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;&#13;&#10;      if COMPUTE('RECORDCOUNT(&#34;KRD_COMM_PAPERS_2&#34;)') &#60;&#62; '0' then&#13;&#10;        begin&#13;&#10;          COMPUTE('FIRST(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;          while COMPUTE('EOF(&#34;KRD_COMM_PAPERS_2&#34;)')='0' do&#13;&#10;            begin&#13;&#10;              COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;              COMPUTE('SETRANGE(&#34;KRD_PAPERS_2&#34;, [&#34;' + VARTOSTR(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;KRD_COMM_PAPERS_2.&#34;DOC_COUNTER&#34;&#62;) + '&#34;])');&#13;&#10;              If  ((Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;) + '|', sPaperCodes) = 0) or&#13;&#10;                  (Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62;) + '|', sPaperNames) = 0))  then&#13;&#10;                COMPUTE('NEXT(&#34;KRD_COMM_PAPERS_2&#34;)')&#13;&#10;              else&#13;&#10;              begin                          &#13;&#10;                if vPapers = &#34;&#34; then&#13;&#10;                  if &#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62; &#60;&#62; NULL then&#13;&#10;                     vPapers := &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; ¹ &#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;) + &#34; îò &#34; +  DATETOSTR(&#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)&#13;&#10;                  else  vPapers := &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; ¹ &#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;)&#13;&#10;                else&#13;&#10;                  if &#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62; &#60;&#62; NULL then&#13;&#10;                       vPapers := vPapers + ', ' + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; ¹&#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;) + &#34; îò &#34; +  DATETOSTR(&#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)&#13;&#10;                  else vPapers := vPapers + ', ' + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; ¹&#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;);  &#13;&#10;                COMPUTE('NEXT(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;              end                            &#13;&#10;            end&#13;&#10;        end&#13;&#10;      else&#13;&#10;        begin&#13;&#10;          COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;          COMPUTE('SETRANGE(&#34;KRD_PAPERS_2&#34;, [&#34;' + VARTOSTR(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + '&#34;])');&#13;&#10;          COMPUTE('FIRST(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;          while COMPUTE('EOF(&#34;KRD_PAPERS_2&#34;)') = '0' do&#13;&#10;            begin&#13;&#10;              If  ((Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERCODE&#34;&#62;) + '|', sPaperCodes) = 0) or&#13;&#10;                  (Pos('|' + Trim(&#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62;) + '|', sPaperNames) = 0))  then&#13;&#10;                COMPUTE('NEXT(&#34;KRD_PAPERS_2&#34;)')&#13;&#10;              else&#13;&#10;              begin  &#13;&#10;                if vPapers = &#34;&#34; then&#13;&#10;                  if &#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62; &#60;&#62; NULL then&#13;&#10;                     vPapers := &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; ¹ &#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;) + &#34; îò &#34; +  DATETOSTR(&#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)&#13;&#10;                  else  vPapers := &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; ¹ &#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;)&#13;&#10;                else&#13;&#10;                  if &#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62; &#60;&#62; NULL then&#13;&#10;                       vPapers := vPapers + ', ' + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; ¹&#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;) + &#34; îò &#34; +  DATETOSTR(&#60;KRD_PAPERS_2.&#34;PAPERDATE&#34;&#62;)&#13;&#10;                  else vPapers := vPapers + ', ' + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; ¹&#34; + VARTOSTR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;);&#13;&#10;                COMPUTE('NEXT(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;              end                        &#13;&#10;            end;    &#13;&#10;          COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;        end;  &#13;&#10;        COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');            &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo4OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  reportPeriod:= &#60;STORES_2.&#34;LICENCENO&#34;&#62;+' c '+ DateToSTR(&#60;STORES_2.&#34;LICENCEDATE&#34;&#62;) +&#13;&#10;   ' ïî ' + FORMATDATETIME(&#34;DD.MM.YYYY&#34;, dtSvidetEnd);&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  COMPUTE('OPENQUERY(&#34;QRYREFPAPERS&#34;, &#34;STS_DB&#34;, &#34;SELECT PAPER_DOCG44_CODE, PAPERNAME ' + &#13;&#10;                                               'FROM PAPERS ' + &#13;&#10;                                               'WHERE PAPER_IS_WAYBILL = 1&#34;)');&#13;&#10;  sPaperNames := '|' + COMPUTE('JOINVALUES(&#34;QRYREFPAPERS&#34;, &#34;|&#34;, [&#34;PAPERNAME&#34;])') + '|';&#13;&#10;  sPaperCodes := '|' + COMPUTE('JOINVALUES(&#34;QRYREFPAPERS&#34;, &#34;|&#34;, [&#34;PAPER_DOCG44_CODE&#34;])') + '|';&#13;&#10;  COMPUTE('CLOSEDATASET(&#34;QRYREFPAPERS&#34;)');  &#13;&#10;end." OnStartReport="OnStartReport" PropData="08446174617365747301010C2F00000020446174615365743D2264735F494E5F434F4D4D5F322220446174615365744E616D653D22494E5F434F4D4D5F322200010C3100000020446174615365743D2264735F4B52445F434F4D4D5F322220446174615365744E616D653D224B52445F434F4D4D5F322200010C3F00000020446174615365743D2264735F4B52445F434F4D4D5F5041504552535F322220446174615365744E616D653D224B52445F434F4D4D5F5041504552535F322200010C3500000020446174615365743D2264735F4B52445F5041504552535F322220446174615365744E616D653D224B52445F5041504552535F322200010C3100000020446174615365743D2264735F4F55545F434F4D4D5F322220446174615365744E616D653D224F55545F434F4D4D5F322200010C3100000020446174615365743D2264735F4F55545F4D41494E5F322220446174615365744E616D653D224F55545F4D41494E5F322200010C2800000020446174615365743D227172794D61696E2220446174615365744E616D653D227172794D61696E2200010C3100000020446174615365743D2264735F52454C5F434F4D4D5F322220446174615365744E616D653D2252454C5F434F4D4D5F322200010C3100000020446174615365743D2264735F52454C5F4D41494E5F322220446174615365744E616D653D2252454C5F4D41494E5F322200010C2D00000020446174615365743D2264735F53544F5245535F322220446174615365744E616D653D2253544F5245535F32220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxBDEQuery Name="qryMain" UserName="qryMain" CloseDataSource="True" FieldAliases.Text="" IgnoreDupParams="False" SQL.Text="SELECT * FROM STORES                            " DatabaseName="STS_DB" SessionName="Default" PropData="05704C65667402240470546F70024C0A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="Page1" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Ïàðàìåòðû îò÷åòà" Height="205" Left="468" Top="206" Width="312" OnActivate="Page1OnBeforePrint">
    <TfrxColorFrameControl Name="ColorFrame2" Left="1" Top="112" Width="300" Height="32" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" BorderWidth="1" FormCaption="False" RectCaption="False" Color="-16777201"/>
    <TfrxColorFrameControl Name="ColorFrame1" Left="1" Top="56" Width="300" Height="56" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" BorderWidth="1" FormCaption="False" RectCaption="False" Color="-16777201"/>
    <TfrxColorEditControl Name="fldStoreLic" Left="88" Top="4" Width="121" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" ReadOnly="True" Text="Edit"/>
    <TfrxColorEditControl Name="fldStoreNm" Left="72" Top="28" Width="229" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" ReadOnly="True" Text="Edit"/>
    <TfrxColorEditControl Name="fldLicExt" Left="72" Top="4" Width="17" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" ReadOnly="True" Text="Edit"/>
    <TfrxColorEditControl Name="fldStoreNum" Left="211" Top="4" Width="90" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" ReadOnly="True" Text="Edit"/>
    <TfrxLabelControl Name="lblNumLicence" Left="4" Top="7" Width="65" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="¹ ëèöåíçèè:" Color="-16777201"/>
    <TfrxLabelControl Name="Label1" Left="16" Top="31" Width="53" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="Íàçâàíèå:" Color="-16777201"/>
    <TfrxColorButtonControl Name="ColorButton1" Left="177" Top="5" Width="31" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777216" Flat="False" GradientType="gtTopToBottom" OnClick="ColorButton1OnBeforePrint"/>
    <TfrxColorButtonControl Name="cbtnOk" Left="142" Top="148" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" Caption="Ïðîñìîòð" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="1" OnClick="cbtnOkOnBeforePrint"/>
    <TfrxColorButtonControl Name="ColorButton2" Left="222" Top="148" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Îòìåíà" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="2"/>
    <TfrxLabelControl Name="Label2" Left="14" Top="64" Width="134" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="Äàòà èñêëþ÷åíèÿ" Color="-16777201"/>
    <TfrxLabelControl Name="Label3" Left="14" Top="76" Width="134" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="ñêëàäà èç ðååñòðà" Color="-16777201"/>
    <TfrxDateEditControl Name="dtSvidEnd" Left="157" Top="72" Width="133" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Microsoft Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38262" DateFormat="dfLong" Time="38262"/>
    <TfrxLabelControl Name="Label4" Left="14" Top="88" Width="134" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="âëàäåëüöåâ ÑÂÕ:" Color="-16777201"/>
    <TfrxCheckBoxControl Name="chkArchive" Left="12" Top="120" Width="281" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Âêëþ÷àòü àðõèâ" Color="-16777201"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page2" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="7" RightMargin="7" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False">
    <TfrxReportTitle Name="ReportTitle1" Height="46" Left="0" Top="18.89765" Width="1069.60699" Child="Child1" PrintChildIfInvisible="True" Stretched="True">
      <TfrxMemoView Name="Memo1" Left="218" Top="4" Width="588" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="ÐžÑ‚Ñ‡ÐµÑ‚ Ð¾ Ñ‚Ð¾Ð²Ð°Ñ€Ð°Ñ…, Ñ…Ñ€Ð°Ð½ÑÑ‰Ð¸Ñ…ÑÑ Ð½Ð° ÑÐºÐ»Ð°Ð´Ðµ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð³Ð¾ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ"/>
      <TfrxMemoView Name="fldStoreName" Left="134" Top="28" Width="252" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="5" ParentFont="False" Text="[STORES_2.&#34;NAME&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="674" Top="24.22047" Width="308" Height="18" OnBeforePrint="Memo4OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="7" ParentFont="False" Text="[reportPeriod]"/>
      <TfrxMemoView Name="Memo2" Left="21" Top="28" Width="112" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÑÐºÐ»Ð°Ð´Ð°:"/>
      <TfrxMemoView Name="Memo5" Left="413" Top="28" Width="260" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="ÐÐ¾Ð¼ÐµÑ€ ÑÐ²Ð¸Ð´ÐµÑ‚ÐµÐ»ÑŒÑÑ‚Ð²Ð° Ð¸ Ð¿ÐµÑ€Ð¸Ð¾Ð´ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ:"/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter1" Height="30" Left="0" Top="453.5436" Width="1069.60699">
      <TfrxLineView Name="Line2" Left="5" Top="4.00000000000006" Width="1008" Height="0" ShowHint="False" Frame.Typ="4" Frame.Width="2"/>
      <TfrxMemoView Name="Memo32" Left="309" Top="8.00000000000006" Width="704" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="Ð’Ð­Ð”-Ð¡ÐºÐ»Ð°Ð´  Copyright (C)  ÐžÐžÐž &#34;Ð¡Ð¢Ðœ&#34;,1996-[FORMATDATETIME(&#34;YYYY&#34;, DATE)].            Internet: www.ctm.ru"/>
      <TfrxMemoView Name="Memo33" Left="9" Top="8.00000000000006" Width="220" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" ParentFont="False" VAlign="vaCenter" Text="[TIME] [DATE]"/>
    </TfrxPageFooter>
    <TfrxPageHeader Name="PageHeader1" Height="112" Left="0" Top="128.50402" Width="1069.60699" Stretched="True">
      <TfrxMemoView Name="Memo25" Left="9" Top="28" Width="28" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="â„– Ð¿/Ð¿"/>
      <TfrxMemoView Name="Memo26" Left="685" Top="28" Width="100" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐšÐ¾Ð´ Ð¿Ð¾ Ð¢Ð Ð’Ð­Ð” Ð¢Ð¡ (Ð¿ÐµÑ€Ð²Ñ‹Ðµ 4 Ð·Ð½Ð°ÐºÐ°) Ð² ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ð¸ Ñ Ð¢Ð Ð’Ð­Ð” Ð¢Ð¡"/>
      <TfrxMemoView Name="Memo28" Left="461" Top="28" Width="76" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð’ÐµÑ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð±Ñ€ÑƒÑ‚Ñ‚Ð¾ (Ð² ÐºÐ³)"/>
      <TfrxMemoView Name="Memo29" Left="785" Top="28" Width="76" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð”Ð°Ñ‚Ð° Ð¿Ð¾Ð¼ÐµÑ‰ÐµÐ½Ð¸Ñ Ð½Ð° ÑÐºÐ»Ð°Ð´"/>
      <TfrxMemoView Name="Memo35" Left="861" Top="28" Width="148" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐžÑÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð½Ð°Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð½Ð° ÑÐºÐ»Ð°Ð´Ðµ"/>
      <TfrxMemoView Name="Memo6" Left="537" Top="28" Width="148" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð¤Ð°ÐºÑ‚ÑƒÑ€Ð½Ð°Ñ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð² Ð²Ð°Ð»ÑŽÑ‚Ðµ, ÑƒÐºÐ°Ð·Ð°Ð½Ð¾Ð¹ Ð² Ñ‚Ñ€Ð°Ð½ÑÐ¿Ð¾Ñ€Ñ‚Ð½Ñ‹Ñ… Ð¸Ð»Ð¸ ÐºÐ¾Ð¼Ð¼ÐµÑ€Ñ‡ÐµÑÐºÐ¸Ñ… Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ…"/>
      <TfrxMemoView Name="Memo8" Left="37" Top="28" Width="140" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ñ‚ÐµÐ»Ñ"/>
      <TfrxMemoView Name="Memo9" Left="9" Top="94" Width="28" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="1"/>
      <TfrxMemoView Name="Memo10" Left="37" Top="94" Width="140" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="2"/>
      <TfrxMemoView Name="Memo11" Left="177" Top="28" Width="140" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð°"/>
      <TfrxMemoView Name="Memo12" Left="317" Top="28" Width="144" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð’Ð¸Ð´, Ð´Ð°Ñ‚Ð° Ð¸ Ð½Ð¾Ð¼ÐµÑ€ Ñ‚Ñ€Ð°Ð½ÑÐ¿Ð¾Ñ€Ñ‚Ð½Ð¾Ð³Ð¾ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°"/>
      <TfrxMemoView Name="Memo13" Left="177" Top="94" Width="140" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="3"/>
      <TfrxMemoView Name="Memo14" Left="317" Top="94" Width="144" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="4"/>
      <TfrxMemoView Name="Memo15" Left="461" Top="94" Width="76" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="5"/>
      <TfrxMemoView Name="Memo16" Left="537" Top="94" Width="148" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="6"/>
      <TfrxMemoView Name="Memo17" Left="685" Top="94" Width="100" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="7"/>
      <TfrxMemoView Name="Memo18" Left="785" Top="94" Width="76" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="8"/>
      <TfrxMemoView Name="Memo19" Left="861" Top="94" Width="148" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="9"/>
      <TfrxLineView Name="Line1" Left="5" Top="24" Width="1008" Height="0" ShowHint="False" Frame.Typ="4" Frame.Width="2"/>
      <TfrxMemoView Name="Memo31" Left="777" Top="4" Width="236" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="3" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° [PAGE#]"/>
    </TfrxPageHeader>
    <TfrxMasterData Name="MasterData1" Height="18" Left="0" Top="302.3624" Visible="False" Width="1069.60699" OnBeforePrint="MasterData1OnBeforePrint" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="qryMain" DataSetName="qryMain" PrintChildIfInvisible="True" PrintIfDetailEmpty="True" RowCount="0" Stretched="True"/>
    <TfrxChild Name="Child1" Height="18" Left="0" Top="86.92919" Width="1069.60699" Stretched="True">
      <TfrxMemoView Name="Memo3" Left="170" Top="0" Width="698.67718" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="Ð½Ð° Ð¼Ð¾Ð¼ÐµÐ½Ñ‚ ÐµÐ³Ð¾ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð¸Ð· Ð ÐµÐµÑÑ‚Ñ€Ð° Ð²Ð»Ð°Ð´ÐµÐ»ÑŒÑ†ÐµÐ² ÑÐºÐ»Ð°Ð´Ð¾Ð² Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð³Ð¾ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ."/>
    </TfrxChild>
    <TfrxDetailData Name="DetailData1" Height="18" Left="0" Top="343.93723" Width="1069.60699" OnBeforePrint="DetailData1OnBeforePrint" AllowSplit="True" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="ds_KRD_COMM_2" DataSetName="KRD_COMM_2" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo20" Left="9" Top="0" Width="28" Height="18" OnBeforePrint="Memo20OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vLine]"/>
      <TfrxMemoView Name="Memo21" Left="685" Top="0" Width="100" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[COPY(&#60;KRD_COMM_2.&#34;G33&#34;&#62;, 1, 4)]"/>
      <TfrxMemoView Name="Memo22" Left="537" Top="0" Width="148" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[sRestG42]"/>
      <TfrxMemoView Name="Memo23" Left="785" Top="0" Width="76" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[IIF(DATEtoSTR(&#60;KRD_COMM_2.&#34;ACCEPTDATE&#34;&#62;)&#60;&#62;'..', FORMATDATETIME(&#34;DD.MM.YYYY&#34;, &#60;KRD_COMM_2.&#34;ACCEPTDATE&#34;&#62;), FORMATDATETIME(&#34;DD.MM.YYYY&#34;, &#60;QRYMAIN.&#34;BEG_KEEP&#34;&#62;))]"/>
      <TfrxMemoView Name="Memo24" Left="861" Top="0" Width="148" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[qryMAIN.&#34;NBD&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="461" Top="0" Width="76" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[sRestG35]"/>
      <TfrxMemoView Name="Memo27" Left="317" Top="0" Width="144" Height="18" OnBeforePrint="Memo27OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vPapers]"/>
      <TfrxMemoView Name="Memo30" Left="177" Top="0" Width="140" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[KRD_COMM_2.&#34;G312&#34;]"/>
      <TfrxMemoView Name="Memo38" Left="37" Top="0" Width="140" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[IIF(&#60;qryMAIN.&#34;G011&#34;&#62;='Ð˜Ðœ', &#60;qryMAIN.&#34;G082&#34;&#62;, &#60;qryMAIN.&#34;G042&#34;&#62;)]"/>
    </TfrxDetailData>
    <TfrxReportSummary Name="ReportSummary1" Height="6" Left="0" Top="423.30736" Width="1069.60699" OnBeforePrint="ReportSummary1OnBeforePrint"/>
  </TfrxReportPage>
</TfrxReport>
