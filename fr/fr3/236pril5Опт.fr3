<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.6.78" DotMatrixReport="False" EngineOptions.ConvertNulls="False" EngineOptions.DoublePass="True" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38262.5335351505" ReportOptions.Description.Text="" ReportOptions.Name="Отчёт владельца там. склада о товарах с истекающим сроком хранения (Пр. №236 прил.5)" ReportOptions.LastChange="40387.6899098495" ScriptLanguage="PascalScript" ScriptText.Text="VAR&#13;&#10;   vSum, vG35 : Double;&#13;&#10;   PeriodInDays, CustomDocsOnly,StoreDocsBlock,  AistCompatible,&#13;&#10;   isVes, NumLine  : Integer;&#13;&#10;   vChief, ondate, vOwner, vPlaceid, sqltext: String;&#13;&#10;   vLicenceDate : Variant;&#13;&#10;   dtPeriodEnd, dtPeriodStart, dtData : TDateTime;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin   &#13;&#10;  with MasterData1, Engine do&#13;&#10;  begin&#13;&#10;      vSum := 0 ;&#13;&#10;           //showmessage(StrToDate(&#60;tblMain.&#34;Storage_date&#34;&#62;));          &#13;&#10;      COMPUTE('CANCELRANGE(&#34;IN_COMM_2&#34;)');  &#13;&#10;      COMPUTE('SETRANGE(&#34;IN_COMM_2&#34;, [&#34;' + VARTOSTR(vPlaceId) + '&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;id&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;g32&#34;&#62;) + '&#34;])');          &#13;&#10;      if (&#60;IN_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) and (&#60;IN_COMM_2.&#34;G315A&#34;&#62;&#60;&#62;0) then        &#13;&#10;        isVes :=0        &#13;&#10;      else              &#13;&#10;      if (&#60;tblMain.&#34;G315A&#34;&#62; &#60;&#62; 0) and (&#60;tblMain.&#34;G315A&#34;&#62;&#60;&#62;0) then&#13;&#10;          isVes :=0&#13;&#10;      else isVes :=1;&#13;&#10;           &#13;&#10;            COMPUTE('SETRANGE(&#34;OUT_COMM_2&#34;, [&#34;' + VARTOSTR(vPlaceId) + '&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;id&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;g32&#34;&#62;) + '&#34;])');&#13;&#10;            if (&#60;OUT_COMM_2.&#34;PLACEID&#34;&#62; &#60;&#62; 0)  then begin                                     &#13;&#10;             COMPUTE('FIRST(&#34;OUT_COMM_2&#34;)');&#13;&#10;             while COMPUTE('EOF(&#34;OUT_COMM_2&#34;)') = '0' do                                     &#13;&#10;               begin&#13;&#10;               if IsVes = 0 then&#13;&#10;                 vSum := vSum + &#60;OUT_COMM_2.&#34;OUT_G315A&#34;&#62;&#13;&#10;                 else     vSum := vSum + &#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;;&#13;&#10;                 COMPUTE('NEXT(&#34;OUT_COMM_2&#34;)')                     &#13;&#10;               end;&#13;&#10;                                 &#13;&#10;             end                     &#13;&#10;             else        &#13;&#10;             //Сначала снимем предыдущий фильтр&#13;&#10;             if COMPUTE('FINDKEY(&#34;REL_COMM_2&#34;, [&#34;' + VARTOSTR(vPlaceid) + '&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;id&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;g32&#34;&#62;) + '&#34;])') then&#13;&#10;              begin&#13;&#10;&#13;&#10;               COMPUTE('CANCELRANGE(&#34;REL_COMM_2&#34;)');&#13;&#10;             //Поставим новый фильтр для текущего товара&#13;&#10;               COMPUTE('SETRANGE(&#34;REL_COMM_2&#34;, [&#34;' + VARTOSTR(vPlaceId) + '&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;id&#34;&#62;) + '&#34;, &#34;' + VARTOSTR(&#60;tblMain.&#34;g32&#34;&#62;) + '&#34;])');&#13;&#10;&#13;&#10;            //Пройдем цикл по выпускам&#13;&#10;             //Товары, чтобы посмотреть вес&#13;&#10;            //======================================&#13;&#10;               COMPUTE('FIRST(&#34;REL_COMM_2&#34;)');&#13;&#10;               while COMPUTE('EOF(&#34;REL_COMM_2&#34;)') = '0' do&#13;&#10;                begin&#13;&#10;                 if IsVes = 0 then&#13;&#10;                 vSum := vSum + &#60;REL_COMM_2.&#34;RELEASE_G315A&#34;&#62;&#13;&#10;                 else     vSum := vSum + &#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;;&#13;&#10;               COMPUTE('NEXT(&#34;REL_COMM_2&#34;)')&#13;&#10;                end&#13;&#10;              end;&#13;&#10;      COMPUTE('CANCELRANGE(&#34;REL_COMM_2&#34;)');&#13;&#10;      COMPUTE('CANCELRANGE(&#34;OUT_COMM_2&#34;)');&#13;&#10;        &#13;&#10;          &#13;&#10;        &#13;&#10;      if IsVes = 0 then begin             &#13;&#10;        If (&#60;tblMain.&#34;Storage_date&#34;&#62; &#60;&#62; 0) then begin&#13;&#10;        showmessage((&#60;tblMain.&#34;G315A&#34;&#62;- vSum));                                      &#13;&#10;           If (dtPeriodEnd &#60;= StrToDate(&#60;tblMain.&#34;Storage_date&#34;&#62;)) and ((&#60;tblMain.&#34;G315A&#34;&#62; - vSum) &#60;= 0)  then                                 &#13;&#10;           Visible := False    &#13;&#10;           else   Visible := true;&#13;&#10;           end                   &#13;&#10;        else begin          &#13;&#10;           If (dtPeriodEnd &#60;= StrToDate(&#60;krd_main.&#34;beg_keep&#34;&#62; + &#60;krd_comm.&#34;store_period&#34;&#62;)) and ((&#60;tblMain.&#34;G315A&#34;&#62;- vSum) &#60;= 0)  then                                                              &#13;&#10;           Visible := False    &#13;&#10;           else   Visible := true;          &#13;&#10;           end;              &#13;&#10;      end            &#13;&#10;      else begin          &#13;&#10;        If (&#60;tblMain.&#34;Storage_date&#34;&#62; &#60;&#62; 0) then begin                                                       &#13;&#10;           If (dtPeriodEnd &#60;= StrToDate( &#60;tblMain.&#34;Storage_date&#34;&#62;)) and ((&#60;tblMain.&#34;G35&#34;&#62;- vSum) &#60;= 0)  then                                 &#13;&#10;           Visible := False    &#13;&#10;           else   Visible := true;&#13;&#10;        end                     &#13;&#10;        else begin          &#13;&#10;           If (dtPeriodEnd &#60;= StrToDate(&#60;krd_main.&#34;beg_keep&#34;&#62; + &#60;krd_comm.&#34;store_period&#34;&#62;)) and ((&#60;tblMain.&#34;G35&#34;&#62;- vSum) &#60;= 0)  then                                                              &#13;&#10;           Visible := False    &#13;&#10;           else   Visible := true;&#13;&#10;        end;                     &#13;&#10;      end;        &#13;&#10;  end;  &#13;&#10;&#13;&#10;COMPUTE('CANCELRANGE(&#34;IN_COMM_2&#34;)');  &#13;&#10;end;&#13;&#10;  &#13;&#10;&#13;&#10;procedure Memo32OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo32, Engine do&#13;&#10;  begin&#13;&#10;     if FINALPASS = True then&#13;&#10;       begin&#13;&#10;         NumLine := NumLine + 1;&#13;&#10;       end&#13;&#10;     else&#13;&#10;       NumLine := 0&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo68OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo68, Engine do&#13;&#10;  begin&#13;&#10;&#13;&#10;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo70OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo70, Engine do&#13;&#10;  begin&#13;&#10;vOwner:='';&#13;&#10;     if &#60;tblMain.&#34;G011&#34;&#62; = 'ИМ'  then&#13;&#10;        vOwner := &#60;tblMain.&#34;G082&#34;&#62;&#13;&#10;     else   vOwner := &#60;tblMain.&#34;G022&#34;&#62;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo80OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo80, Engine do&#13;&#10;  begin&#13;&#10;      if IsVes = 0 then&#13;&#10;          vG35:=&#60;tblMain.&#34;G315A&#34;&#62;- vSum&#13;&#10;      else&#13;&#10;          vG35:=&#60;tblMain.&#34;G35&#34;&#62;- vSum&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Page2, Engine do&#13;&#10;  begin&#13;&#10;    fldStoreLicNum.Text := '';&#13;&#10;    fldStoreNum.Text := '';&#13;&#10;    lblStoreName.Caption := '';&#13;&#10;    fldLicExt.Text := '';&#13;&#10;//    dtOnDate.Enabled := False;&#13;&#10;//    dtFrom.Enabled := True;&#13;&#10;//    dtTo.Enabled := True;&#13;&#10;  //  cbxNotInclude.Enabled := True;&#13;&#10;  //  lblPer.Enabled := True;&#13;&#10;  //  rbtnDate.Checked := False;&#13;&#10;  //  rbtnPeriod.Checked := True;&#13;&#10;  //  rbtnPeriod.Enabled := True;&#13;&#10;    cbtnOk.Enabled := False;&#13;&#10;&#13;&#10;    ondate:=COMPUTE('INIFILE(&#34;Print&#34;,&#34;PrintOnDate&#34;,&#34;&#34;)');&#13;&#10;//    datestart:=COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;&#34;)');&#13;&#10;//    dateend := COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;&#34;)');&#13;&#10;    dtOnDate.Date := STRTODATEDEF(ondate, DATE);&#13;&#10;//    dtFrom.Date := [STRTODATEDEF(datestart, DATE)];&#13;&#10;//    dtTo.Date := [STRTODATEDEF(dateend, DATE)];&#13;&#10;&#13;&#10;    vPlaceId:=COMPUTE('INIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;&#34;)');&#13;&#10;    edtPeriod.Text := COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodInDays&#34;,&#34;20&#34;)');&#13;&#10;&#13;&#10;    If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + VARTOSTR(vPlaceId) + '&#34;])') then&#13;&#10;      Begin&#13;&#10;         fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;         fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;         lblStoreName.Caption := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;         fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;         cbtnOk.Enabled := True;&#13;&#10;      end&#13;&#10;    else begin&#13;&#10;            vPlaceId:=COMPUTE('INIFILE(&#34;WorkPlace&#34;,&#34;PlaceNum&#34;,&#34;&#34;)');&#13;&#10;            If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + VARTOSTR(vPlaceId) + '&#34;])') then&#13;&#10;               begin&#13;&#10;                 fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;                 fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;                 lblStoreName.Caption := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;                 fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;                 cbtnOk.Enabled := True;&#13;&#10;               end&#13;&#10;            else cbtnOk.Enabled := False&#13;&#10;        end;&#13;&#10;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure btnCallRefOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with btnCallRef, Engine do&#13;&#10;  begin&#13;&#10;COMPUTE(' globalvar (&#34;strStoreNumLic&#34;,String)');&#13;&#10;COMPUTE(' globalvar (&#34;strStoreNum&#34;,String)');&#13;&#10;COMPUTE(' globalvar (&#34;strStoreName&#34;,String)');&#13;&#10;COMPUTE(' globalvar (&#34;strLicExt&#34;,String)');&#13;&#10;COMPUTE(' globalvar (&#34;sChief&#34;,String)');&#13;&#10;COMPUTE(' globalvar (&#34;sPlaceId&#34;,Integer)');&#13;&#10;COMPUTE(' globalvar (&#34;sLicenceDate&#34;,DateTime)');&#13;&#10;COMPUTE('OPENQUERY (&#34;Stors&#34;, &#34;STS_DB&#34;, &#34;Select * from STORES&#34;)');&#13;&#10;&#13;&#10;&#13;&#10;COMPUTE('SelectValues (&#34;Список складов&#34;, &#34;Stors&#34;,'+&#13;&#10;                                                '['+&#13;&#10;                                                 '[&#34;LICENCENO&#34;,   &#34;Номер лицензии&#34;, 15],'+&#13;&#10;                                                 '[&#34;LICENCENO_EXT&#34;,   &#34; &#34;, 1],'+&#13;&#10;                                                 '[&#34;STORE_NO&#34;,   &#34;Номер склада&#34;, 15],'+&#13;&#10;                                                 '[&#34;NAME&#34;,   &#34;Название склада&#34;, 30],'+&#13;&#10;                                                 '[&#34;PlaceId&#34;,   &#34;&#34;, 10]'+&#13;&#10;                                                '],'+&#13;&#10;                                                '[ [&#34;LICENCENO&#34;, &#34;strStoreNumLic&#34;],'+&#13;&#10;                                                 ' [&#34;STORE_NO&#34;, &#34;strStoreNum&#34;],'+&#13;&#10;                                                  '[&#34;NAME&#34;, &#34;strStoreName&#34;],'+&#13;&#10;                                                  '[&#34;LICENCENO_EXT&#34;, &#34;strLicExt&#34;],'+&#13;&#10;                                                  '[&#34;Chief&#34;, &#34;sChief&#34;],'+&#13;&#10;                                                  '[&#34;PlaceId&#34;, &#34;sPlaceId&#34;],'+&#13;&#10;                                                  '[&#34;LicenceDate&#34;, &#34;sLicenceDate&#34;],'+&#13;&#10;                                                '],'+&#13;&#10;&#13;&#10;               '&#34;&#34;, &#34;STS_DB&#34;)');&#13;&#10;&#13;&#10;fldStoreLicNum.Text := COMPUTE('Value(&#34;strStoreNumLic&#34;)') ;      //   номер лицензии&#13;&#10;fldStoreNum.Text := '№ склада: ' + COMPUTE('value(&#34;strStoreNum&#34;)') ; //   номер склада&#13;&#10;lblStoreName.Caption := COMPUTE('Value(&#34;strStoreName&#34;)') ;     //   название склада&#13;&#10;fldLicExt.Text := COMPUTE('Value(&#34;strLIcExt&#34;)');     //   Признак перерегистрации&#13;&#10;vChief  := COMPUTE('Value(&#34;sChief&#34;)');   // уполномоченный представитель склада&#13;&#10;vPlaceId := COMPUTE('Value(&#34;sPlaceId&#34;)');&#13;&#10;vLicenceDate := COMPUTE('Value(&#34;sLicenceDate&#34;)');&#13;&#10;cbtnOk.Enabled := True&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbtnOkOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with cbtnOk, Engine do&#13;&#10;  begin&#13;&#10;     //Взяли из ini-шника &#34;Только таможенные документы учета&#34;&#13;&#10;     CustomDocsOnly := STRTOINT(COMPUTE('INIFILE(&#34;RegBook&#34;, &#34;CustomsDocsOnly&#34;, 0)'));&#13;&#10;     //Совместимость с аистом&#13;&#10;     AistCompatible := STRTOINT(COMPUTE('INIFILE(&#34;Docs&#34;, &#34;AistCompatible&#34;, 0)'));&#13;&#10;     //Складские документы&#13;&#10;     StoreDocsBlock := StrToInt(COMPUTE('INIFILE(&#34;Database&#34;, &#34;StoreDocsBlock&#34;, 0)'));&#13;&#10;&#13;&#10;&#13;&#10;         PeriodInDays:=StrToIntDef(edtPeriod.Text, 20);&#13;&#10;         If PeriodInDays = 0  then&#13;&#10;            PeriodInDays := 20;&#13;&#10;&#13;&#10;         dtPeriodEnd := Trunc(dtOnDate.Date) + STRTOTIME('23:59:59');&#13;&#10;         dtPeriodStart := Trunc(dtOnDate.Date) - PeriodInDays + STRTOTIME('00:00:00');&#13;&#10;&#13;&#10;&#13;&#10;// включая просроченные товары&#13;&#10;         if chkOverPeriod.Checked = True then&#13;&#10;              sqltext:='SELECT stores.licenceno as licenceno,'+&#13;&#10;                           'stores.placeid as s_placeid,'+&#13;&#10;                           'stores.licencedate as slicencedate,'+&#13;&#10;                           'stores.G142,'+&#13;&#10;                           'stores.CHIEF, '+&#13;&#10;                           'krd_main.*,'+&#13;&#10;                           'krd_comm.*'+&#13;&#10;                    ' FROM (stores '+&#13;&#10;                      'LEFT JOIN krd_main ON (krd_main.placeid = stores.placeid))'+&#13;&#10;                      'LEFT JOIN krd_comm ON (krd_main.placeid = krd_comm.placeid  '+&#13;&#10;                                       ' AND krd_main.id = krd_comm.id)'+&#13;&#10;                    ' WHERE (krd_main.placeid = '+vPlaceId+')'+&#13;&#10;                     ' AND ((krd_main.beg_keep + krd_comm.store_period) &#60;= '+CHR(39)+DATeTOSTR(dtPeriodEnd)+CHR(39)+')'+&#13;&#10;                    ' ORDER BY krd_main.beg_keep, krd_main.Nu, krd_comm.g32'&#13;&#10;          else&#13;&#10;             sqltext:='SELECT stores.licenceno as licenceno,'+&#13;&#10;                          ' stores.placeid as s_placeid,       '+&#13;&#10;                          ' stores.licencedate as slicencedate,  '+&#13;&#10;                          ' stores.G142,'+&#13;&#10;                          ' stores.CHIEF,'+&#13;&#10;                          ' krd_main.*,'+&#13;&#10;                          ' krd_comm.*'+&#13;&#10;                   ' FROM (stores'+&#13;&#10;                     ' LEFT JOIN krd_main ON (krd_main.placeid = stores.placeid))'+&#13;&#10;                     ' LEFT JOIN krd_comm ON (krd_main.placeid = krd_comm.placeid'+&#13;&#10;                                      '  AND krd_main.id = krd_comm.id)'+&#13;&#10;                    ' WHERE (krd_main.placeid = '+vPlaceId+')'+&#13;&#10;                     {' AND ((krd_main.beg_keep + krd_comm.store_period) &#60;= '+CHR(39)+DATETOSTR(dtPeriodEnd) +CHR(39)+') AND ((krd_main.beg_keep + krd_comm.store_period) &#62;= '+CHR(39)+DAteToSTR(dtPeriodStart)+CHR(39)+')'+ }  &#13;&#10;                    ' ORDER BY krd_main.beg_keep, krd_main.Nu, krd_comm.g32';&#13;&#10;&#13;&#10;      {    MESSAGEBOX(sqlText);  }&#13;&#10;     //Активируем главный запрос&#13;&#10;     tblMain.SQL.Clear;&#13;&#10;     tblMain.SQL.Add(sqlText);&#13;&#10;     tblMain.Active:=True;&#13;&#10;&#13;&#10;//======================================      &#13;&#10;    { if Not A = null then&#13;&#10;      filterText := '(krd_main.beg_keep + krd_comm.store_period) &#60;= '+CHR(39)+DATETOSTR(dtPeriodEnd) +CHR(39)+' AND ....'                       &#13;&#10;     else&#13;&#10;      filterText := '2';                                                     &#13;&#10;     tblMain.Filtered := False;  &#13;&#10;     tblMain.Filter := filterText;&#13;&#10;     tblMain.Filtered := True;&#13;&#10;//======================================&#13;&#10;  &#13;&#10;     sss:=[tblMain.RecordCount];&#13;&#10;     MESSAGEBOX(sss);         }&#13;&#10;&#13;&#10; //сохраняем настройки&#13;&#10; Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PrintOnDate&#34;,&#34;'+DATETOSTR(dtOnDate.Date)+'&#34;)');&#13;&#10; Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;'+vPlaceId+'&#34;)');&#13;&#10; COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodInDays&#34;,&#34;'+IntToStr(PeriodInDays)+'&#34;)');&#13;&#10;end&#13;&#10;  end&#13;&#10;;&#13;&#10;&#13;&#10;procedure Memo73OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if (&#60;tblMain.&#34;Storage_date&#34;&#62;) &#60;&#62; 0 then&#13;&#10;   dtData:= &#60;tblMain.&#34;Storage_date&#34;&#62;&#13;&#10;  else dtData:= compute('FORMATDATETIME(&#34;DD.MM.YYYY&#34;, &#60;tblMain.&#34;beg_keep&#34;&#62;+&#60;tblMain.&#34;store_period&#34;&#62;)');                                              &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="OnStartReport" PropData="08446174617365747301010C2F00000020446174615365743D2264735F494E5F434F4D4D5F322220446174615365744E616D653D22494E5F434F4D4D5F322200010C3100000020446174615365743D2264735F4F55545F434F4D4D5F322220446174615365744E616D653D224F55545F434F4D4D5F322200010C3100000020446174615365743D2264735F4F55545F4D41494E5F322220446174615365744E616D653D224F55545F4D41494E5F322200010C3100000020446174615365743D2264735F52454C5F434F4D4D5F322220446174615365744E616D653D2252454C5F434F4D4D5F322200010C2D00000020446174615365743D2264735F53544F5245535F322220446174615365744E616D653D2253544F5245535F322200010C2800000020446174615365743D2274626C4D61696E2220446174615365744E616D653D2274626C4D61696E220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxBDEQuery Name="tblMain" UserName="tblMain" CloseDataSource="True" FieldAliases.Text="" IgnoreDupParams="False" SQL.Text="SELECT stores.licenceno as licenceno, &#13;&#10;       stores.placeid as s_placeid,&#13;&#10;       stores.licencedate as slicencedate,    &#13;&#10;       stores.G142,&#13;&#10;       stores.CHIEF,&#13;&#10;       operhead.*,&#13;&#10;       opercomm.*&#13;&#10;FROM (stores &#13;&#10;  LEFT JOIN operhead ON (operhead.placeid = stores.placeid))&#13;&#10;  LEFT JOIN opercomm ON (operhead.placeid = opercomm.placeid &#13;&#10;                    AND operhead.id = opercomm.id)&#13;&#10;WHERE (operhead.placeid = :P1)&#13;&#10;  AND (((operhead.period_begin &#60;= :P2)  AND (operhead.period_end &#62;= :P2)) OR ((operhead.period_begin &#60;= :P3)  AND (operhead.period_end &#62;= :P3)))&#13;&#10;&#13;&#10;ORDER BY operhead.period_begin, operhead.id, opercomm.g32" DatabaseName="STS_DB" SessionName="Default" PropData="05704C656674023C0470546F7002140A506172616D657465727301010C35000000204E616D653D225031222044617461547970653D226674496E7465676572222045787072657373696F6E3D2276506C61636549642200010C35000000204E616D653D225032222044617461547970653D22667444617465222045787072657373696F6E3D226474506572696F64456E642200010C35000000204E616D653D225032222044617461547970653D22667444617465222045787072657373696F6E3D226474506572696F64456E642200010C37000000204E616D653D225033222044617461547970653D22667444617465222045787072657373696F6E3D226474506572696F6453746172742200010C37000000204E616D653D225033222044617461547970653D22667444617465222045787072657373696F6E3D226474506572696F645374617274220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="7" RightMargin="7" TopMargin="7" BottomMargin="7" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False">
    <TfrxPageFooter Name="PageFooter1" Height="106" Left="0" Top="317.48052" Width="1069.60699">
      <TfrxMemoView Name="Memo28" Left="726" Top="27" Width="161" Height="20" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haCenter" ParentFont="False" Underlines="True" Text="[FORMATDATETIME('DD/MM/YYYY HH:NN', DATE + TIME)]"/>
      <TfrxMemoView Name="Memo96" Left="386" Top="28" Width="284" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Underlines="True" Text=" [tblMain.&#34;chief&#34;]"/>
      <TfrxMemoView Name="Memo98" Left="858" Top="48" Width="164" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Times New Roman" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="РїРµС‡Р°С‚СЊ"/>
      <TfrxMemoView Name="Memo2" Left="738" Top="48" Width="96" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="(РґР°С‚Р°)"/>
      <TfrxMemoView Name="Memo27" Left="442" Top="48" Width="152" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="(РёРЅРёС†РёР°Р»С‹, С„Р°РјРёР»РёСЏ СЂСѓРєРѕРІРѕРґРёС‚РµР»СЏ)"/>
      <TfrxShapeView Name="Shape2" Left="906" Top="12" Width="88" Height="82" ShowHint="False" Frame.Color="536870912" Frame.Style="fsDot" Shape="skEllipse"/>
      <TfrxMemoView Name="Memo4" Left="14" Top="12" Width="172" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="Р’Р»Р°РґРµР»РµС† С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ"/>
      <TfrxMemoView Name="Memo5" Left="98" Top="48" Width="152" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="(РЅР°РёРјРµРЅРѕРІР°РЅРёРµ РѕСЂРіР°РЅРёР·Р°С†РёРё)"/>
      <TfrxMemoView Name="Memo6" Left="14" Top="28" Width="52" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="СЃРєР»Р°РґР°"/>
      <TfrxMemoView Name="Memo7" Left="70" Top="28" Width="304" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Underlines="True" Text=" [tblMain.&#34;G142&#34;]"/>
    </TfrxPageFooter>
    <TfrxPageHeader Name="PageHeader1" Height="158" Left="0" Top="18.89765" Width="1069.60699">
      <TfrxMemoView Name="Memo1" Left="156" Top="16" Width="700" Height="22" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="РћС‚С‡РµС‚ РІР»Р°РґРµР»СЊС†Р° С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ СЃРєР»Р°РґР°"/>
      <TfrxMemoView Name="Memo17" Left="70" Top="36" Width="856" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="Рѕ С‚РѕРІР°СЂР°С…, СЃСЂРѕРє С…СЂР°РЅРµРЅРёСЏ РєРѕС‚РѕСЂС‹С… РІ СЃРѕРѕС‚РІРµС‚СЃС‚РІРёРё СЃ СЂРµР¶РёРјРѕРј С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ СЃРєР»Р°РґР° РёСЃС‚РµРєР°РµС‚"/>
      <TfrxMemoView Name="Memo3" Left="14" Top="74" Width="40" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="N Рї/Рї"/>
      <TfrxMemoView Name="Memo11" Left="54" Top="74" Width="144" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќРѕРјРµСЂ С‚Р°РјРѕР¶РµРЅРЅРѕР№ РґРµРєР»Р°СЂР°С†РёРё"/>
      <TfrxMemoView Name="Memo14" Left="198" Top="74" Width="240" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќР°РёРјРµРЅРѕРІР°РЅРёРµ С‚РѕРІР°СЂР°"/>
      <TfrxMemoView Name="Memo16" Left="816" Top="74" Width="206" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р—Р°РєРѕРЅРЅС‹Р№ РІР»Р°РґРµР»РµС† С‚РѕРІР°СЂР° РёР»Рё Р»РёС†Рѕ, СѓРєР°Р·Р°РЅРЅРѕРµ РІ СЃС‚Р°С‚СЊРµ 16 РўР°РјРѕР¶РµРЅРЅРѕРіРѕ РєРѕРґРµРєСЃР° Р РѕСЃСЃРёР№СЃРєРѕР№ Р¤РµРґРµСЂР°С†РёРё"/>
      <TfrxMemoView Name="Memo22" Left="546" Top="74" Width="108" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ С‚РѕРІР°СЂР° РІ РµРґРёРЅРёС†Р°С… РёР·РјРµСЂРµРЅРёСЏ"/>
      <TfrxMemoView Name="Memo33" Left="14" Top="140" Width="40" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="1."/>
      <TfrxMemoView Name="Memo37" Left="54" Top="140" Width="144" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="2."/>
      <TfrxMemoView Name="Memo40" Left="198" Top="140" Width="240" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="3."/>
      <TfrxMemoView Name="Memo41" Left="816" Top="140" Width="206" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="7."/>
      <TfrxMemoView Name="Memo45" Left="546" Top="140" Width="108" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="5."/>
      <TfrxMemoView Name="Memo69" Left="654" Top="74" Width="162" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р° РёСЃС‚РµС‡РµРЅРёСЏ СЃСЂРѕРєР° С…СЂР°РЅРµРЅРёСЏ С‚РѕРІР°СЂРѕРІ РІ СЃРѕРѕС‚РІРµС‚СЃС‚РІРёРё СЃ С‚Р°РјРѕР¶РµРЅРЅС‹Рј СЂРµР¶РёРјРѕРј  С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ СЃРєР»Р°РґР°"/>
      <TfrxMemoView Name="Memo71" Left="654" Top="140" Width="162" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="6."/>
      <TfrxMemoView Name="Memo10" Left="862" Top="16" Width="164" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" Text="РЎС‚СЂР°РЅРёС†Р° [Page#] РёР· [TotalPages]"/>
      <TfrxMemoView Name="Memo8" Left="438" Top="74" Width="108" Height="66" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕРґ С‚РѕРІР°СЂР° РїРѕ РўРќ Р’Р­Р” Р РѕСЃСЃРёРё"/>
      <TfrxMemoView Name="Memo12" Left="438" Top="140" Width="108" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="4."/>
    </TfrxPageHeader>
    <TfrxMasterData Name="MasterData1" Height="18" Left="0" Top="238.11039" Width="1069.60699" OnBeforePrint="MasterData1OnBeforePrint" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="tblMain" DataSetName="tblMain" PrintIfDetailEmpty="True" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo32" Left="14" Top="0" Width="40" Height="18" OnBeforePrint="Memo32OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[numline]"/>
      <TfrxMemoView Name="Memo66" Left="54" Top="0" Width="144" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[tblMain.&#34;NU&#34;]"/>
      <TfrxMemoView Name="Memo68" Left="198" Top="0" Width="240" Height="18" OnBeforePrint="Memo68OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[tblMain.&#34;G312&#34;]"/>
      <TfrxMemoView Name="Memo70" Left="816" Top="0" Width="206" Height="18" OnBeforePrint="Memo70OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[vOwner]"/>
      <TfrxMemoView Name="Memo80" Left="546" Top="0" Width="108" Height="18" OnBeforePrint="Memo80OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vG35]"/>
      <TfrxMemoView Name="Memo73" Left="654" Top="0" Width="162" Height="18" OnBeforePrint="Memo73OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[dtData]"/>
      <TfrxMemoView Name="Memo13" Left="438" Top="0" Width="108" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[tblMain.&#34;G33&#34;]"/>
    </TfrxMasterData>
  </TfrxReportPage>
  <TfrxDialogPage Name="Page2" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Color="12615808" Height="277" Left="386" Top="250" Width="308" OnActivate="Page2OnBeforePrint">
    <TfrxColorFrameControl Name="ColorFrame2" Left="0" Top="32" Width="300" Height="216" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" BorderWidth="3" FormCaption="False" RectCaption="False" Color="12615808"/>
    <TfrxColorFrameControl Name="ColorFrame1" Left="7" Top="88" Width="286" Height="88" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="12615808"/>
    <TfrxEditControl Name="fldStoreLicNum" Left="99" Top="40" Width="106" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True"/>
    <TfrxLabelControl Name="lblNumLicence" Left="14" Top="44" Width="65" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="№ лицензии:" Color="12615808"/>
    <TfrxButtonControl Name="btnCallRef" Left="179" Top="42" Width="24" Height="18" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" OnClick="btnCallRefOnBeforePrint"/>
    <TfrxEditControl Name="fldStoreNum" Left="208" Top="40" Width="81" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777212" MaxLength="0" PasswordChar="0" ReadOnly="True"/>
    <TfrxLabelControl Name="lblOn" Left="12" Top="138" Width="50" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Alignment="taRightJustify" AutoSize="False" Caption="На  дату:" Color="12615808"/>
    <TfrxDateEditControl Name="dtOnDate" Left="80" Top="135" Width="133" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38263" DateFormat="dfLong" Time="38263"/>
    <TfrxColorButtonControl Name="cbtnOk" Left="72" Top="208" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Просмотр" Color="12615808" Flat="False" GradientType="gtTopToBottom" ModalResult="1" OnClick="cbtnOkOnBeforePrint"/>
    <TfrxEditControl Name="fldLicExt" Left="84" Top="40" Width="15" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True"/>
    <TfrxColorButtonControl Name="ColorButton1" Left="204" Top="208" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Отмена" Color="12615808" Flat="False" GradientType="gtTopToBottom" ModalResult="2"/>
    <TfrxEditControl Name="edtPeriod" Left="124" Top="104" Width="45" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxLabelControl Name="Label1" Left="16" Top="108" Width="93" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="Период истечения" Color="12615808" WordWrap="True"/>
    <TfrxLabelControl Name="Label2" Left="180" Top="108" Width="24" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="дней" Color="12615808"/>
    <TfrxLabelControl Name="Label3" Left="4" Top="0" Width="290" Height="32" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" Alignment="taCenter" AutoSize="False" Caption="Отчет о товарах, срок хранения которых истекает" Color="12615808" WordWrap="True"/>
    <TfrxLabelControl Name="lblStoreName" Left="7" Top="66" Width="281" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" Alignment="taCenter" AutoSize="False" Color="12615808"/>
    <TfrxCheckBoxControl Name="chkOverPeriod" Left="16" Top="180" Width="189" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="включая просроченные товары" Color="12615808"/>
  </TfrxDialogPage>
</TfrxReport>
