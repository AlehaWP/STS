<?xml version="1.0" encoding="windows-1251"?>
<TfrxReport Name="" DotMatrixReport="False" EngineOptions.ConvertNulls="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" ReportOptions.CreateDate="38287.7802357292" ReportOptions.Description.Text="" ReportOptions.Name="Книга учета товаров и тр.средств (пр.290)" ReportOptions.LastChange="38519.4112011111" ScriptLanguage="PascalScript" ScriptText.Text="Var&#13;&#10;  CustomDocsOnly, AistCompatible, StoreDocsBlock: Integer;&#13;&#10;  vPlaceID, vID: Integer;&#13;&#10;  dtPeriodEnd, dtPeriodStart, OutRelPeriodStart: TDateTime;&#13;&#10;  vRelDocNos, vRelDates, vRelG311, vRelG35: String;&#13;&#10;  strPeriod: String;&#13;&#10;&#13;&#10;  vOutDate: String;&#13;&#10;&#13;&#10;  dRelAtRepDateG311, dRelAtRepDateG35, dRelAtRepDateG42: Double;&#13;&#10;  dRelG311, dRelG35, dRelG42 : Double;&#13;&#10;  sRelAtPeriodG311, sRelAtPeriodG35, sRelAtPeriodG42: String;&#13;&#10;  dRestAtRepDateG311, dRestAtRepDateG35, dRestAtRepDateG42: Double;&#13;&#10;  dRestG311, dRestG35, dRestG42: Double;&#13;&#10;  dQtyAtStoreG311, dQtyAtStoreG35, dQtyAtStoreG42: Double;&#13;&#10;&#13;&#10;  dSumQtyAtStoreG311, dSumQtyAtStoreG35, dSumQtyAtStoreG46: Double;&#13;&#10;  dSumRelAtPeriodG311, dSumRelAtPeriodG35, dSumRelAtPeriodG46: Double;&#13;&#10;  dSumRestAtRepDateG311, dSumRestAtRepDateG35, dSumRestAtRepDateG46: Double;&#13;&#10;&#13;&#10;  vLastReleaseDate: TDateTime;&#13;&#10;  vFilterCrit, vSQL: String;&#13;&#10;  vLine: Integer; vLinePrint: String;&#13;&#10;  vStoreDate, vDONum, vOwner: String;&#13;&#10;  TransDocNames, TransDocRegNames, sTrans,&#13;&#10;  vGTD, vG33, vWithPlace :String;&#13;&#10;  vG46 : Double;&#13;&#10;  vUseStoreDocs,vTDByComms: Boolean;&#13;&#10;&#13;&#10;  vOnCurrentBook: Boolean;&#13;&#10;  vCanPrint: Boolean;&#13;&#10;&#13;&#10;  sDataSetName: String;&#13;&#10;&#13;&#10;procedure SetLine(ID: Integer);&#13;&#10;var&#13;&#10;  vCurID: Integer;&#13;&#10;begin&#13;&#10;  vLinePrint := '';&#13;&#10;  vStoreDate := '';&#13;&#10;  vDONum := '';&#13;&#10;  vOwner := '';&#13;&#10;  //Номер по порядку и Дата помещения&#13;&#10;  if vCurID &#60;&#62; ID then begin&#13;&#10;    vLine := vLine + 1;&#13;&#10;    vLinePrint := IntToStr(vLine);&#13;&#10;    vLinePrint := COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;STORE_DOC_NO&#34;)');&#13;&#10;    //Номер ГТД&#13;&#10;    vDONum := IIF((COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;GTD_NO&#34;)') &#60;&#62; Null) or (COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;GTD_NO&#34;)') &#60;&#62; ''), COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;GTD_NO&#34;)'), IIF(AistCompatible = 1, COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;ND&#34;)'), COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;NBD&#34;)')));&#13;&#10;    // помещатель&#13;&#10;    vOwner := iif(LeftCopy(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;G011&#34;)'),1)='Э', COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;G022&#34;)'),COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;G082&#34;)'));&#13;&#10;    //Дата помещения&#13;&#10;    if ValidDate(LeftCopy(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;BD_DATE&#34;)'), 10))  then&#13;&#10;      vStoreDate := FormatDateTime('DD.MM.YYYY', StrToDateTime(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;BD_DATE&#34;)')))&#13;&#10;    else vStoreDate := '';&#13;&#10;&#13;&#10;  end&#13;&#10;  else if not vTDByComms then&#13;&#10;    begin&#13;&#10;      TransDocNames := &#34;&#34;;&#13;&#10;    end;&#13;&#10;  vCurID := ID;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure btnCallRefOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with btnCallRef, Engine do&#13;&#10;  begin&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreNumLic&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreNum&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strStoreName&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;strLicExt&#34;,String)');&#13;&#10;    COMPUTE('GLOBALVAR(&#34;sPlaceId&#34;,Integer)');&#13;&#10;    COMPUTE('OPENQUERY (&#34;Stors&#34;, &#34;STS_DB&#34;, &#34;Select * from STORES&#34;)');&#13;&#10;    COMPUTE('SelectValues(&#34;Список складов&#34;, &#34;Stors&#34;,[[&#34;LICENCENO&#34;,   &#34;Номер лицензии&#34;, 15],[&#34;LICENCENO_EXT&#34;,   &#34; &#34;, 1],[&#34;STORE_NO&#34;,   &#34;Номер склада&#34;, 15],[&#34;NAME&#34;,   &#34;Название склада&#34;, 30],[&#34;PlaceId&#34;,   &#34;&#34;, 10]],[[&#34;LICENCENO&#34;, &#34;strStoreNumLic&#34;],[&#34;STORE_NO&#34;, &#34;strStoreNum&#34;],[&#34;NAME&#34;, &#34;strStoreName&#34;],[&#34;LICENCENO_EXT&#34;, &#34;strLicExt&#34;],[&#34;PlaceId&#34;, &#34;sPlaceId&#34;],],&#34;&#34;, &#34;STS_DB&#34;)');&#13;&#10;&#13;&#10;&#13;&#10;    fldStoreLicNum.Text := COMPUTE('Value(&#34;strStoreNumLic&#34;)') ;      //   номер лицензии&#13;&#10;    fldStoreNum.Text := '№ склада: ' + COMPUTE('value(&#34;strStoreNum&#34;)') ; //   номер склада&#13;&#10;    lblStoreName.Caption := COMPUTE('Value(&#34;strStoreName&#34;)') ;     //   название склада&#13;&#10;    fldLicExt.Text := COMPUTE('Value(&#34;strLIcExt&#34;)');     //   Признак перерегистрации&#13;&#10;    vPlaceId := StrToInt(COMPUTE('Value(&#34;sPlaceId&#34;)'));&#13;&#10;    if Length(COMPUTE('Value(&#34;strStoreNumLic&#34;)')) &#62; 0 then&#13;&#10;      cbtnOk.Enabled := True&#13;&#10;    else cbtnOk.Enabled := False;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure rbtnPeriodOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with rbtnPeriod, Engine do&#13;&#10;  begin&#13;&#10;&#13;&#10;    dtFrom.Enabled := True;&#13;&#10;    dtTo.Enabled := True;&#13;&#10;&#13;&#10;    fldStoreLicNum.Enabled := True;&#13;&#10;    fldStoreNum.Enabled := True;&#13;&#10;    lblStoreName.Enabled := True;&#13;&#10;    fldLicExt.Enabled := True;&#13;&#10;    btnCallRef.Enabled := True;&#13;&#10;    lblNumLicence.Enabled := True;&#13;&#10;&#13;&#10;    cbtnOk.Enabled := vCanPrint;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure rbtnCurBookOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with rbtnCurBook, Engine do&#13;&#10;  begin&#13;&#10;&#13;&#10;    dtFrom.Enabled := False;&#13;&#10;    dtTo.Enabled := False;&#13;&#10;&#13;&#10;    fldStoreLicNum.Enabled := False;&#13;&#10;    fldStoreNum.Enabled := False;&#13;&#10;    lblStoreName.Enabled := False;&#13;&#10;    fldLicExt.Enabled := False;&#13;&#10;    btnCallRef.Enabled := False;&#13;&#10;    lblNumLicence.Enabled := False;&#13;&#10;&#13;&#10;    vCanPrint := cbtnOk.Enabled;&#13;&#10;    cbtnOk.Enabled := True;&#13;&#10;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbtnOkOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with cbtnOk, Engine do begin&#13;&#10;&#13;&#10;    vOnCurrentBook := rbtnCurBook.Checked;&#13;&#10;&#13;&#10;    if not vOnCurrentBook then begin&#13;&#10;      dtPeriodStart := Trunc(dtFrom.Date) + STRTOTIME('00:00:00');&#13;&#10;      dtPeriodEnd := Trunc(dtTo.Date) + STRTOTIME('23:59:59');&#13;&#10;      //Начало периода для подсчета кол-ва на начало периода&#13;&#10;      OutRelPeriodStart := Trunc(dtFrom.Date) + STRTOTIME('23:59:59');&#13;&#10;      strPeriod := 'с ' + FORMATDATETIME(&#34;DD MMMM YYYY&#34;, OutRelPeriodStart) + ' по ' + FORMATDATETIME(&#34;DD MMMM YYYY&#34;, dtPeriodend);&#13;&#10;&#13;&#10;      vSQL := 'SELECT * FROM KRD_MAIN WHERE PLACEID = ' + IntToStr(vPlaceId) +&#13;&#10;              ' AND BD_DATE &#60;= ' + CHR(39) + VarToStr(dtPeriodEnd) + CHR(39) +&#13;&#10;              ' AND BD_DATE &#62;= ' + CHR(39) + VarToStr(dtPeriodStart) + CHR(39) +&#13;&#10;              ' ORDER BY SHOW_NBD';&#13;&#10;      COMPUTE('OPENQUERY(&#34;QRYKRDMAIN2&#34;, &#34;STS_DB&#34;, &#34;' + vSQL + '&#34;)');&#13;&#10;      sDataSetName := 'QRYKRDMAIN2';&#13;&#10;      Band1.RowCount := StrToInt(COMPUTE('RECORDCOUNT(&#34;QRYKRDMAIN2&#34;)'));&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      dtPeriodStart := STRTODATE('30.08.1981') + STRTOTIME('00:00:01');&#13;&#10;      OutRelPeriodStart := STRTODATE('30.08.1981') + STRTOTIME('00:00:01');&#13;&#10;      dtPeriodEnd := Date + STRTOTIME('23:59:59');&#13;&#10;      vPlaceId := &#60;KRD_MAIN.&#34;PLACEID&#34;&#62;;&#13;&#10;      sDataSetName := 'KRD_MAIN';&#13;&#10;      Band1.DataSetName := 'KRD_MAIN';&#13;&#10;    end;&#13;&#10;&#13;&#10;&#13;&#10;    //Чтобы взять информацию о складе&#13;&#10;    COMPUTE('FINDKEY(&#34;STORES_2&#34;, [&#34;' + IntToStr(vPlaceId) + '&#34;])');&#13;&#10;&#13;&#10;    //сохраняем настройки&#13;&#10;&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;OnCurrentBook&#34;,&#34;'+VarToStr(rbtnCurBook.Checked)+'&#34;)');&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;TDByComms&#34;,&#34;'+VarToStr(cbTDByComms.Checked)+'&#34;)');&#13;&#10;&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;'+DATETOSTR(dtFrom.Date)+'&#34;)');&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;'+DateToStr(dtTo.Date)+'&#34;)');&#13;&#10;    COMPUTE('WRITEINIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;'+IntToStr(vPlaceId)+'&#34;)');&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band3OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('SETFILTER(&#34;IN_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('SETFILTER(&#34;IN_COMM_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('SETFILTER(&#34;OUT_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;  if not vOnCurrentBook then COMPUTE('CLOSEDATASET(&#34;QRYKRDMAIN2&#34;)');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  fldLicExt.Text := '';&#13;&#10;  fldStoreLicNum.Text := '';&#13;&#10;  fldStoreNum.Text := '';&#13;&#10;&#13;&#10;  if COMPUTE('INIFILE(&#34;Print&#34;,&#34;TDByComms&#34;,&#34;False&#34;)') = 'True' then&#13;&#10;    begin&#13;&#10;      cbTDAll.Checked := False;&#13;&#10;      cbTDByComms.Checked := True;&#13;&#10;    end&#13;&#10;  else&#13;&#10;    begin&#13;&#10;      cbTDAll.checked := True;&#13;&#10;      cbTDByComms.Checked := False;&#13;&#10;    end;&#13;&#10;&#13;&#10;  vPlaceId:=StrToInt(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;0&#34;)'));&#13;&#10;  If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;])') then begin&#13;&#10;     fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;     fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;     lblStoreName.Caption := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;     fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;     vCanPrint := True;&#13;&#10;     cbtnOk.Enabled := True;&#13;&#10;  end&#13;&#10;  else begin&#13;&#10;    vPlaceId:=StrToInt(COMPUTE('INIFILE(&#34;WorkPlace&#34;,&#34;PlaceNum&#34;,&#34;0&#34;)'));&#13;&#10;    If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;])') then begin&#13;&#10;      fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;      fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;      lblStoreName.Caption := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;      fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;      vCanPrint := True;&#13;&#10;      cbtnOk.Enabled := True;&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      fldStoreLicNum.Text := '';&#13;&#10;      fldStoreNum.Text := '№ склада: ';&#13;&#10;      lblStoreName.Caption := '';&#13;&#10;      fldLicExt.Text := '';&#13;&#10;      vCanPrint := False;&#13;&#10;      cbtnOk.Enabled := False;&#13;&#10;    end&#13;&#10;  end;&#13;&#10;&#13;&#10;  dtFrom.Date := STRTODATEDEF(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;&#34;)'), DATE);&#13;&#10;  dtTo.Date := STRTODATEDEF(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;&#34;)'), DATE);&#13;&#10;&#13;&#10;&#13;&#10;  if COMPUTE('INIFILE(&#34;Print&#34;,&#34;OnCurrentBook&#34;,&#34;True&#34;)') = 'True' then&#13;&#10;     rbtnCurBook.Checked := True;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DetailData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;A_MODE&#34;)') = '7' then begin&#13;&#10;    //Запомним ID для установки номера текущей строки&#13;&#10;    vID := StrToInt(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;MAIN_ID&#34;)'));&#13;&#10;  end&#13;&#10;  else begin&#13;&#10;    //Запомним ID для установки номера текущей строки&#13;&#10;    vID := StrToInt(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;ID&#34;)'));&#13;&#10;  end;&#13;&#10;  TransDocNames := &#34;&#34;;&#13;&#10;&#13;&#10;  //Подсчет остатков; информация по документам выпуска&#13;&#10;  dQtyAtStoreG311:= 0;&#13;&#10;  dQtyAtStoreG35 := 0;&#13;&#10;  sRelAtPeriodG311 := '';&#13;&#10;  sRelAtPeriodG35 := '';&#13;&#10;  vOutDate := '';&#13;&#10;  vGTD :='';&#13;&#10;&#13;&#10;  // номера ТТН&#13;&#10;  if vTDByComms then&#13;&#10;    begin&#13;&#10;      COMPUTE('CANCELRANGE(&#34;KRD_COMM_PAPERS_2&#34;)');&#13;&#10;      COMPUTE('SETRANGE(&#34;KRD_COMM_PAPERS_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;, &#34;' + STR(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' + STR(&#60;KRD_COMM_2.&#34;G32&#34;&#62;) + '&#34;, &#34;' + STR(&#34;13&#34;) + '&#34;])');&#13;&#10;      KRD_COMM_PAPERS_2.First;&#13;&#10;      while not KRD_COMM_PAPERS_2.Eof do begin&#13;&#10;        COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;        COMPUTE('SETRANGE(&#34;KRD_PAPERS_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;, &#34;' + STR(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' + STR(&#60;KRD_COMM_PAPERS_2.&#34;DOC_COUNTER&#34;&#62;) + '&#34;])');&#13;&#10;        COMPUTE('FIRST(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;        if (COMPUTE('REFERENCE(&#34;PAPERS.DB&#34;, &#34;PAPERNAME&#34;, &#34;' + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + '&#34;, &#34;PAPER_IS_WAYBILL&#34;)')='1') then&#13;&#10;          if TransDocNames = &#34;&#34; then&#13;&#10;            begin&#13;&#10;              TransDocNames := TransDocNames + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; &#34; + STR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;);&#13;&#10;              end&#13;&#10;            else&#13;&#10;              begin&#13;&#10;                TransDocNames := TransDocNames + ', ' + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; &#34; + STR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;);&#13;&#10;              end;&#13;&#10;        KRD_COMM_PAPERS_2.Next&#13;&#10;      end&#13;&#10;    end&#13;&#10;  else&#13;&#10;    begin&#13;&#10;      COMPUTE('CANCELRANGE(&#34;KRD_PAPERS_2&#34;)');&#13;&#10;      COMPUTE('SETRANGE(&#34;KRD_PAPERS_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;, &#34;' + STR(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + '&#34;])');&#13;&#10;      KRD_PAPERS_2.First;&#13;&#10;      while not KRD_PAPERS_2.Eof do begin&#13;&#10;        if (COMPUTE('REFERENCE(&#34;PAPERS.DB&#34;, &#34;PAPERNAME&#34;, &#34;' + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + '&#34;, &#34;PAPER_IS_WAYBILL&#34;)')='1') then&#13;&#10;          if TransDocNames = &#34;&#34; then&#13;&#10;            begin&#13;&#10;              TransDocNames := TransDocNames + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; &#34; + STR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;);&#13;&#10;            end&#13;&#10;          else&#13;&#10;            begin&#13;&#10;              TransDocNames := TransDocNames + ', ' + &#60;KRD_PAPERS_2.&#34;PAPERNAME&#34;&#62; + &#34; &#34; + STR(&#60;KRD_PAPERS_2.&#34;PAPERNO&#34;&#62;);&#13;&#10;            end;&#13;&#10;        KRD_PAPERS_2.Next;&#13;&#10;      end&#13;&#10;    end;&#13;&#10;&#13;&#10;&#13;&#10;  if vUseStoreDocs then begin&#13;&#10;    //Кол-во при помещении&#13;&#10;    if (StrToInt(COMPUTE('FINDKEY(&#34;IN_COMM_2&#34;, [&#34;' + IntToStr(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;KRD_COMM_2.&#34;G32&#34;&#62;) +'&#34;])')) &#60;&#62; 0) then begin&#13;&#10;      dQtyAtStoreG35 := IIF(&#60;IN_COMM_2.&#34;G35&#34;&#62;&#60;&#62;NULL,&#60;IN_COMM_2.&#34;G35&#34;&#62;,IIF(&#60;KRD_COMM_2.&#34;G35&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;G35&#34;&#62;,0));&#13;&#10;      dQtyAtStoreG311 := IIF(&#60;IN_COMM_2.&#34;G311&#34;&#62;&#60;&#62;NULL,&#60;IN_COMM_2.&#34;G311&#34;&#62;,IIF(&#60;KRD_COMM_2.&#34;G311&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;G311&#34;&#62;,0));&#13;&#10;    end&#13;&#10;    else begin&#13;&#10;      dQtyAtStoreG35 := IIF(&#60;KRD_COMM_2.&#34;G35&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;G35&#34;&#62;,0);&#13;&#10;      dQtyAtStoreG311 := IIF(&#60;KRD_COMM_2.&#34;G311&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;G311&#34;&#62;,0);&#13;&#10;    end;&#13;&#10;    //Считаем суммы&#13;&#10;    dSumQtyAtStoreG35 := dSumQtyAtStoreG35 + dQtyAtStoreG35;&#13;&#10;    dSumQtyAtStoreG311 := dSumQtyAtStoreG311 + dQtyAtStoreG311;&#13;&#10;&#13;&#10;    //печатаем строку&#13;&#10;      DetailData1.Visible := True;&#13;&#10;      SetLine(vId);&#13;&#10;      //Смотрим выпуски - получаем дату и номер выпускающего документа&#13;&#10;      COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;&#34;)');&#13;&#10;      vFilterCrit := 'PLACEID=' + IntToStr(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + ' AND ID=' + IntToStr(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + ' AND G32=' + IntToStr(&#60;KRD_COMM_2.&#34;G32&#34;&#62;);&#13;&#10;      COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;      COMPUTE('FIRST(&#34;OUT_COMM_2&#34;)');&#13;&#10;      while COMPUTE('EOF(&#34;OUT_COMM_2&#34;)') = '0' do begin&#13;&#10;        if COMPUTE('FINDKEY(&#34;OUT_MAIN_2&#34;, [&#34;' + IntToStr(&#60;OUT_COMM_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;OUT_COMM_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;OUT_COMM_2.&#34;ACTOUTID&#34;&#62;) + '&#34;])') &#60;&#62; '0' then begin&#13;&#10;          if (&#60;OUT_MAIN_2.&#34;G542&#34;&#62; &#60;&#62; NULL) and (&#60;OUT_MAIN_2.&#34;G542&#34;&#62; &#60;= dtPeriodEnd) then begin&#13;&#10;            if vOutDate &#60;&#62; '' then vOutDate := vOutDate + CHR(13);&#13;&#10;            vOutDate := vOutDate + FormatDateTime('DD.MM.YYYY', &#60;OUT_MAIN_2.&#34;G542&#34;&#62;);&#13;&#10;            if vGTD &#60;&#62; '' then vGTD := vGTD + CHR(13);&#13;&#10;            vGTD := vGTD + &#60;OUT_COMM_2.&#34;ND_GTD&#34;&#62;;&#13;&#10;            if sRelAtPeriodG311 &#60;&#62; '' then sRelAtPeriodG311 := sRelAtPeriodG311 + CHR(13);&#13;&#10;            sRelAtPeriodG311 := sRelAtPeriodG311 + VarToStr(&#60;OUT_COMM_2.&#34;OUT_G311&#34;&#62;);&#13;&#10;            if sRelAtPeriodG35 &#60;&#62; '' then sRelAtPeriodG35 := sRelAtPeriodG35 + CHR(13);&#13;&#10;            sRelAtPeriodG35 := sRelAtPeriodG35 + VarToStr(&#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;);&#13;&#10;            //Считаем суммы&#13;&#10;            dSumRelAtPeriodG311 := dSumRelAtPeriodG311 + IIF(&#60;OUT_COMM_2.&#34;OUT_G311&#34;&#62;&#60;&#62;Null, &#60;OUT_COMM_2.&#34;OUT_G311&#34;&#62;, 0);&#13;&#10;            dSumRelAtPeriodG35 := dSumRelAtPeriodG35 + IIF(&#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;&#60;&#62;Null, &#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;, 0);&#13;&#10;          end;&#13;&#10;        end;&#13;&#10;        COMPUTE('NEXT(&#34;OUT_COMM_2&#34;)');&#13;&#10;      end;&#13;&#10;      COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;&#34;)');&#13;&#10;      COMPUTE('SETFILTER(&#34;OUT_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;  end&#13;&#10;  else begin&#13;&#10;    //Кол-во при помещении&#13;&#10;    begin&#13;&#10;      dQtyAtStoreG35 := IIF(&#60;KRD_COMM_2.&#34;G35&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;G35&#34;&#62;,0);&#13;&#10;      dQtyAtStoreG311 := IIF(&#60;KRD_COMM_2.&#34;G311&#34;&#62;&#60;&#62;NULL,&#60;KRD_COMM_2.&#34;G311&#34;&#62;,0);&#13;&#10;    end;&#13;&#10;    //Считаем суммы&#13;&#10;    dSumQtyAtStoreG35 := dSumQtyAtStoreG35 + dQtyAtStoreG35;&#13;&#10;    dSumQtyAtStoreG311 := dSumQtyAtStoreG311 + dQtyAtStoreG311;&#13;&#10;    // печатаем строку&#13;&#10;      DetailData1.Visible := True;&#13;&#10;      SetLine(vID);&#13;&#10;      COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;&#34;)');&#13;&#10;      vFilterCrit := 'PLACEID=' + IntToStr(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + ' AND ID=' + IntToStr(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + ' AND G32=' + IntToStr(&#60;KRD_COMM_2.&#34;G32&#34;&#62;);&#13;&#10;      COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;      COMPUTE('FIRST(&#34;REL_COMM_2&#34;)');&#13;&#10;      while COMPUTE('EOF(&#34;REL_COMM_2&#34;)') = '0' do begin&#13;&#10;        if COMPUTE('FINDKEY(&#34;REL_MAIN_2&#34;, [&#34;' + IntToStr(&#60;REL_COMM_2.&#34;PLACEID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;REL_COMM_2.&#34;ID&#34;&#62;) + '&#34;, &#34;' + IntToStr(&#60;REL_COMM_2.&#34;COUNTER&#34;&#62;) + '&#34;])') &#60;&#62; '0' then begin&#13;&#10;          if (&#60;REL_MAIN_2.&#34;OUT_DATE&#34;&#62;&#60;&#62;NULL) and (&#60;REL_MAIN_2.&#34;OUT_DATE&#34;&#62; &#60;= dtPeriodEnd) then begin&#13;&#10;            if vOutDate &#60;&#62; '' then vOutDate := vOutDate + CHR(13);&#13;&#10;            vOutDate := vOutDate + FormatDateTime('DD.MM.YYYY', &#60;REL_MAIN_2.&#34;OUT_DATE&#34;&#62;);&#13;&#10;            if vGTD &#60;&#62; '' then vGTD := vGTD + CHR(13);&#13;&#10;            vGTD := vGTD + &#60;REL_MAIN_2.&#34;DOC_NO&#34;&#62;;&#13;&#10;            if sRelAtPeriodG311 &#60;&#62; '' then sRelAtPeriodG311 := sRelAtPeriodG311 + CHR(13);&#13;&#10;            sRelAtPeriodG311 := sRelAtPeriodG311 + VarToStr(&#60;REL_COMM_2.&#34;RELEASE_G311&#34;&#62;);&#13;&#10;            if sRelAtPeriodG35 &#60;&#62; '' then sRelAtPeriodG35 := sRelAtPeriodG35 + CHR(13);&#13;&#10;            sRelAtPeriodG35 := sRelAtPeriodG35 + VarToStr(&#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;);&#13;&#10;            //Считаем суммы&#13;&#10;            dSumRelAtPeriodG311 := dSumRelAtPeriodG311 + IIF(&#60;REL_COMM_2.&#34;RELEASE_G311&#34;&#62;&#60;&#62;Null, &#60;REL_COMM_2.&#34;RELEASE_G311&#34;&#62;, 0);&#13;&#10;            dSumRelAtPeriodG35 := dSumRelAtPeriodG35 + IIF(&#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;&#60;&#62;Null, &#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;, 0);&#13;&#10;          end;&#13;&#10;        end;&#13;&#10;        COMPUTE('NEXT(&#34;REL_COMM_2&#34;)');&#13;&#10;      end;&#13;&#10;      COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;&#34;)');&#13;&#10;      COMPUTE('SETFILTER(&#34;REL_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; COMPUTE('FIRST(&#34;' + sDataSetName + '&#34;)');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');&#13;&#10;  COMPUTE('SETRANGE(&#34;KRD_COMM_2&#34;, [&#34;' + VarToStr(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;PLACEID&#34;)')) + '&#34;, &#34;' +&#13;&#10;                                        VarToStr(COMPUTE('FIELDVALUE(&#34;' + sDataSetName + '&#34;, &#34;ID&#34;)')) + '&#34;])');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Footer1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; if not vOnCurrentBook then COMPUTE('NEXT(&#34;QRYKRDMAIN2&#34;)')&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure cbTDByCommsOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if cbTDByComms.Checked then&#13;&#10;    cbTDAll.Checked := False&#13;&#10;  else if not cbTDByComms.Checked then&#13;&#10;         cbTDAll.Checked := True;&#13;&#10;  vTDByComms := cbTDByComms.Checked;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbTDAllOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if cbTDAll.Checked then&#13;&#10;    cbTDByComms.Checked := False&#13;&#10;  else if not cbTDAll.Checked then&#13;&#10;         cbTDByComms.Checked := True;&#13;&#10;  vTDByComms := cbTDByComms.Checked;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  //Взяли из ini-шника &#34;Только таможенные документы учета&#34;&#13;&#10;  CustomDocsOnly := StrToInt(COMPUTE('INIFILE(&#34;RegBook&#34;, &#34;CustomsDocsOnly&#34;, 0)'));&#13;&#10;  //Включена ли настройка &#34;Совместимость с АИСТом&#34;, 1-да, 0-нет&#13;&#10;  AistCompatible := StrToInt(COMPUTE('INIFILE(&#34;Docs&#34;, &#34;AistCompatible&#34;, &#34;0&#34;)'));&#13;&#10;  //Отключен ли блок складских документов&#13;&#10;  StoreDocsBlock := StrToInt(COMPUTE('INIFILE(&#34;Database&#34;, &#34;StoreDocsBlock&#34;, &#34;0&#34;)'));&#13;&#10;  if (StoreDocsBlock = 1) and ((AistCompatible = 1) or ((AistCompatible = 0) and (CustomDocsOnly = 0))) then&#13;&#10;    vUseStoreDocs := True&#13;&#10;  else vUseStoreDocs := False;&#13;&#10;  //Печать ТСД в каждом товаре по таблице Товары по документам&#13;&#10;  if COMPUTE('INIFILE(&#34;Print&#34;,&#34;TDByComms&#34;,&#34;False&#34;)') = 'True' then&#13;&#10;    vTDByComms := True;&#13;&#10;end." OnStartReport="OnStartReport" PropData="08446174617365747301010C2F00000020446174615365743D2264735F494E5F434F4D4D5F322220446174615365744E616D653D22494E5F434F4D4D5F322200010C2F00000020446174615365743D2264735F494E5F4D41494E5F322220446174615365744E616D653D22494E5F4D41494E5F322200010C3100000020446174615365743D2264735F4B52445F434F4D4D5F322220446174615365744E616D653D224B52445F434F4D4D5F322200010C3F00000020446174615365743D2264735F4B52445F434F4D4D5F5041504552535F322220446174615365744E616D653D224B52445F434F4D4D5F5041504552535F322200010C2D00000020446174615365743D2264735F4B52445F4D41494E2220446174615365744E616D653D224B52445F4D41494E2200010C3100000020446174615365743D2264735F4B52445F4D41494E5F322220446174615365744E616D653D224B52445F4D41494E5F322200010C3500000020446174615365743D2264735F4B52445F5041504552535F322220446174615365744E616D653D224B52445F5041504552535F322200010C3500000020446174615365743D2264735F4B52445F5452414E53505F322220446174615365744E616D653D224B52445F5452414E53505F322200010C3100000020446174615365743D2264735F4F55545F434F4D4D5F322220446174615365744E616D653D224F55545F434F4D4D5F322200010C3100000020446174615365743D2264735F4F55545F4D41494E5F322220446174615365744E616D653D224F55545F4D41494E5F322200010C3100000020446174615365743D2264735F52454C5F434F4D4D5F322220446174615365744E616D653D2252454C5F434F4D4D5F322200010C3100000020446174615365743D2264735F52454C5F4D41494E5F322220446174615365744E616D653D2252454C5F4D41494E5F322200010C2D00000020446174615365743D2264735F53544F5245535F322220446174615365744E616D653D2253544F5245535F32220000095661726961626C65730100055374796C650100">
  <TfrxDialogPage Name="Page1" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Книга учета товаров на ТС" Height="302" Left="341" Top="153" Width="350" OnActivate="Page1OnActivate">
    <TfrxColorFrameControl Name="frameMain" Left="3" Top="4" Width="336" Height="172" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" BorderWidth="0" Color="-16777201"/>
    <TfrxColorFrameControl Name="ColorFrame1" Left="5" Top="6" Width="332" Height="140" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" BorderWidth="2" Color="-16777201"/>
    <TfrxColorFrameControl Name="cfrmPeriod" Left="16" Top="92" Width="312" Height="40" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" BorderWidth="0" Color="-16777201"/>
    <TfrxEditControl Name="fldStoreLicNum" Left="99" Top="16" Width="118" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="039/000049"/>
    <TfrxLabelControl Name="lblNumLicence" Left="14" Top="20" Width="65" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" AutoSize="False" Caption="№ лицензии:" Color="-16777201"/>
    <TfrxButtonControl Name="btnCallRef" Left="191" Top="18" Width="24" Height="18" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" OnClick="btnCallRefOnBeforePrint"/>
    <TfrxEditControl Name="fldStoreNum" Left="228" Top="16" Width="93" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Color="-16777212" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="№ склада: 8"/>
    <TfrxRadioButtonControl Name="rbtnPeriod" Left="16" Top="72" Width="113" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Caption="За период" Checked="True" Color="-16777201" OnClick="rbtnPeriodOnBeforePrint"/>
    <TfrxLabelControl Name="lblFrom" Left="32" Top="103" Width="11" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" AutoSize="False" Caption="С" Color="-16777201"/>
    <TfrxLabelControl Name="lblTo" Left="175" Top="104" Width="12" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" AutoSize="False" Caption="по" Color="-16777201"/>
    <TfrxDateEditControl Name="dtFrom" Left="44" Top="100" Width="121" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Color="-16777211" Date="38287.4108878819"/>
    <TfrxDateEditControl Name="dtTo" Left="196" Top="100" Width="117" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Color="-16777211" Date="38287.4108878819"/>
    <TfrxColorButtonControl Name="cbtnOk" Left="120" Top="240" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" Caption="Просмотр" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="1" OnClick="cbtnOkOnBeforePrint"/>
    <TfrxEditControl Name="fldLicExt" Left="84" Top="16" Width="15" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True" Text="А"/>
    <TfrxColorButtonControl Name="cBtnCancel" Left="220" Top="240" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Caption="Отмена" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="2"/>
    <TfrxLabelControl Name="lblStoreName" Left="8" Top="44" Width="281" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" Alignment="taCenter" AutoSize="False" Caption="ЗАО &#34;КОМИНА&#34;" Color="-16777201"/>
    <TfrxRadioButtonControl Name="rbtnCurBook" Left="20" Top="152" Width="161" Height="17" Caption="По текущей книге учета" Color="-16777201" OnClick="rbtnCurBookOnClick"/>
    <TfrxCheckBoxControl Name="cbTDByComms" Left="12" Top="208" Width="329" Height="17" Caption="Печатать ТСД к товару по таблице 'Товары по документам'" Color="-16777201" OnClick="cbTDByCommsOnClick"/>
    <TfrxCheckBoxControl Name="cbTDAll" Left="12" Top="184" Width="217" Height="17" Caption="Печатать все ТСД в первом товаре" Checked="True" State="cbChecked" Color="-16777201" OnClick="cbTDAllOnClick"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page2" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="8" RightMargin="8" TopMargin="6" BottomMargin="6" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VirtualPage="False" VGuides.Text="" OnBeforePrint="Page2OnBeforePrint">
    <TfrxMasterData Name="Band1" Height="15" Left="0" Top="309.92146" Visible="False" Width="1062.04793" OnBeforePrint="Band1OnBeforePrint" AllowSplit="True" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="ds_KRD_MAIN_2" DataSetName="KRD_MAIN_2" FooterAfterEach="True" PrintChildIfInvisible="True" PrintIfDetailEmpty="True" RowCount="0" Stretched="True"/>
    <TfrxReportTitle Name="Band2" Height="92.22047" Left="0" Top="18.89765" Width="1062.04793">
      <TfrxMemoView Name="Memo58" Left="44.3624" Top="2.32282" Width="973.32313" Height="36.89765" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="3" HAlign="haCenter" Memo.Text="Книга учета товаров, находящихся на таможенном складе" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo1" Left="133.17316" Top="44.44094" Width="336" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" Memo.Text="[STORES_2.&#34;NAME&#34;]" ParentFont="False"/>
      <TfrxMemoView Name="Memo2" Left="17.17316" Top="44.44094" Width="116" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" Memo.Text="Название склада:" ParentFont="False"/>
      <TfrxLineView Name="Line1" Left="5" Top="64.44094" Width="1050" Height="0" Frame.Typ="4" Frame.Width="2"/>
      <TfrxMemoView Name="Memo4" Left="467.8188" Top="44.44094" Width="124" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" Memo.Text="№ лицензии склада:" ParentFont="False"/>
      <TfrxMemoView Name="Memo3" Left="591.8188" Top="44.44094" Width="318.45671" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" Memo.Text="[STORES_2.&#34;LICENCENO&#34;]" ParentFont="False"/>
      <TfrxMemoView Name="Memo16" Left="337.02018547" Top="68.44094" Width="388" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haCenter" Memo.Text="[strPeriod]" ParentFont="False"/>
      <TfrxMemoView Name="Memo44" Left="910.86673" Top="44.5906" Width="135.33859" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haRight" Memo.Text="№ склада: [STORES_2.&#34;STORE_NO&#34;]" ParentFont="False"/>
    </TfrxReportTitle>
    <TfrxReportSummary Name="Band3" Height="9.30705" Left="0" Top="457.32313" Width="1062.04793" OnAfterPrint="Band3OnAfterPrint"/>
    <TfrxPageHeader Name="PageHeader1" Height="117.33859" Left="0" Top="132.28355" Width="1062.04793">
      <TfrxMemoView Name="Memo38" Left="3.77953" Top="3.77952999999999" Width="28" Height="95.55906" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="N&#13;&#10;п/п" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo40" Left="31.77953" Top="3.77952999999999" Width="728.88188" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="Приход" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo41" Left="31.77953" Top="21.77953" Width="40" Height="77.55906" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="Дата поме- щения" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo42" Left="760.66141" Top="3.77952999999999" Width="272.44094" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="Расход" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo45" Left="287.21274" Top="21.77953" Width="119.05511811" Height="77.55906" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="Номер ГТД (74)" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo52" Left="492.5671" Top="21.77953" Width="106.58267717" Height="77.55906" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="№ товаросопроводи- &#13;&#10;тельного документа &#13;&#10;(акта приема-&#13;&#10;передачи товаров)" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo56" Left="173.00773" Top="21.77953" Width="114.23624" Height="77.55906" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="Наименование товаров" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo60" Left="406.36209" Top="48.23624" Width="39.33859" Height="51.10235" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="мест" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo61" Left="445.70068" Top="48.23624" Width="46.86613929" Height="51.10235" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="вес брутто в кг" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo62" Left="599.08658" Top="21.77953" Width="95.2440774" Height="77.55906" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="Место размещения на &#13;&#10;таможенном складе &#13;&#10;(№ бокса, помещения, &#13;&#10;стеллажа, &#13;&#10;холодильника и т.п.)" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo64" Left="760.66141" Top="21.77953" Width="59.33859" Height="77.55906" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="Дата выпуска со склада" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo65" Left="820" Top="21.77953" Width="125.7953" Height="77.55906" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="№ ГТД (№ ДКД)" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo66" Left="945.7953" Top="48.23624" Width="39.33859" Height="51.10235" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="мест" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo67" Left="985.13389" Top="48.23624" Width="47.55906" Height="51.10235" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="вес брутто в кг" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo69" Left="3.77953" Top="99.33859" Width="28" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="1." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo70" Left="31.77953" Top="99.33859" Width="40" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="2." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo71" Left="287.21274" Top="99.33859" Width="119.05511811" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="5." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo73" Left="492.5671" Top="99.33859" Width="106.58267717" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="8." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo77" Left="173.00773" Top="99.33859" Width="114.23624" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="4." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo80" Left="406.36209" Top="99.33859" Width="39.33859" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="6." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo81" Left="445.70068" Top="99.33859" Width="46.86613929" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="7." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo82" Left="599.08658" Top="99.33859" Width="95.2440774" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="9." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo84" Left="760.66141" Top="99.33859" Width="59.33859" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="11." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo85" Left="820" Top="99.33859" Width="125.7953" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="12." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo86" Left="945.7953" Top="99.33859" Width="39.33859" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="13." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo87" Left="985.13389" Top="99.33859" Width="47.55906" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="14." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo89" Left="71.81102362" Top="21.77953" Width="101.29134835" Height="77.55906" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="Лицо, поместившее товары на таможенный склад" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo90" Left="71.81102362" Top="99.33859" Width="101.29134835" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="3." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo91" Left="694.2047" Top="21.77953" Width="66.45671" Height="77.55906" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="Подпись лица, принявшего товары на хранение" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo92" Left="694.2047" Top="99.33859" Width="66.45671" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="10." ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo6" Left="945.7953" Top="21.77953" Width="86.92912898" Height="26.45669291" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="Количество" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo11" Left="406.36209" Top="21.77953" Width="86.17322591" Height="26.45669291" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="Количество" ParentFont="False" VAlign="vaCenter"/>
    </TfrxPageHeader>
    <TfrxDetailData Name="DetailData1" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Height="27.28355" Left="0" ParentFont="False" Top="370.39394" Width="1062.04793" OnBeforePrint="DetailData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="ds_KRD_COMM_2" DataSetName="KRD_COMM_2" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo24" Left="3.77953" Top="0" Width="28" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[vLinePrint]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo25" Left="31.77953" Top="0" Width="40" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[vStoreDate]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo30" Left="173.00773" Top="0" Width="114.23624" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Memo.Text="[KRD_COMM_2.&#34;G312&#34;]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo37" Left="406.36209" Top="0" Width="39.33859" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[dQtyAtStoreG311]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo43" Left="760.66141" Top="0" Width="59.33859" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[vOutDate]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo46" Left="287.21274" Top="0" Width="119.055118110236" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[vDONum]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo22" Left="71.81102362" Top="0" Width="101.29134835" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Memo.Text="[vOwner]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo47" Left="445.70068" Top="0" Width="46.86613929" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[dQtyAtStoreG35]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo48" Left="945.7953" Top="0" Width="39.33859" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[sRelAtPeriodG311]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo49" Left="985.13389" Top="0" Width="47.55906" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" Memo.Text="[sRelAtPeriodG35]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo10" Left="492.5671" Top="0" Width="106.58267717" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Memo.Text="[TransDocNames]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo15" Left="599.08658" Top="0" Width="95.2440774" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Memo.Text="[KRD_COMM_2.&#34;BOXNO&#34;]" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo20" Left="694.2047" Top="0" Width="66.45671" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Memo.Text="" ParentFont="False" VAlign="vaCenter"/>
      <TfrxMemoView Name="Memo21" Left="820" Top="0" Width="125.7953" Height="27.21259843" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" Frame.Typ="15" Memo.Text="[vGTD]" ParentFont="False" VAlign="vaCenter"/>
    </TfrxDetailData>
    <TfrxPageFooter Name="PageFooter1" Height="30" Left="0" Top="491.3389" Width="1062.04793">
      <TfrxMemoView Name="Memo9" Left="852" Top="8.00000000000006" Width="196" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haRight" Memo.Text="Страница [PAGE#]" ParentFont="False"/>
      <TfrxMemoView Name="Memo7" Left="191.02018547" Top="8.00000000000006" Width="660" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" HAlign="haCenter" Memo.Text="ВЭД-Склад   Copyright (C) ООО &#34;СТМ&#34;,1999-[FORMATDATETIME(&#34;YYYY&#34;, DATE)].            Internet: www.ctm.ru" ParentFont="False" VAlign="vaCenter"/>
      <TfrxLineView Name="Line2" Left="5" Top="4.00000000000006" Width="1050" Height="0" Frame.Typ="4" Frame.Width="2"/>
      <TfrxMemoView Name="Memo8" Left="12" Top="8.00000000000006" Width="176" Height="18" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="3" Memo.Text="[Date] [Time]" ParentFont="False"/>
    </TfrxPageFooter>
    <TfrxFooter Name="Footer1" Height="0" Left="0" Top="347.71676" Width="1062.04793" OnBeforePrint="Footer1OnBeforePrint"/>
  </TfrxReportPage>
</TfrxReport>
