<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.6.78" DotMatrixReport="False" EngineOptions.ConvertNulls="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38264.3669390162" ReportOptions.Description.Text="" ReportOptions.Name="Отчетность о товарах (прил.3 пр. № 236)" ReportOptions.LastChange="40450.6387099653" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;&#13;&#10;&#13;&#10;  StoreDocsBlock, CustomDocsOnly, AistCompatible:Integer;&#13;&#10;  vUseStoreDocs : Boolean;      &#13;&#10;  OnDate, DateStart, DateEnd : string;&#13;&#10;  vLine, vPlaceId: Integer;&#13;&#10;  dtPeriodEnd, dtPeriodStart, RelPeriodStart: TDateTime;&#13;&#10;  sLine, strMonth, strMonthStart, strMonthEnd, strPeriod, vFilterCrit, vFilterCrit2: string;&#13;&#10;  vRelG35, vRelG315A, vRelG35OnStart,&#13;&#10;  vRelG315AOnStart, vRestG35OnStart, vRestG315AOnStart: Double;&#13;&#10;  vRest, vPrihod: string;&#13;&#10;  vNumCardAleination, vReceiver, vRelQuantityAleination,&#13;&#10;  vRelQuantityTrans, vNumCard, vNumLic, vRelQuantityOut,&#13;&#10;  vDocModeOut, vDocNoOut: string;&#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Page1, Engine do&#13;&#10;  begin&#13;&#10;  fldLicExt.Text := '';&#13;&#10;  fldStoreLicNum.Text := '';&#13;&#10;  fldStoreNum.Text := '';&#13;&#10;&#13;&#10;  OnDate:=COMPUTE('INIFILE(&#34;Print&#34;,&#34;PrintOnDate&#34;,&#34;&#34;)');&#13;&#10;  DateStart:=COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;&#34;)');&#13;&#10;  DateEnd := COMPUTE('INIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;&#34;)');&#13;&#10;  dtOnDate.Date := STRTODATEDEF(ondate, DATE);&#13;&#10;  dtFrom.Date := STRTODATEDEF(datestart, DATE);&#13;&#10;  dtTo.Date := STRTODATEDEF(dateend, DATE);&#13;&#10;&#13;&#10;  vPlaceId:=StrToInt(COMPUTE('INIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;1&#34;)'));&#13;&#10;&#13;&#10;  If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;])') then&#13;&#10;    Begin&#13;&#10;       fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;       fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;       lblStoreName.Caption := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;       fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;       cbtnOk.Enabled := True;&#13;&#10;    end&#13;&#10;  else begin&#13;&#10;          vPlaceId:=StrToInt(COMPUTE('INIFILE(&#34;WorkPlace&#34;,&#34;PlaceNum&#34;,&#34;1&#34;)'));&#13;&#10;          If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + STR(vPlaceId) + '&#34;])') then&#13;&#10;             begin&#13;&#10;               fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;               fldStoreNum.Text := '№ склада: ' + &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;               lblStoreName.Caption := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;               fldLicExt.Text := &#60;STORES_2.&#34;LICENCENO_EXT&#34;&#62;;     //   Признак перерегистрации&#13;&#10;               cbtnOk.Enabled := True;&#13;&#10;             end&#13;&#10;          else cbtnOk.Enabled := False&#13;&#10;      end;&#13;&#10;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure rbtnDateOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with rbtnDate, Engine do&#13;&#10;  begin&#13;&#10;   dtOnDate.Enabled := True;&#13;&#10;   dtFrom.Enabled := False;&#13;&#10;   dtTo.Enabled := False;&#13;&#10;   cbxNotInclude.Enabled := False;&#13;&#10;   lblPer.Enabled := False&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure rbtnPeriodOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with rbtnPeriod, Engine do&#13;&#10;  begin&#13;&#10;   dtOnDate.Enabled := False;&#13;&#10;   dtFrom.Enabled := True;&#13;&#10;   dtTo.Enabled := True;&#13;&#10;   cbxNotInclude.Enabled := True;&#13;&#10;   lblPer.Enabled := True&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbtnOkOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with cbtnOk, Engine do&#13;&#10;  begin&#13;&#10;  //Далее см. Params к таблицам&#13;&#10;  //На дату или за период?&#13;&#10;  if rbtnDate.Checked = True then&#13;&#10;    begin&#13;&#10;      dtPeriodEnd := Trunc(dtOnDate.Date) + STRTOTIME('23:59:59');&#13;&#10;      dtPeriodStart := STRTODATE('01.01.1900') + STRTOTIME('00:00:00');&#13;&#10;&#13;&#10;      //Запомним начало периода отчета для выпусков&#13;&#10;      //Для запроса qryRelease - нужно отобрать все выпуски до конца перида без&#13;&#10;      //ограничения начала периода&#13;&#10;      RelPeriodStart := Trunc(dtOnDate.Date) + STRTOTIME('00:00:00');&#13;&#10;&#13;&#10;      //Для печати периода отчета (название месяца)&#13;&#10;      strMonth := FORMATDATETIME(&#34;mmmm&#34;, dtPeriodEnd);&#13;&#10;      if COPY(strMonth, LENGTH(strMonth), 1) = 'т' then&#13;&#10;        strMonth := strMonth + 'а'&#13;&#10;      else&#13;&#10;        strMonth := COPY(strMonth, 1, LENGTH(strMonth)-1) + 'я';&#13;&#10;      strPeriod := 'на &#34; ' + FORMATDATETIME(&#34;dd&#34;, dtPeriodEnd) + ' &#34;   ' + LOWERCASE(strMonth) + '   ' + FORMATDATETIME(&#34;yyyy&#34;, dtPeriodEnd) + ' г.'&#13;&#10;    end&#13;&#10;  else&#13;&#10;    begin&#13;&#10;      dtPeriodEnd := Trunc(dtTo.Date) + STRTOTIME('23:59:59');&#13;&#10;      //Проверим галку &#34;Не включать ранее периода&#34;&#13;&#10;      if cbxNotInclude.Checked = True then&#13;&#10;        dtPeriodStart := Trunc(dtFrom.Date) + STRTOTIME('00:00:00')&#13;&#10;      else&#13;&#10;        dtPeriodStart := STRTODATE('01.01.1900') + STRTOTIME('00:00:01');&#13;&#10;&#13;&#10;      //Запомним начало периода отчета для выпусков&#13;&#10;      //Для запроса qryRelease - нужно отобрать все выпуски до конца перида без&#13;&#10;      //ограничения начала периода (покажем все выпуски, котрые были - не только за период)&#13;&#10;      RelPeriodStart := Trunc(dtFrom.Date) + STRTOTIME('00:00:01');&#13;&#10;&#13;&#10;      //Для печати периода отчета (название месяца)&#13;&#10;      strMonthStart := FORMATDATETIME(&#34;mmmm&#34;, RelPeriodStart);&#13;&#10;      if COPY(strMonthStart, LENGTH(strMonthStart), 1) = 'т' then&#13;&#10;        strMonthStart := strMonthStart + 'а'&#13;&#10;      else&#13;&#10;        strMonthStart := COPY(strMonthStart, 1, LENGTH(strMonthStart)-1) + 'я';&#13;&#10;&#13;&#10;      strMonthEnd := FORMATDATETIME(&#34;mmmm&#34;, dtPeriodEnd);&#13;&#10;      if COPY(strMonthEnd, LENGTH(strMonthEnd), 1) = 'т' then&#13;&#10;        strMonthEnd := strMonthEnd + 'а'&#13;&#10;      else&#13;&#10;        strMonthEnd := COPY(strMonthEnd, 1, LENGTH(strMonthEnd)-1) + 'я';&#13;&#10;&#13;&#10;      strPeriod := 'за период с &#34; ' +&#13;&#10;                   FORMATDATETIME(&#34;dd&#34;, RelPeriodStart) + ' &#34;   ' + LOWERCASE(strMonthStart) + '   ' +&#13;&#10;                   FORMATDATETIME(&#34;yyyy&#34;, RelPeriodStart) + ' г.  по &#34; ' +&#13;&#10;                   FORMATDATETIME(&#34;dd&#34;, dtPeriodEnd) + ' &#34;   ' + LOWERCASE(strMonthEnd) + '   ' +&#13;&#10;                   FORMATDATETIME(&#34;yyyy&#34;, dtPeriodEnd) + ' г.'&#13;&#10;    end;&#13;&#10;                          &#13;&#10;  vFilterCrit := &#34;Select * FROM KRD_MAIN WHERE &#34;;&#13;&#10;  vFilterCrit := vFilterCrit + 'PLACEID = ' + CHR(39) + STR(vPlaceId) + CHR(39) +&#13;&#10;          ' AND BD_DATE &#62;= ' + CHR(39) + STR(dtPeriodStart) + CHR(39) +&#13;&#10;          ' AND BD_DATE &#60;= ' + CHR(39) + STR(dtPeriodEnd) + CHR(39);&#13;&#10;&#13;&#10;  vFilterCrit := vFilterCrit + ' Order by BD_DATE, NBD';&#13;&#10;                &#13;&#10;  qryMain.SQL.Clear;&#13;&#10;  qryMain.SQL.Add(vFilterCrit);&#13;&#10;  qryMain.Active:=True;&#13;&#10;  COMPUTE('SETRANGE(&#34;STORES_2&#34;, [&#34;' + IntToStr(vPlaceId) + '&#34;])');&#13;&#10;&#13;&#10;  //сохраняем настройки&#13;&#10;  Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PrintOnDate&#34;,&#34;'+DATETOSTR(dtOnDate.Date)+'&#34;)');&#13;&#10;  Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodStart&#34;,&#34;'+DATETOSTR(dtFrom.Date)+'&#34;)');&#13;&#10;  Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PeriodEnd&#34;,&#34;'+DATETOSTR(dtTo.Date)+'&#34;)');&#13;&#10;  Compute('WRITEINIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;'+IntToStr(vPlaceId)+'&#34;)');&#13;&#10; end  &#13;&#10;  end;&#13;&#10;&#13;&#10;procedure btnCallRefOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE(' globalvar (&#34;strStoreNumLic&#34;,String)');&#13;&#10;  COMPUTE(' globalvar (&#34;strStoreNum&#34;,String)');&#13;&#10;  COMPUTE(' globalvar (&#34;strStoreName&#34;,String)');&#13;&#10;  COMPUTE(' globalvar (&#34;strLicExt&#34;,String)');&#13;&#10;  COMPUTE(' globalvar (&#34;sPlaceId&#34;,Integer)');&#13;&#10;  COMPUTE('OPENQUERY (&#34;Stors&#34;, &#34;STS_DB&#34;, &#34;Select * from STORES&#34;)');&#13;&#10;&#13;&#10;&#13;&#10;  COMPUTE('SelectValues(&#34;Список складов&#34;, &#34;Stors&#34;,[[&#34;LICENCENO&#34;,   &#34;Номер лицензии&#34;, 15],[&#34;LICENCENO_EXT&#34;,   &#34; &#34;, 1],[&#34;STORE_NO&#34;,   &#34;Номер склада&#34;, 15],[&#34;NAME&#34;,   &#34;Название склада&#34;, 30],[&#34;PlaceId&#34;,   &#34;&#34;, 10]],[[&#34;LICENCENO&#34;, &#34;strStoreNumLic&#34;],[&#34;STORE_NO&#34;, &#34;strStoreNum&#34;],[&#34;NAME&#34;, &#34;strStoreName&#34;],[&#34;LICENCENO_EXT&#34;, &#34;strLicExt&#34;],[&#34;PlaceId&#34;, &#34;sPlaceId&#34;],],&#34;&#34;, &#34;STS_DB&#34;)');&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;  fldStoreLicNum.Text := COMPUTE('Value(&#34;strStoreNumLic&#34;)') ;      //   номер лицензии&#13;&#10;  fldStoreNum.Text := '№ склада: ' + COMPUTE('value(&#34;strStoreNum&#34;)') ; //   номер склада&#13;&#10;  lblStoreName.Caption := COMPUTE('Value(&#34;strStoreName&#34;)') ;     //   название склада&#13;&#10;  fldLicExt.Text := COMPUTE('Value(&#34;strLIcExt&#34;)');     //   Признак перерегистрации&#13;&#10;  vPlaceId := StrToInt(COMPUTE('Value(&#34;sPlaceId&#34;)'));&#13;&#10;  cbtnOk.Enabled := True&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');&#13;&#10;  COMPUTE('SETRANGE(&#34;KRD_COMM_2&#34;, [&#34;' + STR(&#60;qryMAIN.&#34;PLACEID&#34;&#62;) +&#13;&#10;                               '&#34;, &#34;' + STR(&#60;qryMAIN.&#34;ID&#34;&#62;) + '&#34;])');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  vLine := 0;&#13;&#10;  sLine := '';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Band3OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  COMPUTE('CANCELRANGE(&#34;STORES_2&#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;KRD_COMM_2&#34;)');&#13;&#10;&#13;&#10;  COMPUTE('SETFILTER(&#34;REL_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;REL_MAIN_2&#34;)');&#13;&#10;&#13;&#10;  COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;REL_COMM_2&#34;)');&#13;&#10;&#13;&#10;  COMPUTE('SETFILTER(&#34;OUT_MAIN_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;OUT_MAIN_2&#34;)');&#13;&#10;&#13;&#10;  COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;OUT_COMM_2&#34;)');&#13;&#10;&#13;&#10;  COMPUTE('SETFILTER(&#34;IN_COMM_2&#34;, &#34;&#34;)');&#13;&#10;  COMPUTE('CANCELRANGE(&#34;IN_COMM_2&#34;)');      &#13;&#10;&#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DetailData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with DetailData1, Engine do&#13;&#10;  begin&#13;&#10;  vRelG35 := 0;&#13;&#10;  vRelG315A := 0;&#13;&#10;  vRelG35OnStart := 0;&#13;&#10;  vRelG315AOnStart := 0;&#13;&#10;  vRestG35OnStart := 0;&#13;&#10;  vRestG315AOnStart := 0;&#13;&#10;&#13;&#10;  vRest := '';&#13;&#10;&#13;&#10;      &#13;&#10;&#13;&#10;  COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;&#34;)');&#13;&#10;  vFilterCrit := 'PLACEID = ' + CHR(39) + STR(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + CHR(39) +&#13;&#10;                 ' AND ID = ' + CHR(39) + STR(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + CHR(39) +&#13;&#10;                ' AND G32 = ' + CHR(39) + STR(&#60;KRD_COMM_2.&#34;G32&#34;&#62;) + CHR(39);&#13;&#10;  COMPUTE('SETFILTER(&#34;REL_COMM_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;    &#13;&#10;  COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;&#34;)');&#13;&#10;  vFilterCrit := 'PLACEID = ' + CHR(39) + STR(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + CHR(39) +&#13;&#10;                 ' AND ID = ' + CHR(39) + STR(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + CHR(39) +&#13;&#10;                ' AND G32 = ' + CHR(39) + STR(&#60;KRD_COMM_2.&#34;G32&#34;&#62;) + CHR(39);&#13;&#10;  COMPUTE('SETFILTER(&#34;OUT_COMM_2&#34;, &#34;' + vFilterCrit + '&#34;)');&#13;&#10;&#13;&#10;     //Для отчуждения&#13;&#10;  vNumCardAleination := '';        //Номер формуляра&#13;&#10;  vReceiver := '';                 //Получатель&#13;&#10;  vRelQuantityAleination := '';&#13;&#10;&#13;&#10;  //Для перемещения&#13;&#10;  vRelQuantityTrans := '';&#13;&#10;  vNumCard := '';                  //Номер формуляра&#13;&#10;  vNumLic := '';                   //№ лицензии СВХ куда перемещаем&#13;&#10;&#13;&#10;  //Для выпуска&#13;&#10;  vRelQuantityOut := '';&#13;&#10;  vDocModeOut := '';&#13;&#10;  vDocNoOut := '';      &#13;&#10;  &#13;&#10;   if vUseStoreDocs then&#13;&#10;   begin&#13;&#10;    COMPUTE('FIRST(&#34;OUT_COMM_2&#34;)');&#13;&#10;        if &#60;Out_COMM_2.&#34;PlaceID&#34;&#62; &#60;&#62; Null then&#13;&#10;        begin&#13;&#10;        COMPUTE('FIRST(&#34;OUT_COMM_2&#34;)');  &#13;&#10;           while COMPUTE('EOF(&#34;OUT_COMM_2&#34;)') = '0' do&#13;&#10;           begin&#13;&#10;&#13;&#10;            COMPUTE('CANCELRANGE(&#34;OUT_MAIN_2&#34;)');&#13;&#10;            COMPUTE('SETRANGE(&#34;OUT_MAIN_2&#34;, [&#34;' + STR(&#60;OUT_COMM_2.&#34;PLACEID&#34;&#62;) +&#13;&#10;                                  '&#34;, &#34;' + STR(&#60;OUT_COMM_2.&#34;ID&#34;&#62;) +&#13;&#10;                                  '&#34;, &#34;' + STR(&#60;OUT_COMM_2.&#34;ACTOUTID&#34;&#62;) + '&#34;])');&#13;&#10;                if &#60;OUT_MAIN_2.&#34;G542&#34;&#62; &#60;= dtPeriodEnd then&#13;&#10;                begin                              &#13;&#10;                   vRelG35 := vRelG35 + iif(&#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;&#60;&#62;NULL,&#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;,0);&#13;&#10;                   vRelG315A := vRelG315A + iif(&#60;OUT_COMM_2.&#34;OUT_G315A&#34;&#62;&#60;&#62;NULL,&#60;OUT_COMM_2.&#34;OUT_G315A&#34;&#62;,0);&#13;&#10;&#13;&#10;                    //Если в &#34;Режиме&#34; выпуска стоит &#34;ОТЧУЖДЕНИЕ&#34;, &#34;по любому&#34; пишем в отчужденные&#13;&#10;                    //несмотря на ТТ/ДКД&#13;&#10;                    if UPPERCASE(&#60;OUT_MAIN_2.&#34;REMARK&#34;&#62;)= &#34;ОТЧУЖДЕНИЕ&#34; then&#13;&#10;                    begin&#13;&#10;                       if vNumCardAleination &#60;&#62; '' then&#13;&#10;                          vNumCardAleination := vNumCardAleination + CHR(13) + CHR(10) + STR(&#60;OUT_MAIN_2.&#34;NDA&#34;&#62;)&#13;&#10;                       else&#13;&#10;                       vNumCardAleination := STR(&#60;OUT_COMM_2.&#34;ND_GTD&#34;&#62;);&#13;&#10;                         &#13;&#10;                       if vReceiver &#60;&#62; '' then&#13;&#10;                       vReceiver := vReceiver + CHR(13) + CHR(10) + STR(&#60;KRD_MAIN_2.&#34;G082&#34;&#62;)&#13;&#10;                       else&#13;&#10;                       vReceiver := STR(&#60;KRD_MAIN_2.&#34;G082&#34;&#62;);&#13;&#10;                         &#13;&#10;                       if vRelQuantityAleination &#60;&#62; '' then&#13;&#10;                       begin&#13;&#10;                        if (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) and (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; NULL) then&#13;&#10;                        vRelQuantityAleination := vRelQuantityAleination + CHR(13) + CHR(10) + STR(&#60;OUT_COMM_2.&#34;OUT_G315A&#34;&#62;) + ' ' + STR(&#60;OUT_COMM_2.&#34;OUT_G315&#34;&#62;)&#13;&#10;                        else&#13;&#10;                        vRelQuantityAleination := vRelQuantityAleination + CHR(13) + CHR(10) + STR(&#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;) + ' КГ';&#13;&#10;                       end&#13;&#10;                       else&#13;&#10;                       begin&#13;&#10;                        if (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) and (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; NULL) then&#13;&#10;                        vRelQuantityAleination := STR(&#60;OUT_COMM_2.&#34;OUT_G315A&#34;&#62;) + ' ' + STR(&#60;OUT_COMM_2.&#34;OUT_G315&#34;&#62;)&#13;&#10;                        else&#13;&#10;                        vRelQuantityAleination := STR(&#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;) + ' КГ';&#13;&#10;                       end&#13;&#10;                    end&#13;&#10;                    else //Затем смотрим на ТТ/ДКД&#13;&#10;                    if ISWORDPRESENT(&#60;OUT_COMM_2.&#34;DOC_TYPE&#34;&#62;, &#34;ТТ|ДКД&#34;, &#34;|&#34;) then&#13;&#10;                    begin&#13;&#10;                         &#13;&#10;                        if vRelQuantityTrans &#60;&#62; '' then&#13;&#10;                        begin&#13;&#10;                         if (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) and (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; NULL) then&#13;&#10;                         vRelQuantityTrans := vRelQuantityTrans + CHR(13) + CHR(10) + STR(&#60;OUT_COMM_2.&#34;OUT_G315A&#34;&#62;) + ' ' + STR(&#60;OUT_COMM_2.&#34;OUT_G315&#34;&#62;)&#13;&#10;                         else&#13;&#10;                         vRelQuantityTrans := vRelQuantityTrans + CHR(13) + CHR(10) + STR(&#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;) + ' КГ';&#13;&#10;                        end&#13;&#10;                        else&#13;&#10;                        begin&#13;&#10;                         if (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) and (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; NULL) then&#13;&#10;                         vRelQuantityTrans := STR(&#60;OUT_COMM_2.&#34;OUT_G315A&#34;&#62;) + ' ' + STR(&#60;OUT_COMM_2.&#34;OUT_G315&#34;&#62;)&#13;&#10;                         else&#13;&#10;                         vRelQuantityTrans := STR(&#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;) + ' КГ';&#13;&#10;                        end;&#13;&#10;                           &#13;&#10;                        if vNumCard &#60;&#62; '' then&#13;&#10;                        vNumCard := vNumCard + CHR(13) + CHR(10) + STR(&#60;OUT_COMM_2.&#34;ND_GTD&#34;&#62;)&#13;&#10;                        else&#13;&#10;                        vNumCard := STR(&#60;OUT_COMM_2.&#34;ND_GTD&#34;&#62;);&#13;&#10;                          &#13;&#10;                        {if vNumLic &#60;&#62; '' then&#13;&#10;                        vNumLic := vNumLic + CHR(13) + CHR(10) + STR(&#60;OUT_MAIN_2.&#34;DOC_MODE&#34;&#62;)&#13;&#10;                        else&#13;&#10;                        vNumLic := STR(&#60;REL_MAIN_2.&#34;DOC_MODE&#34;&#62;);}  &#13;&#10;                    end&#13;&#10;                    else&#13;&#10;                    begin //И уж потом обычный выпуск&#13;&#10;                        if vRelQuantityOut &#60;&#62; '' then&#13;&#10;                         begin&#13;&#10;                          if (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) and (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; NULL) then&#13;&#10;                          vRelQuantityOut := vRelQuantityOut + CHR(13) + CHR(10) + STR(&#60;OUT_COMM_2.&#34;OUT_G315A&#34;&#62;) + &#34; &#34; + STR(&#60;OUT_COMM_2.&#34;OUT_G315&#34;&#62;)&#13;&#10;                          else&#13;&#10;                          vRelQuantityOut := vRelQuantityOut + CHR(13) + CHR(10) + STR(&#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;) + ' КГ';&#13;&#10;                         end&#13;&#10;                         else&#13;&#10;                         begin&#13;&#10;                          if (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) and (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; NULL) then&#13;&#10;                          vRelQuantityOut := STR(&#60;OUT_COMM_2.&#34;OUT_G315A&#34;&#62;) + &#34; &#34; + STR(&#60;OUT_COMM_2.&#34;OUT_G315&#34;&#62;)&#13;&#10;                          else&#13;&#10;                          vRelQuantityOut := STR(&#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;) + ' КГ';&#13;&#10;                            &#13;&#10;                         end;&#13;&#10;                         if vDocNoOut &#60;&#62; '' then&#13;&#10;                           vDocNoOut := vDocNoOut + CHR(13) + CHR(10) + STR(&#60;OUT_COMM_2.&#34;ND_GTD&#34;&#62;)&#13;&#10;                         else&#13;&#10;                           vDocNoOut := STR(&#60;OUT_COMM_2.&#34;ND_GTD&#34;&#62;);  &#13;&#10;                                                 &#13;&#10;                         if vDocModeOut &#60;&#62; '' then&#13;&#10;                           vDocModeOut := vDocModeOut + CHR(13) + CHR(10) + STR(&#60;OUT_COMM_2.&#34;DOC_MODE&#34;&#62;)&#13;&#10;                         else&#13;&#10;                           vDocModeOut := STR(&#60;OUT_COMM_2.&#34;DOC_MODE&#34;&#62;);&#13;&#10;                           &#13;&#10;                    end;&#13;&#10;&#13;&#10;                end;&#13;&#10;&#13;&#10;               if &#60;OUT_MAIN_2.&#34;G542&#34;&#62; &#60; RelPeriodStart then&#13;&#10;                begin&#13;&#10;                 vRelG35OnStart := vRelG35OnStart + iif(&#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;&#60;&#62;NULL,&#60;OUT_COMM_2.&#34;OUT_G35&#34;&#62;,0);&#13;&#10;                 vRelG315AOnStart := vRelG315AOnStart + iif(&#60;OUT_COMM_2.&#34;OUT_G315A&#34;&#62;&#60;&#62;NULL,&#60;OUT_COMM_2.&#34;OUT_G315A&#34;&#62;,0);&#13;&#10;                end;&#13;&#10;               //showmessage(vDocNoOut);                        &#13;&#10;               //showmessage(vNumCard);  &#13;&#10;            COMPUTE('CANCELRANGE(&#34;OUT_MAIN_2&#34;)');&#13;&#10;&#13;&#10;            COMPUTE('NEXT(&#34;OUT_COMM_2&#34;)');&#13;&#10;           end;  &#13;&#10;        end&#13;&#10;        else begin&#13;&#10;        Release2 ();&#13;&#10;        end;                                       &#13;&#10;   end&#13;&#10;   else begin&#13;&#10;   Release2 ();                               &#13;&#10;   end;                      &#13;&#10;       &#13;&#10;&#13;&#10;           &#13;&#10;&#13;&#10;&#13;&#10; &#13;&#10;&#13;&#10;  //Приход и остаток&#13;&#10;  COMPUTE('SETFILTER(&#34;IN_COMM_2&#34;, &#34;&#34;)');&#13;&#10;  vFilterCrit2 := 'PLACEID = ' + CHR(39) + STR(&#60;KRD_COMM_2.&#34;PLACEID&#34;&#62;) + CHR(39) +&#13;&#10;                 ' AND ID = ' + CHR(39) + STR(&#60;KRD_COMM_2.&#34;ID&#34;&#62;) + CHR(39) +&#13;&#10;                ' AND G32 = ' + CHR(39) + STR(&#60;KRD_COMM_2.&#34;G32&#34;&#62;) + CHR(39);&#13;&#10;  COMPUTE('SETFILTER(&#34;IN_COMM_2&#34;, &#34;' + vFilterCrit2 + '&#34;)');&#13;&#10;  COMPUTE('FIRST(&#34;IN_COMM_2&#34;)');      &#13;&#10;   if (&#60;IN_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; NULL) and (&#60;IN_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) then&#13;&#10;    begin&#13;&#10;      vPrihod := STR(&#60;IN_COMM_2.&#34;G315A&#34;&#62; ) + ' ' + &#60;KRD_COMM_2.&#34;G315&#34;&#62;;                                       &#13;&#10;      vRest := STR(&#60;IN_COMM_2.&#34;G315A&#34;&#62; - vRelG315A) + ' ' + &#60;KRD_COMM_2.&#34;G315&#34;&#62;;&#13;&#10;      vRestG315AOnStart := &#60;IN_COMM_2.&#34;G315A&#34;&#62; - vRelG315AOnStart;&#13;&#10;    end  &#13;&#10;   else if (&#60;IN_COMM_2.&#34;G35&#34;&#62; &#60;&#62; NULL) and (&#60;IN_COMM_2.&#34;G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;    begin&#13;&#10;      vPrihod :=  STR(&#60;IN_COMM_2.&#34;G35&#34;&#62;) + ' КГ';             &#13;&#10;      vRest := STR(&#60;IN_COMM_2.&#34;G35&#34;&#62; - vRelG35) + ' КГ';&#13;&#10;      vRestG35OnStart := &#60;IN_COMM_2.&#34;G35&#34;&#62; - vRelG35OnStart;&#13;&#10;    end     &#13;&#10;   &#13;&#10;   else&#13;&#10;   if (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; NULL) and (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) then&#13;&#10;    begin&#13;&#10;      vPrihod := STR(&#60;KRD_COMM_2.&#34;G315A&#34;&#62;) + ' ' + &#60;KRD_COMM_2.&#34;G315&#34;&#62;;                &#13;&#10;      vRest := STR(&#60;KRD_COMM_2.&#34;G315A&#34;&#62; - vRelG315A) + ' ' + &#60;KRD_COMM_2.&#34;G315&#34;&#62;;&#13;&#10;      vRestG315AOnStart := &#60;KRD_COMM_2.&#34;G315A&#34;&#62; - vRelG315AOnStart;&#13;&#10;    end&#13;&#10;  else&#13;&#10;    begin&#13;&#10;      if (&#60;KRD_COMM_2.&#34;G35&#34;&#62; &#60;&#62; NULL) and (&#60;KRD_COMM_2.&#34;G35&#34;&#62; &#60;&#62; 0) then&#13;&#10;        begin&#13;&#10;          vPrihod := STR(&#60;KRD_COMM_2.&#34;G35&#34;&#62;) + ' КГ';              &#13;&#10;          vRest := STR(&#60;KRD_COMM_2.&#34;G35&#34;&#62; - vRelG35) + ' КГ';&#13;&#10;          vRestG35OnStart := &#60;KRD_COMM_2.&#34;G35&#34;&#62; - vRelG35OnStart;&#13;&#10;        end&#13;&#10;      else&#13;&#10;        begin&#13;&#10;          vPrihod := '0';                         &#13;&#10;          vRest := '0';&#13;&#10;          vRestG315AOnStart := 0;&#13;&#10;        end;&#13;&#10;        //showmessage(vRest);                                      &#13;&#10;     COMPUTE('NEXT(&#34;IN_COMM_2&#34;)');              &#13;&#10;    end;&#13;&#10;&#13;&#10;  //Установим видимость в зависимости от остатков на начало периода, т.к. нужно печатать те которые выпущены в течение периода&#13;&#10;  if (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) and (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; NULL) then&#13;&#10;    begin&#13;&#10;      if vRestG315AOnStart &#62; 0 then&#13;&#10;        DetailData1.Visible := True&#13;&#10;      else&#13;&#10;        DetailData1.Visible := False;&#13;&#10;    end&#13;&#10;  else&#13;&#10;    begin&#13;&#10;      if vRestG35OnStart &#62; 0 then&#13;&#10;        DetailData1.Visible := True&#13;&#10;      else&#13;&#10;        DetailData1.Visible := False;&#13;&#10;    end;   &#13;&#10;end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Release2;      &#13;&#10;begin&#13;&#10;COMPUTE('FIRST(&#34;REL_COMM_2&#34;)');  &#13;&#10;           while COMPUTE('EOF(&#34;REL_COMM_2&#34;)') = '0' do&#13;&#10;           begin&#13;&#10;&#13;&#10;            COMPUTE('CANCELRANGE(&#34;REL_MAIN_2&#34;)');&#13;&#10;            COMPUTE('SETRANGE(&#34;REL_MAIN_2&#34;, [&#34;' + STR(&#60;REL_COMM_2.&#34;PLACEID&#34;&#62;) +&#13;&#10;                                  '&#34;, &#34;' + STR(&#60;REL_COMM_2.&#34;ID&#34;&#62;) +&#13;&#10;                                  '&#34;, &#34;' + STR(&#60;REL_COMM_2.&#34;COUNTER&#34;&#62;) + '&#34;])');&#13;&#10;                if &#60;REL_MAIN_2.&#34;RELEASE_DATE&#34;&#62; &#60;= dtPeriodEnd then&#13;&#10;                begin                              &#13;&#10;                   vRelG35 := vRelG35 + iif(&#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;&#60;&#62;NULL,&#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;,0);&#13;&#10;                   vRelG315A := vRelG315A + iif(&#60;REL_COMM_2.&#34;RELEASE_G315A&#34;&#62;&#60;&#62;NULL,&#60;REL_COMM_2.&#34;RELEASE_G315A&#34;&#62;,0);&#13;&#10;&#13;&#10;                    //Если в &#34;Режиме&#34; выпуска стоит &#34;ОТЧУЖДЕНИЕ&#34;, &#34;по любому&#34; пишем в отчужденные&#13;&#10;                    //несмотря на ТТ/ДКД&#13;&#10;                    if UPPERCASE(&#60;REL_MAIN_2.&#34;DOC_MODE&#34;&#62;)= &#34;ОТЧУЖДЕНИЕ&#34; then&#13;&#10;                    begin&#13;&#10;                       if vNumCardAleination &#60;&#62; '' then&#13;&#10;                          vNumCardAleination := vNumCardAleination + CHR(13) + CHR(10) + STR(&#60;REL_MAIN_2.&#34;RELEASE_NO&#34;&#62;)&#13;&#10;                       else&#13;&#10;                       vNumCardAleination := STR(&#60;REL_MAIN_2.&#34;RELEASE_NO&#34;&#62;);&#13;&#10;                         &#13;&#10;                       if vReceiver &#60;&#62; '' then&#13;&#10;                       vReceiver := vReceiver + CHR(13) + CHR(10) + STR(&#60;KRD_MAIN_2.&#34;G082&#34;&#62;)&#13;&#10;                       else&#13;&#10;                       vReceiver := STR(&#60;KRD_MAIN_2.&#34;G082&#34;&#62;);&#13;&#10;                         &#13;&#10;                       if vRelQuantityAleination &#60;&#62; '' then&#13;&#10;                       begin&#13;&#10;                        if (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) and (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; NULL) then&#13;&#10;                        vRelQuantityAleination := vRelQuantityAleination + CHR(13) + CHR(10) + STR(&#60;REL_COMM_2.&#34;RELEASE_G315A&#34;&#62;) + ' ' + STR(&#60;REL_COMM_2.&#34;RELEASE_G315&#34;&#62;)&#13;&#10;                        else&#13;&#10;                        vRelQuantityAleination := vRelQuantityAleination + CHR(13) + CHR(10) + STR(&#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;) + ' КГ';&#13;&#10;                       end&#13;&#10;                       else&#13;&#10;                       begin&#13;&#10;                        if (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) and (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; NULL) then&#13;&#10;                        vRelQuantityAleination := STR(&#60;REL_COMM_2.&#34;RELEASE_G315A&#34;&#62;) + ' ' + STR(&#60;REL_COMM_2.&#34;RELEASE_G315&#34;&#62;)&#13;&#10;                        else&#13;&#10;                        vRelQuantityAleination := STR(&#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;) + ' КГ';&#13;&#10;                       end&#13;&#10;                    end&#13;&#10;                    else //Затем смотрим на ТТ/ДКД&#13;&#10;                    if ISWORDPRESENT(&#60;REL_MAIN_2.&#34;DOC_TYPE&#34;&#62;, &#34;ТТ|ДКД&#34;, &#34;|&#34;) then&#13;&#10;                    begin&#13;&#10;                         &#13;&#10;                        if vRelQuantityTrans &#60;&#62; '' then&#13;&#10;                        begin&#13;&#10;                         if (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) and (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; NULL) then&#13;&#10;                         vRelQuantityTrans := vRelQuantityTrans + CHR(13) + CHR(10) + STR(&#60;REL_COMM_2.&#34;RELEASE_G315A&#34;&#62;) + ' ' + STR(&#60;REL_COMM_2.&#34;RELEASE_G315&#34;&#62;)&#13;&#10;                         else&#13;&#10;                         vRelQuantityTrans := vRelQuantityTrans + CHR(13) + CHR(10) + STR(&#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;) + ' КГ';&#13;&#10;                        end&#13;&#10;                        else&#13;&#10;                        begin&#13;&#10;                         if (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) and (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; NULL) then&#13;&#10;                         vRelQuantityTrans := STR(&#60;REL_COMM_2.&#34;RELEASE_G315A&#34;&#62;) + ' ' + STR(&#60;REL_COMM_2.&#34;RELEASE_G315&#34;&#62;)&#13;&#10;                         else&#13;&#10;                         vRelQuantityTrans := STR(&#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;) + ' КГ';&#13;&#10;                        end;&#13;&#10;                           &#13;&#10;                        if vNumCard &#60;&#62; '' then&#13;&#10;                        vNumCard := vNumCard + CHR(13) + CHR(10) + STR(&#60;REL_MAIN_2.&#34;RELEASE_NO&#34;&#62;)&#13;&#10;                        else&#13;&#10;                        vNumCard := STR(&#60;REL_MAIN_2.&#34;RELEASE_NO&#34;&#62;);&#13;&#10;                          &#13;&#10;                        if vNumLic &#60;&#62; '' then&#13;&#10;                        vNumLic := vNumLic + CHR(13) + CHR(10) + STR(&#60;REL_MAIN_2.&#34;DOC_MODE&#34;&#62;)&#13;&#10;                        else&#13;&#10;                        vNumLic := STR(&#60;REL_MAIN_2.&#34;DOC_MODE&#34;&#62;);&#13;&#10;                    end&#13;&#10;                    else&#13;&#10;                    begin //И уж потом обычный выпуск&#13;&#10;                        if vRelQuantityOut &#60;&#62; '' then&#13;&#10;                         begin&#13;&#10;                          if (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) and (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; NULL) then&#13;&#10;                          vRelQuantityOut := vRelQuantityOut + CHR(13) + CHR(10) + STR(&#60;REL_COMM_2.&#34;RELEASE_G315A&#34;&#62;) + &#34; &#34; + STR(&#60;REL_COMM_2.&#34;RELEASE_G315&#34;&#62;)&#13;&#10;                          else&#13;&#10;                          vRelQuantityOut := vRelQuantityOut + CHR(13) + CHR(10) + STR(&#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;) + ' КГ';&#13;&#10;                         end&#13;&#10;                         else&#13;&#10;                         begin&#13;&#10;                          if (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; 0) and (&#60;KRD_COMM_2.&#34;G315A&#34;&#62; &#60;&#62; NULL) then&#13;&#10;                          vRelQuantityOut := STR(&#60;REL_COMM_2.&#34;RELEASE_G315A&#34;&#62;) + &#34; &#34; + STR(&#60;REL_COMM_2.&#34;RELEASE_G315&#34;&#62;)&#13;&#10;                          else&#13;&#10;                          vRelQuantityOut := STR(&#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;) + ' КГ';&#13;&#10;                         end;&#13;&#10;                           &#13;&#10;                         if vDocModeOut &#60;&#62; '' then&#13;&#10;                         vDocModeOut := vDocModeOut + CHR(13) + CHR(10) + STR(&#60;REL_MAIN_2.&#34;DOC_MODE&#34;&#62;)&#13;&#10;                         else&#13;&#10;                         vDocModeOut := STR(&#60;REL_MAIN_2.&#34;DOC_MODE&#34;&#62;);&#13;&#10;                           &#13;&#10;                         if vDocNoOut &#60;&#62; '' then&#13;&#10;                         vDocNoOut := vDocNoOut + CHR(13) + CHR(10) + STR(&#60;REL_MAIN_2.&#34;DOC_NO&#34;&#62;)&#13;&#10;                         else&#13;&#10;                         vDocNoOut := STR(&#60;REL_MAIN_2.&#34;DOC_NO&#34;&#62;);&#13;&#10;                    end;&#13;&#10;&#13;&#10;                end;&#13;&#10;&#13;&#10;               if &#60;REL_MAIN_2.&#34;RELEASE_DATE&#34;&#62; &#60; RelPeriodStart then&#13;&#10;                begin&#13;&#10;                 vRelG35OnStart := vRelG35OnStart + iif(&#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;&#60;&#62;NULL,&#60;REL_COMM_2.&#34;RELEASE_G35&#34;&#62;,0);&#13;&#10;                 vRelG315AOnStart := vRelG315AOnStart + iif(&#60;REL_COMM_2.&#34;RELEASE_G315A&#34;&#62;&#60;&#62;NULL,&#60;REL_COMM_2.&#34;RELEASE_G315A&#34;&#62;,0);&#13;&#10;                end;&#13;&#10;                //showmessage(vRelQuantityOut);                            &#13;&#10;            COMPUTE('CANCELRANGE(&#34;REL_MAIN_2&#34;)');&#13;&#10;&#13;&#10;            COMPUTE('NEXT(&#34;REL_COMM_2&#34;)');&#13;&#10;           end;  &#13;&#10;    &#13;&#10;end;          &#13;&#10;&#13;&#10;  &#13;&#10;procedure Memo37OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Memo37, Engine do&#13;&#10;  begin&#13;&#10;  sLine := '';&#13;&#10;  if DetailData1.Visible = True then&#13;&#10;    begin&#13;&#10;      vLine := vLine + 1;&#13;&#10;      sLine := STR(vLine);&#13;&#10;    end&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;begin&#13;&#10;  &#13;&#10;  CustomDocsOnly := StrToInt(IniFile('RegBook', 'CustomsDocsOnly', '0'));&#13;&#10;  //Отключен ли блок складских документов&#13;&#10;  StoreDocsBlock := StrToInt(IniFile('Database', 'StoreDocsBlock', '0'));&#13;&#10;  AistCompatible := StrToInt(IniFile('Docs', 'AistCompatible', '0')); {включина ли настройка &#34;Совместимость с АИСТом&#34;, 1-да, 0-нет}&#13;&#10;  if (StoreDocsBlock = 1) and ((AistCompatible = 1){ or ((AistCompatible = 0) and (CustomDocsOnly = 0))}) then&#13;&#10;    vUseStoreDocs := True&#13;&#10;  else vUseStoreDocs := False;&#13;&#10;  //showmessage(vUseStoreDocs);                                  &#13;&#10;end." OnStartReport="OnStartReport" PropData="08446174617365747301010C2B00000020446174615365743D2264735F494E5F434F4D4D2220446174615365744E616D653D22494E5F434F4D4D2200010C2F00000020446174615365743D2264735F494E5F434F4D4D5F322220446174615365744E616D653D22494E5F434F4D4D5F322200010C3100000020446174615365743D2264735F4B52445F434F4D4D5F322220446174615365744E616D653D224B52445F434F4D4D5F322200010C3100000020446174615365743D2264735F4B52445F4D41494E5F322220446174615365744E616D653D224B52445F4D41494E5F322200010C3100000020446174615365743D2264735F4F55545F434F4D4D5F322220446174615365744E616D653D224F55545F434F4D4D5F322200010C3100000020446174615365743D2264735F4F55545F4D41494E5F322220446174615365744E616D653D224F55545F4D41494E5F322200010C2800000020446174615365743D227172794D61696E2220446174615365744E616D653D227172794D61696E2200010C3100000020446174615365743D2264735F52454C5F434F4D4D5F322220446174615365744E616D653D2252454C5F434F4D4D5F322200010C3100000020446174615365743D2264735F52454C5F4D41494E5F322220446174615365744E616D653D2252454C5F4D41494E5F322200010C2D00000020446174615365743D2264735F53544F5245535F322220446174615365744E616D653D2253544F5245535F32220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxBDEQuery Name="qryMain" UserName="qryMain" CloseDataSource="True" FieldAliases.Text="" IgnoreDupParams="False" SQL.Text="" DatabaseName="STS_DB" SessionName="Default" PropData="05704C656674023C0470546F7002140A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="Page1" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Отчет по пр. № 236 прил. 3" Height="303" Left="483" Top="176" Width="328" OnActivate="Page1OnBeforePrint">
    <TfrxColorEditControl Name="fldStoreLicNum" Left="94" Top="4" Width="109" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" ReadOnly="True"/>
    <TfrxColorFrameControl Name="frameMain" Left="3" Top="48" Width="312" Height="188" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201"/>
    <TfrxColorFrameControl Name="cfrmPeriod" Left="16" Top="152" Width="292" Height="72" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201"/>
    <TfrxColorFrameControl Name="cfrmDate" Left="16" Top="80" Width="204" Height="44" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Color="-16777201"/>
    <TfrxCheckBoxControl Name="cbxNotInclude" Left="24" Top="188" Width="261" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" Caption="Не включать оформленные ранее" Color="-16777205"/>
    <TfrxLabelControl Name="lblNumLicence" Left="9" Top="6" Width="65" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="№ лицензии:" Color="-16777201"/>
    <TfrxRadioButtonControl Name="rbtnDate" Left="16" Top="60" Width="93" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Дата" Checked="True" Color="-16777201" OnClick="rbtnDateOnBeforePrint"/>
    <TfrxRadioButtonControl Name="rbtnPeriod" Left="16" Top="132" Width="113" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="За период" TabStop="False" Color="-16777201" OnClick="rbtnPeriodOnBeforePrint"/>
    <TfrxLabelControl Name="lblFrom" Left="36" Top="163" Width="11" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="С" Color="-16777201"/>
    <TfrxLabelControl Name="lblTo" Left="164" Top="164" Width="12" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="по" Color="-16777201"/>
    <TfrxLabelControl Name="lblStoreName" Left="7" Top="28" Width="305" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" Alignment="taCenter" AutoSize="False" Caption="ЗАО &#34;КОМИНА&#34;" Color="-16777201"/>
    <TfrxLabelControl Name="lblOn" Left="24" Top="94" Width="30" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Alignment="taRightJustify" AutoSize="False" Caption="На:" Color="-16777201"/>
    <TfrxDateEditControl Name="dtOnDate" Left="60" Top="91" Width="153" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38264" DateFormat="dfLong" Time="38264"/>
    <TfrxDateEditControl Name="dtFrom" Left="52" Top="160" Width="109" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" Color="-16777211" Date="38264" Time="38264"/>
    <TfrxDateEditControl Name="dtTo" Left="184" Top="160" Width="105" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" Color="-16777211" Date="38264" Time="38264"/>
    <TfrxColorButtonControl Name="cbtnOk" Left="160" Top="244" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" Caption="Просмотр" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="1" OnClick="cbtnOkOnBeforePrint"/>
    <TfrxLabelControl Name="lblPer" Left="47" Top="203" Width="198" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" AutoSize="False" Caption="начала периода" Color="-16777201"/>
    <TfrxColorButtonControl Name="cBtnCancel" Left="240" Top="244" Width="75" Height="25" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Отмена" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="2"/>
    <TfrxColorEditControl Name="fldStoreNum" Left="206" Top="4" Width="101" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" ReadOnly="False"/>
    <TfrxColorButtonControl Name="btnCallRef" Left="175" Top="5" Width="27" Height="17" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777201" Flat="False" GradientType="gtTopToBottom" OnClick="btnCallRefOnBeforePrint"/>
    <TfrxColorEditControl Name="fldLicExt" Left="78" Top="4" Width="17" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" ReadOnly="False"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page2" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="8" RightMargin="8" TopMargin="8" BottomMargin="8" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False">
    <TfrxMasterData Name="MasterData1" Height="0" Left="0" Top="502.67749" Width="1062.04793" OnBeforePrint="MasterData1OnBeforePrint" AllowSplit="True" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="qryMain" DataSetName="qryMain" PrintIfDetailEmpty="True" RowCount="0"/>
    <TfrxReportTitle Name="Band2" Height="254" Left="0" Top="18.89765" Width="1062.04793" OnBeforePrint="Band2OnBeforePrint">
      <TfrxMemoView Name="Memo58" Left="490.68" Top="5" Width="96.64" Height="14" ShowHint="False" AutoWidth="True" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћРўР§Р•РўРќРћРЎРўР¬"/>
      <TfrxMemoView Name="Memo62" Align="baCenter" Left="495.423965" Top="106" Width="71.2" Height="18" ShowHint="False" AutoWidth="True" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="5" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[strPeriod]"/>
      <TfrxMemoView Name="Memo63" Left="10.32282" Top="132" Width="20" Height="122" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="в„– Рї/Рї"/>
      <TfrxMemoView Name="Memo64" Left="78.32282" Top="132" Width="64" Height="122" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РќРѕРјРµСЂ С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ РґРѕРєСѓРјРµРЅС‚Р°"/>
      <TfrxMemoView Name="Memo65" Left="142.32282" Top="132" Width="136" Height="122" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РќР°РёРјРµРЅРѕРІР°РЅРёРµ С‚РѕРІР°СЂР°"/>
      <TfrxMemoView Name="Memo80" Left="394.32282" Top="132" Width="205.13389" Height="38" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РўРѕРІР°СЂС‹, РІ РѕС‚РЅРѕС€РµРЅРёРё РєРѕС‚РѕСЂС‹С… С‚Р°РјРѕР¶РµРЅРЅС‹Р№ СЂРµР¶РёРј С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ СЃРєР»Р°РґР° Р·Р°РІРµСЂС€РµРЅ"/>
      <TfrxMemoView Name="Memo83" Left="394.32282" Top="170" Width="56" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РљРѕР»-РІРѕ С‚РѕРІР°СЂРѕРІ РІ РµРґРёРЅРёС†Р°С… РёР·РјРµСЂРµРЅРёСЏ"/>
      <TfrxMemoView Name="Memo2" Left="39" Top="76" Width="1000" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="РќР°Р·РІР°РЅРёРµ СЃРєР»Р°РґР°: [STORES_2.&#34;NAME&#34;]      в„– Р»РёС†РµРЅР·РёРё: [STORES_2.&#34;LICENCENO&#34;]      в„– СЃРєР»Р°РґР°: [STORES_2.&#34;STORE_NO&#34;]"/>
      <TfrxLineView Name="Line1" Left="35" Top="100" Width="1008" Height="0" ShowHint="False" Frame.Typ="4" Frame.Width="2"/>
      <TfrxMemoView Name="Memo9" Left="784" Top="106" Width="256" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haRight" ParentFont="False" Text="РЎС‚СЂР°РЅРёС†Р° [PAGE#]"/>
      <TfrxMemoView Name="Memo10" Left="113" Top="21" Width="852" Height="50" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Рѕ С‚РѕРІР°СЂР°С…, РЅР°С…РѕРґСЏС‰РёС…СЃСЏ РЅР° С…СЂР°РЅРµРЅРёРё РЅР° С‚Р°РјРѕР¶РµРЅРЅРѕРј СЃРєР»Р°РґРµ, Рѕ С‚РѕРІР°СЂР°С…, РІ РѕС‚РЅРѕС€РµРЅРёРё РєРѕС‚РѕСЂС‹С… С‚Р°РјРѕР¶РµРЅРЅС‹Р№ СЂРµР¶РёРј С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ СЃРєР»Р°РґР° Р±С‹Р» Р·Р°РІРµСЂС€РµРЅ, Рё Рѕ С‚РѕРІР°СЂР°С…, РІ РѕС‚РЅРѕС€РµРЅРёРё РєРѕС‚РѕСЂС‹С… РёРјРµР»Рѕ РјРµСЃС‚Рѕ РїСЂРѕРІРµРґРµРЅРёРµ РѕРїРµСЂР°С†РёР№, СѓСЃС‚Р°РЅРѕРІР»РµРЅРЅС‹С… РІ СЃРѕРѕС‚РІРµС‚СЃС‚РІРёРё СЃ РїСѓРЅРєС‚Р°РјРё 4 Рё 5 СЃС‚Р°С‚СЊРё 219 РўР°РјРѕР¶РµРЅРЅРѕРіРѕ РєРѕРґРµРєСЃР° Р РѕСЃСЃРёР№СЃРєРѕР№ Р¤РµРґРµСЂР°С†РёРё"/>
      <TfrxMemoView Name="Memo11" Left="30.32282" Top="132" Width="48" Height="122" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Р”Р°С‚Р° РїРѕРµРјРµС‰РµРЅРёСЏ С‚РѕРІР°СЂР° РЅР° С…СЂР°РЅРµРЅРёРµ"/>
      <TfrxMemoView Name="Memo13" Left="278.32282" Top="132" Width="52" Height="122" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РљРѕРґ С‚РѕРІР°СЂР° РїРѕ РўРќР’Р­Р” Р РѕСЃСЃРёРёРё"/>
      <TfrxMemoView Name="Memo15" Left="330.32282" Top="132" Width="64" Height="122" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РљРѕР»-РІРѕ С‚РѕРІР°СЂР° РїСЂРё РїРѕРјРµС‰РµРЅРёРё РЅР° С…СЂР°РЅРµРЅРёРµ (РІ РµРґРёРЅРёС†Р°С… РёР·РјРµСЂРµРЅРёСЏ)"/>
      <TfrxMemoView Name="Memo16" Left="450.32282" Top="170" Width="40" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РўР°РјРѕР¶РµРЅРЅС‹Р№ СЂРµР¶РёРј"/>
      <TfrxMemoView Name="Memo17" Left="490.32282" Top="170" Width="109.13389" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="в„– С‚Р°РјРѕР¶РµРЅРЅРѕР№ РґРµРєР»Р°СЂР°С†РёРё"/>
      <TfrxMemoView Name="Memo18" Left="599.45671" Top="132" Width="196.88188" Height="38" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РўРѕРІР°СЂС‹, РїРµСЂРµРјРµС‰РµРЅРЅС‹Рµ &#13;&#10;РЅР° РґСЂСѓРіРѕР№ С‚Р°РјРѕР¶РµРЅРЅС‹Р№ СЃРєР»Р°Рґ"/>
      <TfrxMemoView Name="Memo19" Left="599.45671" Top="170" Width="44.88188" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РљРѕР»-РІРѕ РїРµСЂРµРјРµС‰РµРЅРЅС‹С… С‚РѕРІР°СЂРѕРІ РІ РµРґРёРЅРёС†Р°С… РёР·РјРµСЂРµРЅРёСЏ"/>
      <TfrxMemoView Name="Memo20" Left="644.33859" Top="170" Width="60" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="в„– С„РѕСЂРјСѓР»СЏСЂР°"/>
      <TfrxMemoView Name="Memo21" Left="704.33859" Top="170" Width="92" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РќРѕРјРµСЂ СЃРІРёРґРµС‚РµР»СЊСЃС‚РІР° Рѕ РІРєР»СЋС‡РµРЅРёРё РІ Р РµРµСЃС‚СЂ РІР»Р°РґРµР»СЊС†РµРІ С‚Р°РјРѕР¶РµРЅРЅС‹С… СЃРєР»Р°РґРѕРІ РІР»Р°РґРµР»СЊС†Р° СЃРєР»Р°РґР°, РЅР° РєРѕС‚РѕСЂС‹Р№ РїРµСЂРµРјРµС‰РµРЅС‹ С‚РѕРІР°СЂС‹"/>
      <TfrxMemoView Name="Memo22" Left="796.33859" Top="132" Width="44" Height="122" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РћСЃС‚Р°С‚РѕРє С‚РѕРІР°СЂРѕРІ РЅР° С‚Р°РјРѕР¶РµРЅРЅРѕРј СЃРєР»Р°РґРµ"/>
      <TfrxMemoView Name="Memo23" Left="840.33859" Top="132" Width="212" Height="38" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РўРѕРІР°СЂС‹, РІ РѕС‚РЅРѕС€РµРЅРёРё РєРѕС‚РѕСЂС‹С… РѕСЃСѓС‰РµСЃС‚РІР»СЏР»Р°СЃСЊ РѕРїРµСЂР°С†РёСЏ РІ СЃРѕРѕС‚РІРµСЃС‚РІРёРё СЃ РїСѓРЅРєС‚РѕРј 4 СЃС‚Р°С‚СЊРё 219 РўР°РјРѕР¶РµРЅРЅРѕРіРѕ РєРѕРґРµРєСЃР° Р РѕСЃСЃРёР№СЃРєРѕР№ Р¤РµРґРµСЂР°С†РёРё"/>
      <TfrxMemoView Name="Memo24" Left="840.33859" Top="170" Width="60" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="в„– С„РѕСЂРјСѓР»СЏСЂР°"/>
      <TfrxMemoView Name="Memo25" Left="900.33859" Top="170" Width="92" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Р›РёС†Рѕ, РїСЂРёРѕР±СЂРµС‚С€РµРµ РёРјСѓС‰РµСЃС‚РІРµРЅРЅС‹Рµ РїСЂР°РІР°"/>
      <TfrxMemoView Name="Memo26" Left="992.33859" Top="170" Width="60" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ С‚РѕРІР°СЂРѕРІ РѕС‚С‡СѓР¶РґРµРЅРЅС‹С… (РµРґ. РёР·РјРµСЂРµРЅРёСЏ)"/>
    </TfrxReportTitle>
    <TfrxReportSummary Name="Band3" Height="94" Left="0" Top="600.94527" Width="1062.04793" OnBeforePrint="Band3OnBeforePrint">
      <TfrxMemoView Name="Memo94" Left="220" Top="8" Width="208" Height="18" ShowHint="False" HAlign="haRight" Text="Р’Р»Р°РґРµР»РµС† С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ СЃРєР»Р°РґР°:"/>
      <TfrxMemoView Name="Memo95" Left="428" Top="48" Width="412" Height="18" ShowHint="False" Frame.Typ="8" VAlign="vaCenter" Text="[STORES_2.&#34;CHIEF&#34;]"/>
      <TfrxMemoView Name="Memo96" Left="432" Top="28" Width="608" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="(РЅР°РёРјРµРЅРѕРІР°РЅРёРµ РѕСЂРіР°РЅРёР·Р°С†РёРё)"/>
      <TfrxMemoView Name="Memo97" Left="860" Top="68" Width="116" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="(РїРѕРґРїРёСЃСЊ, РїРµС‡Р°С‚СЊ)"/>
      <TfrxMemoView Name="Memo29" Left="860" Top="48" Width="116" Height="18" ShowHint="False" Frame.Typ="8" Text=""/>
      <TfrxMemoView Name="Memo30" Left="220" Top="48" Width="208" Height="18" ShowHint="False" HAlign="haRight" Text="Р СѓРєРѕРІРѕРґРёС‚РµР»СЊ:"/>
      <TfrxMemoView Name="Memo31" Left="428" Top="8" Width="616" Height="18" ShowHint="False" Frame.Typ="8" Text="[STORES_2.&#34;G142&#34;]"/>
      <TfrxMemoView Name="Memo32" Left="512" Top="68" Width="192" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="(РёРЅРёС†РёР°Р»С‹, С„Р°РјРёР»РёСЏ СЂСѓРєРѕРІРѕРґРёС‚РµР»СЏ)"/>
    </TfrxReportSummary>
    <TfrxPageFooter Name="PageFooter1" Height="30" Left="0" Top="718.1107" Width="1062.04793">
      <TfrxMemoView Name="Memo7" Left="311" Top="8" Width="448" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="Р’Р­Р”-РўР°РјРѕР¶РµРЅРЅС‹Р№ СЃРєР»Р°Рґ   Copyright (C) РћРћРћ &#34;РЎРўРњ&#34;,1999-[FORMATDATETIME(&#34;YYYY&#34;, DATE)]"/>
      <TfrxLineView Name="Line2" Left="16" Top="4" Width="1036" Height="0" ShowHint="False" Frame.Typ="4" Frame.Width="2"/>
      <TfrxMemoView Name="Memo8" Left="20" Top="8" Width="240" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" ParentFont="False" Text="[DATE] [TIME]"/>
      <TfrxMemoView Name="Memo33" Left="860" Top="8" Width="192" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haRight" ParentFont="False" Text="Internet: www.ctm.ru"/>
    </TfrxPageFooter>
    <TfrxDetailData Name="DetailData1" Height="15" Left="0" Top="525.35467" Width="1062.04793" OnBeforePrint="DetailData1OnBeforePrint" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="ds_KRD_COMM_2" DataSetName="KRD_COMM_2" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo37" Left="10.32282" Top="0" Width="20" Height="15" OnBeforePrint="Memo37OnBeforePrint" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[sLine]"/>
      <TfrxMemoView Name="Memo38" Left="78.32282" Top="0" Width="64" Height="15" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[qryMAIN.&#34;GTD_NO&#34;]"/>
      <TfrxMemoView Name="Memo41" Left="278.32282" Top="0" Width="52" Height="15" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[KRD_COMM_2.&#34;G33&#34;]"/>
      <TfrxMemoView Name="Memo43" Left="490.32282" Top="0" Width="109.13389" Height="15" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vDocNoOut]"/>
      <TfrxMemoView Name="Memo45" Left="796.33859" Top="0" Width="44" Height="15" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vRest]"/>
      <TfrxMemoView Name="Memo50" Left="394.32282" Top="0" Width="56" Height="15" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vRelQuantityOut]"/>
      <TfrxMemoView Name="Memo57" Left="142.32282" Top="0" Width="136" Height="15" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[KRD_COMM_2.&#34;G312&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="30.32282" Top="0" Width="48" Height="15" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[FORMATDATETIME(&#34;DD.MM.YYYY&#34;, &#60;qryMAIN.&#34;BD_DATE&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo14" Left="330.32282" Top="0" Width="64" Height="15" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vPrihod]"/>
      <TfrxMemoView Name="Memo27" Left="450.32282" Top="0" Width="40" Height="15" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vDocModeOut]"/>
      <TfrxMemoView Name="Memo1" Left="992.33859" Top="0" Width="60" Height="15" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vRelQuantityAleination]"/>
      <TfrxMemoView Name="Memo3" Left="599.45671" Top="0" Width="44.88188" Height="15" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vRelQuantityTrans]"/>
      <TfrxMemoView Name="Memo4" Left="644.33859" Top="0" Width="60" Height="15" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vNumCard]"/>
      <TfrxMemoView Name="Memo5" Left="704.33859" Top="0" Width="92" Height="15" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vNumLic]"/>
      <TfrxMemoView Name="Memo6" Left="840.33859" Top="0" Width="60" Height="15" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vNumCardAleination]"/>
      <TfrxMemoView Name="Memo28" Left="900.33859" Top="0" Width="92" Height="15" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[vReceiver]"/>
    </TfrxDetailData>
    <TfrxPageHeader Name="PageHeader1" Height="146" Left="0" Top="294.80334" Width="1062.04793" PrintOnFirstPage="False">
      <TfrxMemoView Name="Memo35" Left="10.32282" Top="24" Width="20" Height="122" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="в„– Рї/Рї"/>
      <TfrxMemoView Name="Memo36" Left="78.32282" Top="24" Width="64" Height="122" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РќРѕРјРµСЂ С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ РґРѕРєСѓРјРµРЅС‚Р°"/>
      <TfrxMemoView Name="Memo39" Left="142.32282" Top="24" Width="136" Height="122" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РќР°РёРјРµРЅРѕРІР°РЅРёРµ С‚РѕРІР°СЂР°"/>
      <TfrxMemoView Name="Memo40" Left="394.32282" Top="24" Width="205.13389" Height="38" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РўРѕРІР°СЂС‹, РІ РѕС‚РЅРѕС€РµРЅРёРё РєРѕС‚РѕСЂС‹С… С‚Р°РјРѕР¶РµРЅРЅС‹Р№ СЂРµР¶РёРј С‚Р°РјРѕР¶РµРЅРЅРѕРіРѕ СЃРєР»Р°РґР° Р·Р°РІРµСЂС€РµРЅ"/>
      <TfrxMemoView Name="Memo42" Left="394.32282" Top="62" Width="56" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РљРѕР»-РІРѕ С‚РѕРІР°СЂРѕРІ РІ РµРґРёРЅРёС†Р°С… РёР·РјРµСЂРµРЅРёСЏ"/>
      <TfrxMemoView Name="Memo44" Left="30.32282" Top="24" Width="48" Height="122" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Р”Р°С‚Р° РїРѕРµРјРµС‰РµРЅРёСЏ С‚РѕРІР°СЂР° РЅР° С…СЂР°РЅРµРЅРёРµ"/>
      <TfrxMemoView Name="Memo46" Left="278.32282" Top="24" Width="52" Height="122" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РљРѕРґ С‚РѕРІР°СЂР° РїРѕ РўРќР’Р­Р” Р РѕСЃСЃРёРёРё"/>
      <TfrxMemoView Name="Memo47" Left="330.32282" Top="24" Width="64" Height="122" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РљРѕР»-РІРѕ С‚РѕРІР°СЂР° РїСЂРё РїРѕРјРµС‰РµРЅРёРё РЅР° С…СЂР°РЅРµРЅРёРµ (РІ РµРґРёРЅРёС†Р°С… РёР·РјРµСЂРµРЅРёСЏ)"/>
      <TfrxMemoView Name="Memo48" Left="450.32282" Top="62" Width="40" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РўР°РјРѕР¶РµРЅРЅС‹Р№ СЂРµР¶РёРј"/>
      <TfrxMemoView Name="Memo49" Left="490.32282" Top="62" Width="109.13389" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="в„– С‚Р°РјРѕР¶РµРЅРЅРѕР№ РґРµРєР»Р°СЂР°С†РёРё"/>
      <TfrxMemoView Name="Memo51" Left="599.45671" Top="24" Width="196.88188" Height="38" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РўРѕРІР°СЂС‹, РїРµСЂРµРјРµС‰РµРЅРЅС‹Рµ &#13;&#10;РЅР° РґСЂСѓРіРѕР№ С‚Р°РјРѕР¶РµРЅРЅС‹Р№ СЃРєР»Р°Рґ"/>
      <TfrxMemoView Name="Memo52" Left="599.45671" Top="62" Width="44.88188" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РљРѕР»-РІРѕ РїРµСЂРµРјРµС‰РµРЅРЅС‹С… С‚РѕРІР°СЂРѕРІ РІ РµРґРёРЅРёС†Р°С… РёР·РјРµСЂРµРЅРёСЏ"/>
      <TfrxMemoView Name="Memo53" Left="644.33859" Top="62" Width="60" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="в„– С„РѕСЂРјСѓР»СЏСЂР°"/>
      <TfrxMemoView Name="Memo54" Left="704.33859" Top="62" Width="92" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РќРѕРјРµСЂ СЃРІРёРґРµС‚РµР»СЊСЃС‚РІР° Рѕ РІРєР»СЋС‡РµРЅРёРё РІ Р РµРµСЃС‚СЂ РІР»Р°РґРµР»СЊС†РµРІ С‚Р°РјРѕР¶РµРЅРЅС‹С… СЃРєР»Р°РґРѕРІ РІР»Р°РґРµР»СЊС†Р° СЃРєР»Р°РґР°, РЅР° РєРѕС‚РѕСЂС‹Р№ РїРµСЂРµРјРµС‰РµРЅС‹ С‚РѕРІР°СЂС‹"/>
      <TfrxMemoView Name="Memo55" Left="796.33859" Top="24" Width="44" Height="122" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РћСЃС‚Р°С‚РѕРє С‚РѕРІР°СЂРѕРІ РЅР° С‚Р°РјРѕР¶РµРЅРЅРѕРј СЃРєР»Р°РґРµ"/>
      <TfrxMemoView Name="Memo56" Left="840.33859" Top="24" Width="212" Height="38" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РўРѕРІР°СЂС‹, РІ РѕС‚РЅРѕС€РµРЅРёРё РєРѕС‚РѕСЂС‹С… РѕСЃСѓС‰РµСЃС‚РІР»СЏР»Р°СЃСЊ РѕРїРµСЂР°С†РёСЏ РІ СЃРѕРѕС‚РІРµСЃС‚РІРёРё СЃ РїСѓРЅРєС‚РѕРј 4 СЃС‚Р°С‚СЊРё 219 РўР°РјРѕР¶РµРЅРЅРѕРіРѕ РєРѕРґРµРєСЃР° Р РѕСЃСЃРёР№СЃРєРѕР№ Р¤РµРґРµСЂР°С†РёРё"/>
      <TfrxMemoView Name="Memo59" Left="840.33859" Top="62" Width="60" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="в„– С„РѕСЂРјСѓР»СЏСЂР°"/>
      <TfrxMemoView Name="Memo60" Left="900.33859" Top="62" Width="92" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Р›РёС†Рѕ, РїСЂРёРѕР±СЂРµС‚С€РµРµ РёРјСѓС‰РµСЃС‚РІРµРЅРЅС‹Рµ РїСЂР°РІР°"/>
      <TfrxMemoView Name="Memo61" Left="992.33859" Top="62" Width="60" Height="84" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ С‚РѕРІР°СЂРѕРІ РѕС‚С‡СѓР¶РґРµРЅРЅС‹С… (РµРґ. РёР·РјРµСЂРµРЅРёСЏ)"/>
      <TfrxMemoView Name="Memo66" Left="784" Top="2" Width="256" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haRight" ParentFont="False" Text="РЎС‚СЂР°РЅРёС†Р° [PAGE#]"/>
      <TfrxMemoView Name="Memo34" Align="baCenter" Left="495.423965" Top="2" Width="71.2" Height="18" ShowHint="False" AutoWidth="True" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="5" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[strPeriod]"/>
    </TfrxPageHeader>
  </TfrxReportPage>
</TfrxReport>
