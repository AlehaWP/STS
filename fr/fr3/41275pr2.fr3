<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.6.78" DotMatrixReport="False" EngineOptions.ConvertNulls="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.Author="Алексей Нерченко" ReportOptions.CreateDate="40795.4475227662" ReportOptions.Description.Text="" ReportOptions.Name="Отчет по СВХ (письмо № 04-37/41275 прил. 2)" ReportOptions.LastChange="40812.6482549653" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;qryStoresSql : string;&#13;&#10;vLicenceDate: Variant;    &#13;&#10;vPlaceId, StoreNo, vTov, vRecipient, vCarrier : string;                        &#13;&#10;bSTORexists : boolean;                          &#13;&#10;datestart, dateend : string;                          &#13;&#10;dtPeriodStart, dtPeriodEnd : TDateTime;                       &#13;&#10;iCountPart, iCountPartOut : integer;                          &#13;&#10;iG35, iG311, iG46, iValue : Double;&#13;&#10;iRelG35, iRelG311, iRelG46, iValueOut : Double;&#13;&#10;AistCompatible : integer;      &#13;&#10;  &#13;&#10;Const&#13;&#10;  sIniFile = ProgramPath() + 'print.ini';&#13;&#10;  sIniSection = '14275pr2.fr3'; &#13;&#10;&#13;&#10;  &#13;&#10;procedure ReportTitle1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin &#13;&#10;if bSTORexists = False then&#13;&#10;  qryStoresSql := 'Select PLACEID, LICENCENO, NAME, CUSTOMS_NAME from STORES ORDER BY PLACEID '&#13;&#10;else if vPlaceid &#60;&#62; '0' then                                                                                    &#13;&#10;     qryStoresSql := 'Select PLACEID, LICENCENO, NAME, CUSTOMS_NAME from STORES WHERE (PLACEID= '+ vPlaceId+') '&#13;&#10;     else&#13;&#10;     begin&#13;&#10;       COMPUTE('FIRST(&#34;STOR&#34;)');&#13;&#10;       vPlaceId := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;PLACEID&#34;)');&#13;&#10;       qryStoresSql:='select  PLACEID, LICENCENO, NAME, CUSTOMS_NAME  from STORES WHERE (PLACEID= '+ vPlaceId+') ';&#13;&#10;       COMPUTE('Next(&#34;STOR&#34;)');&#13;&#10;       while COMPUTE('EOF(&#34;STOR&#34;)') = '0' do begin&#13;&#10;         vPlaceId := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;PLACEID&#34;)');&#13;&#10;         qryStoresSql := qryStoresSql + ' OR (PLACEID= '+ vPlaceId+') ';&#13;&#10;         COMPUTE('Next(&#34;STOR&#34;)');&#13;&#10;       end;&#13;&#10;       qryStoresSql := qryStoresSql + 'ORDER BY PLACEID ';                           &#13;&#10;         &#13;&#10;     end;&#13;&#10;  qryStores.Active := False;                                                          &#13;&#10;  qryStores.SQL.Text := '';&#13;&#10;  qryStores.SQL.Text := qryStoresSql;&#13;&#10;  qryStores.Active := True;  &#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure btnCallRefOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with btnCallRef, Engine do&#13;&#10;  begin&#13;&#10;    COMPUTE(' globalvar (&#34;strStoreNumLic&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;strStoreNum&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;strStoreName&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;strLicExt&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;sChief&#34;,String)');&#13;&#10;    COMPUTE(' globalvar (&#34;sPlaceId&#34;,Integer)');&#13;&#10;    COMPUTE(' globalvar (&#34;sLicenceDate&#34;,DateTime)');&#13;&#10;    COMPUTE('OPENQUERY (&#34;Stors&#34;, &#34;STS_DB&#34;, &#34;Select * from STORES&#34;)');&#13;&#10;&#13;&#10;&#13;&#10;    IF COMPUTE('SelectRecords(&#34;Выбор складских площадок&#34;, &#34;STORS&#34;,'+&#13;&#10;                          '['+&#13;&#10;                           '[&#34;LICENCENO&#34;, &#34;№ лицензии&#34;, 12],'+&#13;&#10;                           '[&#34;STORE_NO&#34;, &#34;№ склада&#34;, 8],'+&#13;&#10;                           '[&#34;NAME&#34;, &#34;Название склада&#34;, 30]'+&#13;&#10;                           '],'+&#13;&#10;                           '&#34;STOR&#34;, &#34;&#34;, &#34;STS_DB&#34;)') = '1' then&#13;&#10;&#13;&#10;      begin&#13;&#10;        bSTORexists := True;&#13;&#10;        COMPUTE('FIRST(&#34;STOR&#34;)');&#13;&#10;        fldStoreLicNum.Text := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;LICENCENO&#34;)');  //   номер  лиценцзии&#13;&#10;        StoreNo := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;STORE_NO&#34;)') ; //   номер склада&#13;&#10;        lblStoreName.Text :=COMPUTE('FieldValue(&#34;Stor&#34;, &#34;NAME&#34;)') ;     //   название склада&#13;&#10;        //fldLicExt.Text := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;LICENCENO_EXT&#34;)');     //   Признак перерегистрации&#13;&#10;        If COMPUTE('RECORDCOUNT(&#34;STOR&#34;)') &#60;&#62; '1' then&#13;&#10;          vPlaceId :='0'&#13;&#10;        else vPlaceId := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;PLACEID&#34;)');&#13;&#10;        vLicenceDate := COMPUTE('FieldValue(&#34;Stor&#34;, &#34;LICENCEDATE&#34;)');&#13;&#10;        fldStoreLicDate.Date := STRTODATEDEF(vLicenceDate, Date);  // дата выдачи лицензии &#13;&#10;      end&#13;&#10;  end  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   iCountPart := 0;&#13;&#10;   iCountPartOut := 0;&#13;&#10;   vTov := '';&#13;&#10;   vRecipient := '';                &#13;&#10;   vCarrier := '';         &#13;&#10;   iG35 := 0;&#13;&#10;   iG46 := 0;&#13;&#10;   iG311 := 0;  &#13;&#10;   iRelG35 := 0;&#13;&#10;   iRelG46 := 0;&#13;&#10;   iRelG311 := 0;&#13;&#10;   iValue := 0;                               &#13;&#10;   iValueOut := 0;  &#13;&#10;                                      &#13;&#10;   COMPUTE('OPENQUERY (&#34;CountPart&#34;, &#34;STS_DB&#34;, &#34;Select COUNT(ID) as countId' +&#13;&#10;                                              ' from KRD_MAIN' +     &#13;&#10;                                              ' WHERE (PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +  &#13;&#10;                                              ' ) AND (BD_DATE &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                              ' ) AND (BD_DATE &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                              ' )&#34;)');&#13;&#10;                                                 &#13;&#10;   iCountPart := Compute('FieldValue(&#34;CountPart&#34;,&#34;countId&#34;)');&#13;&#10;     &#13;&#10;   if AistCompatible = 0 then begin                                                                                                                                 &#13;&#10;     COMPUTE('OPENQUERY (&#34;CountPartOut&#34;, &#34;STS_DB&#34;, &#34;Select COUNT(ID) as countId' +&#13;&#10;                                                ' from RELEASE' +     &#13;&#10;                                                ' WHERE (PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +                                                    &#13;&#10;                                                ' ) AND (OUT_DATE &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                                ' ) AND (OUT_DATE &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                                ' )&#34;)');&#13;&#10;   end&#13;&#10;   else begin&#13;&#10;     COMPUTE('OPENQUERY (&#34;CountPartOut&#34;, &#34;STS_DB&#34;, &#34;Select COUNT(ID) as countId' +&#13;&#10;                                                ' from OUT_MAIN' +     &#13;&#10;                                                ' WHERE (PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +                                                    &#13;&#10;                                                ' ) AND (G542 &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                                ' ) AND (G542 &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                                ' )&#34;)');     &#13;&#10;   end;&#13;&#10;       &#13;&#10;   iCountPartOut := Compute('FieldValue(&#34;CountPartOut&#34;,&#34;countId&#34;)');&#13;&#10;   IF (iCountPart &#60;&#62; 0) or (iCountPartOut &#60;&#62; 0) then&#13;&#10;   begin&#13;&#10;     MasterData1.Visible := True; &#13;&#10;     COMPUTE('OPENQUERY (&#34;NameTov&#34;, &#34;STS_DB&#34;, &#34;Select DISTINCT G312 ' +&#13;&#10;                                                ' from KRD_COMM' +     &#13;&#10;                                                ' WHERE (PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +  &#13;&#10;                                                ' ) AND (ACCEPTDATE &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                                ' ) AND (ACCEPTDATE &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                                ' )&#34;)');&#13;&#10;     vTov :=  COMPUTE('JOINVALUES(&#34;NameTov&#34;, &#34;,&#34; + char(13) + char(10), [&#34;G312&#34;])');&#13;&#10;     &#13;&#10;     COMPUTE('OPENQUERY (&#34;Recipient&#34;, &#34;STS_DB&#34;, &#34;Select DISTINCT G082 ' +&#13;&#10;                                                ' from KRD_MAIN' +     &#13;&#10;                                                ' WHERE (PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +  &#13;&#10;                                                ' ) AND (BD_DATE &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                                ' ) AND (BD_DATE &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                                ' )&#34;)');&#13;&#10;     vRecipient := COMPUTE('JOINVALUES(&#34;Recipient&#34;, &#34;,&#34; + char(13) + char(10), [&#34;G082&#34;])');&#13;&#10;       &#13;&#10;     COMPUTE('OPENQUERY (&#34;Carrier&#34;, &#34;STS_DB&#34;, &#34;Select DISTINCT G042 ' +&#13;&#10;                                                ' from KRD_MAIN' +     &#13;&#10;                                                ' WHERE (PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +  &#13;&#10;                                                ' ) AND (BD_DATE &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                                ' ) AND (BD_DATE &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                                ' )&#34;)');&#13;&#10;     vCarrier := COMPUTE('JOINVALUES(&#34;Carrier&#34;, &#34;,&#34; + char(13) + char(10), [&#34;G042&#34;])');&#13;&#10;      &#13;&#10;     if (vRecipient = '') and (iCountPartOut &#60;&#62; 0)  then begin&#13;&#10;       if AistCompatible = 0 then begin&#13;&#10;         COMPUTE('OPENQUERY (&#34;RecipientDO2&#34;, &#34;STS_DB&#34;, &#34;Select DISTINCT K.G082 ' +&#13;&#10;                                                       ' from ' + CorrectTableName('RELEASE')+ ' R,' + CorrectTableName('KRD_MAIN')+ ' K ' +                      &#13;&#10;                                                       ' WHERE (R.PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +  &#13;&#10;                                                       ' ) AND (R.OUT_DATE &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                                       ' ) AND (R.OUT_DATE &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                                       ' ) AND (R.PLACEID = K.PLACEID' +&#13;&#10;                                                       ' ) AND (R.ID = K.ID' +                                                         &#13;&#10;                                                       ' )&#34;)'); &#13;&#10;       end&#13;&#10;       else begin&#13;&#10;         COMPUTE('OPENQUERY (&#34;RecipientDO2&#34;, &#34;STS_DB&#34;, &#34;Select DISTINCT K.G082 ' +&#13;&#10;                                                       ' from ' + CorrectTableName('OUT_MAIN')+ ' O,' + CorrectTableName('KRD_MAIN')+ ' K ' +                      &#13;&#10;                                                       ' WHERE (O.PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +  &#13;&#10;                                                       ' ) AND (O.G542 &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                                       ' ) AND (O.G542 &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                                       ' ) AND (O.PLACEID = K.PLACEID' +&#13;&#10;                                                       ' ) AND (O.ID = K.ID' +                                                         &#13;&#10;                                                       ' )&#34;)');          &#13;&#10;       end;&#13;&#10;       vRecipient := COMPUTE('JOINVALUES(&#34;RecipientDO2&#34;, &#34;,&#34; + char(13) + char(10), [&#34;G082&#34;])');            &#13;&#10;     end; // (vRecipient = '') and (iCountPartOut &#60;&#62; 0)&#13;&#10;             &#13;&#10;     if (vCarrier = '') and (iCountPartOut &#60;&#62; 0)  then begin&#13;&#10;       if AistCompatible = 0 then begin&#13;&#10;         COMPUTE('OPENQUERY (&#34;CarrierDO2&#34;, &#34;STS_DB&#34;, &#34;Select DISTINCT K.G042 ' +&#13;&#10;                                                       ' from ' + CorrectTableName('RELEASE')+ ' R,' + CorrectTableName('KRD_MAIN')+ ' K ' +                      &#13;&#10;                                                       ' WHERE (R.PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +  &#13;&#10;                                                       ' ) AND (R.OUT_DATE &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                                       ' ) AND (R.OUT_DATE &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                                       ' ) AND (R.PLACEID = K.PLACEID' +&#13;&#10;                                                       ' ) AND (R.ID = K.ID' +                                                         &#13;&#10;                                                       ' )&#34;)');&#13;&#10;       end&#13;&#10;       else begin&#13;&#10;         COMPUTE('OPENQUERY (&#34;RecipientDO2&#34;, &#34;STS_DB&#34;, &#34;Select DISTINCT K.G042 ' +&#13;&#10;                                                       ' from ' + CorrectTableName('OUT_MAIN')+ ' O,' + CorrectTableName('KRD_MAIN')+ ' K ' +                      &#13;&#10;                                                       ' WHERE (O.PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +  &#13;&#10;                                                       ' ) AND (O.G542 &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                                       ' ) AND (O.G542 &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                                       ' ) AND (O.PLACEID = K.PLACEID' +&#13;&#10;                                                       ' ) AND (O.ID = K.ID' +                                                         &#13;&#10;                                                       ' )&#34;)');           &#13;&#10;       end;                 &#13;&#10;       vCarrier := COMPUTE('JOINVALUES(&#34;CarrierDO2&#34;, &#34;,&#34; + char(13) + char(10), [&#34;G042&#34;])');&#13;&#10;     end; // if (vSender = '') and (iCountPartOut &#60;&#62; 0)&#13;&#10;  &#13;&#10;     IF iCountPart &#60;&#62; 0 then&#13;&#10;     begin&#13;&#10;       COMPUTE('OPENQUERY (&#34;SumDan&#34;, &#34;STS_DB&#34;, &#34;Select SUM(G35) as sumG35, SUM(G46) as sumG46, SUM(G311) as sumG311 ' +&#13;&#10;                                               ' from KRD_COMM' +     &#13;&#10;                                               ' WHERE (PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +  &#13;&#10;                                               ' ) AND (ACCEPTDATE &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                               ' ) AND (ACCEPTDATE &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                               ' )&#34;)');&#13;&#10;       iG35 := Compute('FieldValue(&#34;SumDan&#34;, &#34;sumG35&#34;)');&#13;&#10;       //iG46 := Compute('FieldValue(&#34;SumDan&#34;, &#34;sumG46&#34;)');&#13;&#10;       iG311 := Compute('FieldValue(&#34;SumDan&#34;, &#34;sumG311&#34;)');&#13;&#10;                                     &#13;&#10;       COMPUTE('OPENQUERY (&#34;Value&#34;, &#34;STS_DB&#34;, &#34;Select PLACEID, ID, G222, G221 ' +&#13;&#10;                                                  ' from KRD_MAIN' +     &#13;&#10;                                                  ' WHERE (PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +  &#13;&#10;                                                  ' ) AND (BD_DATE &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                                  ' ) AND (BD_DATE &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                                  ' )&#34;)');&#13;&#10;       COMPUTE('FIRST(&#34;Value&#34;)');                                    &#13;&#10;       while COMPUTE('EOF(&#34;Value&#34;)') = '0' do begin&#13;&#10;         if (Compute('Fieldvalue(&#34;Value&#34;, &#34;G221&#34;)') &#60;&#62; '') and (Compute('Fieldvalue(&#34;Value&#34;, &#34;G221&#34;)') &#60;&#62; '0')  and (Compute('Fieldvalue(&#34;Value&#34;, &#34;G222&#34;)') &#60;&#62; 0)  then                                              &#13;&#10;           iValue := iValue + StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY', DATE()) + '&#34;, Fieldvalue(&#34;Value&#34;, &#34;G221&#34;), &#34;643&#34;, Fieldvalue(&#34;Value&#34;, &#34;G222&#34;))'))&#13;&#10;         else begin&#13;&#10;           COMPUTE('SETRANGE(&#34;KRD_COMM_2&#34;, [Fieldvalue(&#34;Value&#34;, &#34;PLACEID&#34;),Fieldvalue(&#34;Value&#34;, &#34;ID&#34;) ])');&#13;&#10;           COMPUTE('FIRST(&#34;KRD_COMM_2&#34;)');&#13;&#10;           while COMPUTE('EOF(&#34;KRD_COMM_2&#34;)') = '0' do begin&#13;&#10;             if (&#60;KRD_COMM_2.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; '') and (&#60;KRD_COMM_2.&#34;G42_CURRENCY&#34;&#62; &#60;&#62; NULL) then&#13;&#10;              iValue := iValue + StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY', DATE()) + '&#34;, &#34;'+ &#60;KRD_COMM_2.&#34;G42_CURRENCY&#34;&#62; +'&#34;, &#34;643&#34;, &#34;'+ STR(&#60;KRD_COMM_2.&#34;G42&#34;&#62;) +'&#34;)'));                   &#13;&#10;              COMPUTE('NEXT(&#34;KRD_COMM_2&#34;)');             &#13;&#10;           end;   &#13;&#10;         end;//Compute('Fieldvalue(&#34;Value&#34;, &#34;G221&#34;)') &#60;&#62; ''&#13;&#10;             &#13;&#10;         COMPUTE('Next(&#34;Value&#34;)');&#13;&#10;       end;                 &#13;&#10;     end;// iCountPart &#60;&#62; 0&#13;&#10;     &#13;&#10;     IF iCountPartOut &#60;&#62; 0 then&#13;&#10;     begin&#13;&#10;       if AistCompatible = 0 then begin         &#13;&#10;         COMPUTE('OPENQUERY (&#34;SumDanOut&#34;, &#34;STS_DB&#34;, &#34;Select SUM(RC.RELEASE_G35) as sumG35, SUM(RC.RELEASE_G46) as sumG46, SUM(RC.RELEASE_G311) as sumG311 ' +&#13;&#10;                                                    ' from ' + CorrectTableName('RELEASE')+ ' R,' +  CorrectTableName('REL_COMM')+ ' RC ' +               &#13;&#10;                                                    ' WHERE (R.PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +  &#13;&#10;                                                    ' ) AND (R.OUT_DATE &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                                    ' ) AND (R.OUT_DATE &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                                    ' ) AND (R.PLACEID = RC.PLACEID' +&#13;&#10;                                                    ' ) AND (R.ID = RC.ID' +&#13;&#10;                                                    ' ) AND (R.COUNTER = RC.COUNTER' +                                                      &#13;&#10;                                                    ' )&#34;)');&#13;&#10;         COMPUTE('OPENQUERY (&#34;ValueOut&#34;, &#34;STS_DB&#34;, &#34; SELECT KC.G42_CURRENCY, K.G221, RC.RELEASE_G42' +&#13;&#10;                                                   ' from ' + CorrectTableName('RELEASE')+ ' R, ' +  CorrectTableName('REL_COMM')+ ' RC, ' +&#13;&#10;                                                    CorrectTableName('KRD_MAIN')+ ' K, ' + CorrectTableName('KRD_COMM')+ ' KC ' +                                                       &#13;&#10;                                                   ' WHERE (R.PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +  &#13;&#10;                                                   ' ) AND (R.OUT_DATE &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                                   ' ) AND (R.OUT_DATE &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                                   ' ) AND (R.PLACEID = RC.PLACEID) AND (R.ID = RC.ID) AND (R.COUNTER = RC.COUNTER) ' +&#13;&#10;                                                   ' AND (KC.PLACEID = RC.PLACEID) AND (KC.ID = RC.ID) AND (KC.G32 = RC.G32)' +&#13;&#10;                                                   ' AND (K.PLACEID = RC.PLACEID) AND (K.ID = RC.ID) ' +                                                             &#13;&#10;                                                   ' &#34;)');                                                        &#13;&#10;       end&#13;&#10;       else begin&#13;&#10;         COMPUTE('OPENQUERY (&#34;SumDanOut&#34;, &#34;STS_DB&#34;, &#34;Select SUM(OC.OUT_G35) as sumG35, SUM(OC.OUT_G46) as sumG46, SUM(OC.OUT_G311) as sumG311 ' +&#13;&#10;                                                    ' from ' + CorrectTableName('OUT_MAIN')+ ' O,' +  CorrectTableName('OUT_COMM')+ ' OC ' +               &#13;&#10;                                                    ' WHERE (O.PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +  &#13;&#10;                                                    ' ) AND (O.G542 &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                                    ' ) AND (O.G542 &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                                    ' ) AND (O.PLACEID = OC.PLACEID' +&#13;&#10;                                                    ' ) AND (O.ID = OC.ID' +&#13;&#10;                                                    ' ) AND (O.ACTOUTID = OC.ACTOUTID' +                                                      &#13;&#10;                                                    ' )&#34;)');&#13;&#10;         COMPUTE('OPENQUERY (&#34;ValueOut&#34;, &#34;STS_DB&#34;, &#34; SELECT KC.G42_CURRENCY, K.G221, OC.OUT_G42 as RELEASE_G42' +&#13;&#10;                                                   ' from ' + CorrectTableName('OUT_MAIN')+ ' O, ' +  CorrectTableName('OUT_COMM')+ ' OC, ' +&#13;&#10;                                                    CorrectTableName('KRD_MAIN')+ ' K, ' + CorrectTableName('KRD_COMM')+ ' KC ' +                                                       &#13;&#10;                                                   ' WHERE (O.PLACEID = '  + VarToStr(&#60;qryStores.&#34;PLACEID&#34;&#62;) +  &#13;&#10;                                                   ' ) AND (O.G542 &#62;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 00:00:00', dtPeriodStart) + CHR(39)+&#13;&#10;                                                   ' ) AND (O.G542 &#60;=' + CHR(39) + FormatDateTime('DD.MM.YYYY 23:59:59', dtPeriodEnd) + CHR(39)+&#13;&#10;                                                   ' ) AND (O.PLACEID = OC.PLACEID) AND (O.ID = OC.ID) AND (O.ACTOUTID = OC.ACTOUTID) ' +&#13;&#10;                                                   ' AND (KC.PLACEID = OC.PLACEID) AND (KC.ID = OC.ID) AND (KC.G32 = OC.G32)' +&#13;&#10;                                                   ' AND (K.PLACEID = OC.PLACEID) AND (K.ID = OC.ID) ' +                                                             &#13;&#10;                                                   ' &#34;)');                                                        &#13;&#10;       end;&#13;&#10;       iRelG35 := Compute('FieldValue(&#34;SumDanOut&#34;, &#34;sumG35&#34;)');&#13;&#10;       //iRelG46 := Compute('FieldValue(&#34;SumDanOut&#34;, &#34;sumG46&#34;)');&#13;&#10;       iRelG311 := Compute('FieldValue(&#34;SumDanOut&#34;, &#34;sumG311&#34;)');&#13;&#10;&#13;&#10;        COMPUTE('FIRST(&#34;ValueOut&#34;)');&#13;&#10;        while COMPUTE('EOF(&#34;ValueOut&#34;)') = '0' do begin&#13;&#10;           if (Compute('Fieldvalue(&#34;ValueOut&#34;, &#34;G42_CURRENCY&#34;)') &#60;&#62; '') and (Compute('Fieldvalue(&#34;ValueOut&#34;, &#34;G42_CURRENCY&#34;)') &#60;&#62; '0') then&#13;&#10;            iValueOut := iValueOut + StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY', DATE()) + '&#34;, Fieldvalue(&#34;ValueOut&#34;, &#34;G42_CURRENCY&#34;), &#34;643&#34;, Fieldvalue(&#34;ValueOut&#34;, &#34;RELEASE_G42&#34;))'))               &#13;&#10;           else&#13;&#10;            if (Compute('Fieldvalue(&#34;ValueOut&#34;, &#34;G221&#34;)') &#60;&#62; '') and (Compute('Fieldvalue(&#34;ValueOut&#34;, &#34;G221&#34;)') &#60;&#62; '0') then&#13;&#10;            iValueOut := iValueOut + StrToFloat(COMPUTE('TRANSCURRENCY(&#34;' + FORMATDATETIME('DD.MM.YYYY', DATE()) + '&#34;, Fieldvalue(&#34;ValueOut&#34;, &#34;G221&#34;), &#34;643&#34;, Fieldvalue(&#34;ValueOut&#34;, &#34;RELEASE_G42&#34;))'));                  &#13;&#10;          COMPUTE('NEXT(&#34;ValueOut&#34;)');&#13;&#10;        end;&#13;&#10;     end;//iCountPartOut &#60;&#62; 0&#13;&#10;&#13;&#10;         &#13;&#10;   end&#13;&#10;   else begin&#13;&#10;    MasterData1.Visible := False;       &#13;&#10;   end;// IF (iCountPart &#60;&#62; 0) or (iCountPartOut &#60;&#62; 0)                   &#13;&#10;     &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   AistCompatible := StrToInt(IniFile('Docs', 'AistCompatible', '0'));     &#13;&#10;   datestart:=INIFILE(sIniSection,'PeriodStart','',sIniFile);&#13;&#10;   dateend := INIFILE(sIniSection,'PeriodEnd','',sIniFile);&#13;&#10;   dtFrom.Date := STRTODATEDEF(datestart, DATE);&#13;&#10;   dtTo.Date := STRTODATEDEF(dateend, DATE);&#13;&#10;   vPlaceId:=INIFILE(sIniSection,'PlaceId','',sIniFile);//COMPUTE('INIFILE(&#34;Print&#34;,&#34;PlaceId&#34;,&#34;&#34;)');&#13;&#10;   If COMPUTE('FindKey(&#34;STORES_2&#34;, [&#34;' + VARtoSTR(vPlaceId) + '&#34;])') then Begin&#13;&#10;    fldStoreLicNum.Text := &#60;STORES_2.&#34;LICENCENO&#34;&#62; ;      //   номер лицензии&#13;&#10;    StoreNo := &#60;STORES_2.&#34;STORE_NO&#34;&#62; ; //   номер склада&#13;&#10;    lblStoreName.Text := &#60;STORES_2.&#34;NAME&#34;&#62; ;     //   название склада&#13;&#10;    vLicenceDate := &#60;STORES_2.&#34;LICENCEDATE&#34;&#62;;&#13;&#10;    bSTORexists := True;        &#13;&#10;   end&#13;&#10;   else&#13;&#10;    bSTORexists := False;&#13;&#10;      &#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbtnOkOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if fldStoreLicNum.Text = '' then &#13;&#10;  begin &#13;&#10;    bSTORexists := False;&#13;&#10;    vPlaceID := '';                                                                           &#13;&#10;  end;&#13;&#10;  dtPeriodStart := Trunc(dtFrom.Date) ;&#13;&#10;  dtPeriodEnd := Trunc(dtTo.Date) ;&#13;&#10;  Compute('WRITEINIFILE(&#34;'+sIniSection+'&#34;,&#34;PeriodStart&#34;,&#34;'+DATETOSTR(dtPeriodStart)+'&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;  Compute('WRITEINIFILE(&#34;'+sIniSection+'&#34;,&#34;PeriodEnd&#34;,&#34;'+DATETOSTR(dtPeriodEnd)+'&#34;,&#34;'+sIniFile+'&#34;)');&#13;&#10;  Compute('WRITEINIFILE(&#34;'+sIniSection+'&#34;,&#34;PlaceId&#34;,&#34;'+vPlaceId+'&#34;,&#34;'+sIniFile+'&#34;)');      &#13;&#10;      &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;bSTORexists := False;&#13;&#10;  &#13;&#10;&#13;&#10;end." PropData="08446174617365747301010C3100000020446174615365743D2264735F4B52445F434F4D4D5F322220446174615365744E616D653D224B52445F434F4D4D5F322200010C2C00000020446174615365743D2271727953746F7265732220446174615365744E616D653D2271727953746F7265732200010C2D00000020446174615365743D2264735F53544F5245535F322220446174615365744E616D653D2253544F5245535F32220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxBDEQuery Name="qryStores" UserName="qryStores" CloseDataSource="True" FieldAliases.Text="" IgnoreDupParams="False" SQL.Text="SELECT * &#13;&#10;FROM Stores          &#13;&#10;ORDER BY placeID            " DatabaseName="STS_DB" SessionName="Default" PropData="05704C65667402480470546F7002180A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="0" RightMargin="0" TopMargin="0" BottomMargin="0" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="" VirtualPage="False">
    <TfrxReportTitle Name="ReportTitle1" Height="22.67718" Left="0" Top="18.89765" Width="1122.52041" OnBeforePrint="ReportTitle1OnBeforePrint">
      <TfrxMemoView Name="Memo38" Left="7.55906" Top="3.77953" Width="162.51979" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџСЂРёР»РѕР¶РµРЅРёРµ 2"/>
      <TfrxMemoView Name="Memo39" Left="170.07885" Top="3.77953" Width="207.87415" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[FormatDateTime('mmmm YYYY ', dtPeriodEnd)]"/>
    </TfrxReportTitle>
    <TfrxPageHeader Name="PageHeader1" Height="143.62214" Left="0" Top="64.25201" Width="1122.52041">
      <TfrxMemoView Name="Memo8" ShiftMode="smWhenOverlapped" Left="7.55906" Top="-1.48492329543615E-15" Width="49.13389" Height="124.72449" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РўР°РјРѕР¶РµРЅРЅС‹Р№ РїРѕСЃС‚"/>
      <TfrxMemoView Name="Memo9" ShiftMode="smWhenOverlapped" Left="7.55906" Top="124.72449" Width="49.13389" Height="18.89765" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="1"/>
      <TfrxMemoView Name="Memo10" ShiftMode="smWhenOverlapped" Left="56.69295" Top="-1.48492329543615E-15" Width="56.69295" Height="124.72449" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РќР°РёРјРµРЅРѕРІР°РЅРёРµ РІР»Р°РґРµР»СЊС†Р° РЎР’РҐ"/>
      <TfrxMemoView Name="Memo11" ShiftMode="smWhenOverlapped" Left="113.3859" Top="-1.48492329543615E-15" Width="56.69295" Height="124.72449" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РўРёРї РЎР’РҐ (РґР»СЏ РЎР’РҐ Р·Р°РєСЂС‹С‚РѕРіРѕ С‚РёРїР° РѕР±РѕСЃРЅРѕРІР°РЅРёРµ)"/>
      <TfrxMemoView Name="Memo12" ShiftMode="smWhenOverlapped" Left="170.07885" Top="-1.48492329543615E-15" Width="45.35436" Height="124.72449" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РљРѕР»-РІРѕ С‚РѕРІР°СЂРЅС‹С… РїР°СЂС‚РёР№ РїРѕРјРµС‰С‘РЅРЅС‹С… РЅР° С…СЂР°РЅРµРЅРёРµ Р·Р° РѕС‚С‡С‘С‚РЅС‹Р№ РїРµСЂРёРѕРґ"/>
      <TfrxMemoView Name="Memo13" ShiftMode="smWhenOverlapped" Left="215.43321" Top="-1.48492329543615E-15" Width="162.51979" Height="124.72449" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РќРѕРјРµРЅРєР»Р°С‚СѓСЂР° С‚РѕРІР°СЂРѕРІ, РїРѕРјРµС‰С‘РЅРЅС‹С… РЅР° С…СЂР°РЅРµРЅРёРµ Р·Р° РѕС‚С‡С‘С‚РЅС‹Р№ РїРµСЂРёРѕРґ"/>
      <TfrxMemoView Name="Memo14" ShiftMode="smWhenOverlapped" Left="377.953" Top="-1.48492329543615E-15" Width="124.72449" Height="124.72449" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РџРµСЂРµРІРѕР·С‡РёРєРё С‚РѕРІР°СЂРѕРІ"/>
      <TfrxMemoView Name="Memo15" ShiftMode="smWhenOverlapped" Left="502.67749" Top="-1.48492329543615E-15" Width="64.25201" Height="124.72449" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="Р”РµРєР»Р°СЂР°РЅС‚С‹ С‚РѕРІР°СЂРѕРІ"/>
      <TfrxMemoView Name="Memo16" ShiftMode="smWhenOverlapped" Left="566.9295" Top="-1.48492329543615E-15" Width="196.53556" Height="124.72449" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РџРѕР»СѓС‡Р°С‚РµР»Рё С‚РѕРІР°СЂРѕРІ"/>
      <TfrxMemoView Name="Memo17" ShiftMode="smWhenOverlapped" Left="763.46506" Top="-1.48492329543615E-15" Width="56.69295" Height="124.72449" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ С‚РѕРІР°СЂРЅС‹С… РїР°СЂС‚РёР№ РІС‹РґР°РЅРЅС‹С… СЃ РЎР’РҐ Р·Р° РѕС‚С‡С‘С‚РЅС‹Р№ РїРµСЂРёРѕРґ, РєРѕР»РёС‡РµСЃС‚РІРѕ РґРµРєР»Р°СЂР°С†РёР№ РЅР° С‚РѕРІР°СЂС‹"/>
      <TfrxMemoView Name="Memo18" ShiftMode="smWhenOverlapped" Left="820.15801" Top="-1.48492329543615E-15" Width="226.7718" Height="94.48825" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РћР±С‰РёРµ СЃСѓРјРјР°СЂРЅС‹Рµ СЃС‚Р°С‚РёСЃС‚РёС‡РµСЃРєРёРµ РґР°РЅРЅС‹Рµ Рѕ С‚РѕРІР°СЂР°С… РїРѕРјРµС‰РµРЅРЅС‹С… РЅР° РЎР’РҐ Рё РІС‹РґР°РЅРЅС‹С… СЃ РЅРµРіРѕ Р·Р° РѕС‚С‡С‘С‚РЅС‹Р№ РїРµСЂРёРѕРґ (РІРµСЃ, СЃС‚РѕРёРјРѕСЃС‚СЊ, РєРѕР»РёС‡РµСЃС‚РІРѕ РіСЂСѓР·РѕРІС‹С… РјРµСЃС‚, РІР·С‹СЃРєР°РЅРЅС‹Рµ С‚Р°РјРѕР¶РµРЅРЅС‹Рµ РїР»Р°С‚РµР¶Рё)"/>
      <TfrxMemoView Name="Memo19" ShiftMode="smWhenOverlapped" Left="1046.92981" Top="-1.48492329543615E-15" Width="68.03154" Height="124.72449" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Rotation="90" VAlign="vaCenter" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ РґРµР» РѕР± РђРџ, Р·Р°РІРµРґС‘РЅРЅС‹С… Р·Р° РѕС‚С‡С‘С‚РЅС‹Р№ РїРµСЂРёРѕРґ РІ РѕС‚РЅРѕС€РµРЅРёРё РІР»Р°РґРµР»СЊС†Р° РЎР’РҐ СЃ СѓРєР°Р·Р°РЅРёРµРј РЅРѕРјРµСЂРѕРІ СЃС‚Р°С‚РµР№ РѕР± РђРџ"/>
      <TfrxMemoView Name="Memo20" ShiftMode="smWhenOverlapped" Left="56.69295" Top="124.72449" Width="56.69295" Height="18.89765" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="2"/>
      <TfrxMemoView Name="Memo21" ShiftMode="smWhenOverlapped" Left="113.3859" Top="124.72449" Width="56.69295" Height="18.89765" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="3"/>
      <TfrxMemoView Name="Memo22" ShiftMode="smWhenOverlapped" Left="170.07885" Top="124.72449" Width="45.35436" Height="18.89765" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="4"/>
      <TfrxMemoView Name="Memo23" ShiftMode="smWhenOverlapped" Left="215.43321" Top="124.72449" Width="162.51979" Height="18.89765" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="5"/>
      <TfrxMemoView Name="Memo24" ShiftMode="smWhenOverlapped" Left="377.953" Top="124.72449" Width="124.72449" Height="18.89765" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="6"/>
      <TfrxMemoView Name="Memo25" ShiftMode="smWhenOverlapped" Left="502.67749" Top="124.72449" Width="64.25201" Height="18.89765" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="7"/>
      <TfrxMemoView Name="Memo26" ShiftMode="smWhenOverlapped" Left="566.9295" Top="124.72449" Width="196.53556" Height="18.89765" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="8"/>
      <TfrxMemoView Name="Memo27" ShiftMode="smWhenOverlapped" Left="763.46506" Top="124.72449" Width="56.69295" Height="18.89765" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="9"/>
      <TfrxMemoView Name="Memo28" ShiftMode="smWhenOverlapped" Left="820.15801" Top="124.72449" Width="226.7718" Height="18.89765" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="10"/>
      <TfrxMemoView Name="Memo29" ShiftMode="smWhenOverlapped" Left="1046.92981" Top="124.72449" Width="68.03154" Height="18.89765" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="11"/>
      <TfrxMemoView Name="Memo40" Left="820.15801" Top="109.60637" Width="37.7953" Height="15.11812" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РєРі."/>
      <TfrxMemoView Name="Memo41" Left="857.95331" Top="109.60637" Width="37.7953" Height="15.11812" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="СЂСѓР±."/>
      <TfrxMemoView Name="Memo42" Left="895.74861" Top="109.60637" Width="37.7953" Height="15.11812" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РјРµСЃС‚"/>
      <TfrxMemoView Name="Memo43" Left="933.54391" Top="109.60637" Width="37.7953" Height="15.11812" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РєРі."/>
      <TfrxMemoView Name="Memo44" Left="971.33921" Top="109.60637" Width="37.7953" Height="15.11812" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="СЂСѓР±."/>
      <TfrxMemoView Name="Memo45" Left="1009.13451" Top="109.60637" Width="37.7953" Height="15.11812" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РјРµСЃС‚"/>
      <TfrxMemoView Name="Memo46" Left="820.15801" Top="94.48825" Width="113.3859" Height="15.11812" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РїСЂРёС…РѕРґ"/>
      <TfrxMemoView Name="Memo47" Left="933.54391" Top="94.48825" Width="113.3859" Height="15.11812" ShowHint="False" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="СЂР°СЃС…РѕРґ"/>
    </TfrxPageHeader>
    <TfrxMasterData Name="MasterData1" Height="18.89765" Left="0" Top="268.34663" Width="1122.52041" OnBeforePrint="MasterData1OnBeforePrint" AllowSplit="True" ColumnWidth="0" ColumnGap="0" DataSet="qryStores" DataSetName="qryStores" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo6" Left="857.95331" Top="4.66293670342566E-15" Width="37.7953" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[FormatFloat('0.##', iValue)]"/>
      <TfrxMemoView Name="Memo1" Left="170.07885" Top="4.66293670342566E-15" Width="45.35436" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[iCountPart]"/>
      <TfrxMemoView Name="Memo2" Left="215.43321" Top="4.66293670342566E-15" Width="162.51979" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vTov]"/>
      <TfrxMemoView Name="Memo3" Left="566.9295" Top="4.66293670342566E-15" Width="196.53556" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vRecipient]"/>
      <TfrxMemoView Name="Memo4" Left="377.953" Top="4.66293670342566E-15" Width="124.72449" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[vCarrier]"/>
      <TfrxMemoView Name="Memo5" Left="820.15801" Top="4.66293670342566E-15" Width="37.7953" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[iG35]"/>
      <TfrxMemoView Name="Memo7" Left="895.74861" Top="4.66293670342566E-15" Width="37.7953" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[iG311]"/>
      <TfrxMemoView Name="qryStoresNAME" Left="56.69295" Top="4.66293670342566E-15" Width="56.69295" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" DataField="NAME" DataSet="qryStores" DataSetName="qryStores" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[qryStores.&#34;NAME&#34;]"/>
      <TfrxMemoView Name="Memo30" Left="502.67749" Top="4.66293670342566E-15" Width="64.25201" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo31" Left="763.46506" Top="4.66293670342566E-15" Width="56.69295" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[iCountPartOut]"/>
      <TfrxMemoView Name="Memo35" Left="1046.92981" Top="4.66293670342566E-15" Width="68.03154" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo36" Left="113.3859" Top="4.66293670342566E-15" Width="56.69295" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo37" Left="7.55906" Top="4.66293670342566E-15" Width="49.13389" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[qryStores.&#34;CUSTOMS_NAME&#34;]"/>
      <TfrxMemoView Name="Memo32" Left="971.33921" Top="4.66293670342566E-15" Width="37.7953" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[FormatFloat('0.##', iValueOut)]"/>
      <TfrxMemoView Name="Memo33" Left="933.54391" Top="4.66293670342566E-15" Width="37.7953" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[iRelG35]"/>
      <TfrxMemoView Name="Memo34" Left="1009.13451" Top="4.66293670342566E-15" Width="37.7953" Height="18.89765" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[iRelG311]"/>
    </TfrxMasterData>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="204" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="242" Left="492" Top="144" Width="360" OnActivate="DialogPage1OnActivate">
    <TfrxColorFrameControl Name="ColorFrame10" Left="8" Top="8" Width="324" Height="80" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="Место хранения" Color="-16777201"/>
    <TfrxEditControl Name="fldStoreLicNum" Left="103" Top="31" Width="106" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxLabelControl Name="lblNumLicence" Left="18" Top="35" Width="65" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="№ лицензии:" Color="-16777201"/>
    <TfrxButtonControl Name="btnCallRef" Left="183" Top="32" Width="24" Height="18" Font.Charset="204" Font.Color="-16777208" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="1" ParentFont="False" ShowHint="True" OnClick="btnCallRefOnClick"/>
    <TfrxDateEditControl Name="fldStoreLicDate" Left="227" Top="31" Width="87" Height="23" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38247" Time="38247"/>
    <TfrxEditControl Name="lblStoreName" Left="19" Top="56" Width="295" Height="23" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxColorButtonControl Name="cbtnOk" Left="164" Top="172" Width="75" Height="25" ShowHint="True" Caption="Просмотр" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="1" OnClick="cbtnOkOnClick"/>
    <TfrxColorButtonControl Name="ColorButton1" Left="254" Top="172" Width="75" Height="25" ShowHint="True" Caption="Отмена" Color="-16777201" Flat="False" GradientType="gtTopToBottom" ModalResult="2"/>
    <TfrxColorFrameControl Name="cfrmPeriod" Left="9" Top="92" Width="322" Height="64" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" Enabled="False" ShowHint="True" BorderWidth="0" FormCaption="False" RectCaption="False" Caption="За период" Color="-16777201"/>
    <TfrxLabelControl Name="lblFrom" Left="16" Top="120" Width="11" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="С" Color="-16777201"/>
    <TfrxLabelControl Name="lblTo" Left="159" Top="122" Width="12" Height="13" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="по" Color="-16777201"/>
    <TfrxDateEditControl Name="dtFrom" Left="35" Top="117" Width="116" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38247" Time="38247"/>
    <TfrxDateEditControl Name="dtTo" Left="185" Top="118" Width="112" Height="21" Font.Charset="204" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="38247" Time="38247"/>
  </TfrxDialogPage>
</TfrxReport>
